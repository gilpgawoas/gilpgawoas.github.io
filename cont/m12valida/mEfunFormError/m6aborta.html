<section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">false</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span class="resaltado"> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span class="resaltado">  status: ProblemDetails::BadRequest,</span>
<span class="resaltado">  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span class="resaltado">  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span class="resaltado"> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">false</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Response</h1>
 <div class="resaltado">
  <details>
   <summary>
    HTTP/1.1 400 Bad Request
   </summary>
   Server: openresty<br>
   Date: Fri, 02 May 2025 13:53:21 GMT<br>
   Content-Type: application/problem+json<br>
   Transfer-Encoding: chunked<br>
   Connection: keep-alive
  </details>
  {"title":"Falta el saludo.","type":"\/error\/faltasaludo.html"}
 </div>
</section>