<!DOCTYPE html>
<html lang="es">

<head>
 <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" sizes="32x32" href="/favicon.ico">
<meta name="theme-color" content="#039623">
<link rel="manifest" href="/site.webmanifest">
<script src="/lib/js/muestra-codigo.js"></script>
 <title>Aplicaciones web orientadas a servicios y mashups - GilPG AWOAS</title>
 <meta name="description" content="PÃ¡gina para imprimir todo el contenido de GilPG AWOAS, que introduce conceptos de desarrollo multiplataforma.">
 <style>
 /* https://paletton.com/#uid=74W0u0kllllaFw0g0qFqFg0w0aF */
 :root {
  --marginTop: 0.25rem;
  --padTop: 0;
  --h1PadTop: 2.5rem;
  --introDuracion: 2s;
  --introFuncion: ease-out;
  --padCont: 0.5rem;
  --padNav: 0.75rem 0.5rem;
  --anchoNav: 300px;
  --anchoLectura: 900px;
  --colLetra: black;
  --colFondo: white;
  --colPush: var(--colFondo);
  --colPushHover: var(--colFondo);
  --colPushFocus: var(--colFondo);
  --colPushActive: #bae397;
  --colFondoPush: #609732;
  --colFondoPushHover: #8abd5f;
  --colFondoPushFocus: #3e7213;
  --colFondoPushActive: #224c00;
  --paddingPush: 0.2rem 0.3rem;
  --borderPush: none;
  --borderRadiusPush: 0.6em;
  --colA: #6a7b15;
  --colAVisited: #6f256f;
  --colAActive: #e498af;
  --colAPush: var(--colFondo);
  --colAVisitedPush: var(--colFondo);
  --colAPushHover: var(--colFondo);
  --colAVisitedPushHover: var(--colFondo);
  --colAPushFocus: var(--colFondo);
  --colAVisitedPushFocus: var(--colFondo);
  --colAPushActive: var(--colFondo);
  --colAVisitedPushActive: var(--colFondo);
  --colFondoAPush: #6a7b15;
  --colFondoAVisitedPush: #6f256f;
  --colFondoAPushHover: #91a437;
  --colFondoAVisitedPushHover: #a66fa6;
  --colFondoAPushFocus: #445200;
  --colFondoAVisitedPushFocus: #530e53;
  --colFondoAPushActive: #e498af;
  --colFondoAVisitedPushActive: #e498af;
  --colSombra: #49494980;
  --navSombra: 0.5rem 0 0.5rem var(--colSombra);
  --shadowTitulo: 3px 1px 2px black;
  /* --colTitulo: #bae397; */
  --colTitulo: #609732;
  /* --colTituloFondo: #609732; */
  --colPrincipalTituloStrong: #6E256E;
  --colAStrong: var(--colLetra);
  /* --colNavH1Sel: #b35f7c; */
  --colFondoNav: var(--colFondo);
  --colFondoNavSel: #e498af;
  --colScrollbar: #CFD8DC;
  --colThumb: #90a4ae;
  --colThumbActivo: #3f3f3f;
  --colResaltado: #e9c8d2;
  --colResaltado2: #bae397;
  --colResaltado3: #cfcfcf;
  --colLetraResaltado: black;
  --colLetraCodeComment: #224c00;
  --colLetraCodeString: #903357;
  --colLetraCodeReserved: #445200;
  --colSecundario: #e498af;
  --colTarget: #cef4ff;
  --colStack1: black;
  --colStack2: #224ba5;
  --colStack3: #92731f;
  --anchoThumb: 7px;
  --borderRadiusThumb: 3.5px;
  --gap: 0.5rem;
  --fontMono: 'Xanh Mono', monospace;
  --fontSans: 'Patrick Hand', sans-serif;
  /* --fontSerif: 'Purple Purse', serif; */
  --fontSerif: Georgia, 'Times New Roman', Times, serif;
  font-family: var(--fontSerif);
  color: var(--colLetra);
  background-color: var(--colFondo);
  scrollbar-width: thin;
  scrollbar-color: var(--colThumb) var(--colScrollbar);
 }

 @media (prefers-color-scheme: light) {
  :root {
   --colLetra: black;
   --colFondo: white;
  }
 }

 /* https://paletton.com/#uid=74W0u0kaVz84jP27qHbeJtFiHpX */
 @media (prefers-color-scheme: dark) {

  :root {
   --colLetra: white;
   /* --colFondo: #272727; */
   --colFondo: black;
   --colPushActive: #e3f5d4;
   --colFondoPush: #bbe697;
   --colFondoPushHover: #d0eeb7;
   --colFondoPushFocus: #9ed372;
   --colFondoPushActive: #7db84d;
   --colA: #e9f7a3;
   --colAVisited: #c89ac8;
   --colAActive: #983351;
   --colFondoAPush: #e9f7a3;
   --colFondoAVisitedPush: #c89ac8;
   --colFondoAPushHover: #f6fcda;
   --colFondoAVisitedPushHover: #dec0de;
   --colFondoAPushFocus: #b4c853;
   --colFondoAVisitedPushFocus: #9a539a;
   --colFondoAPushActive: #983351;
   --colFondoAVisitedPushActive: #983351;
   --colSombra: #00000080;
   --colTitulo: #e3f5d4;
   --colPrincipalTituloStrong: #C899C8;
   /* --colTituloFondo: #7db84d; */
   /* --colNavH1Sel: #d37290; */
   --colFondoNavSel: #7a3059;
   --colScrollbar: #616161;
   --colThumb: #ffffff;
   --colResaltado: #7a3059;
   --colResaltado2: #5c922f;
   --colResaltado3: #4e4e4e;
   --colLetraResaltado: white;
   --colLetraCodeComment: #d0eeb7;
   --colLetraCodeString: #eeb7c8;
   --colLetraCodeReserved: #f0fac0;
  }
 }

 /* xanh-mono-regular - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Xanh Mono';
  font-style: normal;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/xanh-mono-v18-latin_latin-ext-regular.woff2') format('woff2');
 }

 /* xanh-mono-italic - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Xanh Mono';
  font-style: italic;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/xanh-mono-v18-latin_latin-ext-italic.woff2') format('woff2');
 }

 /* patrick-hand-regular - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Patrick Hand';
  font-style: normal;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/patrick-hand-v23-latin_latin-ext-regular.woff2') format('woff2');
 }

 /* purple-purse-regular - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Purple Purse';
  font-style: normal;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/purple-purse-v23-latin_latin-ext-regular.woff2') format('woff2');
 }

 @font-face {
  font-family: 'Material Symbols Outlined';
  font-style: normal;
  src:
   url(/fonts/MaterialSymbolsOutlined[FILL\,GRAD\,opsz\,wght].woff2) format('woff2'),
   url(/fonts/MaterialSymbolsOutlined[FILL\,GRAD\,opsz\,wght].ttf) format('truetype');
 }

 .material-symbols-outlined {
  font-family: 'Material Symbols Outlined';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  width: 24px;
  height: 24px;
  /* Preferred icon size */
  display: inline-block;
  line-height: 1;
  text-transform: none;
  letter-spacing: normal;
  word-wrap: normal;
  white-space: nowrap;
  direction: ltr;
 }

 body::-webkit-scrollbar {
  width: var(--anchoThumb);
  height: var(--anchoThumb);
 }

 body::-webkit-scrollbar-track {
  background: var(--colScrollbar);
 }

 body::-webkit-scrollbar-thumb {
  background-color: var(--colThumb);
  border-radius: var(--borderRadiusThumb);
 }

 body::-webkit-scrollbar-thumb:active {
  background-color: var(--colThumbActivo);
 }

 body {
  margin-top: 0;
 }

 a {
  color: var(--colA);
 }

 a:visited {
  color: var(--colAVisited);
 }

 a:active {
  color: var(--colAActive);
 }

 .anterior,
 .siguiente,
 .paginaAnterior,
 .paginaSiguiente,
 button {
  display: inline-block;
  padding: var(--paddingPush);
  border: var(--borderPush);
  border-radius: var(--borderRadiusPush);
  text-align: center;
  text-decoration: none;
 }

 .anterior,
 .siguiente,
 .paginaAnterior,
 .paginaSiguiente {
  color: var(--colAPush);
  background-color: var(--colFondoAPush);
 }

 .anterior:visited,
 .siguiente:visited,
 .paginaAnterior:visited,
 .paginaSiguiente:visited {
  color: var(--colAVisitedPush);
  background-color: var(--colFondoAVisitedPush);
 }

 .anterior.bye,
 .siguiente.bye,
 .paginaAnterior.bye,
 .paginaSiguiente.bye {
  display: none;
 }

 .anterior:hover,
 .siguiente:hover,
 .paginaAnterior:hover,
 .paginaSiguiente:hover {
  color: var(--colAPushHover);
  background-color: var(--colFondoAPushHover);
 }

 .anterior:visited:hover,
 .siguiente:visited:hover,
 .paginaAnterior:visited:hover,
 .paginaSiguiente:visited:hover {
  color: var(--colAVisitedPushHover);
  background-color: var(--colFondoAVisitedPushHover);
 }

 .anterior:focus,
 .siguiente:focus,
 .paginaAnterior:focus,
 .paginaSiguiente:focus {
  color: var(--colAPushFocus);
  background-color: var(--colFondoAPushFocus);
 }

 .anterior:visited:focus,
 .siguiente:visited:focus,
 .paginaAnterior:visited:focus,
 .paginaSiguiente:visited:focus {
  color: var(--colAVisitedPushFocus);
  background-color: var(--colFondoAVisitedPushFocus);
 }

 .anterior:active,
 .siguiente:active,
 .paginaAnterior:active,
 .paginaSiguiente:active {
  color: var(--colAPushActive);
  background-color: var(--colFondoAPushActive);
 }

 .anterior:visited:active,
 .siguiente:visited:active,
 .paginaAnterior:visited:active,
 .paginaSiguiente:visited:active {
  color: var(--colAVisitedPushActive);
  background-color: var(--colFondoAVisitedPushActive);
 }

 button {
  color: var(--colPush);
  background-color: var(--colFondoPush);
 }

 button:hover {
  color: var(--colPushHover);
  background-color: var(--colFondoPushHover);
 }

 button:focus {
  color: var(--colPushFocus);
  background-color: var(--colFondoPushFocus);
 }

 button:active {
  color: var(--colPushActive);
  background-color: var(--colFondoPushActive);
 }

 .anterior span,
 .siguiente span,
 .paginaAnterior span,
 .paginaSiguiente span,
 button span {
  vertical-align: middle;
 }

 a[data-logo] {
  display: block;
  height: 54px;
  line-height: 54px;
  padding-left: 54px;
  margin-top: 1rem;
  background-image: url("/img/icono/maskable_icon_x48.png");
  background-position: 3px center;
  background-repeat: no-repeat;
 }

 a strong,
 a code,
 h1 strong,
 h1 code {
  font-size: 1em;
 }

 a strong,
 a code {
  color: var(--colAStrong);
 }

 nav a {
  font-family: var(--fontSans);
 }

 pre {
  font-family: var(--fontMono);
 }

 code {
  font-family: var(--fontMono);
  font-size: 1rem;
 }

 .tree {
  font-family: var(--fontSans);
 }

 .tree summary {
  text-decoration: underline;
  cursor: pointer;
 }

 .tree li {
  margin-top: 1em;
  margin-bottom: 1em;
 }

 h1:not(.default) {
  font-family: var(--fontSans);
  color: var(--colTituloFondo);
 }

 h1,
 .lectura a,
 .lectura p,
 .lectura blockquote {
  overflow-wrap: anywhere;
 }

 .autor {
  font-family: var(--fontSans);
  font-size: 1.5rem;
  color: var(--colTituloFondo);
 }

 figure {
  text-align: center;
 }

 figure img {
  width: 100%;
 }

 figcaption {
  font-family: var(--fontMono);
 }

 .print .noPrint {
  display: none;
 }

 @media print {
  .noPrint {
   display: none;
  }

  .pruebaDeEscritorio {
   page-break-before: always;
  }
 }

 iframe {
  box-sizing: border-box;
  width: 300px;
 }

 .lectura {
  max-width: var(--anchoLectura);
  margin: 1rem auto;
 }

 .lectura p,
 .lectura blockquote {
  text-align: justify;
 }

 .horizontal {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  align-items: start;
  justify-content: center;
 }

 .horizontal>*:first-child {
  flex: 1 1 300px;
  text-align: center;
 }

 .horizontal>*:nth-child(2) {
  flex: 1 1 auto;
 }

 .columnas4 {
  columns: 4 180px;
  column-gap: 1rem;
 }

 .columnas2 {
  columns: 2 360px;
  column-gap: 1rem;
 }

 .resaltado {
  background-color: var(--colResaltado);
  color: var(--colLetraResaltado);
 }

 .resaltado2 {
  background-color: var(--colResaltado2);
  color: var(--colLetraResaltado);
 }

 .resaltado3 {
  background-color: var(--colResaltado3);
  color: var(--colLetraResaltado);
 }

 table.borde {
  margin-left: auto;
  margin-right: auto;
 }

 table.borde,
 table.borde td {
  border: thin solid;
  border-collapse: collapse;
 }

 table.borde th,
 table.borde td {
  padding: 0.4rem;
 }

 table.codeShow {
  margin-left: auto;
  margin-right: auto;
 }

 .codeShow td:first-child {
  text-align: right;
  padding: 0 0 0 0;
  vertical-align: top;
  font-family: var(--fontMono);
  white-space: pre;
  font-size: 1rem;
  line-height: 1.2rem;
  /* Avoid selection */
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
 }

 .codeShow td:nth-child(2) {
  padding: 0 0 0 0.25rem;
  vertical-align: top;
  font-family: var(--fontMono);
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  font-size: 1rem;
  line-height: 1.2rem;
 }

 .codeReserved {
  color: var(--colLetraCodeReserved);
  font-weight: bolder;
 }

 .codeString {
  color: var(--colLetraCodeString);
  font-weight: 600;
 }

 .codeComment {
  color: var(--colLetraCodeComment);
  font-style: italic;
 }

 @media print {

  .codeShow button {
   display: none;
  }
 }


 footer {
  margin-top: 1rem;
  display: block;
  text-align: center;
  font-family: var(--fontSans);
  font-size: small;
 }
</style>
 <style>
 .pruebaDeEscritorio {
  font-family: var(--fontSans);
 }

 .pruebaDeEscritorio .section,
 .pruebaDeEscritorio section {
  display: inline-block;
  vertical-align: top;
 }

 .pruebaDeEscritorio section {
  margin: 1em;
 }

 .section section {
  display: block;
 }

 .pruebaDeEscritorio section pre {
  margin: 0;
 }

 .pruebaDeEscritorio samp {
  font-weight: bold;
 }

 .pruebaDeEscritorio .activo {
  display: inline-block;
  margin: 0 0.2rem 0 0;
  vertical-align: top;
  background-color: var(--colSecundario);
  border: 1px solid var(--colSecundario);
 }

 .pruebaDeEscritorio :target,
 .pruebaDeEscritorio :target caption {
  background-color: var(--colTarget);
 }

 .pruebaDeEscritorio .numero1 {
  display: inline-block;
  margin: 0 0.2rem 0 0;
  color: var(--colStack1);
  border: 1px solid var(--colStack1);
 }

 .pruebaDeEscritorio .numero2 {
  display: inline-block;
  color: var(--colStack2);
  border: 1px solid var(--colStack2);
 }

 .pruebaDeEscritorio .numero3 {
  display: inline-block;
  color: var(--colStack3);
  border: 1px solid var(--colStack3);
 }

 .pruebaDeEscritorio a.parametro1,
 .pruebaDeEscritorio .parametro1 {
  color: var(--colPar1);
 }

 .pruebaDeEscritorio a.parametro2,
 .pruebaDeEscritorio .parametro2 {
  color: var(--colPar2);
 }

 .pruebaDeEscritorio .descongela {
  color: var(--colDescongela);
 }

 .pruebaDeEscritorio table.tabla1,
 .pruebaDeEscritorio table.tabla1 th,
 .pruebaDeEscritorio table.tabla1 td {
  border: 1px solid var(--colStack1);
 }

 .pruebaDeEscritorio table.tabla2,
 .pruebaDeEscritorio table.tabla2 th,
 .pruebaDeEscritorio table.tabla2 td {
  border: 1px solid var(--colStack2);
 }

 .pruebaDeEscritorio table.tabla3,
 .pruebaDeEscritorio table.tabla3 th,
 .pruebaDeEscritorio table.tabla3 td {
  border: 1px solid var(--colStack3);
 }

 .pruebaDeEscritorio .frame {
  font-family: var(--fontMono);
  border-collapse: collapse;
 }

 .pruebaDeEscritorio .frame,
 .pruebaDeEscritorio .frame th,
 .pruebaDeEscritorio .frame td {
  border: thin solid;
 }

 .pruebaDeEscritorio .frame caption {
  font-style: italic;
 }

 .pruebaDeEscritorio .objeto caption {
  text-decoration: underline;
  font-style: italic;
 }

 .pruebaDeEscritorio .creaciÃ³n {
  display: flex;
 }
</style>
</head>

<body class="print">
   <h1 class="sitio">Aplicaciones web orientadas a servicios y mashups</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <p class="autor">por Gilberto Pacheco Gallegos</p>
 <ul>
  <li>
   <p>
    Este curso trata sobre pÃ¡ginas web que se comunican, sin recargarse, con un
    tipo de software conocido como <dfn>servicio</dfn>, alojado en servidores.
   </p>
  </li>
  <li>
   <p>
    Otros tipos de app, como apps mÃ³viles y de escritorio tambiÃ©n se pueden
    conectar a un servicio.
   </p>
  </li>
  <li>
   <p>
    Este curso tambiÃ©n se muestra la construcciÃ³n de <dfn>mashups</dfn>, tÃ©cnica
    que consiste en agregar el contenido de otros sitios.
   </p>
  </li>
  <li>
   <p>
    TambiÃ©n se muestran los fundamentos para construir e-commerce.
   </p>
  </li>
  <li>
   <p>
    Los chats con websockets se han sustituido por un chat con MQTT, que es mÃ¡s
    sencillo.
   </p>
  </li>
  <li>
   <p>
    Utiliza el botÃ³n
    <button type="button" title="MenÃº" style="vertical-align: middle">
     <span class="material-symbols-outlined">
      menu
     </span>
    </button>
    para mostrar el menÃº de navegaciÃ³n, o el enlace
    <span class="material-symbols-outlined"
      style="display: inline-block; vertical-align: middle">
     skip_next
    </span>
    para avanzar a las siguietes paginas. La pÃ¡gina
    <a href="m00instrucciones.html">Instrucciones de navegaciÃ³n</a>
    te muestra otras opciones para desplazarte por el sitio.
   </p>
  </li>
 </ul>
 <nav>
  <h1>Lecciones</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m00previos.html">Conocimientos requeridos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m00instrucciones.html">Instrucciones de navegaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01software.html">Software a instalar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/">Aplicaciones Orientadas a Servicios</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/">Ejemplo de servicio</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/">Arquitectura orientada a servicios</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m04geolocalizacion.html">Ejemplo de geolocalizaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m05sociales.html">Ejemplo de redes sociales</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m06ecommerce/">CaracterÃ­sticas de un e-commerce</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/">Servicio que devuelve JSON</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/">Servicio que recibe y devuelve JSON</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/">Servicio que procesa una forma</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/">Servicio que valida datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/">Mostrar datos en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/">Renderizado del lado del cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/">Renderizado del lado del servidor</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/">Bases de datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/">Chat sencillo - Protocolos de comunicaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m16streaming.html">Ejemplo de streaming</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/">Relaciones a uno en la base de datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/">Relaciones a muchos - Usuarios y roles</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/">AutenticaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/">Archivos en la base de datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/">Compras sencillas</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/">Pruebas</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/">Servicio con token</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >1. Conocimientos requeridos</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Puedes ver el listado de mis sitios educativos en
    <a href="https://gilpgcl.github.io" target="_blank"
      rel="noreferrer">https://gilpgcl.github.io</a>.
   </p>
  </li>
  <li>
   <p>
    Este curso es continuaciÃ³n de
    <a href="https://gilpgiti.github.io" rel="noreferrer"
      target="_blank">https://gilpgiti.github.io</a>,
    <a href="https://gilpgijs.github.io" rel="noreferrer"
      target="_blank">https://gilpgijs.github.io</a>
    y
    <a href="https://gilpgihc.github.io" rel="noreferrer"
      target="_blank">https://gilpgihc.github.io</a>.
    Mucho contenido que originalmente aparecÃ­a en este sitio, se ha desplazado a
    estos sitios.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >2. Instrucciones de navegaciÃ³n</h1><div class="lectura">
 <section class="noPrint">
 <ul>
  <li>
   <p>
    Los siguientes controles te permitirÃ¡n navegar por todo el contenido del
    sitio.
   </p>
   <dl>
    <dt>
     <button type="button" title="Cierra" style="vertical-align: middle">
      <span class="material-symbols-outlined">
       close
      </span>
     </button>
    </dt>
    <dd>
     <p>Oculta el menÃº de navegaciÃ³n.</p>
    </dd>
    <dt>
     <button type="button" title="MenÃº" style="vertical-align: middle">
      <span class="material-symbols-outlined">
       menu
      </span>
     </button>
    </dt>
    <dd>
     <p>Muestra el menÃº de navegaciÃ³n.</p>
    </dd>
    <dt>
     <span class="anterior" title="PÃ¡gina anterior"
       style="vertical-align: middle">
      <span class="material-symbols-outlined">
       skip_previous
      </span></span>
    </dt>
    <dt>
     <span class="material-symbols-outlined"
       style="display: inline-block; vertical-align: middle">
      arrow_back
     </span> (Tecla flecha a la izquierda)
    </dt>
    <dt>
     Swipe hacia la derecha
    </dt>
    <dd>
     <p>Regresa a la pÃ¡gina anterior.</p>
    </dd>
    <dt>
     <span class="siguiente" title="PÃ¡gina siguiente"
       style="vertical-align: middle">
      <span class="material-symbols-outlined">
       skip_next
      </span>
     </span>
    </dt>
    <dt>
     <span class="material-symbols-outlined"
       style="display: inline-block; vertical-align: middle">
      arrow_forward
     </span> (Tecla flecha a la derecha)
    </dt>
    <dt>
     Swipe hacia la izquierda
    </dt>
    <dd>
     <p>Avanza a la pÃ¡gina siguiente.</p>
    </dd>
   </dl>
  </li>
 </ul>
</section>
</div>
      </section>
     <section >
         <h1 >3. Software a instalar</h1><div class="lectura">
 <dl>
  <dt>Microsoft Edge Chromium</dt>
  <dd>
   <ul>
    <li>
     <p>
      Ya viene instalado en las computadoras mÃ¡s nuevas, pero si la tuya
      no lo tiene, lo puedes descargar de
      <a href="https://www.microsoft.com/es-es/edge" rel="noreferrer"
        target="_blank">https://www.microsoft.com/es-es/edge</a>.
     </p>
    </li>
    <li class="noPrint">
     <p>
      <a href="https://drive.google.com/file/d/1Wwsq6D3MaX8CDPpCIu53p9Lvx_42D5ou/view?usp=sharing"
        target="_blank" rel="noreferrer">Video de instalaciÃ³n.</a>
     </p>
    </li>
   </ul>
  </dd>
  <dt>Mozilla Firefox</dt>
  <dd>
   <ul>
    <li>
     <p>
      Lo puedes descargar de
      <a href="https://www.mozilla.org"
        target="_blank" rel="noreferrer">https://www.mozilla.org</a>.
     </p>
    </li>
    <li class="noPrint">
     <p>
      <a href="https://drive.google.com/file/d/1Wr5AZUh1isg2qH0GtzQrz-MwjCfm2ZJC/view?usp=sharing"
        target="_blank" rel="noreferrer">Video de InstalaciÃ³n.</a>
     </p>
    </li>
   </ul>
  </dd>
  <dt>Google Chrome</dt>
  <dd>
   <ul>
    <li>
     <p>
      Lo puedes descargar de
      <a href="https://google.com/chrome"
        target="_blank" rel="noreferrer">https://google.com/chrome</a>.
     </p>
    </li>
    <li class="noPrint">
     <p>
      <a href="https://drive.google.com/file/d/1DvSCM9GSypdK1GEI7EpBnIp9olPG3zNE/view?usp=sharing"
        target="_blank" rel="noreferrer">Video de InstalaciÃ³n.</a>
     </p>
    </li>
   </ul>
  </dd>
  <dt>PHP</dt>
  <dd>
   <dl>
    <dt>Para Linux y apple</dt>
    <dd>
     <p>Se puede instalar desde las tiendas de software.</p>
    </dd>
    <dt>Para Windows</dt>
    <dd>
     <ol>
      <li>
       <p>
        Descarga la versiÃ³n Thread Safe que corresponda a la arquitectura de tu
        computadora (x64 o x86, la mayprÃ­a son x64) desde
        <a target="_blank" rel="noreferrer"
          href="https://windows.php.net/download#php-8.3">https://windows.php.net/download#php-8.3</a>.
       </p>
      </li>
      <li>
       <p>Crea una carpeta con nombre <em>php</em> en el disco <em>C:</em> y
        descompacta ahÃ­ el php
       </p>
      </li>
      <li>
       <p>Edita el archivo C:\php\php.ini con el siguiente contenido</p>
       <pre><code>extension = php_mbstring.dll
extension=php_pdo_sqlite.dll
extension=php_pdo_mysql.dll
extension=php_openssl.dll
extension=php_sockets.dll
extension=php_fileinfo.dll
zend_extension = xdebug
xdebug.mode = debug
xdebug.start_with_request = yes
</code></pre>
      </li>
      <li>
       <p>
        AÃ±ade la ruta <em>C:\php</em> a la variable de ambiente PATH.
       </p>
       <ol>
        <li>
         <p>
          Haz clic en el logo de Windows.
         </p>
        </li>
        <li>
         <p>
          Haz clic en ConfiguraciÃ³n.
         </p>
        </li>
        <li>
         <p>
          Haz clic en Sistema.
         </p>
        </li>
        <li>
         <p>
          Haz clic en Acerca de.
         </p>
        </li>
        <li>
         <p>
          Haz clic en ConfiguraciÃ³n avanzada del sistema. Te pide que autorices.
          Autoriza.
         </p>
        </li>
        <li>
         <p>
          Haz clic en Variables de entorno.
         </p>
        </li>
        <li>
         <p>
          En Variables del sistema selecciona Path y haz clic en Editar...
         </p>
        </li>
        <li>
         <p>
          Haz clic en Nuevo. Se abre una entrada y en ella teclea
          <kbd>C:\php</kbd>. Haz clic en Aceptar.
         </p>
        </li>
        <li>
         <p>
          Haz clic en Aceptar para cerrar las variables de entorno.
         </p>
        </li>
        <li>
         <p>
          Haz clic en Aceptar para cerrar las propiedades del sistema.
         </p>
        </li>
       </ol>
      </li>
     </ol>
    </dd>
   </dl>
  </dd>
  <dt>Visual Studio Code</dt>
  <dd>
   <p>Usa la URL <a target="_blank" rel="noreferrer"
      href="https://code.visualstudio.com/">https://code.visualstudio.com/</a>.
   </p>
   <p>Instala las extensiones:</p>
   <ul>
    <li>es6-string-html de Tobermory</li>
    <li>anuragsingk-PHP Server de Anuragsingk</li>
    <li>PHP Debug de Xdebug</li>
    <li>PHP Estension Pack de Xdebug</li>
    <li>PHP Intellephsense de Ben Mewburn</li>
    <li>PHP IntelliSense de Damjan Cvetko</li>
   </ul>
   <p>
    Haz clic en el engrane de abajo a la izquierda <img alt=""
      src="/img/engrane.png"> y seleciona <em>Settings</em>. En
    <em>Extensions > PHP Server configuration</em> configura lo siguiente
   <dl>
    <dt>Phpserver Ip</dt>
    <dd>localhost</dd>
    <dt>Phpserver port</dt>
    <dd>80</dd>
   </dl>
   </p>
  </dd>
  <dt>Xdebug</dt>
  <dd>
   <ul>
    <li>
     <p>
      Crea una carpeta vacÃ­a y Ã¡brela con Visual Studio Code.
     </p>
    </li>
    <li>
     <p>
      Crea el archivo <em>index.php</em> con el siguiente contenido
     </p>
     <pre><code>&lt;?php

phpinfo();
</code></pre>
    </li>
    <li>
     <p>
      Haz clic derecho en <em>index.php</em> y selecciona
      <em>PHP Server: serve project</em>
     </p>
    </li>
    <li>
     <p>
      Sigue las instrucciones de <a target="_blank" rel="noreferrer"
        href="https://xdebug.org/wizard">https://xdebug.org/wizard</a>
     </p>
    </li>
   </ul>
  </dd>
 </dl>
</div>
      </section>
     <section>
         <h1 >4. Aplicaciones Orientadas a Servicios</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m01awoas/mAintro.html">Introduccion</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mAnube.html"><dfn>Nube computacional</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mBaw.html"><dfn>AplicaciÃ³n web</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mCservicio.html"><dfn>Servicio en la nube</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mDtipos.html">Tipos de servicios</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mEoferta.html">Servicios que se ofrecen en la nube</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mFmasUsados.html">Servicios de nube mÃ¡s usados</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mGaoas.html"><dfn>AplicaciÃ³n orientada a servicios</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mHawoas.html"><dfn>AplicaciÃ³n web orientada a servicios</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mImashups.html"><dfn>AplicaciÃ³n web hibrida (Mashup)</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m01awoas/mJresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. Introduccion</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se presentan los conceptos de:
   </p>
   <ul>
    <li>
     <p>
      aplicaciones web orientadas a servicios y
     </p>
    </li>
    <li>
     <p>
      mashups.
     </p>
    </li>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. <dfn>Nube computacional</dfn></h1><figure>
 <img src="/img/m01awoas/Imagen1.png">
</figure>
<div class="lectura">
 <ul>
  <li>
   <p>
    Es el conjunto de servidores remotos en Internet para gestionar archivos y
    aplicaciones.
   </p>
  </li>
  <li>
   <p>
    Una de las ventajas de una nube es que permite que los usuarios utilicen
    archivos y aplicaciones sin tener que instalar programas en una computadora
    con acceso aÂ Internet.
   </p>
  </li>
  <li>
   <p>
    El concepto de nube saliÃ³ de los diagramas de red, donde Internet se
    representa como una nube, en unaÂ abstracciÃ³n de la infraestructura que
    representa.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >C. <dfn>AplicaciÃ³n web</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    AplicaciÃ³n que los usuarios pueden utilizar accediendo a un servidor web a
    travÃ©s de internet o de una intranet mediante un navegador.
   </p>
  </li>
  <li>
   <p>
    <small>
     Fuente:
     <a target="_blank" rel="noreferrer"
       href="https://es.wikipedia.org/wiki/Aplicaci%C3%B3n_web">https://es.wikipedia.org/wiki/Aplicaci%C3%B3n_web</a>
    </small>
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >D. <dfn>Servicio en la nube</dfn></h1><div class="lectura">
 <p>
  Utilidad o funciÃ³n que se utiliza a travÃ©s de Internet.
 </p>
</div>
      </section>
     <section >
         <h1 >E. Tipos de servicios</h1><div class="lectura">
 <dl>
  <dt><dfn>Software as a Service</dfn> <abbr>(SaaS)</abbr></dt>
  <dd>
   <p>
    El mÃ¡s utilizado. El software estÃ¡ alojado en servidores de los proveedores
    y el cliente accede a ellos a travÃ©s del navegador web. Todo lo relacionado
    con mantenimiento, soporte y disponibilidad es manejado por el proveedor.
   </p>
  </dd>
  <dt><dfn>Platform as a Service</dfn> <abbr>(PaaS)</abbr></dt>
  <dd>
   <p>
    En este tipo de servicios en la nube el proveedor ofrece acceso a un entorno
    basado en cloud en el cual los usuarios pueden crear, ejecutar, distribuir y
    administrar sus propias aplicaciones.
   </p>
  </dd>
  <dt><dfn>Infrastructure as a Service</dfn> <abbr>(IaaS)</abbr></dt>
  <dd>
   <p>
    Un proveedor de servicios proporciona aceso a recursos como servidores con
    una capacidad de cÃ³mputo contratada, almacenamiento y acceso a red.
   </p>
  </dd>
 </dl>
</div>
      </section>
     <section >
         <h1 >F. Servicios que se ofrecen en la nube</h1><div class="lectura">
 <ul>
  <li>
   <p>Almacenamiento</p>
  </li>
  <li>
   <p>Herramientas de Productividad</p>
  </li>
  <li>
   <p>Desarrollo de Aplicaciones</p>
  </li>
  <li>
   <p>Hosting</p>
  </li>
  <li>
   <p>Videoconferencias</p>
  </li>
  <li>
   <p>Mapas</p>
  </li>
  <li>
   <p>Streamming</p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >G. Servicios de nube mÃ¡s usados</h1><div class="lectura">
 <dl>
  <dt>Amazon Web Services (AWS)</dt>
  <dd>
   <p>
    <a href="https://aws.amazon.com/" target="_blank"
      rel="noreferrer">https://aws.amazon.com/</a>
   </p>
  </dd>
  <dt>Microsoft Azure</dt>
  <dd>
   <p>
    <a href="https://azure.microsoft.com/" target="_blank"
      rel="noreferrer">https://azure.microsoft.com/</a>.
   </p>
  </dd>
  <dt>Google Cloud</dt>
  <dd>
   <p>
    <a href="https://cloud.google.com/" target="_blank"
      rel="noreferrer">https://cloud.google.com/</a>.
   </p>
  </dd>
 </dl>
</div>
      </section>
     <section >
         <h1 >H. <dfn>AplicaciÃ³n orientada a servicios</dfn></h1><div class="lectura">
 <p>
  Es una aplicaciÃ³n en la que algunas partes se realizan en un servidor
  independiente.
 </p>
 <section>
  <h1>CaracterÃ­sticas</h1>
  <ul>
   <li>
    <p>El procesamiento se reparte en varias computadoras.</p>
   </li>
   <li>
    <p>Un servicio puede ser utilizado por varias aplicaciones.</p>
   </li>
  </ul>
 </section>
</div>
      </section>
     <section >
         <h1 >I. <dfn>AplicaciÃ³n web orientada a servicios</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    AplicaciÃ³n web en la que algunas operaciones se realizan en el servidor web
    y sus resultados se descargan al navegador web sin cambiar la pÃ¡gina
    desplegada.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >J. <dfn>AplicaciÃ³n web hibrida (Mashup)</dfn></h1><div class="lectura">
 <p>Es una aplicaciÃ³n que usa otras aplicaciones web.</p>
 <section>
  <h1>Estructura</h1>
  <dl>
   <dt><dfn>Proveedor de contenidos</dfn></dt>
   <dd>
    <p>
     Fuente de los datos. Los datos estÃ¡n disponibles vÃ­a una API y diferentes
     protocolos web como RSS, REST y Web Service.
    </p>
   </dd>
   <dt><dfn>El sitio mashup</dfn></dt>
   <dd>
    <p>
     Es la nueva aplicaciÃ³n web que provee un nuevo servicio utilizando
     diferente informaciÃ³n y de la que no es dueÃ±a.
    </p>
   </dd>
   <dt><dfn>El navegador web cliente</dfn></dt>
   <dd>
    <p>
     Interfaz de usuario del mashup. En una aplicaciÃ³n web, el contenido puede
     ser mezclado por los web browser clientes usando lenguaje web del lado del
     cliente, por ejemplo, HTML y JavaScript.
    </p>
   </dd>
  </dl>
 </section>
 <p><small>Fuente: Wikipedia</small></p>
</div>
      </section>
     <section >
         <h1 >K. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>En esta lecciÃ³n se tocaron los siguientes temas:</p>
   <ul>
    <li>
     <p>Nube computacional.</p>
    </li>
    <li>
     <p>AplicaciÃ³n web.</p>
    </li>
    <li>
     <p>Servicio en la nube.</p>
    </li>
    <li>
     <p>Tipos de servicios.</p>
    </li>
    <li>
     <p>Servicios que se ofrecen en la nube.</p>
    </li>
    <li>
     <p>Servicios de nube mÃ¡s usados.</p>
    </li>
    <li>
     <p>AplicaciÃ³n orientada a servicios.</p>
    </li>
    <li>
     <p>AplicaciÃ³n web orientada a servicios.</p>
    </li>
    <li>
     <p>AplicaciÃ³n web hibrida (Mashup).</p>
    </li>
   </ul>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >5. Ejemplo de servicio</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m02servicio/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mBdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/">Funcionamiento</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/m-servicio-php.html">servicio.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mHresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <p>
  En esta lecciÃ³n se explica el funcionamiento de un servicio muy sencillo.
 </p>
 <p>
  Puedes probar el ejemplo en
  <a href="http://srvejemplo.rf.gd/" rel="noreferrer"
   target="_blank">http://srvejemplo.rf.gd/</a>.
 </p>
</div>
      </section>
     <section >
         <h1 >B. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m02servicio/serviciodistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section>
         <h1 >C. Funcionamiento</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m1cliente.html">Iniciamos al ejecutar cÃ³digo en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m2invoca.html">Se invoca el servicio en el servidor</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m3procesa.html">El servicio procesa la request y genera la response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m4devuelve.html">El servicio devuelve la response, que es recibida en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m5verifica.html">Verifica si la conexiÃ³n terminÃ³ con Ã©xito</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m6recupera.html">Como la conexiÃ³n terminÃ³ con Ã©xito, recupera el texto de response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m7muestra.html">Muestra el texto en un alert</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m02servicio/mCfuncionamiento/m8termina.html">Al cerrar el alert, termina el evento</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section class="pruebaDeEscritorio">
         <h1 >1. Iniciamos al ejecutar cÃ³digo en el cliente</h1><section>
 <h1>index.html</h1>
 <pre class="resaltado"><code class="language-javascript"><span><span class="codeReserved">const</span> resp =</span>
<span> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</span>
<span><span class="codeReserved">if</span> (resp.ok) {</span>
<span> <span class="codeReserved">const</span> texto =</span>
<span>  <span class="codeReserved">await</span> resp.text()</span>
<span> alert(texto)</span>
<span>} <span class="codeReserved">else</span> {</span>
<span> throw <span class="codeReserved">new</span> Error(</span>
<span>  resp.statusText)</span>
<span>}</span></code></pre>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >2. Se invoca el servicio en el servidor</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> resp =</span>
<span class="resaltado"> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</span>
<span><span class="codeReserved">if</span> (resp.ok) {</span>
<span> <span class="codeReserved">const</span> texto =</span>
<span>  <span class="codeReserved">await</span> resp.text()</span>
<span> alert(texto)</span>
<span>} <span class="codeReserved">else</span> {</span>
<span> throw <span class="codeReserved">new</span> Error(</span>
<span>  resp.statusText)</span>
<span>}</span></code></pre>
 <p class="resaltado2">Ejecuta fetch y envÃ­a request (solicitud).</p>
</section>
<section>
 <h1>Request</h1>
 <dl class="resaltado">
  <dt>URL</dt>
  <dd>
   <p>servicio.php</p>
  </dd>
  <dt>Method</dt>
  <dd>
   <p>GET</p>
  </dd>
 </dl>
</section>
<section>
 <h1>servicio.php</h1>
 <pre class="resaltado"><code class="language-php"><span>&lt;?<span class="codeReserved">php</span></span>
<span></span>
<span>echo <span class="codeString">&quot;Hola&quot;</span>;</span></code></pre>
 <p class="resaltado2">Despierta y recibe request.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >3. El servicio procesa la request y genera la response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> resp =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</span>
<span><span class="codeReserved">if</span> (resp.ok) {</span>
<span> <span class="codeReserved">const</span> texto =</span>
<span>  <span class="codeReserved">await</span> resp.text()</span>
<span> alert(texto)</span>
<span>} <span class="codeReserved">else</span> {</span>
<span> throw <span class="codeReserved">new</span> Error(</span>
<span>  resp.statusText)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>servicio.php</h1>
 <pre><code class="language-php"><span>&lt;?<span class="codeReserved">php</span></span>
<span></span>
<span class="resaltado">echo <span class="codeString">&quot;Hola&quot;</span>;</span></code></pre>
 <p class="resaltado2">
  Procesa la request y genera
  <br>la response (respuesta).</p>
</section>
<section>
 <h1>Response</h1>
 <dl class="resaltado">
  <dt>code</dt>
  <dd>200</dd>
  <dt>body</dt>
  <dd>Hola</dd>
 </dl>
 <p class="resaltado2">
  El code (o cÃ³digo) 200
  <br>indica que terminÃ³
  <br>con Ã©xito.
 </p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >4. El servicio devuelve la response, que es recibida en el cliente</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span class="resaltado"><span class="codeReserved">const</span> resp =</span>
<span class="resaltado"> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</span>
<span><span class="codeReserved">if</span> (resp.ok) {</span>
<span> <span class="codeReserved">const</span> texto =</span>
<span>  <span class="codeReserved">await</span> resp.text()</span>
<span> alert(texto)</span>
<span>} <span class="codeReserved">else</span> {</span>
<span> throw <span class="codeReserved">new</span> Error(</span>
<span>  resp.statusText)</span>
<span>}</span></code></pre>
 <p class="resaltado2">Despierta y recibe response.</p>
</section>
<div class="section">
 <section >
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>Hola</dd>
  </dl>
 </section>
 <section >
  <h1>Memoria</h1>
  <dl class="resaltado">
   <dt>resp</dt>
   <dd>
    <dl>
     <dt>ok</dt>
     <dd>true</dd>
     <dt>text</dt>
     <dd>Hola</dd>
    </dl>
   </dd>
  </dl>
  <p class="resaltado2">
   <var>resp</var> tiene lo mismo
   <br>que la response,
   <br>pero en un objeto
   <br>de JavaScript.
  </p>
 </section>
</div>
<section>
 <h1>servicio.php</h1>
 <pre class="resaltado3"><code class="language-php"><span>&lt;?<span class="codeReserved">php</span></span>
<span></span>
<span>echo <span class="codeString">&quot;Hola&quot;</span>;</span></code></pre>
 <p class="resaltado3">Devuelve response y se duerme.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >5. Verifica si la conexiÃ³n terminÃ³ con Ã©xito</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> resp =</span>
<span> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</span>
<span class="resaltado"><span class="codeReserved">if</span> (resp.ok) {</span>
<span> <span class="codeReserved">const</span> texto =</span>
<span>  <span class="codeReserved">await</span> resp.text()</span>
<span> alert(texto)</span>
<span>} <span class="codeReserved">else</span> {</span>
<span> throw <span class="codeReserved">new</span> Error(</span>
<span>  resp.statusText)</span>
<span>}</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl style="padding: 0.5rem;">
  <dt>resp</dt>
  <dd>
   <dl>
    <dt class="resaltado">ok</dt>
    <dd class="resaltado">true</dd>
    <dt>text</dt>
    <dd>Hola</dd>
   </dl>
  </dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >6. Como la conexiÃ³n terminÃ³ con Ã©xito, recupera el texto de response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> resp =</span>
<span> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</span>
<span><span class="codeReserved">if</span> (resp.ok) {</span>
<span class="resaltado"> <span class="codeReserved">const</span> texto =</span>
<span class="resaltado">  <span class="codeReserved">await</span> resp.text()</span>
<span> alert(texto)</span>
<span>} <span class="codeReserved">else</span> {</span>
<span> throw <span class="codeReserved">new</span> Error(</span>
<span>  resp.statusText)</span>
<span>}</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl style="padding: 0.5rem;">
  <dt>resp</dt>
  <dd>
   <dl>
    <dt>ok</dt>
    <dd>true</dd>
    <dt class="resaltado">text</dt>
    <dd class="resaltado">Hola</dd>
   </dl>
  </dd>
  <dt class="resaltado">texto</dt>
  <dd class="resaltado">Hola</dd>
 </dl>
 <p class="resaltado2">
  El texto recuperado
  <br>queda en la
  <br>constante <var>texto</var>.
 </p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >7. Muestra el texto en un alert</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> resp =</span>
<span> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</span>
<span><span class="codeReserved">if</span> (resp.ok) {</span>
<span> <span class="codeReserved">const</span> texto =</span>
<span>  <span class="codeReserved">await</span> resp.text()</span>
<span class="resaltado"> alert(texto)</span>
<span>} <span class="codeReserved">else</span> {</span>
<span> throw <span class="codeReserved">new</span> Error(</span>
<span>  resp.statusText)</span>
<span>}</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl style="padding: 0.5rem;">
  <dt>resp</dt>
  <dd>
   <dl>
    <dt>ok</dt>
    <dd>true</dd>
    <dt>text</dt>
    <dd>Hola</dd>
   </dl>
  </dd>
  <dt>texto</dt>
  <dd>Hola</dd>
 </dl>
</section>
<section>
 <h1>Alert</h1>
 <div class="resaltado" style="border: thin solid; padding: 0 0.5rem;">
  <p>Hola</p>
  <p style="text-align: end;">
   <button type="button">Aceptar</button>
  </p>
  </div>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >8. Al cerrar el alert, termina el evento</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> resp =</td></tr></span>
<span> <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</td></tr></span>
<span><span class="codeReserved">if</span> (resp.ok) {</td></tr></span>
<span> <span class="codeReserved">const</span> texto =</td></tr></span>
<span>  <span class="codeReserved">await</span> resp.text()</td></tr></span>
<span> alert(texto)</td></tr></span>
<span>} <span class="codeReserved">else</span> {</td></tr></span>
<span> throw <span class="codeReserved">new</span> Error(</td></tr></span>
<span>  resp.statusText)</td></tr></span>
<span>}</td></tr></span></code></pre>
</section>
      </section>
      </section>
     <section >
         <h1 >D. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvejemplo.rf.gd/" rel="noreferrer"
      target="_blank">http://srvejemplo.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvejemplo.zip" download>/src/srvejemplo.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >E. Archivos</h1><div class="lectura">
 <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-servicio-php.html">servicio.php</a></p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >F. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">&quot;es&quot;</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">&quot;UTF-8&quot;</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">&quot;viewport&quot;</span> content=<span class="codeString">&quot;width=device-width&quot;</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Ejemplo de servicio&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">h1</span>&gt;Ejemplo de servicio&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> &lt;<span class="codeReserved">button</span> onclick=<span class="codeString">&quot;ejecuta()&quot;</span>&gt;</td></tr>
  <tr><td>17</td><td>  Ejecuta</td></tr>
  <tr><td>18</td><td> &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">async</span> <span class="codeReserved">function</span> ejecuta() {</td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>24</td><td>    <span class="codeComment">// Se conecta a servicio.php y recibe su respuesta.</span></td></tr>
  <tr><td>25</td><td>    <span class="codeReserved">const</span> resp =</td></tr>
  <tr><td>26</td><td>     <span class="codeReserved">await</span> fetch(<span class="codeString">&quot;servicio.php&quot;</span>)</td></tr>
  <tr><td>27</td><td>    <span class="codeReserved">if</span> (resp.ok) {</td></tr>
  <tr><td>28</td><td>     <span class="codeReserved">const</span> texto =</td></tr>
  <tr><td>29</td><td>      <span class="codeReserved">await</span> resp.text()</td></tr>
  <tr><td>30</td><td>     alert(texto)</td></tr>
  <tr><td>31</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>32</td><td>     throw <span class="codeReserved">new</span> Error(</td></tr>
  <tr><td>33</td><td>      resp.statusText)</td></tr>
  <tr><td>34</td><td>    }</td></tr>
  <tr><td>35</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>36</td><td>    console.error(error)</td></tr>
  <tr><td>37</td><td>    alert(error.message)</td></tr>
  <tr><td>38</td><td>   }</td></tr>
  <tr><td>39</td><td>  }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. servicio.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td>echo <span class="codeString">&quot;Hola&quot;</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>En esta lecciÃ³n se mostrÃ³ el funcionamiento de un servicio.</p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >6. Arquitectura orientada a servicios</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m03soa/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mAsoa.html"><dfn>Arquitectura orientada a servicios</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mBventajas.html">Ventajas</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mCprincipios.html">Principios de diseÃ±o de un servicio</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mDcapas.html">Capas</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mEdiagrama.html"><dfn>Diagrama de Arquitectura</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mFxml/">IntroducciÃ³n a XML</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mGsoap/">IntroducciÃ³n a SOAP</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mHwsdl/">IntroducciÃ³n a WSDL</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mIdefUddi.html"><dfn>UDDI</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mJrest/">IntroducciÃ³n a REST</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mKresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se presentan el concepto y los componentes de una
    arquitectura orientada a servicios.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. <dfn>Arquitectura orientada a servicios</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Estilo de arquitectura de TI que se apoya en la orientaciÃ³n a
    servicios.
   </p>
  </li>
  <li>
   <p>
    La orientaciÃ³n a servicios es una forma de pensar en servicios, su
    construcciÃ³n y sus resultados.
   </p>
  </li>
  <li>
   <p>
    Un servicio es una representaciÃ³n lÃ³gica de una actividad de negocio
    que tiene un resultado de negocio especÃ­fico (ejemplo: comprobar el
    crÃ©dito de un cliente, obtener datos de clima, consolidar reportes
    de perforaciÃ³n).
   </p>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://es.wikipedia.org/wiki/Arquitectura_orientada_a_servicios"
     target="_blank" rel="noreferrer">https://es.wikipedia.org/wiki/Arquitectura_orientada_a_servicios</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >C. Ventajas</h1><div class="lectura">
 <ul>
  <li>
   <p>Reduce el nivel de acoplamiento.</p>
  </li>
  <li>
   <p>Clara definiciÃ³n de roles de desarrollo.</p>
  </li>
  <li>
   <p>DefiniciÃ³n de seguridad mÃ¡s clara.</p>
  </li>
  <li>
   <p>FÃ¡cil de probar.</p>
  </li>
  <li>
   <p>Mejora el mantenimiento.</p>
  </li>
  <li>
   <p>Favorece la reutilizaciÃ³n.</p>
  </li>
  <li>
   <p>Favorece el desarrollo en paralelo.</p>
  </li>
  <li>
   <p>Favorece la escalabilidad.</p>
  </li>
  <li>
   <p>Permite un mapeo directo entre los procesos y los sistemas.</p>
  </li>
  <li>
   <p>Permite un monitoreo preciso.</p>
  </li>
  <li>
   <p>Permite la interoperabilidad.</p>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="http://soa-fpuna.blogspot.com/2011/11/ventajas-y-desventajas.html"
     target="_blank" rel="noreferrer">http://soa-fpuna.blogspot.com/2011/11/ventajas-y-desventajas.html</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >D. Principios de diseÃ±o de un servicio</h1><div class="lectura">
 <ul>
  <li>
   <p>
    DefiniciÃ³n clara y estandarizada mediante descriptores de servicio, donde se
    indique:
   </p>
   <ul>
    <li>
     <p>Nombre del Servicio.</p>
    </li>
    <li>
     <p>Forma de accesos.</p>
    </li>
    <li>
     <p>Funcionalidades que ofrece.</p>
    </li>
    <li>
     <p>
      DescripciÃ³n de los datos de entrada de cada funcionalidad que ofrece.
     </p>
    </li>
    <li>
     <p>
      DescripciÃ³n de los datos de salida de cada funcionalidad que ofrece.
     </p>
    </li>
   </ul>
  </li>
  <li>
   <p>
    Sin estado: no guardan valores para ser usados en otras llamadas. (es
    posible acceder a bases de datos.)
   </p>
  </li>
  <li>
   <p>
    Pueden tambiÃ©n ejecutar unidades discretas de trabajo como serÃ­an editar y
    procesar una transacciÃ³n.
   </p>
  </li>
  <li>
   <p>No dependen del estado de otras funciones o procesos.</p>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://ederluisdsd.wordpress.com/2013/03/17/principios-de-diseno-soa/"
     target="_blank rel="noreferrer">https://ederluisdsd.wordpress.com/2013/03/17/principios-de-diseno-soa/</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >E. Capas</h1><figure>
 <img src="/img/m03soa/capas_soa.svg" alt="Capas de SOA">
</figure>
<div class="lectura">
 <dl>
  <dt>Capa de acceso</dt>
  <dd>
   <ul>
    <li>
     <p>Interfaz de usuario que invoca a los procesos de negocio.</p>
    </li>
    <li>
     <p>Interfaces web, escritorio, mÃ³vil, etc.</p>
    </li>
    <li>
     <p>Pueden ejecutarse en varios dispositivos.</p>
    </li>
   </ul>
  </dd>
  <dt>Capa de procesos de negocio</dt>
  <dd>
   <ul>
    <li>
     <p>
      IntegraciÃ³n de uno o mÃ¡s servicios que resuelven un problema de negocio.
     </p>
    </li>
   </ul>
  </dd>
  <dt>Capa de servicio</dt>
  <dd>
   <ul>
    <li>
     <p>Componentes que se han desarrollado como servicios.</p>
    </li>
   </ul>
  </dd>
  <dt>Capa de recursos</dt>
  <dd>
   <ul>
    <li>
     <p>Recursos operacionales: CRM, ERP, HR, BD.</p>
    </li>
    <li>
     <p>TecnologÃ­as (Java, .NET, PHP).</p>
    </li>
   </ul>
  </dd>
 </dl>
 <p>
  <small>
   Fuente:
   <a href="https://www.slideshare.net/imcinstitute/service-oriented-architecture-soa-15-introduction-to-soa"
     target="_blank"
     rel="noreferrer">https://www.slideshare.net/imcinstitute/service-oriented-architecture-soa-15-introduction-to-soa</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >F. <dfn>Diagrama de Arquitectura</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Puedes encontrar informaciÃ³n sobre este tipo de diagramas en:
    <a href="https://www.uml-diagrams.org/component-diagrams.html"
      target="_blank"
      rel="noreferrer">https://www.uml-diagrams.org/component-diagrams.html</a>.
   </p>
  </li>
  <li>
   <p>
    A continuaciÃ³n se muestra como quedarÃ­a un sitio con bases de datos
    si se adaptara a SOA.
   </p>
  </li>
 </ul>
</div>
<figure>
 <img style="max-height: none;" src="/img/m03soa/arquitectura_soa.drawio.svg"
   alt="Capas de SOA">
</figure>
      </section>
     <section>
         <h1 >G. IntroducciÃ³n a XML</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m03soa/mFxml/m1defXml.html"><dfn>XML</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mFxml/m2ejXml.html">Ejemplo de XML</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mFxml/m3dtdXml.html">DTD MiContacto</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >1. <dfn>XML</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Siglas en inglÃ©s de
    e<strong>Xtensible Markup Language</strong>,
    traducido como
    <strong>Lenguaje de Marcado Extensible o Lenguaje de Marcas
     Extensible</strong>.
   </p>
  </li>
  <li>
   <p>Metalenguaje que permite definir lenguajes de marcas.</p>
  </li>
  <li>
   <p>
    Desarrollado por el
    <a href="https://www.w3.org/">World Wide Web Consortium</a>
    (W3C).
   </p>
  </li>
  <li>
   <p>Utilizado para almacenar datos en forma legible.</p>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://es.wikipedia.org/wiki/Extensible_Markup_Language"
     target="_blank"
     rel="noreferrer">https://es.wikipedia.org/wiki/Extensible_Markup_Language</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >2. Ejemplo de XML</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">xml</span> version=<span class="codeString">&quot;1.0&quot;</span> encoding=<span class="codeString">&quot;UTF-8&quot;</span> ?&gt;</td></tr>
  <tr><td>2</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> MiContacto SYSTEM <span class="codeString">&quot;MiContacto.dtd&quot;</span>&gt;</td></tr>
  <tr><td>3</td><td>&lt;<span class="codeReserved">Contacto</span>&gt;</td></tr>
  <tr><td>4</td><td> &lt;<span class="codeReserved">Nombre</span>&gt;Juan&lt;/<span class="codeReserved">Nombre</span>&gt;</td></tr>
  <tr><td>5</td><td> &lt;<span class="codeReserved">Email</span>&gt;juan@gm.com&lt;/<span class="codeReserved">Email</span>&gt;</td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">Telefonos</span>&gt;</td></tr>
  <tr><td>7</td><td>  &lt;<span class="codeReserved">Telefono</span>&gt;5555555555&lt;/<span class="codeReserved">Telefono</span>&gt;</td></tr>
  <tr><td>8</td><td>  &lt;<span class="codeReserved">Telefono</span>&gt;8888888888&lt;/<span class="codeReserved">Telefono</span>&gt;</td></tr>
  <tr><td>9</td><td> &lt;/<span class="codeReserved">Telefonos</span>&gt;</td></tr>
  <tr><td>10</td><td>&lt;/<span class="codeReserved">Contacto</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. DTD MiContacto</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">xml</span> version=<span class="codeString">&quot;1.0&quot;</span> encoding=<span class="codeString">&quot;ISO-8859-1&quot;</span> ?&gt;</td></tr>
  <tr><td>2</td><td><span class="codeComment">&lt;!-- Este es el DTD de Contacto --&gt;</span></td></tr>
  <tr><td>3</td><td>&lt;!<span class="codeReserved">ELEMENT</span> Contacto (Nombre, Email, Telefonos)&gt;</td></tr>
  <tr><td>4</td><td>&lt;!<span class="codeReserved">ELEMENT</span> Nombre (#PCDATA)&gt;</td></tr>
  <tr><td>5</td><td>&lt;!<span class="codeReserved">ELEMENT</span> Email (#PCDATA)&gt;</td></tr>
  <tr><td>6</td><td>&lt;!<span class="codeReserved">ELEMENT</span> Telefonos (Telefono)*&gt;</td></tr>
  <tr><td>7</td><td>&lt;!<span class="codeReserved">ELEMENT</span> Telefono (#PCDATA)&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >H. IntroducciÃ³n a SOAP</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m03soa/mGsoap/mKdefSoap.html"><dfn>SOAP</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mGsoap/mLestrSoap.html">Estructura de los mensajes de SOAP</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mGsoap/mMsolSoap.html">Ejemplo de solicitud SOAP</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mGsoap/mNrespSoap.html">Ejemplo de respuesta SOAP</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >1. <dfn>SOAP</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Originalmente siglas de Simple Object Access Protocol, Protocolo de Acceso
    Simple a Objetos.
   </p>
  </li>
  <li>
   <p>Hoy en dÃ­a solo es SOAP, sin un significado especial.</p>
  </li>
  <li>
   <p>
    Protocolo estÃ¡ndar que define cÃ³mo dos objetos en diferentes procesos pueden
    comunicarse por medio de intercambio de datos XML.
   </p>
  </li>
  <li>
   <p>
    Es uno de los protocolos utilizados para implementar servicios web.
   </p>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://es.wikipedia.org/wiki/Simple_Object_Access_Protocol"
     target="_blank"
     rel="noreferrer">https://es.wikipedia.org/wiki/Simple_Object_Access_Protocol</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >2. Estructura de los mensajes de SOAP</h1><div class="marco-lectura">
 <figure>
  <img src="/img/m03soa/mensajes_soap.svg" alt="Mensajes SOAP">
 </figure>
 <ul>
  <li>
   <p>Usan formato XML.</p>
  </li>
  <li>
   <p>3 elementos:</p>
   <dl>
    <dt><dfn>Envelope</dfn> o <dfn>sobre</dfn></dt>
    <dd>
     <p>El elemento raÃ­z.</p>
    </dd>
    <dt><dfn>Header</dfn> o <dfn>encabezado</dfn></dt>
    <dd>
     <p>EspecificaciÃ³n de como procesar los datos.</p>
    </dd>
    <dt><dfn>Body</dfn> o <dfn>cuerpo</dfn></dt>
    <dd>
     <p>El conenido del mensaje.</p>
    </dd>
   </dl>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://es.wikipedia.org/wiki/Simple_Object_Access_Protocol"
     target="_blank"
     rel="noreferrer">https://es.wikipedia.org/wiki/Simple_Object_Access_Protocol</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >3. Ejemplo de solicitud SOAP</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;<span class="codeReserved">soap</span>:Envelope xmlns:soap=<span class="codeString">&quot;http:&#47;/schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</td></tr>
  <tr><td>2</td><td> &lt;<span class="codeReserved">soap</span>:Header&gt;</td></tr>
  <tr><td>3</td><td>  &lt;<span class="codeReserved">t</span>:Transaction xmlns:t=<span class="codeString">&quot;alguna-URI&quot;</span> soap:mustUnderstand=<span class="codeString">&quot;1&quot;</span>&gt;</td></tr>
  <tr><td>4</td><td>   5</td></tr>
  <tr><td>5</td><td>  &lt;/<span class="codeReserved">t</span>:Transaction&gt;</td></tr>
  <tr><td>6</td><td> &lt;/<span class="codeReserved">soap</span>:Header&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">soap</span>:Body&gt;</td></tr>
  <tr><td>8</td><td>  &lt;<span class="codeReserved">getDetalleDeProducto</span> xmlns=<span class="codeString">&quot;http:&#47;/warehouse.example.com/ws&quot;</span>&gt;</td></tr>
  <tr><td>9</td><td>   &lt;<span class="codeReserved">productoId</span>&gt;827635&lt;/<span class="codeReserved">productoId</span>&gt;</td></tr>
  <tr><td>10</td><td>  &lt;/<span class="codeReserved">getDetalleDeProducto</span>&gt;</td></tr>
  <tr><td>11</td><td> &lt;/<span class="codeReserved">soap</span>:Body&gt;</td></tr>
  <tr><td>12</td><td>&lt;/<span class="codeReserved">soap</span>:Envelope&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. Ejemplo de respuesta SOAP</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;<span class="codeReserved">soap</span>:Envelope xmlns:soap=<span class="codeString">&quot;http:&#47;/schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</td></tr>
  <tr><td>2</td><td> &lt;<span class="codeReserved">soap</span>:Body&gt;</td></tr>
  <tr><td>3</td><td>  &lt;<span class="codeReserved">getRespuestaDetalleDeProducto</span> xmlns=<span class="codeString">&quot;http:&#47;/warehouse.example.com/ws&quot;</span>&gt;</td></tr>
  <tr><td>4</td><td>   &lt;<span class="codeReserved">getResultadoDetalleDeProducto</span>&gt;</td></tr>
  <tr><td>5</td><td>    &lt;<span class="codeReserved">productId</span>&gt;827635&lt;/<span class="codeReserved">productId</span>&gt;</td></tr>
  <tr><td>6</td><td>    &lt;<span class="codeReserved">nombre</span>&gt;BalÃ³n de Futbol&lt;/<span class="codeReserved">nombre</span>&gt;</td></tr>
  <tr><td>7</td><td>    &lt;<span class="codeReserved">descripcion</span>&gt;BalÃ³n de futbol de 11â de vinil.&lt;/<span class="codeReserved">descripcion</span>&gt;</td></tr>
  <tr><td>8</td><td>    &lt;<span class="codeReserved">precio</span>&gt;300.0&lt;/<span class="codeReserved">precio</span>&gt;</td></tr>
  <tr><td>9</td><td>   &lt;/<span class="codeReserved">getResultadoDetalleDeProducto</span>&gt;</td></tr>
  <tr><td>10</td><td>  &lt;/<span class="codeReserved">getRespuestaDetalleDeProducto</span>&gt;</td></tr>
  <tr><td>11</td><td> &lt;/<span class="codeReserved">soap</span>:Body&gt;</td></tr>
  <tr><td>12</td><td>&lt;/<span class="codeReserved">soap</span>:Envelope&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >I. IntroducciÃ³n a WSDL</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m03soa/mHwsdl/mPdefWsdl.html"><dfn>WSDL</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mHwsdl/mQelemWsdl.html">Elementos de WSDL</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mHwsdl/mRejemWsdl.html">Ejemplo de WSDL</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >1. <dfn>WSDL</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Siglas de
    <strong>Web Services Description Language</strong>,
    es un formato de XML que se utiliza para describir servicios Web.
   </p>
  </li>
  <li>
   <p>
    Describe los requisitos del protocolo y los formatos de los mensajes
    necesarios para interactuar con los servicios listados en su catÃ¡logo.
   </p>
  </li>
  <li>
   <p>
    Las operaciones y mensajes que soporta se describen en abstracto y se ligan
    despuÃ©s al protocolo concreto de red y al formato del mensaje.
   </p>
  </li>
  <li>
   <p>Se usa a menudo en combinaciÃ³n con SOAP y XML Schema.</p>
  </li>
  <li>
   <p>
    Los tipos de datos especiales se incluyen en el archivo WSDL en forma de XML
    Schema.
   </p>
  </li>
  <li>
   <p>
    El cliente puede usar SOAP para hacer la llamada a una de las funciones
    listadas en el WSDL.
   </p>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://es.wikipedia.org/wiki/Simple_Object_Access_Protocol"
     target="_blank"
     rel="noreferrer">https://es.wikipedia.org/wiki/Simple_Object_Access_Protocol</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >2. Elementos de WSDL</h1><div class="lectura">
 <dl>
  <dt><dfn>types</dfn></dt>
  <dd>
   <p>
    Define los tipos de datos usados en los mensajes. Se utilizan los tipos
    definidos en la especificaciÃ³n XML Schema.
   </p>
  </dd>
  <dt><dfn>message</dfn></dt>
  <dd>
   <p>
    Define los elementos de mensaje. Cada mensaje puede consistir en una serie
    de partes lÃ³gicas. Las partes pueden ser de cualquiera de los tipos
    definidos en el elemento message.
   </p>
  </dd>
  <dt><dfn>portType</dfn></dt>
  <dd>
   <p>
    Define las operaciones permitidas y los mensajes intercambiados en el
    Servicio.
   </p>
  </dd>
  <dt><dfn>binding</dfn></dt>
  <dd>
   <p>Especifica los protocolos de comunicaciÃ³n usados.</p>
  </dd>
  <dt><dfn>service</dfn></dt>
  <dd>
   <p>
    Conjunto de puertos y direcciÃ³n de los mismos. Esta parte final hace
    referencia a lo aportado por las secciones anteriores.
   </p>
  </dd>
 </dl>
 <p>
  Con estos elementos no sabemos quÃ© hace un servicio pero sÃ­ disponemos de la
  informaciÃ³n necesaria para interactuar con Ã©l (funciones, mensajes de
  entrada/salida, protocolos, etcÃ©tera).
 </p>
</div>
      </section>
     <section >
         <h1 >3. Ejemplo de WSDL</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;<span class="codeReserved">definitions</span> name=âPrecioProdâ</td></tr>
  <tr><td>2</td><td> targetNamespace=<span class="codeString">&quot;http:&#47;/example.com/stockquote.wsdl&quot;</span></td></tr>
  <tr><td>3</td><td> xmlns:tns=<span class="codeString">&quot;http:&#47;/example.com/stockquote.wsdl&quot;</span></td></tr>
  <tr><td>4</td><td> xmlns:xsd1=<span class="codeString">&quot;http:&#47;/example.com/stockquote.xsd&quot;</span></td></tr>
  <tr><td>5</td><td> xmlns:soap=<span class="codeString">&quot;http:&#47;/schemas.xmlsoap.org/wsdl/soap/&quot;</span></td></tr>
  <tr><td>6</td><td> xmlns=<span class="codeString">&quot;http:&#47;/schemas.xmlsoap.org/wsdl/&quot;</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">types</span>&gt;</td></tr>
  <tr><td>8</td><td>  &lt;<span class="codeReserved">schema</span> targetNamespace=<span class="codeString">&quot;http:&#47;/example.com/stockquote.xsd&quot;</span></td></tr>
  <tr><td>9</td><td>   xmlns=<span class="codeString">&quot;http:&#47;/www.w3.org/2000/10/XMLSchema&quot;</span>&gt;</td></tr>
  <tr><td>10</td><td>   &lt;<span class="codeReserved">element</span> name=<span class="codeString">&quot;SolPrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>11</td><td>    &lt;<span class="codeReserved">complexType</span>&gt;</td></tr>
  <tr><td>12</td><td>     &lt;<span class="codeReserved">all</span>&gt;</td></tr>
  <tr><td>13</td><td>      &lt;<span class="codeReserved">element</span> name=<span class="codeString">&quot;productoId&quot;</span> <span class="codeReserved">type</span>=<span class="codeString">&quot;decimal&quot;</span>/&gt;</td></tr>
  <tr><td>14</td><td>     &lt;/<span class="codeReserved">all</span>&gt;</td></tr>
  <tr><td>15</td><td>    &lt;/<span class="codeReserved">complexType</span>&gt;</td></tr>
  <tr><td>16</td><td>   &lt;/<span class="codeReserved">element</span>&gt;</td></tr>
  <tr><td>17</td><td>   &lt;<span class="codeReserved">element</span> name=<span class="codeString">&quot;PrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>18</td><td>    &lt;<span class="codeReserved">complexType</span>&gt;</td></tr>
  <tr><td>19</td><td>     &lt;<span class="codeReserved">all</span>&gt;</td></tr>
  <tr><td>20</td><td>      &lt;<span class="codeReserved">element</span> name=<span class="codeString">&quot;precio&quot;</span> <span class="codeReserved">type</span>=<span class="codeString">&quot;float&quot;</span>/&gt;</td></tr>
  <tr><td>21</td><td>     &lt;/<span class="codeReserved">all</span>&gt;</td></tr>
  <tr><td>22</td><td>    &lt;/<span class="codeReserved">complexType</span>&gt;</td></tr>
  <tr><td>23</td><td>   &lt;/<span class="codeReserved">element</span>&gt;</td></tr>
  <tr><td>24</td><td>  &lt;/<span class="codeReserved">schema</span>&gt;</td></tr>
  <tr><td>25</td><td> &lt;/<span class="codeReserved">types</span>&gt;</td></tr>
  <tr><td>26</td><td> &lt;<span class="codeReserved">message</span> name=<span class="codeString">&quot;InputGetPrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>27</td><td>  &lt;<span class="codeReserved">part</span> name=<span class="codeString">&quot;body&quot;</span> element=<span class="codeString">&quot;xsd1:SolPrecioProd&quot;</span>/&gt;</td></tr>
  <tr><td>28</td><td> &lt;/<span class="codeReserved">message</span>&gt;</td></tr>
  <tr><td>29</td><td> &lt;<span class="codeReserved">message</span> name=<span class="codeString">&quot;OutputGetPrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>30</td><td>  &lt;<span class="codeReserved">part</span> name=<span class="codeString">&quot;body&quot;</span> element=<span class="codeString">&quot;xsd1:PrecioProd&quot;</span>/&gt;</td></tr>
  <tr><td>31</td><td> &lt;/<span class="codeReserved">message</span>&gt;</td></tr>
  <tr><td>32</td><td> &lt;<span class="codeReserved">portType</span> name=<span class="codeString">&quot;PortTypePrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>33</td><td>  &lt;<span class="codeReserved">operation</span> name=<span class="codeString">&quot;GetPrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>34</td><td>   &lt;<span class="codeReserved">input</span> message=<span class="codeString">&quot;tns:InputGetPrecioProd&quot;</span>/&gt;</td></tr>
  <tr><td>35</td><td>   &lt;<span class="codeReserved">output</span> message=<span class="codeString">&quot;tns:OutputGetPrecioProd&quot;</span>/&gt;</td></tr>
  <tr><td>36</td><td>  &lt;/<span class="codeReserved">operation</span>&gt;</td></tr>
  <tr><td>37</td><td> &lt;/<span class="codeReserved">portType</span>&gt;</td></tr>
  <tr><td>38</td><td> &lt;<span class="codeReserved">binding</span> name=<span class="codeString">&quot;BindPrecioProdSoap&quot;</span> <span class="codeReserved">type</span>=<span class="codeString">&quot;tns:PortTypePrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>39</td><td>  &lt;<span class="codeReserved">soap</span>:binding style=<span class="codeString">&quot;document&quot;</span> transport=<span class="codeString">&quot;http:&#47;/schemas.xmlsoap.org/soap/http&quot;</span>/&gt;</td></tr>
  <tr><td>40</td><td>  &lt;<span class="codeReserved">operation</span> name=<span class="codeString">&quot;GetPrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>41</td><td>   &lt;<span class="codeReserved">soap</span>:operation soapAction=<span class="codeString">&quot;http:&#47;/example.com/GetPrecioProd&quot;</span>/&gt;</td></tr>
  <tr><td>42</td><td>   &lt;<span class="codeReserved">input</span>&gt;</td></tr>
  <tr><td>43</td><td>    &lt;<span class="codeReserved">soap</span>:body use=<span class="codeString">&quot;literal&quot;</span>/&gt;</td></tr>
  <tr><td>44</td><td>   &lt;/<span class="codeReserved">input</span>&gt;</td></tr>
  <tr><td>45</td><td>   &lt;<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>46</td><td>    &lt;<span class="codeReserved">soap</span>:body use=<span class="codeString">&quot;literal&quot;</span>/&gt;</td></tr>
  <tr><td>47</td><td>   &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>48</td><td>  &lt;/<span class="codeReserved">operation</span>&gt;</td></tr>
  <tr><td>49</td><td> &lt;/<span class="codeReserved">binding</span>&gt;</td></tr>
  <tr><td>50</td><td> &lt;<span class="codeReserved">service</span> name=<span class="codeString">&quot;ServPrecioProd&quot;</span>&gt;</td></tr>
  <tr><td>51</td><td>  &lt;<span class="codeReserved">documentation</span>&gt;Devuelve el precio de un producto.&lt;/<span class="codeReserved">documentation</span>&gt;</td></tr>
  <tr><td>52</td><td>  &lt;<span class="codeReserved">port</span> name=<span class="codeString">&quot;PuertoPrecioProd&quot;</span> binding=<span class="codeString">&quot;tns:BindPrecioProdSoap&quot;</span>&gt;</td></tr>
  <tr><td>53</td><td>   &lt;<span class="codeReserved">soap</span>:address location=<span class="codeString">&quot;http:&#47;/example.com/precioprod&quot;</span>/&gt;</td></tr>
  <tr><td>54</td><td>  &lt;/<span class="codeReserved">port</span>&gt;</td></tr>
  <tr><td>55</td><td> &lt;/<span class="codeReserved">service</span>&gt;</td></tr>
  <tr><td>56</td><td>&lt;/<span class="codeReserved">definitions</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >J. <dfn>UDDI</dfn></h1><div class="lectura">
 <p><strong>Este estÃ¡ndar no se usa.</strong></p>
 <ul>
  <li>
   <p>
    Siglas del catÃ¡logo de negocios de Internet denominado
    <strong>Universal Description, Discovery and Integration</strong>.
   </p>
  </li>
  <li>
   <p>El registro en el catÃ¡logo se hace en XML.</p>
  </li>
  <li>
   <p>
    Es una iniciativa industrial abierta (sufragada por la OASIS) entroncada en
    el contexto de los servicios Web.
   </p>
  </li>
  <li>
   <p>El registro de un negocio en UDDI tiene tres partes:</p>
   <dl>
    <dt><dfn>PÃ¡ginas blancas</dfn></dt>
    <dd>
     <p>direcciÃ³n, contacto y otros identificadores conocidos.</p>
    </dd>
    <dt><dfn>PÃ¡ginas amarillas</dfn></dt>
    <dd>
     <p>categorizaciÃ³n industrial basada en taxonomÃ­as.</p>
    </dd>
    <dt><dfn>PÃ¡ginas verdes</dfn></dt>
    <dd>
     <p>
      informaciÃ³n tÃ©cnica sobre los servicios que aportan las propias empresas.
     </p>
    </dd>
   </dl>
  </li>
  <li>
   <p>
    Es uno de los estÃ¡ndares bÃ¡sicos de los servicios web, cuyo objetivo es ser
    accedido por los mensajes SOAP y dar paso a documentos WSDL, en los que se
    describen los requisitos del protocolo y los formatos del mensaje solicitado
    para interactuar con los servicios Web del catÃ¡logo de registros.
   </p>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://es.wikipedia.org/wiki/UDDI"
     target="_blank" rel="noreferrer">https://es.wikipedia.org/wiki/UDDI</a>
  </small>
 </p>
</div>
      </section>
     <section>
         <h1 >K. IntroducciÃ³n a REST</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m03soa/mJrest/m1defRest.html"><dfn>REST</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mJrest/m2dirsRest.html"><dfn>Solicitud HTTP</dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m03soa/mJrest/m3metodosRes.html">MÃ©todos de envÃ­o HTTP</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >1. <dfn>REST</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Siglas para
    <strong>Representational State Transfer</strong>
    o
    <em>transferencia de estado representacional</em>.
   </p>
  </li>
  <li>
   <p>
    Estilo de arquitectura de software para sistemas distribuidos en la World
    Wide Web.
   </p>
  </li>
 </ul>
 <p>
  <small>
   Fuentes:
   <a href="https://es.wikipedia.org/wiki/Transferencia_de_Estado_Representacional"
     target="_blank"
     rel="noreferrer">https://es.wikipedia.org/wiki/Transferencia_de_Estado_Representacional</a>
   y
   <a href="https://bbvaopen4u.com/es/actualidad/api-rest-que-es-y-cuales-son-sus-ventajas-en-el-desarrollo-de-proyectos"
     target="_blank"
     rel="noreferrer">https://bbvaopen4u.com/es/actualidad/api-rest-que-es-y-cuales-son-sus-ventajas-en-el-desarrollo-de-proyectos</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >2. <dfn>Solicitud HTTP</dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Toda pÃ¡gina web tiene una URL asociada, pero tambiÃ©n puede representar una
    entidad, que puede ser una colecciÃ³n de datos, por ejemplo,
    <q>https://mirest.com/contactos</q>, o un objeto, por ejemplo,
    <q>https://mirest.com/contactos/69</q>.
   </p>
  </li>
  <li>
   <p>
    Para interactuar con la URL hay que enviarle una solicitud, que consta de:
   </p>
   <dl>
    <dt><dfn>URL</dfn>
    <dd>
     <p>
      Con parÃ¡metros opcionales que consisten en nombre y
      valor asociado, separados por & (como cuando buscas en Google).
     </p>
    </dd>
    <dt><dfn>conjunto de encabezados</dfn></dt>
    <dd>
     <p>
      Proporcionan informaciÃ³n sobre la computadora y el programa que envÃ­an los
      datos, asÃ­ como la informacion que esperan recibir.
     </p>
    </dd>
    <dt><dfn>cuerpo</dfn></dt>
    <dt><dfn>carga Ãºtil</dfn></dt>
    <dd>
     <p>
      Contiene datos adicionales,Pueden representarse en los siguientes
      formatos:
     </p>
     <ul>
      <li>
       <p>application/x-www-form-urlencoded</p>
      </li>
      <li>
       <p>multipart/form-data</p>
      </li>
      <li>
       <p>text/plain</p>
      </li>
      <li>
       <p>XML</p>
      </li>
      <li>
       <p>JSON</p>
      </li>
      <li>
       <p>YAML</p>
      </li>
     </ul>
    </dd>
    <dt><dfn>MÃ©todo de envÃ­o</dfn></dt>
    <dd>
     <p>
      Indica la acciÃ³n que debe realizarse sobre la URL, usando los datos
      adicionales.
     </p>
    </dd>
   </dl>
  </li>
 </ul>
 <p>
  <small>
   Fuente:
   <a href="https://developer.mozilla.org/es/docs/Web/HTTP/Methods" rel="noreferrer"
     target="_blank">https://developer.mozilla.org/es/docs/Web/HTTP/Methods</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >3. MÃ©todos de envÃ­o HTTP</h1><div class="lectura">
 <dl>
  <dt><dfn>TRACE</dfn></dt>
  <dd>
   <p>
    Realiza una prueba de enviar un mensaje mensaje al servidor de la URL
    y recibirlo de regreso sin modificaciones.
   </p>
  </dd>
  <dt><dfn>OPTIONS</dfn></dt>
  <dd>
   <p>
    Devuelve una descripciÃ³n de las opciones de comunicaciÃ³n de laURL.
   </p>
  </dd>
  <dt><dfn>CONNECT</dfn></dt>
  <dd>
   <p>
    Establece un tunel bidireccional hacia el servidor.
   </p>
  </dd>
  <dt><dfn>GET</dfn></dt>
  <dd>
   <p>
    Devuelve los datos de la colecciÃ³n u objeto asociados con la URL, sin
    modificar el estado del servidor.
   </p>
   <p>
    Puede tomarse en cuenta los parÃ¡metros que lleva la URL, como si
    fueran las condiciones de una clÃ¡usula WHERE de SQL.
   </p>
  </dd>
  <dt><dfn>HEAD</dfn></dt>
  <dd>
   <p>
    Devuelve una respuesta como la de GET, pero sin el cuerpo de la
    respuesta.
   </p>
  </dd>
  <dt><dfn>POST</dfn></dt>
  <dd>
   <p>EnvÃ­a una entidad a una URL.</p>
   <p>
    Si la URL representa una lista que no contiene esa entidad, la agrega.
   </p>
   <p>
    Los datos de la entidad se indican en el cuerpo de la solicitud.
   </p>
   <p>
    A menudo causa un cambio o efectos secundarios en el servidor.
   </p>
  </dd>
  <dt><dfn>PUT</dfn></dt>
  <dd>
   <p>
    Reemplaza toda la entidad indicada en la URL con el contenido del
    cuerpo de la solicitud.
   </p>
  </dd>
  <dt><dfn>PATCH</dfn></dt>
  <dd>
   <p>
    Modifica parcialmente la entidad de la URL, modificando solamente los
    datos enviados en el cuerpo de la solicitud.
   </p>
  </dd>
  <dt><dfn>DELETE</dfn></dt>
  <dd>
   <p>Eliminar la entidad de la URL</p>
  </dd>
 </dl>
 <p>
  <small>
   Fuente:
   <a href="https://developer.mozilla.org/es/docs/Web/HTTP/Methods" rel="noreferrer"
     target="_blank">https://developer.mozilla.org/es/docs/Web/HTTP/Methods</a>
  </small>
 </p>
</div>
      </section>
      </section>
     <section >
         <h1 >L. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>En esta lecciÃ³n se introdujeron los siguientes temas:</p>
   <ul>
    <li>
     <p>Arquitectura orientada a servicios</p>
    </li>
    <li>
     <p>Ventajas de una arquitectura orientada a servicios</p>
    </li>
    <li>
     <p>Principios de diseÃ±o de un servici</p>
    </li>
    <li>
     <p>Capas de una arquitectura orientada a servicios</p>
    </li>
    <li>
     <p>Diagrama de Arquitectura</p>
    </li>
    <li>
     <p>XML</p>
    </li>
    <li>
     <p>SOAP</p>
    </li>
    <li>
     <p>WSDL</p>
    </li>
    <li>
     <p>UDDI</p>
    </li>
    <li>
     <p>REST</p>
    </li>
   </ul>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section >
         <h1 >7. Ejemplo de geolocalizaciÃ³n</h1><iframe src="/src/m04geolocalizacion/maps.html" height="550"></iframe>
<p class="noPrint">
 <a href="/src/m04geolocalizacion/maps.html" target="_blank"
   rel="noreferrer">Ãbrelo en otra pestaÃ±a.</a>
</p>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">&quot;es&quot;</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">&quot;UTF-8&quot;</span>&gt;</td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">&quot;viewport&quot;</span> content=<span class="codeString">&quot;width=device-width&quot;</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">title</span>&gt;Maps&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>8</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">h1</span>&gt;Maps&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">iframe</span></td></tr>
  <tr><td>13</td><td>   src=<span class="codeString">&quot;https:&#47;/www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d7526.355841517565!2d-98.98640932835467!3d19.40471709504528!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x85d1e319b9413c4f%3A0x1d391ad53ddf65d1!2sUniversidad%20Tecnol%C3%B3gica%20de%20Nezahualc%C3%B3yotl!5e0!3m2!1ses-419!2smx!4v1574352931317!5m2!1ses-419!2smx&quot;</span></td></tr>
  <tr><td>14</td><td>   width=<span class="codeString">&quot;600&quot;</span> height=<span class="codeString">&quot;450&quot;</span> frameborder=<span class="codeString">&quot;0&quot;</span> style=<span class="codeString">&quot;border:0;&quot;</span></td></tr>
  <tr><td>15</td><td>   allowfullscreen=<span class="codeString">&quot;&quot;</span>&gt;&lt;/<span class="codeReserved">iframe</span>&gt;</td></tr>
  <tr><td>16</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. Ejemplo de redes sociales</h1><div class="lectura">
 <p>
  Generado en
  <a href="https://developers.facebook.com/docs/plugins/page-plugin/"
    target="_blank">https://developers.facebook.com/docs/plugins/page-plugin/</a>
 </p>
</div>
<iframe src="/src/m05sociales/face.html" height="600"></iframe>
<p class="noPrint">
 <a href="/src/m05sociales/face.html" target="_blank" rel="noreferrer">Ãbrelo en
  otra pestaÃ±a.</a>
</p>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">&quot;es&quot;</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">&quot;UTF-8&quot;</span>&gt;</td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">&quot;viewport&quot;</span></td></tr>
  <tr><td>7</td><td>   content=<span class="codeString">&quot;width=device-width&quot;</span>&gt;</td></tr>
  <tr><td>8</td><td> &lt;<span class="codeReserved">title</span>&gt;Face&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>9</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">h1</span>&gt;Face&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">iframe</span></td></tr>
  <tr><td>14</td><td>   src=&quot;https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Ffacebook&tabs=timeline&width=340&height=500&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true&appId=437040163649483<span class="codeString">&quot;</td></tr>
  <tr><td>15</td><td>   width=&quot;</span>340<span class="codeString">&quot; height=&quot;</span>500<span class="codeString">&quot;</td></tr>
  <tr><td>16</td><td>   style=&quot;</span>border:none;overflow:hidden<span class="codeString">&quot;</td></tr>
  <tr><td>17</td><td>   scrolling=&quot;</span>no<span class="codeString">&quot; frameborder=&quot;</span>0<span class="codeString">&quot;</td></tr>
  <tr><td>18</td><td>   allowTransparency=&quot;</span>true<span class="codeString">&quot;</td></tr>
  <tr><td>19</td><td>   allow=&quot;</span>encrypted-media&quot;&gt;&lt;/<span class="codeReserved">iframe</span>&gt;</td></tr>
  <tr><td>20</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >9. CaracterÃ­sticas de un e-commerce</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m06ecommerce/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m06ecommerce/mAfacilidad.html">Facilidad de navegaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m06ecommerce/mBnoDestaca.html">El diseÃ±o no destaca por encima de los productos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m06ecommerce/mCfacil.html">FÃ¡cil proceso de compra</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m06ecommerce/mDpopulares.html">Exhibir los productos mÃ¡s populares</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m06ecommerce/mEdetalle.html">Fotos de productos a detalle</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m06ecommerce/mFresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <p>
  En esta lecciÃ³n se presentan las caracterÃ­sticas principales de un e-commerce.
 </p>
 <p>
  <small>
   Fuente:
   <a href="https://www.actualidadecommerce.com/las-5-principales-caracteristicas-de-un-sitio-ecommerce-bien-disenado/"
     target="_blank"
     rel="noreferrer">https://www.actualidadecommerce.com/las-5-principales-caracteristicas-de-un-sitio-ecommerce-bien-disenado/</a>
  </small>
 </p>
</div>
      </section>
     <section >
         <h1 >B. Facilidad de navegaciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Cuando se trata de vender productos, el primer requisito a cumplir para una
    tienda e-commerce es que el comprador tiene que ser capaz de encontrar
    rÃ¡pida y de forma especifica, lo que el o ella estÃ¡n buscando. Una
    navegaciÃ³n eficaz es fundamental para los sitios e-commerce ya que los
    visitantes que no pueden encontrar lo que buscan se traducen en ventas
    perdidas.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >C. El diseÃ±o no destaca por encima de los productos</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En un negocio e-commerce, el foco de atenciÃ³n siempre debe estar en los
    productos que estÃ¡n disponibles para su compra. Un diseÃ±o que es
    extravagante sin sentido, generalmente hace mÃ¡s daÃ±o que beneficio, puesto
    que al final, el diseÃ±o no es lo que se vende, sino los productos.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >D. FÃ¡cil proceso de compra</h1><div class="lectura">
 <ul>
  <li>
   <p>
    La experiencia del usuario en sitios de comercio electrÃ³nico es fundamental
    para el Ã©xito. Es decir, si el proceso de compra implica demasiados pasos o
    incluso es confuso, los compradores simplemente terminarÃ¡n abandonando su
    carrito de compras. Por ello, el checkout siempre debe implicar la mÃ­nima
    cantidad de pasos y debe ser lo mÃ¡s fÃ¡cil e intuitivo para los compradores.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >E. Exhibir los productos mÃ¡s populares</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Muchos negocios e-commerce se esfuerzan por mostrar los elementos que pueden
    ser de interÃ©s para los potenciales compradores. Un gran nÃºmero de sitios de
    comercio electrÃ³nico estÃ¡n utilizando espacios muy amplios en la pÃ¡gina de
    inicio para promover las ventas actuales, el lanzamiento de un nuevo
    producto o lo que sea que genere interÃ©s.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >F. Fotos de productos a detalle</h1><div class="lectura">
 <ul>
  <li>
   <p>
    La venta de productos en Internet es diferente de vender en una tienda
    fÃ­sica porque el comprador no puede tocar o ver en persona el producto antes
    de tomar la decisiÃ³n de compra. Al ofrecer fotos de los productos que
    resaltan a detalle las caracterÃ­sticas principales del mismo, se consigue
    superar ese inconveniente y se hace mÃ¡s fÃ¡cil para el comprador decidir si
    conviene o no comprar el producto.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >G. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se presentaron las caracterÃ­sticas principales de un
    e-commerce:
   </p>
   <ul>
    <li>
     <p>
      Facilidad de navegaciÃ³n.
     </p>
    </li>
    <li>
     <p>
      El diseÃ±o no destaca por encima de los productos.
     </p>
    </li>
    <li>
     <p>
      El diseÃ±o no destaca por encima de los productos.
     </p>
    </li>
    <li>
     <p>
      FÃ¡cil proceso de compra.
     </p>
    </li>
    <li>
     <p>
      Exhibir los productos mÃ¡s populares.
     </p>
    </li>
    <li>
     <p>
      Fotos de productos a detalle.
     </p>
    </li>
   </ul>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >10. Servicio que devuelve JSON</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mBconsumeJson.html">La funciÃ³n <dfn><code>consumeJson</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCdevuelveJson.html">La funciÃ³n <dfn><code>devuelveJson</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mDProblemDetails.html">La clase <dfn><code>ProblemDetails</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mD3muestraerror.html">La funciÃ³n <dfn><code>muestraError</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mBdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/">Funcionamiento</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mHresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <p>
  Este ejemplo recibe los datos JSON generados por un servicio.
 </p>
 <p>
  Puedes probar el ejemplo en
  <a href="http://srvdevuelve.rf.gd/" rel="noreferrer"
    target="_blank">http://srvdevuelve.rf.gd/</a>.
 </p>
</div>
      </section>
     <section >
         <h1 >B. La funciÃ³n <dfn><code>consumeJson</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    El cÃ³digo que se muestra en el ejemplo de servicio se repite en muchos
    ejemplos posteriores, pero ademÃ¡s debe realizar algunas cuastiones
    adicionales. Para simplificar el trabajo, se introduce la funciÃ³n
    <code>consumeJson</code>, que realiza todo lo necesario para controlar la
    conxiÃ³n desde el navegador web hacia el servidor.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde estÃ¡ definida esta funciÃ³n y
    luego invocarla pasÃ¡ndole la url del servicio, o alternativamente, pasÃ¡ndole
    el resultado de invocar la funciÃ³n fetch que comunica al servicio.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n y las siguientes, se profundiza en el uso y
    estructura de esta funciÃ³n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >C. La funciÃ³n <dfn><code>devuelveJson</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Para devolver al cliente los resultados de la ejecuciÃ³n de un servicio, se
    usa la funciÃ³n <code>devuelveJson</code>, escrita en PHP.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde estÃ¡ definida esta funciÃ³n
    usando <code>require</code> o <code>require_once</code> y luego invocarla
    pasÃ¡ndole el resultado generado por el servicio.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n y las siguientes, se profundiza en el uso y
    estructura de esta clase.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >D. La clase <dfn><code>ProblemDetails</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Se acuerdo con el RFC 9457 en
    <a rel="noo"
      href="https://www.rfc-editor.org/info/rfc9457" rel="noreferrer"
      target="_blank">https://www.rfc-editor.org/info/rfc9457</a>,
    cuando un servicio falla, debe devolver una
    estructura JSON conocida como <dfn>Problem Details</dfn> que informa los
    detalles del fallo.
   </p>
  </li>
  <li>
   <p>
    El tipo de fallo se describe en el campo <var>type</var>, del problem
    details y, adicionalmente, todo tipo de fallo debe tener una pequeÃ±a pÃ¡gina
    donde se describe el problema. En estos ejemplos, se usa la carpeta
    <dfn>error</dfn> para almacenar las pÃ¡ginas que decriben los errores.
   </p>
  </li>
  <li>
   <p>
    Para usarla en JavaScript, debes importar el archivo donde estÃ¡ definida
    esta clase.
   </p>
  </li>
  <li>
   <p>
    Para usarla en PHP, debes importar el archivo donde estÃ¡ definida esta
    clase usando <code>require</code> o <code>require_once</code>. En este
    ejemplo no se usa la versiÃ³n en PHP; se empezarÃ¡ a usar a partir de la
    lecciÃ³n sobre validaciones.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n y las siguientes, se profundiza en el uso y
    estructura de estas clases.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >E. La funciÃ³n <dfn><code>muestraError</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Manejamos los errores en el navegador web y de una manera uniforme con la
    funciÃ³n <code>muestraError</code>.
   </p>
  </li>
  <li>
   <p>
    Cuando se tiene un error normal de JavaScript, se muestra la excepciÃ³n
    correspondiente en la consola del navegador y el mensaje de la excepciÃ³n en
    un cuadro de alert.
   </p>
  </li>
  <li>
   <p>
    Cuando es un ProblemDetails, cuya estructure se revisa en la lecciÃ³n sobre
    validaciones, sus propiedades se muestran en la consola del navegador y en
    un cuadro de alert.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde estÃ¡ definida esta funciÃ³n y
    colocarla dentro de un catch. Se le pasa como parÃ¡metro la excepciÃ³n
    atrapada por el catch.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n y las siguientes, se profundiza en el uso y
    estructura de esta funciÃ³n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >F. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m08srvdevuelve/srvdevuelvedistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section>
         <h1 >G. Funcionamiento</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m1cliente.html">Iniciamos al ejecutar cÃ³digo en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m2servidor.html">Se invoca el servicio en el servidor</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m3procesa.html">El servicio procesa la request y genera la response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m4devuelve.html">El servicio devuelve la response, que es recibida en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m5variable.html">Se crea la constante body, que apunta al cuerpo de la respuesta</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m5muestra.html">Muestra el objeto recibido en un alert</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m6termina.html">Al cerrar el alert, termina el evento</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section class="pruebaDeEscritorio">
         <h1 >1. Iniciamos al ejecutar cÃ³digo en el cliente</h1><section>
 <h1>index.html</h1>
 <pre class="resaltado"><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> consumeJson(</span>
<span>  <span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span><span class="codeReserved">const</span> body = respuesta.body</span>
<span>alert(<span class="codeString">`Nombre: ${body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${body.mensaje}`</span>)</span></code></pre>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >2. Se invoca el servicio en el servidor</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> consumeJson(</span>
<span class="resaltado">  <span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span><span class="codeReserved">const</span> body = respuesta.body</span>
<span>alert(<span class="codeString">`Nombre: ${body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${body.mensaje}`</span>)</span></code></pre>
 <p class="resaltado2">Ejecuta invocaServicio y<br>envÃ­a request (solicitud).</p>
</section>
<section>
 <h1>Request</h1>
 <dl class="resaltado">
  <dt>URL</dt>
  <dd>srv&#47;devuelve.php</dd>
  <dt>Method</dt>
  <dd>GET</dd>
 </dl>
</section>
<section>
 <h1>srv&#47;devuelve.php</h1>
 <pre class="resaltado"><code class="language-php"><span>devuelveJson([</span>
<span> <span class="codeString">&quot;nombre&quot;</span> =&gt; <span class="codeString">&quot;pp&quot;</span>,</span>
<span> <span class="codeString">&quot;mensaje&quot;</span> =&gt; <span class="codeString">&quot;Hola.&quot;</span></span>
<span>]);</span></code></pre>
 <p class="resaltado2">Despierta y recibe request.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >3. El servicio procesa la request y genera la response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> consumeJson(</span>
<span class="resaltado3">  <span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span><span class="codeReserved">const</span> body = respuesta.body</span>
<span>alert(<span class="codeString">`Nombre: ${body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${body.mensaje}`</span>)</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv&#47;devuelve.php</h1>
 <pre><code class="language-php"><span class="resaltado">devuelveJson([</span>
<span class="resaltado"> <span class="codeString">&quot;nombre&quot;</span> =&gt; <span class="codeString">&quot;pp&quot;</span>,</span>
<span class="resaltado"> <span class="codeString">&quot;mensaje&quot;</span> =&gt; <span class="codeString">&quot;Hola.&quot;</span></span>
<span class="resaltado">]);</span></code></pre>
 <p class="resaltado2">Procesa la request y<br>genera response<br>(respuesta).</p>
</section>
<section style="vertical-align: top; overflow-wrap: anywhere;">
 <h1>Response</h1>
 <dl class="resaltado">
  <dt>code</dt>
  <dd>200</dd>
  <dt>body</dt>
  <dd>{"nombre":"pp","mensaje":"Hola."}</dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >4. El servicio devuelve la response, que es recibida en el cliente</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span class="resaltado"><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> consumeJson(</span>
<span class="resaltado">  <span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span><span class="codeReserved">const</span> body = respuesta.body</span>
<span>alert(<span class="codeString">`Nombre: ${body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${body.mensaje}`</span>)</span></code></pre>
 <p class="resaltado2">Despierta y recibe response.</p>
</section>
<div class="section">
 <section >
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>{"nombre":"pp","mensaje":"Hola."}</dd>
  </dl>
 </section>
 <section >
  <h1>Memoria</h1>
  <dl class="resaltado">
   <dt>respuesta</dt>
   <dd>
    <dl>
     <dt>status</dt>
     <dd>200</dd>
     <dt>body</dt>
     <dd>
      <dl>
       <dt>nombre</dt>
       <dd>"pp"</dd>
       <dt>mensaje</dt>
       <dd>"Hola."</dd>
      </dl>
     </dd>
    </dl>
   </dd>
  </dl>
 </section>
</div>
<section>
 <h1>srv&#47;devuelve.php</h1>
 <pre class="resaltado3"><code class="language-php"><span>devuelveJson([</span>
<span> <span class="codeString">&quot;nombre&quot;</span> =&gt; <span class="codeString">&quot;pp&quot;</span>,</span>
<span> <span class="codeString">&quot;mensaje&quot;</span> =&gt; <span class="codeString">&quot;Hola.&quot;</span></span>
<span>]);</span></code></pre>
 <p class="resaltado3">Devuelve response y se duerme.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >5. Se crea la constante body, que apunta al cuerpo de la respuesta</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> consumeJson(</span>
<span">  <span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span class="resaltado"><span class="codeReserved">const</span> body = respuesta.body</span>
<span>alert(<span class="codeString">`Nombre: ${body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${body.mensaje}`</span>)</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt>respuesta</dt>
  <dd>
   <dl>
    <dt>status</dt>
    <dd>200</dd>
    <dt class="resaltado2">body</dt>
    <dd class="resaltado2">
     <dl>
      <dt>nombre</dt>
      <dd>"pp"</dd>
      <dt>mensaje</dt>
      <dd>"Hola."</dd>
     </dl>
    </dd>
   </dl>
  </dd>
  <dt class="resaltado">body</dt>
  <dd class="resaltado2">ref->respuesta.body</dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >6. Muestra el objeto recibido en un alert</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span class="resaltado"><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> consumeJson(</span>
<span">  <span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span><span class="codeReserved">const</span> body = respuesta.body</span>
<span class="resaltado">alert(<span class="codeString">`Nombre: ${body.nombre}</span></span>
<span class="resaltado"><span class="codeString">Mensaje: ${body.mensaje}`</span>)</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt>respuesta</dt>
  <dd>
   <dl>
    <dt>status</dt>
    <dd>200</dd>
    <dt class="resaltado2">body</dt>
    <dd>
     <dl>
      <dt class="resaltado2">nombre</dt>
      <dd class="resaltado2">"pp"</dd>
      <dt class="resaltado2">mensaje</dt>
      <dd class="resaltado2">"Hola."</dd>
     </dl>
    </dd>
   </dl>
  </dd>
  <dt class="resaltado">body</dt>
  <dd class="resaltado2">ref->respuesta.body</dd>
 </dl>
</section>
<section>
 <h1>Alert</h1>
 <div class="resaltado" style="border: thin solid; padding: 0 0.5rem;">
  <p>Nombre: pp<br>Mensaje: Hola.</p>
  <p style="text-align: end;">
   <button type="button">Aceptar</button>
  </p>
 </div>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >7. Al cerrar el alert, termina el evento</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> consumeJson(</span>
<span>  <span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span><span class="codeReserved">const</span> body = respuesta.body</span>
<span>alert(<span class="codeString">`Nombre: ${body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${body.mensaje}`</span>)</span></code></pre>
</section>
      </section>
      </section>
     <section >
         <h1 >H. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvdevuelve.rf.gd/" rel="noreferrer"
      target="_blank">http://srvdevuelve.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvdevuelve.zip" download>/src/srvdevuelve.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >I. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-devuelve-php.html">devuelve.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >J. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Servicio que devuelve JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Servicio que devuelve JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> onclick=<span class="codeString">"resultado()"</span>&gt;Resultado&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/consumeJson.js"</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/muestraError.js"</span></td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">async</span> <span class="codeReserved">function</span> resultado() {</td></tr>
  <tr><td>25</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>26</td><td>    <span class="codeReserved">const</span> respuesta =</td></tr>
  <tr><td>27</td><td>     <span class="codeReserved">await</span> consumeJson(</td></tr>
  <tr><td>28</td><td>      <span class="codeString">"srv/devuelve.php"</span>)</td></tr>
  <tr><td>29</td><td>    <span class="codeReserved">const</span> body = respuesta.body</td></tr>
  <tr><td>30</td><td>    alert(<span class="codeString">`Nombre: ${body.nombre}</span></td></tr>
  <tr><td>31</td><td><span class="codeString">Mensaje: ${body.mensaje}`</span>)</td></tr>
  <tr><td>32</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>33</td><td>    muestraError(error)</td></tr>
  <tr><td>34</td><td>   }</td></tr>
  <tr><td>35</td><td>  }</td></tr>
  <tr><td>36</td><td>  <span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>  window[<span class="codeString">"resultado"</span>] = resultado</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >K. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-srv/m-devuelve-php.html">srv / devuelve.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / devuelve.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td>devuelveJson([</td></tr>
  <tr><td>6</td><td> <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"pp"</span>,</td></tr>
  <tr><td>7</td><td> <span class="codeString">"mensaje"</span> =&gt; <span class="codeString">"Hola."</span></td></tr>
  <tr><td>8</td><td>]);</td></tr>
  <tr><td>9</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >L. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >M. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section >
         <h1 >N. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >O. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ el funcionamiento de un ejemplo recibe los datos
    JSON generados por un servicio.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >11. Servicio que recibe y devuelve JSON</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m09srvjson/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mBenviaJson.html">La funciÃ³n <code>enviaJson</code></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mCrecuperaJson.html">La funciÃ³n <code>recuperaJson</code></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mDdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/">Funcionamiento</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mFinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mSresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este ejemplo envÃ­a y recibe datos JSON.
   </p>
  </li>
  <li>
   <p>
    Muchos servicios de Internet utilizan esta forma de comunicaciÃ³n.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvjson.rf.gd/" rel="noreferrer"
      target="_blank">http://srvjson.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. La funciÃ³n <code>enviaJson</code></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Se introduce la funciÃ³n <code>enviaJson</code>, que convierte un dato en una
    cadena JSON y la manda desde el navegador web hacia el servidor.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde estÃ¡ definida esta funciÃ³n y
    luego invocarla pasÃ¡ndole la URL, los datos y el mÃ©todo de envÃ­o, que por
    omisiÃ³n es POST.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n, se profundiza en el uso y estructura de esta
    funciÃ³n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >C. La funciÃ³n <code>recuperaJson</code></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Para que los servicios en el servidor puedan recuperar un texto en formato
    JSON, se introduce la funciÃ³n <code>recuperaJson</code>, escrita en PHP.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importarla con <code>require</code> o
    <code>require_once</code>, invocarla y recibir la referencia al objeto
    recibido.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n, se profundiza en el uso y estructura de esta
    funciÃ³n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m09srvjson/srvjsondistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section>
         <h1 >E. Funcionamiento</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m1cliente.html">Iniciamos al ejecutar cÃ³digo en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m2acreaJson.html">Se crea la literal de objeto</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m3servicio.html">Se invoca el servicio en el servidor</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m4aleeDatos.html">El servicio lee los datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m5aprocesaDatos.html">El servicio procesa los datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m6response.html">El servicio genera la response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m7devuelve.html">El servicio devuelve la response, que es recibida en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m8muestra.html">Muestra el valor recibido recibido en un alert</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/mEfunJson/m9termina.html">Al cerrar el alert, termina el evento</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section class="pruebaDeEscritorio">
         <h1 >1. Iniciamos al ejecutar cÃ³digo en el cliente</h1><section>
 <h1>index.html</h1>
 <pre class="resaltado"><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> enviaJson(</span>
<span>  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >2. Se crea la literal de objeto</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span class="resaltado"><span class="codeReserved">const</span> datos = {</span>
<span class="resaltado"> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span class="resaltado"> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span class="resaltado">}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> enviaJson(</span>
<span>  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt class="resaltado">datos</dt>
  <dd class="resaltado">
    <dl>
     <dt>saludo</dt>
     <dd>"Hola"</dd>
     <dt>nombre</dt>
     <dd>"pp"</dd>
    </dl>
  </dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >3. Se invoca el servicio en el servidor</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> enviaJson(</span>
<span class="resaltado">  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado2">Ejecuta fetch y envÃ­a<br>request (solicitud).</p>
</section>
<div class="section">
 <section >
  <h1>Memoria</h1>
  <dl>
   <dt>datos</dt>
   <dd>
    <dl>
     <dt>saludo</dt>
     <dd>"Hola"</dd>
     <dt>nombre</dt>
     <dd>"pp"</dd>
    </dl>
   </dd>
  </dl>
 </section>
 <section >
  <h1>Request</h1>
  <dl class="resaltado" style="overflow-wrap: anywhere;">
   <dt>URL</dt>
   <dd>srv/json.php</dd>
   <dt>Method</dt>
   <dd>POST</dd>
   <dt>body</dt>
   <dd>
    {"saludo":"Hola","nombre":"pp"}
   </dd>
  </dl>
 </section>
</div>
<section>
 <h1>srv/json.php</h1>
 <pre class="resaltado"><code class="language-php"><span>$json = leeJson();</span>
<span>$saludo = $json-&gt;saludo;</span>
<span>$nombre = $json-&gt;nombre;</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado2">Despierta y recibe request.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >4. El servicio lee los datos</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> enviaJson(</span>
<span class="resaltado3">  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt>datos</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd>"Hola"</dd>
    <dt>nombre</dt>
    <dd>"pp"</dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>srv/json.php</h1>
 <pre><code class="language-php"><span class="resaltado">$json = leeJson();</span>
<span class="resaltado">$saludo = $json-&gt;saludo;</span>
<span class="resaltado">$nombre = $json-&gt;nombre;</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<div class="section">
 <section >
  <h1>Request</h1>
  <dl style="padding: 0.5rem; overflow-wrap: anywhere;">
   <dt>URL</dt>
   <dd>srv/json.php</dd>
   <dt>Method</dt>
   <dd>POST</dd>
   <dt class="resaltado">body</dt>
   <dd class="resaltado">
    {"saludo":"Hola","nombre":"pp"}
   </dd>
   </dl>
 </section>
 <section >
  <h1>Memoria (Servidor)</h1>
  <dl class="resaltado">
   <dt>$json</dt>
   <dd>
    <dl>
     <dt>saludo</dt>
     <dd>"Hola"</dd>
     <dt>nombre</dt>
     <dd>"pp"</dd>
    </dl>
   </dd>
   <dt>$saludo</dt>
   <dd>"Hola"</dd>
   <dt>$nombre</dt>
   <dd>"pp"</dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >5. El servicio procesa los datos</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> enviaJson(</span>
<span class="resaltado3">  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt>datos</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd>"Hola"</dd>
    <dt>nombre</dt>
    <dd>"pp"</dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>srv/json.php</h1>
 <pre><code class="language-php"><span>$json = leeJson();</span>
<span>$saludo = $json-&gt;saludo;</span>
<span>$nombre = $json-&gt;nombre;</span>
<span class="resaltado">$resultado =</span>
<span class="resaltado"> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Memoria (Servidor)</h1>
 <dl>
  <dt>$json</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd>"Hola"</dd>
    <dt>nombre</dt>
    <dd>"pp"</dd>
   </dl>
  </dd>
  <dt class="resaltado2">$saludo</dt>
  <dd class="resaltado2">"Hola"</dd>
  <dt class="resaltado2">$nombre</dt>
  <dd class="resaltado2">"pp"</dd>
  <dt class="resaltado">$resultado</dt>
  <dd class="resaltado">"Hola pp."</dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >6. El servicio genera la response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> enviaJson(</span>
<span class="resaltado3">  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
   <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt>datos</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd>"Hola"</dd>
    <dt>nombre</dt>
    <dd>"pp"</dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>srv/json.php</h1>
 <pre><code class="language-php"><span>$json = leeJson();</span>
<span>$saludo = $json-&gt;saludo;</span>
<span>$nombre = $json-&gt;nombre;</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span class="resaltado">devuelveJson($resultado);</span></code></pre>
</section>
<div class="section">
 <section >
  <h1>Memoria (Servidor)</h1>
  <dl>
   <dt>$json</dt>
   <dd>
    <dl>
     <dt>saludo</dt>
     <dd>"Hola"</dd>
     <dt>nombre</dt>
     <dd>"pp"</dd>
    </dl>
   </dd>
   <dt>$saludo</dt>
   <dd>"Hola"</dd>
   <dt>$nombre</dt>
   <dd>"pp"</dd>
   <dt class="resaltado2">$resultado</dt>
   <dd class="resaltado2">"Hola pp."</dd>
  </dl>
 </section>
 <section >
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>"Hola pp."</dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >7. El servicio devuelve la response, que es recibida en el cliente</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span class="resaltado"><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> enviaJson(</span>
<span class="resaltado">  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado2">Despierta y recibe response.</p>
</section>
<div class="section">
 <section >
  <h1>Memoria</h1>
  <dl>
   <dt>datos</dt>
   <dd>
    <dl>
     <dt>saludo</dt>
     <dd>"Hola"</dd>
     <dt>nombre</dt>
     <dd>"pp"</dd>
    </dl>
   </dd>
   <dt class="resaltado">respuesta</dt>
   <dd class="resaltado">
    <dl>
     <dt>status</dt>
     <dd>200</dd>
     <dt>body</dt>
     <dd>"Hola pp."</dd>
    </dl>
   </dd>
  </dl>
 </section>
 <section >
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>"Hola pp."</dd>
  </dl>
 </section>
</div>
<section>
 <h1>srv/json.php</h1>
 <pre class="resaltado3"><code class="language-php"><span>$json = leeJson();</span>
<span>$saludo = $json-&gt;saludo;</span>
<span>$nombre = $json-&gt;nombre;</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado3">Devuelve response y se duerme.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >8. Muestra el valor recibido recibido en un alert</h1><section style="vertical-align: top;">
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> enviaJson(</span>
<span>  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span class="resaltado">alert(respuesta.body)</span></code></pre>
</section>
<section style="vertical-align: top;">
 <h1>Memoria</h1>
 <dl>
  <dt>datos</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd>"Hola"</dd>
    <dt>nombre</dt>
    <dd>"pp"</dd>
   </dl>
  </dd>
  <dt class="resaltado">respuesta</dt>
  <dd>
   <dl>
    <dt>status</dt>
    <dd>200</dd>
    <dt class="resaltado">body</dt>
    <dd class="resaltado">"Hola pp."</dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>Alert</h1>
 <div class="resaltado" style="border: thin solid; padding: 0 0.5rem;">
  <p>Hola pp.</p>
  <p style="text-align: end;">
   <button type="button">Aceptar</button>
  </p>
 </div>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >9. Al cerrar el alert, termina el evento</h1><section style="vertical-align: middle;">
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> datos = {</span>
<span> saludo: <span class="codeString">&quot;Hola&quot;</span>,</span>
<span> nombre: <span class="codeString">&quot;pp&quot;</span></span>
<span>}</span>
<span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> enviaJson(</span>
<span>  <span class="codeString">&quot;srv&#47;json.php&quot;</span>, datos)</span>
<span>alert(respuesta.body)</span></code></pre>
  </section>
      </section>
      </section>
     <section >
         <h1 >F. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvjson.rf.gd/" rel="noreferrer"
      target="_blank">http://srvjson.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvjson.zip" download>/src/srvjson.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >G. Archivos</h1><div class="lectura">
 <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
 <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <details>
    <summary>error</summary>
    <ul>
     <li>
      <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
     </li>
     <li>
      <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a>
      </p>
     </li>
    </ul>
   </details>
  </li>
  <li>
   <details>
    <summary>lib</summary>
    <ul>
     <li>
      <details>
       <summary>js</summary>
       <ul>
        <li>
         <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
        </li>
        <li>
         <p><a href="m-lib/m-js/m-enviaJson-js.html">enviaJson.js</a></p>
        </li>
        <li>
         <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
        </li>
        <li>
         <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a>
         </p>
        </li>
       </ul>
      </details>
     </li>
     <li>
      <details>
       <summary>php</summary>
       <ul>
        <li>
         <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a>
         </p>
        </li>
        <li>
         <p><a
            href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a>
         </p>
        </li>
        <li>
         <p><a
            href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a>
         </p>
        </li>
        <li>
         <p><a href="m-lib/m-php/m-recuperaJson-php.html">recuperaJson.php</a>
         </p>
        </li>
       </ul>
      </details>
     </li>
    </ul>
   </details>
  </li>
  <li>
   <details>
    <summary>srv</summary>
    <ul>
     <li>
      <p><a href="m-srv/m-json-php.html">json.php</a></p>
     </li>
    </ul>
   </details>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >H. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Servicio que recibe y devuelve JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Servicio que recibe y devuelve JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> onclick=<span class="codeString">"envia()"</span>&gt;EnvÃ­a JSON&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/muestraError.js"</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">import</span> { enviaJson } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/enviaJson.js"</span></td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">async</span> <span class="codeReserved">function</span> envia() {</td></tr>
  <tr><td>25</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>26</td><td>    <span class="codeReserved">const</span> datos = {</td></tr>
  <tr><td>27</td><td>     saludo: <span class="codeString">"Hola"</span>,</td></tr>
  <tr><td>28</td><td>     nombre: <span class="codeString">"pp"</span></td></tr>
  <tr><td>29</td><td>    }</td></tr>
  <tr><td>30</td><td>    <span class="codeReserved">const</span> respuesta =</td></tr>
  <tr><td>31</td><td>     <span class="codeReserved">await</span> enviaJson(</td></tr>
  <tr><td>32</td><td>      <span class="codeString">"srv/json.php"</span>, datos)</td></tr>
  <tr><td>33</td><td>    alert(respuesta.body)</td></tr>
  <tr><td>34</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>35</td><td>    muestraError(error)</td></tr>
  <tr><td>36</td><td>   }</td></tr>
  <tr><td>37</td><td>  }</td></tr>
  <tr><td>38</td><td>  <span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>39</td><td>  window[<span class="codeString">"envia"</span>] = envia</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >I. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m09srvjson/m-srv/m-json-php.html">srv / json.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / json.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td>$json = recuperaJson();</td></tr>
  <tr><td>7</td><td>$saludo = $json-&gt;saludo;</td></tr>
  <tr><td>8</td><td>$nombre = $json-&gt;nombre;</td></tr>
  <tr><td>9</td><td>$resultado =</td></tr>
  <tr><td>10</td><td> <span class="codeString">"{$saludo} {$nombre}."</span>;</td></tr>
  <tr><td>11</td><td>devuelveJson($resultado);</td></tr>
  <tr><td>12</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >J. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-js/m-enviaJson-js.html">lib / js / enviaJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / enviaJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } url</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Object } body</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> enviaJson(url, body, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">return</span> <span class="codeReserved">await</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>11</td><td>  method: metodoHttp,</td></tr>
  <tr><td>12</td><td>  headers: {</td></tr>
  <tr><td>13</td><td>   <span class="codeString">"Content-Type"</span>: <span class="codeString">"application/json"</span>,</td></tr>
  <tr><td>14</td><td>   <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span></td></tr>
  <tr><td>15</td><td>  },</td></tr>
  <tr><td>16</td><td>  body: JSON.stringify(body)</td></tr>
  <tr><td>17</td><td> }))</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>21</td><td>window[<span class="codeString">"enviaJson"</span>] = enviaJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-lib/m-php/m-recuperaJson-php.html">lib / php / recuperaJson.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / recuperaJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> recuperaJson()</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">return</span> json_decode(file_get_contents(<span class="codeString">"php://input"</span>));</td></tr>
  <tr><td>6</td><td>}</td></tr>
  <tr><td>7</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section >
         <h1 >K. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >L. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m09srvjson/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m09srvjson/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >M. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ un ejemplo que envÃ­a JSON a un servicio y, como
    respuesta, recibe datos JSON de ese mismo servicio.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >12. Servicio que procesa una forma</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m10form/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mBsubmit.html">La funciÃ³n <code>submitForm</code></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mCrecuperaTexto.html">La funciÃ³n <code>recuperaTexto</code></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mDdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/">Funcionamiento</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mGinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este ejemplo muestra como procesar el contenido de una forma usando
    servicios.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvform.rf.gd/" rel="noreferrer"
      target="_blank">http://srvform.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. La funciÃ³n <code>submitForm</code></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Se introduce la funciÃ³n <code>submitForm</code>, que permite enviar los
    datos capturados en un formulario hacia una URL.
   </p>
  </li>
  <li>
   <p>
    Se utiliza el formato <q>mutipart/form-data</q>, lo cual permite transmitir
    el contenido de archivos.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde estÃ¡ definida esta funciÃ³n y
    luego invocarla pasÃ¡ndole el evento generado al hacer submit a una form, la
    URL del servicio que precesa los datos y el mÃ©todo de envÃ­o, que por omisiÃ³n
    es POST.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n y las siguientes, se profundiza en el uso y
    estructura de esta funciÃ³n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >C. La funciÃ³n <code>recuperaTexto</code></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Para que los servicios en el servidor puedan recuperar los datos tipo texto
    enviados por un formulario, por cookies o parÃ¡metros en la URL, se introduce
    la funciÃ³n <code>recuperaTexto</code>, escrita en PHP.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importarla con <code>require</code> o
    <code>require_once</code>, invocarla pasÃ¡ndole el nombre del parÃ¡metro o
    campo que deseas leer y recibir el texto resultante. Si el nombre no estÃ¡
    incluido en la solicitud, se recibe <code>false</code>.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecciÃ³n y las siguientes, se profundiza en el uso y
    estructura de esta funciÃ³n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m10form/srvformdistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section>
         <h1 >E. Funcionamiento</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m1captura.html">El usuario captura datos y activa la forma</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m2submit.html">Se activa el cÃ³digo del evento submit.</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m3invoca.html">Se invoca el servicio, incluyendo los datos de la forma</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m4leeDatos.html">El servicio lee los datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m7procesaDatos.html">El servicio procesa los datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m8response.html">El servicio genera la response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m9devuelve.html">El servicio devuelve la response, que es recibida en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m10muestra.html">Muestra el texto recibido en un alert</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/mFfunFormOk/m11termina.html">Al cerrar el alert, termina el evento</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section class="pruebaDeEscritorio">
         <h1 >1. El usuario captura datos y activa la forma</h1><div class="section">
 <section>
  <h1>Forma</h1>
  <form action="javascript:;" class="resaltado"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo" value="hola">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre" value="pp">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >2. Se activa el cÃ³digo del evento submit.</h1><div class="section">
 <section >
  <h1>Forma</h1>
  <form action="javascript:;"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo" value="hola">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre" value="pp">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
 <section >
  <h1>index.html</h1>
  <pre class="resaltado"><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> submitForm(</span>
<span>  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span>alert(respuesta.body)</span></code></pre>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >3. Se invoca el servicio, incluyendo los datos de la forma</h1><div class="section">
 <section>
  <h1>Forma</h1>
  <form action="javascript:;"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo" value="hola">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre" value="pp">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
 <section>
  <h1>index.html</h1>
  <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado">  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span>alert(respuesta.body)</span></code></pre>
 </section>
</div>
<section>
 <h1>Request</h1>
 <dl class="resaltado">
  <dt>URL</dt>
  <dd>srv/procesa.php</dd>
  <dt>Method</dt>
  <dd>POST</dd>
  <dt>body</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd>hola</dd>
    <dt>nombre</dt>
    <dd>pp</dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>srv/procesa.php</h1>
 <pre class="resaltado"><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado2">Despierta y recibe request.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >4. El servicio lee los datos</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/procesa.php</h1>
 <pre><code class="language-php"><span class="resaltado">$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span class="resaltado">$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<div class="section">
 <section>
  <h1>Request</h1>
  <dl>
   <dt>URL</dt>
   <dd>srv/procesa.php</dd>
   <dt>Method</dt>
   <dd>POST</dd>
   <dt>body</dt>
   <dd>
    <dl>
     <dt class="resaltado">saludo</dt>
     <dd class="resaltado">hola</dd>
     <dt class="resaltado">nombre</dt>
     <dd class="resaltado">pp</dd>
    </dl>
   </dd>
  </dl>
 </section>
 <section>
  <h1>Memoria (Servidor)</h1>
  <dl class="resaltado">
   <dt>$saludo</dt>
   <dd>"hola"</dd>
   <dt>$nombre</dt>
   <dd>"pp"</dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >5. El servicio procesa los datos</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/procesa.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span class="resaltado">$resultado =</span>
<span class="resaltado"> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Memoria (Servidor)</h1>
 <dl>
  <dt class="resaltado2">$saludo</dt>
  <dd class="resaltado2">"hola"</dd>
  <dt class="resaltado2">$nombre</dt>
  <dd class="resaltado2">"pp"</dd>
  <dt class="resaltado">$resultado</dt>
  <dd class="resaltado">"hola pp"</dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >6. El servicio genera la response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/procesa.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span class="resaltado">devuelveJson($resultado);</span></code></pre>
</section>
<div class="section">
 <section >
  <h1>Memoria (Servidor)</h1>
  <dl>
   <dt>$saludo</dt>
   <dd>"hola"</dd>
   <dt>$nombre</dt>
   <dd>"pp"</dd>
   <dt class="resaltado">$resultado</dt>
   <dd class="resaltado">"hola pp"</dd>
  </dl>
 </section>
 <section >
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>"hola pp"</dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >7. El servicio devuelve la response, que es recibida en el cliente</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span class="resaltado"><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado">  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span>alert(respuesta.body)</span></code></pre>
 <p class="resaltado2">Despierta y recibe response.</p>
</section>
<div class="section">
 <section>
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>"hola pp"</dd>
  </dl>
 </section>
 <section>
  <h1>Memoria</h1>
  <dl>
   <dt class="resaltado">respuesta</dt>
   <dd class="resaltado">
    <dl>
     <dt>status</dt>
     <dd>200</dd>
     <dt>body</dt>
     <dd>"Hola pp."</dd>
    </dl>
   </dd>
  </dl>
 </section>
</div>
<section>
 <h1>srv/procesa.php</h1>
 <pre class="resaltado3"><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado3">Devuelve response y se duerme.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >8. Muestra el texto recibido en un alert</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> submitForm(</span>
<span>  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span class="resaltado">alert(respuesta.body)</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt class="resaltado">respuesta</dt>
  <dd>
   <dl>
    <dt>status</dt>
    <dd>200</dd>
    <dt class="resaltado">body</dt>
    <dd class="resaltado">"Hola pp."</dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>Alert</h1>
 <div class="resaltado" style="border: thin solid; padding: 0 0.5rem;">
  <p>hola pp</p>
  <p style="text-align: end;">
   <button type="button">Aceptar</button>
  </p>
 </div>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >9. Al cerrar el alert, termina el evento</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> submitForm(</span>
<span>  <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</span>
<span>alert(respuesta.body)</span></code></pre>  
</section>
      </section>
      </section>
     <section >
         <h1 >F. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvform.rf.gd/" rel="noreferrer"
      target="_blank">http://srvform.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvform.zip" download>/src/srvform.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >G. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-procesa-php.html">procesa.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >H. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">&quot;es&quot;</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">&quot;UTF-8&quot;</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">&quot;viewport&quot;</span> content=<span class="codeString">&quot;width=device-width&quot;</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Servicio que procesa un formulario&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Servicio que procesa un formulario&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">&quot;procesaForm(event) &quot;</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>20</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>21</td><td>    Saludo:</td></tr>
  <tr><td>22</td><td>    <span class="codeComment">&lt;!-- Como este input tiene name=<span class="codeString">&quot;saludo&quot;</span>, su valor se recupera en el</span></td></tr>
  <tr><td>23</td><td><span class="codeComment">     servidor con leeTexto(<span class="codeString">&quot;saludo&quot;</span>) --&gt;</span></td></tr>
  <tr><td>24</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">&quot;saludo&quot;</span>&gt;</td></tr>
  <tr><td>25</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>29</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>30</td><td>    Nombre:</td></tr>
  <tr><td>31</td><td>    <span class="codeComment">&lt;!-- Como este input tiene name=<span class="codeString">&quot;nombre&quot;</span>, su valor se recupera en el</span></td></tr>
  <tr><td>32</td><td><span class="codeComment">     servidor con leeTexto(<span class="codeString">&quot;nombre&quot;</span>) --&gt;</span></td></tr>
  <tr><td>33</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">&quot;nombre&quot;</span>&gt;</td></tr>
  <tr><td>34</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>35</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">&quot;submit&quot;</span>&gt;Procesa&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">&quot;module&quot;</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">&quot;.&#47;lib&#47;js&#47;muestraError.js&quot;</span></td></tr>
  <tr><td>44</td><td>  <span class="codeReserved">import</span> { submitForm } <span class="codeReserved">from</span> <span class="codeString">&quot;.&#47;lib&#47;js&#47;submitForm.js&quot;</span></td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>47</td><td><span class="codeComment">   * @param {Event} event</span></td></tr>
  <tr><td>48</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>49</td><td>  <span class="codeReserved">async</span> <span class="codeReserved">function</span> procesaForm(event) {</td></tr>
  <tr><td>50</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>51</td><td>    <span class="codeReserved">const</span> respuesta =</td></tr>
  <tr><td>52</td><td>     <span class="codeReserved">await</span> submitForm(</td></tr>
  <tr><td>53</td><td>      <span class="codeString">&quot;srv&#47;procesa.php&quot;</span>, event)</td></tr>
  <tr><td>54</td><td>    alert(respuesta.body)</td></tr>
  <tr><td>55</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>56</td><td>    muestraError(error)</td></tr>
  <tr><td>57</td><td>   }</td></tr>
  <tr><td>58</td><td>  }</td></tr>
  <tr><td>59</td><td>  <span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>60</td><td>  window[<span class="codeString">&quot;procesaForm&quot;</span>] = procesaForm</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >I. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m10form/m-srv/m-procesa-php.html">srv / procesa.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / procesa.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td>$saludo = recuperaTexto(<span class="codeString">"saludo"</span>);</td></tr>
  <tr><td>7</td><td>$nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>8</td><td>$resultado =</td></tr>
  <tr><td>9</td><td> <span class="codeString">"{$saludo} {$nombre}."</span>;</td></tr>
  <tr><td>10</td><td>devuelveJson($resultado);</td></tr>
  <tr><td>11</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >J. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m10form/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m10form/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m10form/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >K. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m10form/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m10form/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >L. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >M. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ un servicio que procesa una forma.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >13. Servicio que valida datos</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12valida/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mDdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/">Escenario con datos incorrectos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/">Escenario con datos correctos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mGinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este ejemplo muestra como validar que los datos recibidos por un formulario
    sean correctos.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvvalida.rf.gd/" rel="noreferrer"
      target="_blank">http://srvvalida.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m12valida/srvvalidadistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section>
         <h1 >C. Escenario con datos incorrectos</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m1captura.html">El usuario activa la forma sin capturar datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m2submit.html">Se activa el cÃ³digo del evento submit</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m3invoca.html">Se invoca el servicio, incluyendo los datos de la forma</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m4leeDatos.html">El servicio lee los datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m5validaDatos.html">El servicio comprueba que el saludo sea vÃ¡lido</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m6aborta.html">Como el saludo no es vÃ¡lido, aborta y genera la response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m7devuelve.html">El servicio devuelve la response, que es recibida en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m8throwCliente.html">Como hay error, lanza una excepciÃ³n que atrapa catch</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m9muestra.html">Muestra los detalles de la excepciÃ³n en la consola y en un alert</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mEfunFormError/m10termina.html">Al cerrar el alert, termina el evento</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section class="pruebaDeEscritorio">
         <h1 >1. El usuario activa la forma sin capturar datos</h1><div class="section">
 <section>
  <h1>Forma</h1>
  <form action="javascript:;" class="resaltado"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >2. Se activa el cÃ³digo del evento submit</h1><div class="section">
 <section>
  <h1>Forma</h1>
  <form action="javascript:;"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
 <section>
  <h1>index.html</h1>
  <pre class="resaltado"><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span>  <span class="codeReserved">await</span> submitForm(</span>
<span>   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >3. Se invoca el servicio, incluyendo los datos de la forma</h1><div class="section">
 <section >
  <h1>Forma</h1>
  <form action="javascript:;"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
 <section >
  <h1>index.html</h1>
  <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 </section>
</div>
<section>
 <h1>Request</h1>
 <dl class="resaltado">
  <dt>URL</dt>
  <dd>srv/valida.php</dd>
  <dt>Method</dt>
  <dd>POST</dd>
  <dt>body</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd><em>vacÃ­o</em></dd>
    <dt>nombre</dt>
    <dd><em>vacÃ­o</em></dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre class="resaltado"><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado2">Despierta y recibe request.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >4. El servicio lee los datos</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span class="resaltado">$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span class="resaltado">$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<div class="section">
 <section >
  <h1>Request</h1>
  <dl>
   <dt>URL</dt>
   <dd>srv/valida.php</dd>
   <dt>Method</dt>
   <dd>POST</dd>
   <dt>body</dt>
   <dd>
    <dl>
     <dt class="resaltado">saludo</dt>
     <dd class="resaltado"><em>vacÃ­o</em></dd>
     <dt class="resaltado">nombre</dt>
     <dd class="resaltado"><em>vacÃ­o</em></dd>
    </dl>
   </dd>
  </dl>
 </section>
 <section >
  <h1>Memoria (Servidor)</h1>
  <dl>
   <dt class="resaltado">$saludo</dt>
   <dd class="resaltado">""</dd>
   <dt class="resaltado">$nombre</dt>
   <dd class="resaltado">""</dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >5. El servicio comprueba que el saludo sea vÃ¡lido</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span class="resaltado"><span class="codeReserved">if</span> (</span>
<span class="resaltado"> $saludo === <span class="codeReserved">null</span></span>
<span class="resaltado"> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span class="resaltado">) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Memoria (Servidor)</h1>
 <dl>
  <dt class="resaltado">$saludo</dt>
  <dd class="resaltado">""</dd>
  <dt>$nombre</dt>
  <dd>""</dd>
 </dl>
</section>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >6. Como el saludo no es vÃ¡lido, aborta y genera la response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span class="resaltado"> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span class="resaltado">  status: ProblemDetails::BadRequest,</span>
<span class="resaltado">  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span class="resaltado">  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span class="resaltado"> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Response</h1>
 <dl class="resaltado">
  <dt>code</dt>
  <dd>400</dd>
  <dt>body</dt>
  <dd>
   {<br>
    "type": "/error/faltasaludo.html",<br>
    "title": "Falta el saludo."<br>
   }
  </dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >7. El servicio devuelve la response, que es recibida en el cliente</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado2">Despierta y recibe response.</p>
</section>
<section>
 <h1>Response</h1>
 <dl class="resaltado">
  <dt>code</dt>
  <dd>400</dd>
  <dt>body</dt>
  <dd>
   {<br>
    "type": "/error/faltasaludo.html",<br>
    "title": "Falta el saludo."<br>
   }
  </dd>
 </dl>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre class="resaltado3"><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado3">Devuelve response y se duerme.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >8. Como hay error, lanza una excepciÃ³n que atrapa catch</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span>  <span class="codeReserved">await</span> submitForm(</span>
<span>   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span class="resaltado">} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
</section>
<div class="section">
 <section>
  <h1>Response</h1>
  <dl class="resaltado2">
   <dt>code</dt>
   <dd>400</dd>
   <dt>body</dt>
   <dd>
    {<br>
    "type": "/error/faltasaludo.html",<br>
    "title": "Falta el saludo."<br>
    }
   </dd>
  </dl>
 </section>
 <section>
  <h1>Memoria</h1>
  <dl class="resaltado">
   <dt>error</dt>
   <dt>ProblemDetails</dt>
   <dd>
    <dl>
     <dt>status</dt>
     <dd>400</dd>
     <dt>type</dt>
     <dd>"/error/faltasaludo.html"</dd>
     <dt>title</dt>
     <dd>"Falta el saludo."</dd>
    </dl>
   </dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >9. Muestra los detalles de la excepciÃ³n en la consola y en un alert</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span>  <span class="codeReserved">await</span> submitForm(</span>
<span>   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span class="resaltado"> muestraError(error)</span>
<span>}</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl class="resaltado">
  <dt>error</dt>
  <dt>ProblemDetails</dt>
  <dd>
   <dl>
    <dt>status</dt>
    <dd>400</dd>
    <dt>type</dt>
    <dd>"/error/faltasaludo.html"</dd>
    <dt>title</dt>
    <dd>"Falta el saludo."</dd>
   </dl>
  </dd>
</dl>
</section>
<section>
 <h1>Alert</h1>
 <div class="resaltado" style="border: thin solid; padding: 0 0.5rem;">
  <p>Falta el saludo</p>
  <p>CÃ³digo 400 /error/faltasaludo.html</p>
  <p style="text-align: end;">
   <button type="button">Aceptar</button>
  </p>
 </div>
</section>
<section>
 <h1>Consola</h1>
 <pre class="resaltado">Falta el saludo

CÃ³digo: 400 /error/faltasaludo.html
Error: Falta el saludo
  at invocaServicio (invocaServicio.js:48:10)
  at async procesaForma ((Ã­ndice):52:6)
</pre>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >10. Al cerrar el alert, termina el evento</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span>  <span class="codeReserved">await</span> submitForm(</span>
<span>   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
</section>
<section>
 <h1>Consola</h1>
 <pre>Falta el saludo

CÃ³digo: 400 /error/faltasaludo.html
Error: Falta el saludo
  at invocaServicio (invocaServicio.js:48:10)
  at async procesaForma ((Ã­ndice):52:6)
</pre>
</section>
      </section>
      </section>
     <section>
         <h1 >D. Escenario con datos correctos</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m1captura.html">El usuario captura datos y activa la forma</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m2submit.html">Se activa el cÃ³digo del evento submit.</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m3invoca.html">Se invoca el servicio, incluyendo los datos de la forma</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m4leeDatos.html">El servicio lee los datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m5validaSaludo.html">El servicio comprueba que el saludo sea vÃ¡lido</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m6validaNombre.html">Como el saludo es vÃ¡lido, se comprueba que el nombre sea vÃ¡lido</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m7procesaDatos.html">Como el nombre es vÃ¡lido, procesa los datos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m8response.html">El servicio genera la response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m9devuelve.html">El servicio devuelve la response, que es recibida en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m10muestra.html">Muestra el texto recibido en un alert</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/mFfunFormOk/m11termina.html">Al cerrar el alert, termina el evento</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section class="pruebaDeEscritorio">
         <h1 >1. El usuario captura datos y activa la forma</h1><div class="section">
 <section>
  <h1>Forma</h1>
  <form action="javascript:;" class="resaltado"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo" value="hola">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre" value="pp">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >2. Se activa el cÃ³digo del evento submit.</h1><div class="section">
 <section >
  <h1>Forma</h1>
  <form action="javascript:;"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo" value="hola">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre" value="pp">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
 <section>
  <h1>index.html</h1>
  <pre class="resaltado"><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span>  <span class="codeReserved">await</span> submitForm(</span>
<span>   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >3. Se invoca el servicio, incluyendo los datos de la forma</h1><div class="section">
 <section >
  <h1>Forma</h1>
  <form action="javascript:;"
    style="overflow: auto; padding: 0 1rem;">
   <p>
    <label>
     Saludo:
     <input name="saludo" value="hola">
    </label>
   </p>
   <p>
    <label>
     Nombre:
     <input name="nombre" value="pp">
    </label>
   </p>
   <p>
    <button>Procesa</button>
   </p>
  </form>
 </section>
 <section >
  <h1>index.html</h1>
  <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 </section>
</div>
<section>
 <h1>Request</h1>
 <dl class="resaltado">
  <dt>URL</dt>
  <dd>srv/valida.php</dd>
  <dt>Method</dt>
  <dd>POST</dd>
  <dt>body</dt>
  <dd>
   <dl>
    <dt>saludo</dt>
    <dd>hola</dd>
    <dt>nombre</dt>
    <dd>pp</dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre class="resaltado"><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado2">Despierta y recibe request.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >4. El servicio lee los datos</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span class="resaltado">$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span class="resaltado">$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<div class="section">
 <section >
  <h1>Request</h1>
  <dl>
   <dt>URL</dt>
   <dd>srv/valida.php</dd>
   <dt>Method</dt>
   <dd>POST</dd>
   <dt>body</dt>
   <dd>
    <dl>
     <dt class="resaltado">saludo</dt>
     <dd class="resaltado">hola</dd>
     <dt class="resaltado">nombre</dt>
     <dd class="resaltado">pp</dd>
    </dl>
   </dd>
  </dl>
 </section>
 <section >
  <h1>Memoria (Servidor)</h1>
  <dl class="resaltado">
   <dt>$saludo</dt>
   <dd>"hola"</dd>
   <dt>$nombre</dt>
   <dd>"pp"</dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >5. El servicio comprueba que el saludo sea vÃ¡lido</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span class="resaltado"><span class="codeReserved">if</span> (</span>
<span class="resaltado"> $saludo === <span class="codeReserved">null</span></span>
<span class="resaltado"> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span class="resaltado">) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Memoria (Servidor)</h1>
 <dl>
  <dt class="resaltado">$saludo</dt>
  <dd class="resaltado">"hola"</dd>
  <dt>$nombre</dt>
  <dd>"pp"</dd>
 </dl>
</section>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >6. Como el saludo es vÃ¡lido, se comprueba que el nombre sea vÃ¡lido</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span class="resaltado"><span class="codeReserved">if</span> (</span>
<span class="resaltado"> $nombre === <span class="codeReserved">null</span></span>
<span class="resaltado"> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span class="resaltado">) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Memoria (Servidor)</h1>
 <dl>
  <dt>$saludo</dt>
  <dd>"hola"</dd>
  <dt class="resaltado">$nombre</dt>
  <dd class="resaltado">"pp"</dd>
 </dl>
</section>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >7. Como el nombre es vÃ¡lido, procesa los datos</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span class="resaltado">$resultado =</span>
<span class="resaltado"> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
</section>
<section>
 <h1>Memoria (Servidor)</h1>
 <dl class="resaltado">
  <dt>$saludo</dt>
  <dd>"hola"</dd>
  <dt">$nombre</dt>
  <dd>"pp"</dd>
  <dt>$resultado</dt>
  <dd>"hola pp"</dd>
 </dl>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >8. El servicio genera la response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado3">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv/valida.php</h1>
 <pre><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span class="resaltado">devuelveJson($resultado);</span></code></pre>
</section>
<div class="section">
 <section >
  <h1>Memoria (Servidor)</h1>
  <dl>
   <dt>$saludo</dt>
   <dd>"hola"</dd>
   <dt>$nombre</dt>
   <dd>"pp"</dd>
   <dt class="resaltado">$resultado</dt>
   <dd class="resaltado">"hola pp"</dd>
  </dl>
 </section>
 <section >
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>"hola pp"</dd>
  </dl>
 </section>
</div>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >9. El servicio devuelve la response, que es recibida en el cliente</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span class="resaltado"> <span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado">  <span class="codeReserved">await</span> submitForm(</span>
<span class="resaltado">   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
 <p class="resaltado2">Despierta y recibe response.</p>
</section>
<div class="section">
 <section>
  <h1>Response</h1>
  <dl class="resaltado">
   <dt>code</dt>
   <dd>200</dd>
   <dt>body</dt>
   <dd>"hola pp"</dd>
  </dl>
 </section>
 <section>
  <h1>Memoria</h1>
  <dl>
   <dt class="resaltado">respuesta</dt>
   <dd class="resaltado">
    <dl>
     <dt>status</dt>
     <dd>200</dd>
     <dt>body</dt>
     <dd>"Hola pp."</dd>
    </dl>
   </dd>
  </dl>
 </section>
</div>
<section>
 <h1>srv/valida.php</h1>
 <pre class="resaltado3"><code class="language-php"><span>$saludo = leeTexto(<span class="codeString">&quot;saludo&quot;</span>);</span>
<span>$nombre = leeTexto(<span class="codeString">&quot;nombre&quot;</span>);</span>
<span><span class="codeReserved">if</span> (</span>
<span> $saludo === <span class="codeReserved">null</span></span>
<span> || $saludo === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltasaludo.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el saludo.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span><span class="codeReserved">if</span> (</span>
<span> $nombre === <span class="codeReserved">null</span></span>
<span> || $nombre === <span class="codeString">&quot;&quot;</span></span>
<span>) {</span>
<span> <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</span>
<span>  status: ProblemDetails::BadRequest,</span>
<span>  type: <span class="codeString">&quot;&#47;error&#47;faltanombre.html&quot;</span>,</span>
<span>  title: <span class="codeString">&quot;Falta el nombre.&quot;</span>,</span>
<span> );</span>
<span>}</span>
<span>$resultado =</span>
<span> <span class="codeString">&quot;{$saludo} {$nombre}.&quot;</span>;</span>
<span>devuelveJson($resultado);</span></code></pre>
 <p class="resaltado3">Devuelve response y se duerme.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >10. Muestra el texto recibido en un alert</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span>  <span class="codeReserved">await</span> submitForm(</span>
<span>   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span class="resaltado"> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt class="resaltado">respuesta</dt>
  <dd>
   <dl>
    <dt>status</dt>
    <dd>200</dd>
    <dt class="resaltado">body</dt>
    <dd class="resaltado">"Hola pp."</dd>
   </dl>
  </dd>
</dl>
</section>
<section>
 <h1>Alert</h1>
 <div class="resaltado" style="border: thin solid; padding: 0 0.5rem;">
  <p>hola pp</p>
  <p style="text-align: end;">
   <button type="button">Aceptar</button>
  </p>
 </div>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >11. Al cerrar el alert, termina el evento</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">try</span> {</span>
<span> <span class="codeReserved">const</span> respuesta =</span>
<span>  <span class="codeReserved">await</span> submitForm(</span>
<span>   <span class="codeString">&quot;srv&#47;valida.php&quot;</span>, event)</span>
<span> alert(respuesta.body)</span>
<span>} <span class="codeReserved">catch</span> (error) {</span>
<span> muestraError(error)</span>
<span>}</span></code></pre>
</section>

      </section>
      </section>
     <section >
         <h1 >E. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvvalida.rf.gd/" rel="noreferrer"
      target="_blank">http://srvvalida.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvvalida.zip" download>/src/srvvalida.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >F. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltanombre-html.html">faltanombre.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltasaludo-html.html">faltasaludo.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-valida-php.html">valida.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >G. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Servicio que valida datos&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Servicio que valida datos&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"procesaForma(event) "</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>20</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>21</td><td>    Saludo:</td></tr>
  <tr><td>22</td><td>    <span class="codeComment">&lt;!-- Como este input tiene name=&quot;saludo&quot;, su valor se recupera en el</span></td></tr>
  <tr><td>23</td><td><span class="codeComment">     servidor con leeTexto(&quot;saludo&quot;) --&gt;</span></td></tr>
  <tr><td>24</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"saludo"</span>&gt;</td></tr>
  <tr><td>25</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>29</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>30</td><td>    Nombre:</td></tr>
  <tr><td>31</td><td>    <span class="codeComment">&lt;!-- Como este input tiene name=&quot;nombre&quot;, su valor se recupera en el</span></td></tr>
  <tr><td>32</td><td><span class="codeComment">     servidor con leeTexto(&quot;nombre&quot;) --&gt;</span></td></tr>
  <tr><td>33</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span>&gt;</td></tr>
  <tr><td>34</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>35</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Procesa&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/muestraError.js"</span></td></tr>
  <tr><td>44</td><td>  <span class="codeReserved">import</span> { submitForm } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/submitForm.js"</span></td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>47</td><td><span class="codeComment">   * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>48</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>49</td><td>  <span class="codeReserved">async</span> <span class="codeReserved">function</span> procesaForma(event) {</td></tr>
  <tr><td>50</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>51</td><td>    <span class="codeReserved">const</span> respuesta =</td></tr>
  <tr><td>52</td><td>     <span class="codeReserved">await</span> submitForm(</td></tr>
  <tr><td>53</td><td>      <span class="codeString">"srv/valida.php"</span>, event)</td></tr>
  <tr><td>54</td><td>    alert(respuesta.body)</td></tr>
  <tr><td>55</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>56</td><td>    muestraError(error)</td></tr>
  <tr><td>57</td><td>   }</td></tr>
  <tr><td>58</td><td>  }</td></tr>
  <tr><td>59</td><td>  <span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>60</td><td>  window[<span class="codeString">"procesaForma"</span>] = procesaForma</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >H. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12valida/m-srv/m-valida-php.html">srv / valida.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / valida.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $saludo = recuperaTexto(<span class="codeString">"saludo"</span>);</td></tr>
  <tr><td>13</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">if</span> (</td></tr>
  <tr><td>16</td><td>  $saludo === <span class="codeReserved">false</span></td></tr>
  <tr><td>17</td><td>  || $saludo === <span class="codeString">""</span></td></tr>
  <tr><td>18</td><td> )</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>20</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>21</td><td>   title: <span class="codeString">"Falta el saludo."</span>,</td></tr>
  <tr><td>22</td><td>   type: <span class="codeString">"/error/faltasaludo.html"</span></td></tr>
  <tr><td>23</td><td>  );</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (</td></tr>
  <tr><td>26</td><td>  $nombre === <span class="codeReserved">false</span></td></tr>
  <tr><td>27</td><td>  || $nombre === <span class="codeString">""</span></td></tr>
  <tr><td>28</td><td> )</td></tr>
  <tr><td>29</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>30</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>31</td><td>   title: <span class="codeString">"Falta el nombre."</span>,</td></tr>
  <tr><td>32</td><td>   type: <span class="codeString">"/error/faltanombre.html"</span></td></tr>
  <tr><td>33</td><td>  );</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td> $resultado =</td></tr>
  <tr><td>36</td><td>  <span class="codeString">"{$saludo} {$nombre}."</span>;</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td> devuelveJson($resultado);</td></tr>
  <tr><td>39</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>42</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>45</td><td>}</td></tr>
  <tr><td>46</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >I. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12valida/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-error/m-faltanombre-html.html">error / faltanombre.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-error/m-faltasaludo-html.html">error / faltasaludo.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / faltanombre.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el nombre&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el nombre&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / faltasaludo.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el saludo&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el saludo&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >J. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12valida/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m12valida/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12valida/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section >
         <h1 >K. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >L. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ un servicio que procesa una forma y valida los
    datos de entrada..
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >14. Mostrar datos en el cliente</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11muestra/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/mBdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/mCinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se presenta un ejemplo que muestra los datos devueltos por
    un servicio.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvmuestra.rf.gd/" rel="noreferrer"
      target="_blank">http://srvmuestra.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama de despliegue</h1><figure>
 <img src="/img/m11muestra/srvmuestradistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >C. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvmuestra.rf.gd/" rel="noreferrer"
      target="_blank">http://srvmuestra.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvmuestra.zip" download>/src/srvmuestra.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >D. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraObjeto-js.html">muestraObjeto.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-datos-php.html">datos.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >E. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">title</span>&gt;Muestra datos&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>8</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"descargaDatos()"</span>&gt;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">h1</span>&gt;Muestra datos&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> <span class="codeComment">&lt;!-- Al mostrar un dato, se usan los atributos &quot;id&quot;, &quot;name&quot; o &quot;data-name&quot;</span></td></tr>
  <tr><td>15</td><td><span class="codeComment">  para buscar la propiedad a desplegar en la pÃ¡gina. --&gt;</span></td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>19</td><td>   Nombre</td></tr>
  <tr><td>20</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad nombre del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>21</td><td><span class="codeComment">    value del output. --&gt;</span></td></tr>
  <tr><td>22</td><td>   &lt;<span class="codeReserved">output</span> name=<span class="codeString">"nombre"</span>&gt;&lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>23</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>24</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>27</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>28</td><td>   Apellido</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad apellido del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>30</td><td><span class="codeComment">    value del input. --&gt;</span></td></tr>
  <tr><td>31</td><td>   &lt;<span class="codeReserved">input</span> name=<span class="codeString">"apellido"</span> type=<span class="codeString">"text"</span>&gt;</td></tr>
  <tr><td>32</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>33</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>37</td><td>   GÃ©nero</td></tr>
  <tr><td>38</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad genero del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>39</td><td><span class="codeComment">    value del select. --&gt;</span></td></tr>
  <tr><td>40</td><td>   &lt;<span class="codeReserved">select</span> name=<span class="codeString">"genero"</span>&gt;</td></tr>
  <tr><td>41</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">""</span>&gt;Sin selecciÃ³n&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>42</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"pop"</span>&gt;Pop&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>43</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"reg"</span>&gt;ReguetÃ³n&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;/<span class="codeReserved">select</span>&gt;</td></tr>
  <tr><td>45</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>46</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>49</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>50</td><td>   GÃ©neraciÃ³n</td></tr>
  <tr><td>51</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad generacion del objeto descargado, usando la</span></td></tr>
  <tr><td>52</td><td><span class="codeComment">    propiedad value del select. --&gt;</span></td></tr>
  <tr><td>53</td><td>   &lt;<span class="codeReserved">select</span> name=<span class="codeString">"generacion"</span>&gt;</td></tr>
  <tr><td>54</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"boom"</span>&gt;Baby Boom&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>55</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"X"</span>&gt;X&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>56</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">""</span>&gt;Sin selecciÃ³n&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>57</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"Y"</span>&gt;Millenoals&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>58</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"Z"</span>&gt;Z&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>59</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"alfa"</span>&gt;Alfa&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>60</td><td>   &lt;/<span class="codeReserved">select</span>&gt;</td></tr>
  <tr><td>61</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>62</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>65</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>66</td><td>   Edad</td></tr>
  <tr><td>67</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad edad del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>68</td><td><span class="codeComment">    valueAsNumber del input. --&gt;</span></td></tr>
  <tr><td>69</td><td>   &lt;<span class="codeReserved">input</span> data-name=<span class="codeString">"edad"</span> type=<span class="codeString">"number"</span>&gt;</td></tr>
  <tr><td>70</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>71</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>74</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>75</td><td>   NÃºmero de la suerte</td></tr>
  <tr><td>76</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad numero del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>77</td><td><span class="codeComment">    value del output. --&gt;</span></td></tr>
  <tr><td>78</td><td>   &lt;<span class="codeReserved">output</span> id=<span class="codeString">"numero"</span>&gt;&lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>79</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>80</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>83</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>84</td><td>   Avance</td></tr>
  <tr><td>85</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad avance del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>86</td><td><span class="codeComment">    value del progress. --&gt;</span></td></tr>
  <tr><td>87</td><td>   &lt;<span class="codeReserved">progress</span> id=<span class="codeString">"avance"</span> max=<span class="codeString">"100"</span>&gt;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>88</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>89</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>92</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>93</td><td>   Capacidad</td></tr>
  <tr><td>94</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad capacidad del objeto descargado, usando la</span></td></tr>
  <tr><td>95</td><td><span class="codeComment">    propiedad value del meter. --&gt;</span></td></tr>
  <tr><td>96</td><td>   &lt;<span class="codeReserved">meter</span> id=<span class="codeString">"capacidad"</span> min=<span class="codeString">"50"</span> max=<span class="codeString">"80"</span>&gt;&lt;/<span class="codeReserved">meter</span>&gt;</td></tr>
  <tr><td>97</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>98</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>99</td><td></td></tr>
  <tr><td>100</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>101</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>102</td><td>   Temperatura</td></tr>
  <tr><td>103</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad temperatura del objeto descargado, usando la</span></td></tr>
  <tr><td>104</td><td><span class="codeComment">    propiedad valueAsNumber del meter. --&gt;</span></td></tr>
  <tr><td>105</td><td>   &lt;<span class="codeReserved">input</span> id=<span class="codeString">"temperatura"</span> type=<span class="codeString">"range"</span> min=<span class="codeString">"0"</span> max=<span class="codeString">"50"</span>&gt;</td></tr>
  <tr><td>106</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>107</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>108</td><td></td></tr>
  <tr><td>109</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>110</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>111</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad aprobado del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>112</td><td><span class="codeComment">    checked del input, porque el tipo del dato es boolean y el input tiene</span></td></tr>
  <tr><td>113</td><td><span class="codeComment">    type=&quot;checkbox&quot;. --&gt;</span></td></tr>
  <tr><td>114</td><td>   &lt;<span class="codeReserved">input</span> id=<span class="codeString">"aprobado"</span> type=<span class="codeString">"checkbox"</span>&gt;</td></tr>
  <tr><td>115</td><td>   Aprobado</td></tr>
  <tr><td>116</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>117</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>118</td><td></td></tr>
  <tr><td>119</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>120</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>121</td><td>   Gracioso</td></tr>
  <tr><td>122</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad gracioso del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>123</td><td><span class="codeComment">    value del output. --&gt;</span></td></tr>
  <tr><td>124</td><td>   &lt;<span class="codeReserved">output</span> id=<span class="codeString">"gracioso"</span>&gt;&lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>125</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>126</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>127</td><td></td></tr>
  <tr><td>128</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>129</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>130</td><td>   Emplacado</td></tr>
  <tr><td>131</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad emplacado del objeto descargado, usando la</span></td></tr>
  <tr><td>132</td><td><span class="codeComment">    propiedad value del select. --&gt;</span></td></tr>
  <tr><td>133</td><td>   &lt;<span class="codeReserved">select</span> name=<span class="codeString">"emplacado"</span>&gt;</td></tr>
  <tr><td>134</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">""</span>&gt;Sin selecciÃ³n&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>135</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"<span class="codeReserved">true</span>"</span>&gt;Si&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>136</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"<span class="codeReserved">false</span>"</span>&gt;No&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>137</td><td>   &lt;/<span class="codeReserved">select</span>&gt;</td></tr>
  <tr><td>138</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>139</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>140</td><td></td></tr>
  <tr><td>141</td><td> &lt;<span class="codeReserved">label</span>&gt;DirecciÃ³n&lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>142</td><td> <span class="codeComment">&lt;!-- Muestra la propiedad direccion del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>143</td><td><span class="codeComment">  textContent del pre. --&gt;</span></td></tr>
  <tr><td>144</td><td> &lt;<span class="codeReserved">pre</span> id=<span class="codeString">"direccion"</span>&gt;&lt;/<span class="codeReserved">pre</span>&gt;</td></tr>
  <tr><td>145</td><td></td></tr>
  <tr><td>146</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>147</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>148</td><td>   Encabezado</td></tr>
  <tr><td>149</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad encabezado del objeto descargado, usando la</span></td></tr>
  <tr><td>150</td><td><span class="codeComment">    propiedad innerHTML del span. --&gt;</span></td></tr>
  <tr><td>151</td><td>   &lt;<span class="codeReserved">span</span> id=<span class="codeString">"encabezado"</span>&gt;&lt;/<span class="codeReserved">span</span>&gt;</td></tr>
  <tr><td>152</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>153</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>154</td><td></td></tr>
  <tr><td>155</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>156</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>157</td><td>   Nacimiento</td></tr>
  <tr><td>158</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad nacimiento del objeto descargado, usando la</span></td></tr>
  <tr><td>159</td><td><span class="codeComment">    propiedad value del input. Revisa la especificaciÃ³n de input para</span></td></tr>
  <tr><td>160</td><td><span class="codeComment">    los distintos formatos de fecha que se pueden usar. --&gt;</span></td></tr>
  <tr><td>161</td><td>   &lt;<span class="codeReserved">input</span> id=<span class="codeString">"nacimiento"</span> type=<span class="codeString">"date"</span>&gt;</td></tr>
  <tr><td>162</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>163</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>164</td><td></td></tr>
  <tr><td>165</td><td> &lt;<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>166</td><td>  <span class="codeComment">&lt;!-- Muestra la propiedad imagen1 del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>167</td><td><span class="codeComment">   <span class="codeReserved">src</span> del img. --&gt;</span></td></tr>
  <tr><td>168</td><td>  &lt;<span class="codeReserved">img</span> id=<span class="codeString">"imagen1"</span> alt=<span class="codeString">"Imagen 2"</span>&gt;</td></tr>
  <tr><td>169</td><td>  &lt;<span class="codeReserved">figcaption</span>&gt;Imagen 1&lt;/<span class="codeReserved">figcaption</span>&gt;</td></tr>
  <tr><td>170</td><td> &lt;/<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>171</td><td></td></tr>
  <tr><td>172</td><td> &lt;<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>173</td><td>  <span class="codeComment">&lt;!-- Muestra la propiedad imagen2 del objeto descargado, usando la propiedad</span></td></tr>
  <tr><td>174</td><td><span class="codeComment">   <span class="codeReserved">src</span> del img. Como el valor es &quot;&quot;, se oculta el img usando hidden = <span class="codeReserved">true</span>. --&gt;</span></td></tr>
  <tr><td>175</td><td>  &lt;<span class="codeReserved">img</span> id=<span class="codeString">"imagen2"</span> alt=<span class="codeString">"Imagen 2"</span>&gt;</td></tr>
  <tr><td>176</td><td>  &lt;<span class="codeReserved">figcaption</span>&gt;Imagen 2&lt;/<span class="codeReserved">figcaption</span>&gt;</td></tr>
  <tr><td>177</td><td> &lt;/<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>178</td><td></td></tr>
  <tr><td>179</td><td> <span class="codeComment">&lt;!-- Muestra la propiedad pasatiempos[] del objeto descargado; como es un</span></td></tr>
  <tr><td>180</td><td><span class="codeComment">   array, usa los elementos con name=&quot;pasatiempos[]&quot; y les pone la propiedad</span></td></tr>
  <tr><td>181</td><td><span class="codeComment">   checked en <span class="codeReserved">true</span> si su value estÃ¡ en el array; de lo contrario se las pone en</span></td></tr>
  <tr><td>182</td><td><span class="codeComment">   <span class="codeReserved">false</span>. Los corchetes([]), le indican a PHP que la propiedad es un array</span></td></tr>
  <tr><td>183</td><td><span class="codeComment">   que puede llegar a tener 0, 1 o mÃ¡s elementos. --&gt;</span></td></tr>
  <tr><td>184</td><td> &lt;<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>185</td><td>  &lt;<span class="codeReserved">legend</span>&gt;Pasatiempos&lt;/<span class="codeReserved">legend</span>&gt;</td></tr>
  <tr><td>186</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>187</td><td>   &lt;<span class="codeReserved">input</span> type=<span class="codeString">"checkbox"</span> name=<span class="codeString">"pasatiempos[]"</span> value=<span class="codeString">"fut"</span>&gt;Futbol</td></tr>
  <tr><td>188</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>189</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>190</td><td>   &lt;<span class="codeReserved">input</span> type=<span class="codeString">"checkbox"</span> name=<span class="codeString">"pasatiempos[]"</span> value=<span class="codeString">"chess"</span>&gt;Ajedrez</td></tr>
  <tr><td>191</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>192</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>193</td><td>   &lt;<span class="codeReserved">input</span> type=<span class="codeString">"checkbox"</span> data-name=<span class="codeString">"pasatiempos[]"</span> value=<span class="codeString">"basket"</span>&gt;Basketbol</td></tr>
  <tr><td>194</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>195</td><td> &lt;/<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>196</td><td></td></tr>
  <tr><td>197</td><td> <span class="codeComment">&lt;!-- Muestra la propiedad madrugador del objeto descargado; como es un</span></td></tr>
  <tr><td>198</td><td><span class="codeComment">   array, usa los elementos con name=&quot;madrugador&quot; y les pone la propiedad</span></td></tr>
  <tr><td>199</td><td><span class="codeComment">   checked en <span class="codeReserved">true</span> si su value estÃ¡ en el array; de lo contrario se las pone en</span></td></tr>
  <tr><td>200</td><td><span class="codeComment">   <span class="codeReserved">false</span>. Como el name no tiene [], el array solo tiene 0 o un elemento. --&gt;</span></td></tr>
  <tr><td>201</td><td> &lt;<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>202</td><td>  &lt;<span class="codeReserved">legend</span>&gt;Madrugador&lt;/<span class="codeReserved">legend</span>&gt;</td></tr>
  <tr><td>203</td><td>  &lt;<span class="codeReserved">label</span>&gt;&lt;<span class="codeReserved">input</span> type=<span class="codeString">"radio"</span> name=<span class="codeString">"madrugador"</span> value=<span class="codeString">"si"</span>&gt;Si&lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>204</td><td>  &lt;<span class="codeReserved">label</span>&gt;&lt;<span class="codeReserved">input</span> type=<span class="codeString">"radio"</span> name=<span class="codeString">"madrugador"</span> value=<span class="codeString">"no"</span>&gt;No&lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>205</td><td> &lt;/<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>206</td><td></td></tr>
  <tr><td>207</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>208</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>209</td><td>   Patos</td></tr>
  <tr><td>210</td><td>   <span class="codeComment">&lt;!-- Muestra la propiedad patos del objeto descargado; como es un</span></td></tr>
  <tr><td>211</td><td><span class="codeComment">     array, usa los las opciones del select con name=&quot;patos[]&quot; y les pone la</span></td></tr>
  <tr><td>212</td><td><span class="codeComment">     propiedad selected en <span class="codeReserved">true</span> si su value estÃ¡ en el array; de lo contrario se</span></td></tr>
  <tr><td>213</td><td><span class="codeComment">     las pone en <span class="codeReserved">false</span>.  Los corchetes([]), le indican a PHP que la propiedad es</span></td></tr>
  <tr><td>214</td><td><span class="codeComment">     un array que puede llegar a tener 0, 1 o mÃ¡s elementos. --&gt;</span></td></tr>
  <tr><td>215</td><td>   &lt;<span class="codeReserved">select</span> name=<span class="codeString">"patos[]"</span> multiple size=<span class="codeString">"3"</span>&gt;</td></tr>
  <tr><td>216</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"hugo"</span>&gt;Hugo&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>217</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"paco"</span>&gt;Paco&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>218</td><td>    &lt;<span class="codeReserved">option</span> value=<span class="codeString">"luis"</span>&gt;Luis&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>219</td><td>   &lt;/<span class="codeReserved">select</span>&gt;</td></tr>
  <tr><td>220</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>221</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>222</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>223</td><td></td></tr>
  <tr><td>224</td><td>&lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span>&gt;</td></tr>
  <tr><td>225</td><td></td></tr>
  <tr><td>226</td><td> <span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/consumeJson.js"</span></td></tr>
  <tr><td>227</td><td> <span class="codeReserved">import</span> { muestraObjeto } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/muestraObjeto.js"</span></td></tr>
  <tr><td>228</td><td> <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/muestraError.js"</span></td></tr>
  <tr><td>229</td><td></td></tr>
  <tr><td>230</td><td> <span class="codeReserved">async</span> <span class="codeReserved">function</span> descargaDatos() {</td></tr>
  <tr><td>231</td><td>  <span class="codeReserved">try</span> {</td></tr>
  <tr><td>232</td><td>   <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> consumeJson(<span class="codeString">"srv/datos.php"</span>)</td></tr>
  <tr><td>233</td><td>   muestraObjeto(document, respuesta.body)</td></tr>
  <tr><td>234</td><td>  } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>235</td><td>   muestraError(error)</td></tr>
  <tr><td>236</td><td>  }</td></tr>
  <tr><td>237</td><td> }</td></tr>
  <tr><td>238</td><td> <span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>239</td><td> window[<span class="codeString">"descargaDatos"</span>] = descargaDatos</td></tr>
  <tr><td>240</td><td></td></tr>
  <tr><td>241</td><td>&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>242</td><td></td></tr>
  <tr><td>243</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >F. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11muestra/m-srv/m-datos-php.html">srv / datos.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / datos.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td>devuelveJson([</td></tr>
  <tr><td>6</td><td> <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"pp"</span>],</td></tr>
  <tr><td>7</td><td> <span class="codeString">"apellido"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"tkt"</span>],</td></tr>
  <tr><td>8</td><td> <span class="codeString">"genero"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"pop"</span>],</td></tr>
  <tr><td>9</td><td> <span class="codeString">"generacion"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">""</span>],</td></tr>
  <tr><td>10</td><td> <span class="codeString">"edad"</span> =&gt; [<span class="codeString">"valueAsNumber"</span> =&gt; 18],</td></tr>
  <tr><td>11</td><td> <span class="codeString">"numero"</span> =&gt; [<span class="codeString">"value"</span> =&gt; 5],</td></tr>
  <tr><td>12</td><td> <span class="codeString">"avance"</span> =&gt; [<span class="codeString">"value"</span> =&gt; 70],</td></tr>
  <tr><td>13</td><td> <span class="codeString">"capacidad"</span> =&gt; [<span class="codeString">"value"</span> =&gt; 60],</td></tr>
  <tr><td>14</td><td> <span class="codeString">"temperatura"</span> =&gt; [<span class="codeString">"valueAsNumber"</span> =&gt; 40],</td></tr>
  <tr><td>15</td><td> <span class="codeString">"aprobado"</span> =&gt; [<span class="codeString">"checked"</span> =&gt; <span class="codeReserved">true</span>],</td></tr>
  <tr><td>16</td><td> <span class="codeString">"gracioso"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeReserved">false</span>],</td></tr>
  <tr><td>17</td><td> <span class="codeString">"emplacado"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeReserved">false</span>],</td></tr>
  <tr><td>18</td><td> <span class="codeString">"direccion"</span> =&gt; [<span class="codeString">"textContent"</span> =&gt; <span class="codeString">"Girasoles 23\ncolonia Rosales"</span>],</td></tr>
  <tr><td>19</td><td> <span class="codeString">"encabezado"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; <span class="codeString">"&lt;<span class="codeReserved">em</span>&gt;Hola, soy &lt;<span class="codeReserved">strong</span>&gt;pp&lt;/<span class="codeReserved">strong</span>&gt;"</span>],</td></tr>
  <tr><td>20</td><td> <span class="codeString">"nacimiento"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"2000-07-04"</span>],</td></tr>
  <tr><td>21</td><td> <span class="codeString">"imagen1"</span> =&gt; [</td></tr>
  <tr><td>22</td><td>  <span class="codeString">"<span class="codeReserved">src</span>"</span> =&gt; <span class="codeString">"https://gilpgawoas.github.io/img/icono/maskable_icon_x48.png"</span></td></tr>
  <tr><td>23</td><td> ],</td></tr>
  <tr><td>24</td><td> <span class="codeString">"imagen2"</span> =&gt; [<span class="codeString">"<span class="codeReserved">src</span>"</span> =&gt; <span class="codeString">""</span>, <span class="codeString">"hidden"</span> =&gt; <span class="codeReserved">true</span>],</td></tr>
  <tr><td>25</td><td> <span class="codeString">"pasatiempos[]"</span> =&gt; [<span class="codeString">"fut"</span>, <span class="codeString">"basket"</span>],</td></tr>
  <tr><td>26</td><td> <span class="codeString">"madrugador"</span> =&gt; [<span class="codeString">"no"</span>],</td></tr>
  <tr><td>27</td><td> <span class="codeString">"patos[]"</span> =&gt; [<span class="codeString">"paco"</span>, <span class="codeString">"luis"</span>],</td></tr>
  <tr><td>28</td><td>]);</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >G. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-js/m-muestraObjeto-js.html">lib / js / muestraObjeto.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraObjeto.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraObjeto(raizHtml, objeto) {</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [nombre, definiciones] of Object.entries(objeto)) {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">if</span> (Array.isArray(definiciones)) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   muestraArray(raizHtml, nombre, definiciones)</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (definiciones !== undefined && definiciones !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">const</span> elementoHtml = buscaElementoHtml(raizHtml, nombre)</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (elementoHtml <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>    muestraInput(raizHtml, elementoHtml, definiciones)</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>   } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (elementoHtml !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> elementoHtml) {</td></tr>
  <tr><td>25</td><td>      elementoHtml[atributo] = valor</td></tr>
  <tr><td>26</td><td>     }</td></tr>
  <tr><td>27</td><td>    }</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>   }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>window[<span class="codeString">"muestraObjeto"</span>] = muestraObjeto</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } nombre</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>43</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> buscaElementoHtml(raizHtml, nombre) {</td></tr>
  <tr><td>44</td><td> <span class="codeReserved">return</span> raizHtml.querySelector(</td></tr>
  <tr><td>45</td><td>  <span class="codeString">`#${nombre},[name=&quot;${nombre}&quot;],[data-name=&quot;${nombre}&quot;]`</span>)</td></tr>
  <tr><td>46</td><td>}</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } propiedad</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {any[]} valores</span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>53</td><td><span class="codeReserved">function</span> muestraArray(raizHtml, propiedad, valores) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> <span class="codeReserved">const</span> conjunto = <span class="codeReserved">new</span> Set(valores)</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> elementos =</td></tr>
  <tr><td>57</td><td>  raizHtml.querySelectorAll(<span class="codeString">`[name=&quot;${propiedad}&quot;],[data-name=&quot;${propiedad}&quot;]`</span>)</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> <span class="codeReserved">if</span> (elementos.length === 1) {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">const</span> elemento = elementos[0]</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLSelectElement) {</td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">const</span> options = elemento.options</td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = options.length; i &lt; len; i++) {</td></tr>
  <tr><td>65</td><td>    <span class="codeReserved">const</span> option = options[i]</td></tr>
  <tr><td>66</td><td>    option.selected = conjunto.has(option.value)</td></tr>
  <tr><td>67</td><td>   }</td></tr>
  <tr><td>68</td><td>   <span class="codeReserved">return</span></td></tr>
  <tr><td>69</td><td>  }</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td> }</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = elementos.length; i &lt; len; i++) {</td></tr>
  <tr><td>74</td><td>  <span class="codeReserved">const</span> elemento = elementos[i]</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>76</td><td>   elemento.checked = conjunto.has(elemento.value)</td></tr>
  <tr><td>77</td><td>  }</td></tr>
  <tr><td>78</td><td> }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>}</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>83</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>84</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>85</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } definiciones</span></td></tr>
  <tr><td>86</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>87</td><td><span class="codeReserved">function</span> muestraInput(raizHtml, input, definiciones) {</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>  <span class="codeReserved">if</span> (atributo == <span class="codeString">"data-file"</span>) {</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>95</td><td>    input.dataset.file = valor</td></tr>
  <tr><td>96</td><td>    input.value = <span class="codeString">""</span></td></tr>
  <tr><td>97</td><td>    <span class="codeReserved">if</span> (valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>98</td><td>     img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>99</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>100</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>101</td><td>     img.<span class="codeReserved">src</span> = valor</td></tr>
  <tr><td>102</td><td>     img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>103</td><td>    }</td></tr>
  <tr><td>104</td><td>   }</td></tr>
  <tr><td>105</td><td></td></tr>
  <tr><td>106</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> input) {</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>   input[atributo] = valor</td></tr>
  <tr><td>109</td><td></td></tr>
  <tr><td>110</td><td>  }</td></tr>
  <tr><td>111</td><td> }</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td>}</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>116</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>117</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLElement } elementoHtml</span></td></tr>
  <tr><td>118</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>119</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getImgParaElementoHtml(raizHtml, elementoHtml) {</td></tr>
  <tr><td>120</td><td> <span class="codeReserved">const</span> imgId = elementoHtml.getAttribute(<span class="codeString">"data-img"</span>)</td></tr>
  <tr><td>121</td><td> <span class="codeReserved">if</span> (imgId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>122</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>123</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>124</td><td>  <span class="codeReserved">const</span> input = buscaElementoHtml(raizHtml, imgId)</td></tr>
  <tr><td>125</td><td>  <span class="codeReserved">if</span> (input <span class="codeReserved">instanceof</span> HTMLImageElement) {</td></tr>
  <tr><td>126</td><td>   <span class="codeReserved">return</span> input</td></tr>
  <tr><td>127</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>128</td><td>   <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>129</td><td>  }</td></tr>
  <tr><td>130</td><td> }</td></tr>
  <tr><td>131</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >H. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11muestra/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11muestra/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >I. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se indica como mostrar en el cliente los datos devueltos por
    un servicio.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >15. Renderizado del lado del cliente</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11renderCliente/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/mBdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/mCinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Para algunas partes de una pÃ¡gina no hay componentes grÃ¡ficos que puedan
    mostrar valores, como en el caso de los listados. En ese caso se tiene que
    generar el cÃ³digo HTM desde el programa, proceso que se conoce como
    <dfn>renderizado</dfn>.
   </p>
  </li>
  <li>
   <p>
    En esta lecciÃ³n se presenta un ejemplo de renderizado en el cliente.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://rendercli.rf.gd/" rel="noreferrer"
      target="_blank">http://rendercli.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m11renderCliente/renclientedistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >C. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://rendercli.rf.gd/" rel="noreferrer"
      target="_blank">http://rendercli.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/rendercli.zip" download>/src/rendercli.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >D. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-htmlentities-js.html">htmlentities.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-lista-php.html">lista.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >E. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Render en el cliente&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"descargaDatos()"</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Render en el cliente&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">dl</span> id=<span class="codeString">"lista"</span>&gt;</td></tr>
  <tr><td>18</td><td>  &lt;<span class="codeReserved">dt</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">dt</span>&gt;</td></tr>
  <tr><td>19</td><td>  &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">dl</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/consumeJson.js"</span></td></tr>
  <tr><td>25</td><td>  <span class="codeReserved">import</span> { htmlentities } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/htmlentities.js"</span></td></tr>
  <tr><td>26</td><td>  <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/muestraError.js"</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">async</span> <span class="codeReserved">function</span> descargaDatos() {</td></tr>
  <tr><td>29</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>30</td><td>    <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> consumeJson(<span class="codeString">"srv/lista.php"</span>)</td></tr>
  <tr><td>31</td><td>    <span class="codeComment">// Genera el cÃ³digo HTML de la lista.</span></td></tr>
  <tr><td>32</td><td>    <span class="codeReserved">let</span> render = <span class="codeString">""</span></td></tr>
  <tr><td>33</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> modelo of respuesta.body) {</td></tr>
  <tr><td>34</td><td>     <span class="codeComment">/* Codifica nombre y <span class="codeReserved">color</span> para que cambie los caracteres especiales y</span></td></tr>
  <tr><td>35</td><td><span class="codeComment">      * el texto no se pueda interpretar como HTML. Esta tÃ©cnica evita la</span></td></tr>
  <tr><td>36</td><td><span class="codeComment">      * inyecciÃ³n de cÃ³digo. */</span></td></tr>
  <tr><td>37</td><td>     <span class="codeReserved">const</span> nombre =</td></tr>
  <tr><td>38</td><td>      <span class="codeReserved">typeof</span> modelo.nombre === <span class="codeString">"string"</span> ? htmlentities(modelo.nombre) : <span class="codeString">""</span></td></tr>
  <tr><td>39</td><td>     <span class="codeReserved">const</span> <span class="codeReserved">color</span> =</td></tr>
  <tr><td>40</td><td>      <span class="codeReserved">typeof</span> modelo.<span class="codeReserved">color</span> === <span class="codeString">"string"</span> ? htmlentities(modelo.<span class="codeReserved">color</span>) : <span class="codeString">""</span></td></tr>
  <tr><td>41</td><td>     render += <span class="codeComment">/* html */</span></td></tr>
  <tr><td>42</td><td>      <span class="codeString">`&lt;<span class="codeReserved">dt</span>&gt;${nombre}&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>43</td><td><span class="codeString">       &lt;<span class="codeReserved">dd</span>&gt;${<span class="codeReserved">color</span>}&lt;/<span class="codeReserved">dd</span>&gt;`</span></td></tr>
  <tr><td>44</td><td>    }</td></tr>
  <tr><td>45</td><td>    lista.innerHTML = render</td></tr>
  <tr><td>46</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>47</td><td>    muestraError(error)</td></tr>
  <tr><td>48</td><td>   }</td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td>  <span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>51</td><td>  window[<span class="codeString">"descargaDatos"</span>] = descargaDatos</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >F. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11renderCliente/m-srv/m-lista-php.html">srv / lista.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / lista.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td>devuelveJson([</td></tr>
  <tr><td>6</td><td> [</td></tr>
  <tr><td>7</td><td>  <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"pp"</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"azul"</span></td></tr>
  <tr><td>9</td><td> ],</td></tr>
  <tr><td>10</td><td> [</td></tr>
  <tr><td>11</td><td>  <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"kq"</span>,</td></tr>
  <tr><td>12</td><td>  <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"rojo"</span></td></tr>
  <tr><td>13</td><td> ],</td></tr>
  <tr><td>14</td><td> [</td></tr>
  <tr><td>15</td><td>  <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"tt"</span>,</td></tr>
  <tr><td>16</td><td>  <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"rosa"</span></td></tr>
  <tr><td>17</td><td> ],</td></tr>
  <tr><td>18</td><td> [</td></tr>
  <tr><td>19</td><td>  <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"bb"</span>,</td></tr>
  <tr><td>20</td><td>  <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"azul"</span></td></tr>
  <tr><td>21</td><td> ]</td></tr>
  <tr><td>22</td><td>]);</td></tr>
  <tr><td>23</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >G. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-js/m-htmlentities-js.html">lib / js / htmlentities.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / htmlentities.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * Codifica un texto para que cambie los caracteres</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * especiales y no se pueda interpretar como</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * etiiqueta HTML. Esta tÃ©cnica evita la inyecciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * de cÃ³digo.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } texto</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">*/</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> htmlentities(texto) {</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">return</span> texto.replace(<span class="codeString">/[&lt;&gt;&quot;&#039;]/</span>g, textoDetectado =&gt; {</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">switch</span> (textoDetectado) {</td></tr>
  <tr><td>11</td><td>   <span class="codeReserved">case</span> <span class="codeString">"<"</span>: <span class="codeReserved">return</span> <span class="codeString">"&lt;"</span></td></tr>
  <tr><td>12</td><td>   <span class="codeReserved">case</span> <span class="codeString">"&gt;"</span>: <span class="codeReserved">return</span> <span class="codeString">"&gt;"</span></td></tr>
  <tr><td>13</td><td>   <span class="codeReserved">case</span> <span class="codeString">'&quot;'</span>: <span class="codeReserved">return</span> <span class="codeString">"&quot;"</span></td></tr>
  <tr><td>14</td><td>   <span class="codeReserved">case</span> <span class="codeString">"&#039;"</span>: <span class="codeReserved">return</span> <span class="codeString">"&#039;"</span></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">default</span>: <span class="codeReserved">return</span> textoDetectado</td></tr>
  <tr><td>16</td><td>  }</td></tr>
  <tr><td>17</td><td> })</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >H. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m11renderCliente/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m11renderCliente/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >I. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ un ejemplo de renderizado en el cliente.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >16. Renderizado del lado del servidor</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12renderServidor/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/mBdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/mCinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Para algunas partes de una pÃ¡gina no hay componentes grÃ¡ficos que puedan
    mostrar valores, como en el caso de los listados. En ese caso se tiene que
    generar el cÃ³digo HTM desde el programa, proceso que se conoce como
    <dfn>renderizado</dfn>.
   </p>
  </li>
  <li>
   <p>
    En esta lecciÃ³n se presenta un ejemplo de renderizado en el servidor.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://renderserv.rf.gd/" rel="noreferrer"
      target="_blank">http://renderserv.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m12renderServidor/renserverdistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >C. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://renderserv.rf.gd/" rel="noreferrer"
      target="_blank">http://renderserv.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/renderserv.zip" download>/src/renderserv.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >D. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraObjeto-js.html">muestraObjeto.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-render-php.html">render.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >E. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Render en el servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/render.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">  .then(respuesta =&gt; muestraObjeto(document, respuesta.body))</span></td></tr>
  <tr><td>19</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">h1</span>&gt;Render en el servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">dl</span> id=<span class="codeString">"lista"</span>&gt;</td></tr>
  <tr><td>24</td><td>  &lt;<span class="codeReserved">dt</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">dt</span>&gt;</td></tr>
  <tr><td>25</td><td>  &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;</td></tr>
  <tr><td>26</td><td> &lt;/<span class="codeReserved">dl</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >F. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12renderServidor/m-srv/m-render-php.html">srv / render.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / render.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $lista = [</td></tr>
  <tr><td>9</td><td>  [</td></tr>
  <tr><td>10</td><td>   <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"pp"</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"azul"</span></td></tr>
  <tr><td>12</td><td>  ],</td></tr>
  <tr><td>13</td><td>  [</td></tr>
  <tr><td>14</td><td>   <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"qk"</span>,</td></tr>
  <tr><td>15</td><td>   <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"rojo"</span></td></tr>
  <tr><td>16</td><td>  ],</td></tr>
  <tr><td>17</td><td>  [</td></tr>
  <tr><td>18</td><td>   <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"tt"</span>,</td></tr>
  <tr><td>19</td><td>   <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"rosa"</span></td></tr>
  <tr><td>20</td><td>  ],</td></tr>
  <tr><td>21</td><td>  [</td></tr>
  <tr><td>22</td><td>   <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"bb"</span>,</td></tr>
  <tr><td>23</td><td>   <span class="codeString">"<span class="codeReserved">color</span>"</span> =&gt; <span class="codeString">"azul"</span></td></tr>
  <tr><td>24</td><td>  ]</td></tr>
  <tr><td>25</td><td> ];</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeComment">// Genera el cÃ³digo HTML de la lista.</span></td></tr>
  <tr><td>28</td><td> $render = <span class="codeString">""</span>;</td></tr>
  <tr><td>29</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>30</td><td>  <span class="codeComment">/* Codifica nombre y <span class="codeReserved">color</span> para que cambie los caracteres</span></td></tr>
  <tr><td>31</td><td><span class="codeComment">   * especiales y el texto no se pueda interpretar como HTML.</span></td></tr>
  <tr><td>32</td><td><span class="codeComment">   * Esta tÃ©cnica evita la inyecciÃ³n de cÃ³digo. */</span></td></tr>
  <tr><td>33</td><td>  $nombre = htmlentities($modelo[<span class="codeString">"nombre"</span>]);</td></tr>
  <tr><td>34</td><td>  $color = htmlentities($modelo[<span class="codeString">"<span class="codeReserved">color</span>"</span>]);</td></tr>
  <tr><td>35</td><td>  $render .=</td></tr>
  <tr><td>36</td><td>   <span class="codeString">"&lt;<span class="codeReserved">dt</span>&gt;{$nombre}&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>37</td><td><span class="codeString">    &lt;<span class="codeReserved">dd</span>&gt;{$color}&lt;/<span class="codeReserved">dd</span>&gt;"</span>;</td></tr>
  <tr><td>38</td><td> }</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td> devuelveJson([<span class="codeString">"lista"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>41</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>44</td><td>}</td></tr>
  <tr><td>45</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >G. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-js/m-muestraObjeto-js.html">lib / js / muestraObjeto.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraObjeto.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraObjeto(raizHtml, objeto) {</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [nombre, definiciones] of Object.entries(objeto)) {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">if</span> (Array.isArray(definiciones)) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   muestraArray(raizHtml, nombre, definiciones)</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (definiciones !== undefined && definiciones !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">const</span> elementoHtml = buscaElementoHtml(raizHtml, nombre)</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (elementoHtml <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>    muestraInput(raizHtml, elementoHtml, definiciones)</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>   } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (elementoHtml !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> elementoHtml) {</td></tr>
  <tr><td>25</td><td>      elementoHtml[atributo] = valor</td></tr>
  <tr><td>26</td><td>     }</td></tr>
  <tr><td>27</td><td>    }</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>   }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>window[<span class="codeString">"muestraObjeto"</span>] = muestraObjeto</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } nombre</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>43</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> buscaElementoHtml(raizHtml, nombre) {</td></tr>
  <tr><td>44</td><td> <span class="codeReserved">return</span> raizHtml.querySelector(</td></tr>
  <tr><td>45</td><td>  <span class="codeString">`#${nombre},[name=&quot;${nombre}&quot;],[data-name=&quot;${nombre}&quot;]`</span>)</td></tr>
  <tr><td>46</td><td>}</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } propiedad</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {any[]} valores</span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>53</td><td><span class="codeReserved">function</span> muestraArray(raizHtml, propiedad, valores) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> <span class="codeReserved">const</span> conjunto = <span class="codeReserved">new</span> Set(valores)</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> elementos =</td></tr>
  <tr><td>57</td><td>  raizHtml.querySelectorAll(<span class="codeString">`[name=&quot;${propiedad}&quot;],[data-name=&quot;${propiedad}&quot;]`</span>)</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> <span class="codeReserved">if</span> (elementos.length === 1) {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">const</span> elemento = elementos[0]</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLSelectElement) {</td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">const</span> options = elemento.options</td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = options.length; i &lt; len; i++) {</td></tr>
  <tr><td>65</td><td>    <span class="codeReserved">const</span> option = options[i]</td></tr>
  <tr><td>66</td><td>    option.selected = conjunto.has(option.value)</td></tr>
  <tr><td>67</td><td>   }</td></tr>
  <tr><td>68</td><td>   <span class="codeReserved">return</span></td></tr>
  <tr><td>69</td><td>  }</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td> }</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = elementos.length; i &lt; len; i++) {</td></tr>
  <tr><td>74</td><td>  <span class="codeReserved">const</span> elemento = elementos[i]</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>76</td><td>   elemento.checked = conjunto.has(elemento.value)</td></tr>
  <tr><td>77</td><td>  }</td></tr>
  <tr><td>78</td><td> }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>}</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>83</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>84</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>85</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } definiciones</span></td></tr>
  <tr><td>86</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>87</td><td><span class="codeReserved">function</span> muestraInput(raizHtml, input, definiciones) {</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>  <span class="codeReserved">if</span> (atributo == <span class="codeString">"data-file"</span>) {</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>95</td><td>    input.dataset.file = valor</td></tr>
  <tr><td>96</td><td>    input.value = <span class="codeString">""</span></td></tr>
  <tr><td>97</td><td>    <span class="codeReserved">if</span> (valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>98</td><td>     img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>99</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>100</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>101</td><td>     img.<span class="codeReserved">src</span> = valor</td></tr>
  <tr><td>102</td><td>     img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>103</td><td>    }</td></tr>
  <tr><td>104</td><td>   }</td></tr>
  <tr><td>105</td><td></td></tr>
  <tr><td>106</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> input) {</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>   input[atributo] = valor</td></tr>
  <tr><td>109</td><td></td></tr>
  <tr><td>110</td><td>  }</td></tr>
  <tr><td>111</td><td> }</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td>}</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>116</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>117</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLElement } elementoHtml</span></td></tr>
  <tr><td>118</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>119</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getImgParaElementoHtml(raizHtml, elementoHtml) {</td></tr>
  <tr><td>120</td><td> <span class="codeReserved">const</span> imgId = elementoHtml.getAttribute(<span class="codeString">"data-img"</span>)</td></tr>
  <tr><td>121</td><td> <span class="codeReserved">if</span> (imgId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>122</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>123</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>124</td><td>  <span class="codeReserved">const</span> input = buscaElementoHtml(raizHtml, imgId)</td></tr>
  <tr><td>125</td><td>  <span class="codeReserved">if</span> (input <span class="codeReserved">instanceof</span> HTMLImageElement) {</td></tr>
  <tr><td>126</td><td>   <span class="codeReserved">return</span> input</td></tr>
  <tr><td>127</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>128</td><td>   <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>129</td><td>  }</td></tr>
  <tr><td>130</td><td> }</td></tr>
  <tr><td>131</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >H. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m12renderServidor/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m12renderServidor/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >I. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ un ejemplo de renderizado en el servidor.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >17. Bases de datos</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m13bd/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/mBder.html">Diagrama entidad relaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/mBrel.html">Diagrama relacional</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/mCdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-agrega-html.html">agrega.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-modifica-html.html">modifica.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se muestra el acceso a bases de datos con servicios.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvbd.rf.gd/" rel="noreferrer"
      target="_blank">http://srvbd.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama entidad relaciÃ³n</h1><figure>
 <img style="max-height: none;"
   src="/img/m13bd/bdentity.drawio.svg"
   alt="Diagrama entidad relaciÃ³nn">
</figure>
      </section>
     <section >
         <h1 >C. Diagrama relacional</h1><figure>
 <img style="max-height: none;"
   src="/img/m13bd/bqrel.drawio.svg"
   alt="Diagrama relacional">
</figure>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m13bd/bddistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >E. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvbd.rf.gd/" rel="noreferrer"
      target="_blank">http://srvbd.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvbd.zip" download>/src/srvbd.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >F. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-agrega-html.html">agrega.html</a></p>
  </li>
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <p><a href="m-modifica-html.html">modifica.html</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltaid-html.html">faltaid.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltanombre-html.html">faltanombre.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-idenblanco-html.html">idenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-nombreenblanco-html.html">nombreenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-pasatiemponoencontrado-html.html">pasatiemponoencontrado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraObjeto-js.html">muestraObjeto.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveCreated-php.html">devuelveCreated.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveNoContent-php.html">devuelveNoContent.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetch-php.html">fetch.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetchAll-php.html">fetchAll.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-NOT_FOUND-php.html">NOT_FOUND.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-OrmPdo-php.html">OrmPdo.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaEntero-php.html">recuperaEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaIdEntero-php.html">recuperaIdEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-validaNombre-php.html">validaNombre.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-Bd-php.html">Bd.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-pasatiempo-agrega-php.html">pasatiempo-agrega.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-pasatiempo-elimina-php.html">pasatiempo-elimina.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-pasatiempo-modifica-php.html">pasatiempo-modifica.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-pasatiempo-php.html">pasatiempo.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-pasatiempos-php.html">pasatiempos.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-pasatimpoOrm-php.html">pasatimpoOrm.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >G. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Acceso a base de datos&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/pasatiempos.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   .then(respuesta =&gt; muestraObjeto(document, respuesta.body))</span></td></tr>
  <tr><td>19</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">h1</span>&gt;Acceso a base de datos&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"agrega.html"</span>&gt;Agregar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> &lt;<span class="codeReserved">ul</span> id=<span class="codeString">"lista"</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">li</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">li</span>&gt;</td></tr>
  <tr><td>27</td><td> &lt;/<span class="codeReserved">ul</span>&gt;</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. agrega.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Agregar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/pasatiempo-agrega.php&#039;, event)</span></td></tr>
  <tr><td>19</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>20</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Agregar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>27</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>28</td><td>    Nombre *</td></tr>
  <tr><td>29</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span>&gt;</td></tr>
  <tr><td>30</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>31</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Agregar&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. modifica.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span></td></tr>
  <tr><td>8</td><td>   <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> &lt;<span class="codeReserved">title</span>&gt;Modificar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>18</td><td>  <span class="codeComment">// Obtiene los parÃ¡metros de la pÃ¡gina.</span></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">const</span> params = <span class="codeReserved">new</span> URL(location.href).searchParams</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"<span class="codeReserved">if</span> (params.size &gt; 0) {</span></td></tr>
  <tr><td>25</td><td><span class="codeString">   consumeJson(&#039;srv/pasatiempo.php?&#039; + params)</span></td></tr>
  <tr><td>26</td><td><span class="codeString">    .then(respuesta =&gt; muestraObjeto(forma, respuesta.body))</span></td></tr>
  <tr><td>27</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>28</td><td><span class="codeString">  }"</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td> &lt;<span class="codeReserved">form</span> id=<span class="codeString">"forma"</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/pasatiempo-modifica.php&#039;, event)</span></td></tr>
  <tr><td>31</td><td><span class="codeString">    .then(respuesta =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>32</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Modificar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td>  &lt;<span class="codeReserved">input</span> name=<span class="codeString">"id"</span> type=<span class="codeString">"hidden"</span>&gt;</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>41</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>42</td><td>    Nombre *</td></tr>
  <tr><td>43</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span> value=<span class="codeString">"Cargando&hellip;"</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>45</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Guardar&lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> onclick=<span class="codeString">"</span></td></tr>
  <tr><td>54</td><td><span class="codeString">     <span class="codeReserved">if</span> (params.size &gt; 0 && confirm(&#039;Confirma la eliminaciÃ³n&#039;)) {</span></td></tr>
  <tr><td>55</td><td><span class="codeString">      consumeJson(&#039;srv/pasatiempo-elimina.php?&#039; + params)</span></td></tr>
  <tr><td>56</td><td><span class="codeString">       .then(() =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>57</td><td><span class="codeString">       .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>58</td><td><span class="codeString">     }"</span>&gt;</td></tr>
  <tr><td>59</td><td>    Eliminar</td></tr>
  <tr><td>60</td><td>   &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >J. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m13bd/m-srv/m-Bd-php.html">srv / Bd.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-srv/m-pasatiempo-agrega-php.html">srv / pasatiempo-agrega.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-srv/m-pasatiempo-elimina-php.html">srv / pasatiempo-elimina.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-srv/m-pasatiempo-modifica-php.html">srv / pasatiempo-modifica.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-srv/m-pasatiempo-php.html">srv / pasatiempo.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-srv/m-pasatiempos-php.html">srv / pasatiempos.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-srv/m-pasatimpoOrm-php.html">srv / pasatimpoOrm.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / Bd.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">class</span> Bd</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeReserved">private</span> <span class="codeReserved">static</span> ?PDO $conexion = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> <span class="codeReserved">static</span> <span class="codeReserved">function</span> getConexion(): PDO</td></tr>
  <tr><td>9</td><td> {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>  <span class="codeReserved">if</span> (<span class="codeReserved">self</span>::$conexion === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>   <span class="codeReserved">self</span>::$conexion = <span class="codeReserved">new</span> PDO(</td></tr>
  <tr><td>14</td><td>    <span class="codeComment">// cadena de conexiÃ³n</span></td></tr>
  <tr><td>15</td><td>    <span class="codeString">"sqlite:srvbd.db"</span>,</td></tr>
  <tr><td>16</td><td>    <span class="codeComment">// usuario</span></td></tr>
  <tr><td>17</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>18</td><td>    <span class="codeComment">// contraseÃ±a</span></td></tr>
  <tr><td>19</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>20</td><td>    <span class="codeComment">// Opciones: conexiones persistentes y lanza excepciones.</span></td></tr>
  <tr><td>21</td><td>    [PDO::ATTR_PERSISTENT =&gt; <span class="codeReserved">true</span>, PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION]</td></tr>
  <tr><td>22</td><td>   );</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>25</td><td>    <span class="codeString">"<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> PASATIEMPO (</span></td></tr>
  <tr><td>26</td><td><span class="codeString">      PAS_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>27</td><td><span class="codeString">      PAS_NOMBRE <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>28</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PAS_PK</span></td></tr>
  <tr><td>29</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(PAS_ID),</span></td></tr>
  <tr><td>30</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PAS_NOM_UNQ</span></td></tr>
  <tr><td>31</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(PAS_NOMBRE),</span></td></tr>
  <tr><td>32</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PAS_NOM_NV</span></td></tr>
  <tr><td>33</td><td><span class="codeString">       CHECK(LENGTH(PAS_NOMBRE) &gt; 0)</span></td></tr>
  <tr><td>34</td><td><span class="codeString">     )"</span></td></tr>
  <tr><td>35</td><td>   );</td></tr>
  <tr><td>36</td><td>  }</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">self</span>::$conexion;</td></tr>
  <tr><td>39</td><td> }</td></tr>
  <tr><td>40</td><td>}</td></tr>
  <tr><td>41</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. srv / pasatiempo-agrega.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaNombre.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveCreated.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/pasatimpoOrm.php"</span>;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> $nombre = validaNombre($nombre);</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> list($id) =</td></tr>
  <tr><td>19</td><td>  $pasatimpoOrm-&gt;insert(Bd::getConexion(), [[PAS_NOMBRE =&gt; $nombre]]);</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> $encodeId = urlencode($id);</td></tr>
  <tr><td>22</td><td> devuelveCreated(<span class="codeString">"/srv/pasatiempo.php?id=$encodeId"</span>, [</td></tr>
  <tr><td>23</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $id],</td></tr>
  <tr><td>24</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $nombre],</td></tr>
  <tr><td>25</td><td> ]);</td></tr>
  <tr><td>26</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>29</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>32</td><td>}</td></tr>
  <tr><td>33</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. srv / pasatiempo-elimina.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveNoContent.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/pasatimpoOrm.php"</span>;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>12</td><td> $id = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>13</td><td> $pasatimpoOrm-&gt;delete(Bd::getConexion(), [[PAS_ID =&gt; $id]]);</td></tr>
  <tr><td>14</td><td> devuelveNoContent();</td></tr>
  <tr><td>15</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>16</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>17</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>18</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. srv / pasatiempo-modifica.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaNombre.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/pasatimpoOrm.php"</span>;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $id = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>16</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $nombre = validaNombre($nombre);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $pasatimpoOrm-&gt;update(</td></tr>
  <tr><td>21</td><td>  Bd::getConexion(),</td></tr>
  <tr><td>22</td><td>  [[PAS_ID =&gt; $id, PAS_NOMBRE =&gt; $nombre]]</td></tr>
  <tr><td>23</td><td> );</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> devuelveJson([</td></tr>
  <tr><td>26</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $id],</td></tr>
  <tr><td>27</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $nombre],</td></tr>
  <tr><td>28</td><td> ]);</td></tr>
  <tr><td>29</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>32</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. srv / pasatiempo.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/pasatimpoOrm.php"</span>;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $id = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $modelo = $pasatimpoOrm-&gt;select(Bd::getConexion(), [PAS_ID =&gt; $id]);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($modelo === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  $idHtml = htmlentities($id);</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>23</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>24</td><td>   title: <span class="codeString">"Pasatiempo no encontrado."</span>,</td></tr>
  <tr><td>25</td><td>   type: <span class="codeString">"/error/pasatiemponoencontrado.html"</span>,</td></tr>
  <tr><td>26</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn pasatiempo con el id $idHtml."</span>,</td></tr>
  <tr><td>27</td><td>  );</td></tr>
  <tr><td>28</td><td> }</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td> devuelveJson([</td></tr>
  <tr><td>31</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $id],</td></tr>
  <tr><td>32</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $modelo[PAS_NOMBRE]],</td></tr>
  <tr><td>33</td><td> ]);</td></tr>
  <tr><td>34</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>37</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>40</td><td>}</td></tr>
  <tr><td>41</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. srv / pasatiempos.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/pasatimpoOrm.php"</span>;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> $conexionexion = Bd::getConexion();</td></tr>
  <tr><td>14</td><td> $lista = fetchAll($conexionexion-&gt;query(</td></tr>
  <tr><td>15</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span> *</span></td></tr>
  <tr><td>16</td><td><span class="codeString">   <span class="codeReserved">FROM</span> PASATIEMPO</span></td></tr>
  <tr><td>17</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> PAS_NOMBRE"</span></td></tr>
  <tr><td>18</td><td> ));</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $render = <span class="codeString">""</span>;</td></tr>
  <tr><td>21</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>22</td><td>  $encodeId = urlencode($modelo[PAS_ID]);</td></tr>
  <tr><td>23</td><td>  $id = htmlentities($encodeId);</td></tr>
  <tr><td>24</td><td>  $nombre = htmlentities($modelo[PAS_NOMBRE]);</td></tr>
  <tr><td>25</td><td>  $render .=</td></tr>
  <tr><td>26</td><td>   <span class="codeString">"&lt;<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>27</td><td><span class="codeString">     &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>28</td><td><span class="codeString">      &lt;<span class="codeReserved">a</span> href=&#039;modifica.html?id=$id&#039;&gt;$nombre&lt;/<span class="codeReserved">a</span>&gt;</span></td></tr>
  <tr><td>29</td><td><span class="codeString">     &lt;/<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>30</td><td><span class="codeString">    &lt;/<span class="codeReserved">li</span>&gt;"</span>;</td></tr>
  <tr><td>31</td><td> }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> devuelveJson([<span class="codeString">"lista"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>34</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>37</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>40</td><td>}</td></tr>
  <tr><td>41</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. srv / pasatimpoOrm.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"../../lib/php/OrmPdo.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">const</span> PASATIEMPO = <span class="codeString">"PASATIEMPO"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">const</span> PAS_ID = <span class="codeString">"PAS_ID"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">const</span> PAS_NOMBRE = <span class="codeString">"PAS_NOMBRE"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td>$pasatimpoOrm = <span class="codeReserved">new</span> OrmPdo(</td></tr>
  <tr><td>11</td><td> nombreDeTabla: PASATIEMPO,</td></tr>
  <tr><td>12</td><td> nombresDeLlaves: [PAS_ID],</td></tr>
  <tr><td>13</td><td> nombresDeCampos: [PAS_NOMBRE]</td></tr>
  <tr><td>14</td><td>);</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >K. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m13bd/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m13bd/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-js/m-muestraObjeto-js.html">lib / js / muestraObjeto.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraObjeto.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraObjeto(raizHtml, objeto) {</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [nombre, definiciones] of Object.entries(objeto)) {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">if</span> (Array.isArray(definiciones)) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   muestraArray(raizHtml, nombre, definiciones)</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (definiciones !== undefined && definiciones !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">const</span> elementoHtml = buscaElementoHtml(raizHtml, nombre)</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (elementoHtml <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>    muestraInput(raizHtml, elementoHtml, definiciones)</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>   } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (elementoHtml !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> elementoHtml) {</td></tr>
  <tr><td>25</td><td>      elementoHtml[atributo] = valor</td></tr>
  <tr><td>26</td><td>     }</td></tr>
  <tr><td>27</td><td>    }</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>   }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>window[<span class="codeString">"muestraObjeto"</span>] = muestraObjeto</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } nombre</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>43</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> buscaElementoHtml(raizHtml, nombre) {</td></tr>
  <tr><td>44</td><td> <span class="codeReserved">return</span> raizHtml.querySelector(</td></tr>
  <tr><td>45</td><td>  <span class="codeString">`#${nombre},[name=&quot;${nombre}&quot;],[data-name=&quot;${nombre}&quot;]`</span>)</td></tr>
  <tr><td>46</td><td>}</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } propiedad</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {any[]} valores</span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>53</td><td><span class="codeReserved">function</span> muestraArray(raizHtml, propiedad, valores) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> <span class="codeReserved">const</span> conjunto = <span class="codeReserved">new</span> Set(valores)</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> elementos =</td></tr>
  <tr><td>57</td><td>  raizHtml.querySelectorAll(<span class="codeString">`[name=&quot;${propiedad}&quot;],[data-name=&quot;${propiedad}&quot;]`</span>)</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> <span class="codeReserved">if</span> (elementos.length === 1) {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">const</span> elemento = elementos[0]</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLSelectElement) {</td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">const</span> options = elemento.options</td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = options.length; i &lt; len; i++) {</td></tr>
  <tr><td>65</td><td>    <span class="codeReserved">const</span> option = options[i]</td></tr>
  <tr><td>66</td><td>    option.selected = conjunto.has(option.value)</td></tr>
  <tr><td>67</td><td>   }</td></tr>
  <tr><td>68</td><td>   <span class="codeReserved">return</span></td></tr>
  <tr><td>69</td><td>  }</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td> }</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = elementos.length; i &lt; len; i++) {</td></tr>
  <tr><td>74</td><td>  <span class="codeReserved">const</span> elemento = elementos[i]</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>76</td><td>   elemento.checked = conjunto.has(elemento.value)</td></tr>
  <tr><td>77</td><td>  }</td></tr>
  <tr><td>78</td><td> }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>}</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>83</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>84</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>85</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } definiciones</span></td></tr>
  <tr><td>86</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>87</td><td><span class="codeReserved">function</span> muestraInput(raizHtml, input, definiciones) {</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>  <span class="codeReserved">if</span> (atributo == <span class="codeString">"data-file"</span>) {</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>95</td><td>    input.dataset.file = valor</td></tr>
  <tr><td>96</td><td>    input.value = <span class="codeString">""</span></td></tr>
  <tr><td>97</td><td>    <span class="codeReserved">if</span> (valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>98</td><td>     img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>99</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>100</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>101</td><td>     img.<span class="codeReserved">src</span> = valor</td></tr>
  <tr><td>102</td><td>     img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>103</td><td>    }</td></tr>
  <tr><td>104</td><td>   }</td></tr>
  <tr><td>105</td><td></td></tr>
  <tr><td>106</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> input) {</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>   input[atributo] = valor</td></tr>
  <tr><td>109</td><td></td></tr>
  <tr><td>110</td><td>  }</td></tr>
  <tr><td>111</td><td> }</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td>}</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>116</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>117</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLElement } elementoHtml</span></td></tr>
  <tr><td>118</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>119</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getImgParaElementoHtml(raizHtml, elementoHtml) {</td></tr>
  <tr><td>120</td><td> <span class="codeReserved">const</span> imgId = elementoHtml.getAttribute(<span class="codeString">"data-img"</span>)</td></tr>
  <tr><td>121</td><td> <span class="codeReserved">if</span> (imgId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>122</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>123</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>124</td><td>  <span class="codeReserved">const</span> input = buscaElementoHtml(raizHtml, imgId)</td></tr>
  <tr><td>125</td><td>  <span class="codeReserved">if</span> (input <span class="codeReserved">instanceof</span> HTMLImageElement) {</td></tr>
  <tr><td>126</td><td>   <span class="codeReserved">return</span> input</td></tr>
  <tr><td>127</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>128</td><td>   <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>129</td><td>  }</td></tr>
  <tr><td>130</td><td> }</td></tr>
  <tr><td>131</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-devuelveCreated-php.html">lib / php / devuelveCreated.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-devuelveNoContent-php.html">lib / php / devuelveNoContent.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-fetch-php.html">lib / php / fetch.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-fetchAll-php.html">lib / php / fetchAll.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-NOT_FOUND-php.html">lib / php / NOT_FOUND.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-OrmPdo-php.html">lib / php / OrmPdo.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-recuperaEntero-php.html">lib / php / recuperaEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-recuperaIdEntero-php.html">lib / php / recuperaIdEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-lib/m-php/m-validaNombre-php.html">lib / php / validaNombre.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveCreated.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveCreated($urlDelNuevo, $resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(201);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Location: {$urlDelNuevo}"</span>);</td></tr>
  <tr><td>17</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>18</td><td>  echo $json;</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td>}</td></tr>
  <tr><td>21</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveNoContent.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> devuelveNoContent()</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> http_response_code(204);</td></tr>
  <tr><td>6</td><td>}</td></tr>
  <tr><td>7</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / fetch.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetch(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_ASSOC,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">if</span> ($opcional === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>20</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch($mode);</td></tr>
  <tr><td>21</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>22</td><td>   $statement-&gt;setFetchMode($mode, $opcional);</td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch();</td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >9. lib / php / fetchAll.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetchAll(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_ASSOC,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>): array {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  $resultado = $opcional === <span class="codeReserved">null</span></td></tr>
  <tr><td>20</td><td>   ? $statement-&gt;fetchAll($mode)</td></tr>
  <tr><td>21</td><td>   : $statement-&gt;fetchAll($mode, $opcional);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">if</span> ($resultado === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>25</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">return</span> $resultado;</td></tr>
  <tr><td>27</td><td>  }</td></tr>
  <tr><td>28</td><td> }</td></tr>
  <tr><td>29</td><td>}</td></tr>
  <tr><td>30</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >10. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >11. lib / php / NOT_FOUND.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> NOT_FOUND = 404;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >12. lib / php / OrmPdo.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/fetch.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">class</span> OrmPdo</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td> <span class="codeReserved">private</span> string $nombreDeTabla;</td></tr>
  <tr><td>8</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@var</span> string[]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">private</span> array $nombresDeLlaves;</td></tr>
  <tr><td>12</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  * <span class="codeReserved">@var</span> string[]</span></td></tr>
  <tr><td>14</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">private</span> array $nombresDeCampos;</td></tr>
  <tr><td>16</td><td> <span class="codeReserved">private</span> <span class="codeReserved">bool</span> $autoincrement;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">private</span> string $sequence;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>20</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> string[] $nombresDeLlaves</span></td></tr>
  <tr><td>21</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> string[] $nombresDeCampos</span></td></tr>
  <tr><td>22</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>24</td><td>  string $nombreDeTabla,</td></tr>
  <tr><td>25</td><td>  array $nombresDeLlaves,</td></tr>
  <tr><td>26</td><td>  array $nombresDeCampos,</td></tr>
  <tr><td>27</td><td>  <span class="codeReserved">bool</span> $autoincrement = <span class="codeReserved">true</span>,</td></tr>
  <tr><td>28</td><td>  string $sequence = <span class="codeString">""</span>,</td></tr>
  <tr><td>29</td><td> ) {</td></tr>
  <tr><td>30</td><td>  $this-&gt;nombreDeTabla = $nombreDeTabla;</td></tr>
  <tr><td>31</td><td>  $this-&gt;nombresDeLlaves = $nombresDeLlaves;</td></tr>
  <tr><td>32</td><td>  $this-&gt;autoincrement = $autoincrement;</td></tr>
  <tr><td>33</td><td>  $this-&gt;sequence = $sequence;</td></tr>
  <tr><td>34</td><td>  $this-&gt;nombresDeCampos = $nombresDeCampos;</td></tr>
  <tr><td>35</td><td> }</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>38</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> array[] $objetos</span></td></tr>
  <tr><td>39</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>40</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> insert(PDO $conexion, array $objetos)</td></tr>
  <tr><td>41</td><td> {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  $sqlCampos = implode(<span class="codeString">","</span>, $this-&gt;nombresDeCampos);</td></tr>
  <tr><td>44</td><td>  $sqlValoresCampos =</td></tr>
  <tr><td>45</td><td>   implode(<span class="codeString">","</span>, $this-&gt;convierteCamposEnParametros($this-&gt;nombresDeCampos));</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>  <span class="codeReserved">if</span> ($this-&gt;autoincrement) {</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>   $sql =</td></tr>
  <tr><td>50</td><td>    <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> $this-&gt;nombreDeTabla ($sqlCampos) <span class="codeReserved">VALUES</span> ($sqlValoresCampos)"</span>;</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td>   <span class="codeComment">/**</span></td></tr>
  <tr><td>53</td><td><span class="codeComment">    * <span class="codeReserved">@var</span> string[]</span></td></tr>
  <tr><td>54</td><td><span class="codeComment">    */</span></td></tr>
  <tr><td>55</td><td>   $llaves = [];</td></tr>
  <tr><td>56</td><td>   $statement = $conexion-&gt;prepare($sql);</td></tr>
  <tr><td>57</td><td>   <span class="codeReserved">foreach</span> ($objetos <span class="codeReserved">as</span> $objeto) {</td></tr>
  <tr><td>58</td><td>    $this-&gt;ejecutaStatement($statement, $objeto);</td></tr>
  <tr><td>59</td><td>    <span class="codeReserved">if</span> ($this-&gt;sequence === <span class="codeString">""</span>) {</td></tr>
  <tr><td>60</td><td>     $id = $conexion-&gt;lastInsertId();</td></tr>
  <tr><td>61</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>     $id = $conexion-&gt;lastInsertId($this-&gt;sequence);</td></tr>
  <tr><td>63</td><td>    }</td></tr>
  <tr><td>64</td><td>    <span class="codeReserved">if</span> ($id === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>65</td><td>     $llaves[] = <span class="codeString">""</span>;</td></tr>
  <tr><td>66</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>67</td><td>     $llaves[] = $id;</td></tr>
  <tr><td>68</td><td>    }</td></tr>
  <tr><td>69</td><td>   }</td></tr>
  <tr><td>70</td><td>   <span class="codeReserved">return</span> $llaves;</td></tr>
  <tr><td>71</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   $sqlLlaves = implode(<span class="codeString">","</span>, $this-&gt;nombresDeLlaves);</td></tr>
  <tr><td>74</td><td>   $sqlValoresLlaves =</td></tr>
  <tr><td>75</td><td>    implode(<span class="codeString">","</span>, $this-&gt;convierteCamposEnParametros($this-&gt;nombresDeLlaves));</td></tr>
  <tr><td>76</td><td>   $sql =</td></tr>
  <tr><td>77</td><td>    <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> $this-&gt;nombreDeTabla ($sqlLlaves,$sqlCampos)</span></td></tr>
  <tr><td>78</td><td><span class="codeString">      <span class="codeReserved">VALUES</span> ($sqlValoresLlaves,$sqlValoresCampos)"</span>;</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>   $statement = $conexion-&gt;prepare($sql);</td></tr>
  <tr><td>81</td><td>   <span class="codeReserved">foreach</span> ($objetos <span class="codeReserved">as</span> $objeto) {</td></tr>
  <tr><td>82</td><td>    $this-&gt;ejecutaStatement($statement, $objeto);</td></tr>
  <tr><td>83</td><td>   }</td></tr>
  <tr><td>84</td><td>   <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>85</td><td>  }</td></tr>
  <tr><td>86</td><td> }</td></tr>
  <tr><td>87</td><td></td></tr>
  <tr><td>88</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>89</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> array[] $objetos</span></td></tr>
  <tr><td>90</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>91</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> update(PDO $conexion, array $objetos)</td></tr>
  <tr><td>92</td><td> {</td></tr>
  <tr><td>93</td><td></td></tr>
  <tr><td>94</td><td>  $sqlCampos =</td></tr>
  <tr><td>95</td><td>   implode(<span class="codeString">","</span>, $this-&gt;convierteCamposEnAsignaciones($this-&gt;nombresDeCampos));</td></tr>
  <tr><td>96</td><td>  $sqlLlaves = implode(</td></tr>
  <tr><td>97</td><td>   <span class="codeString">" AND "</span>,</td></tr>
  <tr><td>98</td><td>   $this-&gt;convierteCamposEnAsignaciones($this-&gt;nombresDeLlaves)</td></tr>
  <tr><td>99</td><td>  );</td></tr>
  <tr><td>100</td><td>  $sql = <span class="codeString">"<span class="codeReserved">UPDATE</span> $this-&gt;nombreDeTabla <span class="codeReserved">SET</span> $sqlCampos <span class="codeReserved">WHERE</span> $sqlLlaves"</span>;</td></tr>
  <tr><td>101</td><td></td></tr>
  <tr><td>102</td><td>  $statement = $conexion-&gt;prepare($sql);</td></tr>
  <tr><td>103</td><td>  <span class="codeReserved">foreach</span> ($objetos <span class="codeReserved">as</span> $objeto) {</td></tr>
  <tr><td>104</td><td>   $this-&gt;ejecutaStatement($statement, $objeto);</td></tr>
  <tr><td>105</td><td>  }</td></tr>
  <tr><td>106</td><td> }</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>109</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> array[] $laves</span></td></tr>
  <tr><td>110</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>111</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> delete(PDO $conexion, array $llaves)</td></tr>
  <tr><td>112</td><td> {</td></tr>
  <tr><td>113</td><td></td></tr>
  <tr><td>114</td><td>  $sqlLlaves = implode(</td></tr>
  <tr><td>115</td><td>   <span class="codeString">" AND "</span>,</td></tr>
  <tr><td>116</td><td>   $this-&gt;convierteCamposEnAsignaciones($this-&gt;nombresDeLlaves)</td></tr>
  <tr><td>117</td><td>  );</td></tr>
  <tr><td>118</td><td>  $sql = <span class="codeString">"<span class="codeReserved">DELETE</span> <span class="codeReserved">FROM</span> $this-&gt;nombreDeTabla <span class="codeReserved">WHERE</span> $sqlLlaves"</span>;</td></tr>
  <tr><td>119</td><td></td></tr>
  <tr><td>120</td><td>  $statement = $conexion-&gt;prepare($sql);</td></tr>
  <tr><td>121</td><td>  <span class="codeReserved">foreach</span> ($llaves <span class="codeReserved">as</span> $llave) {</td></tr>
  <tr><td>122</td><td>   $this-&gt;ejecutaStatement($statement, $llave);</td></tr>
  <tr><td>123</td><td>  }</td></tr>
  <tr><td>124</td><td> }</td></tr>
  <tr><td>125</td><td></td></tr>
  <tr><td>126</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>127</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> array $valor</span></td></tr>
  <tr><td>128</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>129</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> select(</td></tr>
  <tr><td>130</td><td>  PDO $conexion,</td></tr>
  <tr><td>131</td><td>  array $lave,</td></tr>
  <tr><td>132</td><td>  <span class="codeReserved">int</span> $mode = PDO::FETCH_ASSOC,</td></tr>
  <tr><td>133</td><td>  $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>134</td><td> ) {</td></tr>
  <tr><td>135</td><td></td></tr>
  <tr><td>136</td><td>  $sqlLlaves = implode(</td></tr>
  <tr><td>137</td><td>   <span class="codeString">" AND "</span>,</td></tr>
  <tr><td>138</td><td>   $this-&gt;convierteCamposEnAsignaciones($this-&gt;nombresDeLlaves)</td></tr>
  <tr><td>139</td><td>  );</td></tr>
  <tr><td>140</td><td>  $sql = <span class="codeString">"<span class="codeReserved">SELECT</span> * <span class="codeReserved">FROM</span> $this-&gt;nombreDeTabla <span class="codeReserved">WHERE</span> $sqlLlaves"</span>;</td></tr>
  <tr><td>141</td><td></td></tr>
  <tr><td>142</td><td>  $statement = $conexion-&gt;prepare($sql);</td></tr>
  <tr><td>143</td><td>  $parametros = $this-&gt;convierteAsignacionEnParametros($lave);</td></tr>
  <tr><td>144</td><td>  <span class="codeReserved">return</span> fetch($statement, $parametros, $mode, $opcional);</td></tr>
  <tr><td>145</td><td> }</td></tr>
  <tr><td>146</td><td></td></tr>
  <tr><td>147</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>148</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> string[] $campos</span></td></tr>
  <tr><td>149</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>150</td><td> <span class="codeReserved">private</span> <span class="codeReserved">function</span> convierteCamposEnParametros(array $campos)</td></tr>
  <tr><td>151</td><td> {</td></tr>
  <tr><td>152</td><td>  $parametros = [];</td></tr>
  <tr><td>153</td><td>  <span class="codeReserved">foreach</span> ($campos <span class="codeReserved">as</span> $campo) {</td></tr>
  <tr><td>154</td><td>   $parametros[] = <span class="codeString">":$campo"</span>;</td></tr>
  <tr><td>155</td><td>  }</td></tr>
  <tr><td>156</td><td>  <span class="codeReserved">return</span> $parametros;</td></tr>
  <tr><td>157</td><td> }</td></tr>
  <tr><td>158</td><td></td></tr>
  <tr><td>159</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>160</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> string[] $campos</span></td></tr>
  <tr><td>161</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>162</td><td> <span class="codeReserved">private</span> <span class="codeReserved">function</span> convierteCamposEnAsignaciones(array $campos)</td></tr>
  <tr><td>163</td><td> {</td></tr>
  <tr><td>164</td><td>  $parametros = [];</td></tr>
  <tr><td>165</td><td>  <span class="codeReserved">foreach</span> ($campos <span class="codeReserved">as</span> $campo) {</td></tr>
  <tr><td>166</td><td>   $parametros[] = <span class="codeString">"$campo=:$campo"</span>;</td></tr>
  <tr><td>167</td><td>  }</td></tr>
  <tr><td>168</td><td>  <span class="codeReserved">return</span> $parametros;</td></tr>
  <tr><td>169</td><td> }</td></tr>
  <tr><td>170</td><td></td></tr>
  <tr><td>171</td><td> <span class="codeReserved">private</span> <span class="codeReserved">function</span> convierteAsignacionEnParametros(array $asignacion)</td></tr>
  <tr><td>172</td><td> {</td></tr>
  <tr><td>173</td><td>  $parametros = [];</td></tr>
  <tr><td>174</td><td>  <span class="codeReserved">foreach</span> ($asignacion <span class="codeReserved">as</span> $llave =&gt; $valor) {</td></tr>
  <tr><td>175</td><td>   $parametros[<span class="codeString">":$llave"</span>] = $valor;</td></tr>
  <tr><td>176</td><td>  }</td></tr>
  <tr><td>177</td><td>  <span class="codeReserved">return</span> $parametros;</td></tr>
  <tr><td>178</td><td> }</td></tr>
  <tr><td>179</td><td></td></tr>
  <tr><td>180</td><td> <span class="codeReserved">private</span> <span class="codeReserved">function</span> ejecutaStatement(PDOStatement $statement, array $asignacion)</td></tr>
  <tr><td>181</td><td> {</td></tr>
  <tr><td>182</td><td>  $statement-&gt;execute($this-&gt;convierteAsignacionEnParametros($asignacion));</td></tr>
  <tr><td>183</td><td> }</td></tr>
  <tr><td>184</td><td>}</td></tr>
  <tr><td>185</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >13. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >14. lib / php / recuperaEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * Devuelve el valor entero de un parÃ¡metro recibido en el</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuekve <span class="codeReserved">false</span></span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> * Si se recibe una cadena vacÃ­a, se devuelve <span class="codeReserved">null</span>.</span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> * Si parÃ¡metro no se puede convertir a entero, se genera</span></td></tr>
  <tr><td>14</td><td><span class="codeComment"> * un error.</span></td></tr>
  <tr><td>15</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>16</td><td><span class="codeReserved">function</span> recuperaEntero(string $parametro): <span class="codeReserved">false</span>|<span class="codeReserved">null</span>|<span class="codeReserved">int</span></td></tr>
  <tr><td>17</td><td>{</td></tr>
  <tr><td>18</td><td> $valor = recuperaTexto($parametro);</td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($valor === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>21</td><td> } <span class="codeReserved">elseif</span> ($valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span>;</td></tr>
  <tr><td>23</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">return</span> (<span class="codeReserved">int</span>) trim($valor);</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >15. lib / php / recuperaIdEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> recuperaIdEntero(string $parametro): <span class="codeReserved">int</span></td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> $id = recuperaEntero($parametro);</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>14</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>15</td><td>   title: <span class="codeString">"Falta el id."</span>,</td></tr>
  <tr><td>16</td><td>   type: <span class="codeString">"/error/faltaid.html"</span>,</td></tr>
  <tr><td>17</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de id."</span>,</td></tr>
  <tr><td>18</td><td>  );</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">null</span>)</td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>22</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>23</td><td>   title: <span class="codeString">"Id en blanco."</span>,</td></tr>
  <tr><td>24</td><td>   type: <span class="codeString">"/error/idenblanco.html"</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $id;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >16. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >17. lib / php / validaNombre.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaNombre(<span class="codeReserved">false</span>|string $nombre)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($nombre === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>11</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>12</td><td>   title: <span class="codeString">"Falta el nombre."</span>,</td></tr>
  <tr><td>13</td><td>   type: <span class="codeString">"/error/faltanombre.html"</span>,</td></tr>
  <tr><td>14</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de nombre."</span></td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $trimNombre = trim($nombre);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($trimNombre === <span class="codeString">""</span>)</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>21</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>22</td><td>   title: <span class="codeString">"Nombre en blanco."</span>,</td></tr>
  <tr><td>23</td><td>   type: <span class="codeString">"/error/nombreenblanco.html"</span>,</td></tr>
  <tr><td>24</td><td>   detail: <span class="codeString">"Pon texto en el campo nombre."</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $trimNombre;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >L. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m13bd/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-error/m-faltaid-html.html">error / faltaid.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-error/m-faltanombre-html.html">error / faltanombre.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-error/m-idenblanco-html.html">error / idenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-error/m-nombreenblanco-html.html">error / nombreenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-error/m-pasatiemponoencontrado-html.html">error / pasatiemponoencontrado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m13bd/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / faltaid.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el id&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el id&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de id.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / faltanombre.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el nombre&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el nombre&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / idenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Id en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Id en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. error / nombreenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon texto en el campo nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. error / pasatiemponoencontrado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Pasatiempo no encontrado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Pasatiempo no encontrado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ningÃºn pasatiempo con el id solicitado.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >M. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ el acceso a bases de datos con servicios.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >18. Chat sencillo - Protocolos de comunicaciÃ³n</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m14chat/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/mBdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/mCinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-paho.javascript-1.0.3/">Carpeta Â« paho.javascript-1.0.3 Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se presentan un chat sencillo.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://chatm.rf.gd/" rel="noreferrer"
      target="_blank">http://chatm.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Copia la url de la app y pÃ©gala en varias pestaÃ±as, navegadores y
    dispositivos para que veas como entre todas estas vistas se puede chatear.
   </p>
  </li>
  <li>
   <p>
    Este proyecto puede correr simultÃ¡neamente en varios navegadores y
    computadoras. Todos interactuan con el servidor
    <a href="https://test.mosquitto.org" target="_blank"
      rel="noreferrer">test.mosquitto.org</a>.
   </p>
  </li>
  <li>
   <p>
    Mosquitto es de prueba, pero puedes contratar servidores de MQTT para
    producciÃ³n y cambiar la configuraciÃ³n del cÃ³digo para usarlos.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m14chat/chatdistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >C. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://chatm.rf.gd/" rel="noreferrer"
      target="_blank">http://chatm.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Copia la url de la app y pÃ©gala en varias pestaÃ±as, navegadores y
    dispositivos para que veas como entre todas estas vistas se puede chatear.
   </p>
  </li>
  <li>
   <p>
    Este proyecto puede correr simultÃ¡neamente en varios navegadores y
    computadoras. Todos interactuan con el servidor
    <a href="https://test.mosquitto.org" target="_blank"
      rel="noreferrer">test.mosquitto.org</a>.
   </p>
  </li>
  <li>
   <p>
    Este ejercicio usa la librerÃ­a Eclipse Paho JavaScript Client para conectar
    el JavaScript del navegador web para conectarse al servidor de mqtt. Puedes
    profundizar en este tema en la URL
    <a href="https://eclipse.dev/paho/clients/js/" rel="noreferrer"
      target="_blank">https://eclipse.dev/paho/clients/js/</a>
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/chatm.zip" download>/src/chatm.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >D. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-conexionMqttPerdida-js.html">conexionMqttPerdida.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-creaClientIdMqtt-js.html">creaClientIdMqtt.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-falloEnLaConexionMqtt-js.html">falloEnLaConexionMqtt.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>paho.javascript-1.0.3</summary>
      <ul>
  <li>
   <p><a href="m-paho.javascript-1.0.3/m-about-html.html">about.html</a></p>
  </li>
  <li>
   <p><a href="m-paho.javascript-1.0.3/m-CONTRIBUTING-md.html">CONTRIBUTING.md</a></p>
  </li>
  <li>
   <p><a href="m-paho.javascript-1.0.3/m-edl-v10.html">edl-v10</a></p>
  </li>
  <li>
   <p><a href="m-paho.javascript-1.0.3/m-epl-v10.html">epl-v10</a></p>
  </li>
  <li>
   <p><a href="m-paho.javascript-1.0.3/m-paho-mqtt-min-js.html">paho-mqtt-min.js</a></p>
  </li>
  <li>
   <p><a href="m-paho.javascript-1.0.3/m-paho-mqtt-js.html">paho-mqtt.js</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >E. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">&quot;UTF-8&quot;</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">&quot;viewport&quot;</span> content=<span class="codeString">&quot;width=device-width&quot;</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Chat&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> src=<span class="codeString">&quot;paho.javascript-1.0.3/paho-mqtt-min.js&quot;</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">&quot;formActivada(event)&quot;</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Chat&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>22</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>23</td><td>    Alias *</td></tr>
  <tr><td>24</td><td>    &lt;<span class="codeReserved">input</span> id=<span class="codeString">&quot;inputAlias&quot;</span> required&gt;</td></tr>
  <tr><td>25</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>29</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>30</td><td>    Mensaje *</td></tr>
  <tr><td>31</td><td>    &lt;<span class="codeReserved">input</span> id=<span class="codeString">&quot;inputMensaje&quot;</span> required&gt;</td></tr>
  <tr><td>32</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>33</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">&quot;submit&quot;</span>&gt;Enviar&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>  &lt;<span class="codeReserved">pre</span> id=<span class="codeString">&quot;pre&quot;</span>&gt;&lt;/<span class="codeReserved">pre</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">&quot;module&quot;</span>&gt;</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td>  <span class="codeReserved">import</span> { creaClientIdMqtt } <span class="codeReserved">from</span> <span class="codeString">&quot;./lib/js/creaClientIdMqtt.js&quot;</span></td></tr>
  <tr><td>46</td><td>  <span class="codeReserved">import</span> { falloEnLaConexionMqtt } <span class="codeReserved">from</span> <span class="codeString">&quot;./lib/js/falloEnLaConexionMqtt.js&quot;</span></td></tr>
  <tr><td>47</td><td>  <span class="codeReserved">import</span> { conexionMqttPerdida } <span class="codeReserved">from</span> <span class="codeString">&quot;./lib/js/conexionMqttPerdida.js&quot;</span></td></tr>
  <tr><td>48</td><td>  <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">&quot;./lib/js/muestraError.js&quot;</span></td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>  <span class="codeReserved">const</span> TOPICO_CHAT = <span class="codeString">&quot;gilpgawoas/chat&quot;</span></td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Cambia por una raÃ­z para tu proyecto.</span></td></tr>
  <tr><td>53</td><td>  <span class="codeReserved">const</span> clientId = creaClientIdMqtt(<span class="codeString">&quot;gilpgawoasChat-&quot;</span>)</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>  <span class="codeComment">// Si usas un servidor de MQTT diferente, necesitas cambiar los parÃ¡metros.</span></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">const</span> cliente = <span class="codeReserved">new</span> Paho.MQTT.Client(<span class="codeString">&quot;test.mosquitto.org&quot;</span>, 8081, clientId)</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>59</td><td><span class="codeComment">   * @param {Event} event</span></td></tr>
  <tr><td>60</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>61</td><td>  <span class="codeReserved">function</span> formActivada(event) {</td></tr>
  <tr><td>62</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>63</td><td>    event.preventDefault()</td></tr>
  <tr><td>64</td><td>    <span class="codeReserved">const</span> mensaje = <span class="codeString">`${inputAlias.value.trim()}</span></td></tr>
  <tr><td>65</td><td><span class="codeString">${inputMensaje.value.trim()}`</span></td></tr>
  <tr><td>66</td><td>    enviaMensajeMqtt(mensaje, TOPICO_CHAT)</td></tr>
  <tr><td>67</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>68</td><td>    muestraError(error)</td></tr>
  <tr><td>69</td><td>   }</td></tr>
  <tr><td>70</td><td>  }</td></tr>
  <tr><td>71</td><td>  <span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>72</td><td>  window[<span class="codeString">&quot;formActivada&quot;</span>] = formActivada</td></tr>
  <tr><td>73</td><td></td></tr>
  <tr><td>74</td><td>  <span class="codeComment">// Acciones al recibir un mensaje.</span></td></tr>
  <tr><td>75</td><td>  cliente.onMessageArrived = mensaje =&gt; {</td></tr>
  <tr><td>76</td><td>   <span class="codeReserved">if</span> (mensaje.destinationName === TOPICO_CHAT) {</td></tr>
  <tr><td>77</td><td>    pre.textContent += mensaje.payloadString + <span class="codeString">&quot;\n\n&quot;</span></td></tr>
  <tr><td>78</td><td>   }</td></tr>
  <tr><td>79</td><td>  }</td></tr>
  <tr><td>80</td><td></td></tr>
  <tr><td>81</td><td>  <span class="codeComment">// Acciones al perder la conexiÃ³n.</span></td></tr>
  <tr><td>82</td><td>  cliente.onConnectionLost = conexionMqttPerdida</td></tr>
  <tr><td>83</td><td></td></tr>
  <tr><td>84</td><td>  <span class="codeComment">// Configura el cliente.</span></td></tr>
  <tr><td>85</td><td>  cliente.connect({</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   keepAliveInterval: 10,</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>   useSSL: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>   <span class="codeComment">// Acciones al fallar la conexiÃ³n.</span></td></tr>
  <tr><td>92</td><td>   onFailure: falloEnLaConexionMqtt,</td></tr>
  <tr><td>93</td><td></td></tr>
  <tr><td>94</td><td>   <span class="codeComment">// Acciones al lograr la conexiÃ³n.</span></td></tr>
  <tr><td>95</td><td>   onSuccess: () =&gt; {</td></tr>
  <tr><td>96</td><td>    console.log(<span class="codeString">&quot;Conectado&quot;</span>)</td></tr>
  <tr><td>97</td><td>    <span class="codeComment">// Se suscribe a uno o mÃ¡s tÃ³picos.</span></td></tr>
  <tr><td>98</td><td>    cliente.subscribe(TOPICO_CHAT)</td></tr>
  <tr><td>99</td><td>   },</td></tr>
  <tr><td>100</td><td></td></tr>
  <tr><td>101</td><td>  })</td></tr>
  <tr><td>102</td><td></td></tr>
  <tr><td>103</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>104</td><td><span class="codeComment">   * EnvÃ¡ un valor al servidor de MQTT y es reenviado a todos los dispositivos</span></td></tr>
  <tr><td>105</td><td><span class="codeComment">   * suscritos al tÃ³pico indicado</span></td></tr>
  <tr><td>106</td><td><span class="codeComment">   * @param {string} mensaje</span></td></tr>
  <tr><td>107</td><td><span class="codeComment">   * @param {string} topico</span></td></tr>
  <tr><td>108</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>109</td><td>  <span class="codeReserved">function</span> enviaMensajeMqtt(mensaje, topico) {</td></tr>
  <tr><td>110</td><td>   <span class="codeReserved">const</span> mensajeMqtt = <span class="codeReserved">new</span> Paho.MQTT.Message(mensaje)</td></tr>
  <tr><td>111</td><td>   mensajeMqtt.destinationName = topico</td></tr>
  <tr><td>112</td><td>   cliente.send(mensajeMqtt)</td></tr>
  <tr><td>113</td><td>  }</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>116</td><td></td></tr>
  <tr><td>117</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>118</td><td></td></tr>
  <tr><td>119</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >F. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m14chat/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m14chat/m-lib/m-js/m-conexionMqttPerdida-js.html">lib / js / conexionMqttPerdida.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-lib/m-js/m-creaClientIdMqtt-js.html">lib / js / creaClientIdMqtt.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-lib/m-js/m-falloEnLaConexionMqtt-js.html">lib / js / falloEnLaConexionMqtt.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / conexionMqttPerdida.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { {</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> *  errorCode: number,</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> *  errorMessage: string</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * } } responseObject</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>7</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> conexionMqttPerdida(responseObject) {</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">if</span> (responseObject.errorCode !== 0) {</td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">const</span> mensaje = <span class="codeString">"ConexiÃ³n terminada "</span> + responseObject.errorMessage</td></tr>
  <tr><td>10</td><td>  console.error(mensaje)</td></tr>
  <tr><td>11</td><td>  alert(mensaje)</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td>}</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>16</td><td>window[<span class="codeString">"conexionMqttPerdida"</span>] = conexionMqttPerdida</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / creaClientIdMqtt.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * AÃ±ade caracteres al azar a una raÃ­z, para obtener un clientId Ãºnico por cada</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * instancia que se conecte al servidor de mqtt.</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} raiz </span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>6</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> creaClientIdMqtt(raiz) {</td></tr>
  <tr><td>7</td><td> <span class="codeReserved">const</span> chars = <span class="codeString">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"</span></td></tr>
  <tr><td>8</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">var</span> i = 0; i &lt; 15; i++) {</td></tr>
  <tr><td>9</td><td>  raiz += chars.charAt(Math.floor(Math.random() * chars.length))</td></tr>
  <tr><td>10</td><td> }</td></tr>
  <tr><td>11</td><td> <span class="codeReserved">return</span> raiz</td></tr>
  <tr><td>12</td><td>}</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>15</td><td>window[<span class="codeString">"creaClientIdMqtt"</span>] = creaClientIdMqtt</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / falloEnLaConexionMqtt.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { { errorMessage: string } } res</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> falloEnLaConexionMqtt(res) {</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">const</span> mensaje = <span class="codeString">"Fallo en conexiÃ³n:"</span> + res.errorMessage</td></tr>
  <tr><td>6</td><td> console.error(mensaje)</td></tr>
  <tr><td>7</td><td> alert(mensaje)</td></tr>
  <tr><td>8</td><td>}</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>11</td><td>window[<span class="codeString">"falloEnLaConexionMqtt"</span>] = falloEnLaConexionMqtt</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section >
         <h1 >G. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >H. Carpeta Â« paho.javascript-1.0.3 Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m14chat/m-paho.javascript-1.0.3/m-about-html.html">paho.javascript-1.0.3 / about.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-paho.javascript-1.0.3/m-CONTRIBUTING-md.html">paho.javascript-1.0.3 / CONTRIBUTING.md</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-paho.javascript-1.0.3/m-edl-v10.html">paho.javascript-1.0.3 / edl-v10</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-paho.javascript-1.0.3/m-epl-v10.html">paho.javascript-1.0.3 / epl-v10</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-paho.javascript-1.0.3/m-paho-mqtt-min-js.html">paho.javascript-1.0.3 / paho-mqtt-min.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m14chat/m-paho.javascript-1.0.3/m-paho-mqtt-js.html">paho.javascript-1.0.3 / paho-mqtt.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. paho.javascript-1.0.3 / about.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html PUBLIC <span class="codeString">"-//W3C//DTD XHTML 1.0 Strict//EN"</span> <span class="codeString">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"</span>&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> xmlns=<span class="codeString">"http://www.w3.org/1999/xhtml"</span>&gt;&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>3</td><td>&lt;<span class="codeReserved">meta</span> http-equiv=<span class="codeString">"Content-Type"</span> <span class="codeReserved">content</span>=<span class="codeString">"text/html; charset=ISO-8859-1"</span>&gt;</td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">title</span>&gt;About&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>5</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>6</td><td>&lt;<span class="codeReserved">body</span> lang=<span class="codeString">"EN-US"</span>&gt;</td></tr>
  <tr><td>7</td><td>&lt;<span class="codeReserved">h2</span>&gt;About This Content&lt;/<span class="codeReserved">h2</span>&gt;</td></tr>
  <tr><td>8</td><td> </td></tr>
  <tr><td>9</td><td>&lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">em</span>&gt;December 9, 2013&lt;/<span class="codeReserved">em</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;	</td></tr>
  <tr><td>10</td><td>&lt;<span class="codeReserved">h3</span>&gt;License&lt;/<span class="codeReserved">h3</span>&gt;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>&lt;<span class="codeReserved">p</span>&gt;The Eclipse Foundation makes available all <span class="codeReserved">content</span> <span class="codeReserved">in</span> <span class="codeReserved">this</span> plug-in (<span class="codeString">"Content"</span>).  Unless otherwise </td></tr>
  <tr><td>13</td><td>indicated below, the Content is provided to you under the terms and conditions of the</td></tr>
  <tr><td>14</td><td>Eclipse Public License Version 1.0 (<span class="codeString">"EPL"</span>) and Eclipse Distribution License Version 1.0 (<span class="codeString">"EDL"</span>).</td></tr>
  <tr><td>15</td><td>A copy of the EPL is available at </td></tr>
  <tr><td>16</td><td>&lt;<span class="codeReserved">a</span> href=<span class="codeString">"http://www.eclipse.org/legal/epl-v10.html"</span>&gt;http:<span class="codeComment">//www.eclipse.org/legal/epl-v10.html&lt;/a&gt; </span></td></tr>
  <tr><td>17</td><td>and a copy of the EDL is available at </td></tr>
  <tr><td>18</td><td>&lt;<span class="codeReserved">a</span> href=<span class="codeString">"http://www.eclipse.org/org/documents/edl-v10.php"</span>&gt;http:<span class="codeComment">//www.eclipse.org/org/documents/edl-v10.php&lt;/a&gt;. </span></td></tr>
  <tr><td>19</td><td>For purposes of the EPL, <span class="codeString">"Program"</span> will mean the Content.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;<span class="codeReserved">p</span>&gt;If you did not receive <span class="codeReserved">this</span> Content directly <span class="codeReserved">from</span> the Eclipse Foundation, the Content is </td></tr>
  <tr><td>22</td><td>being redistributed by another party (<span class="codeString">"Redistributor"</span>) and different terms and conditions may</td></tr>
  <tr><td>23</td><td>apply to your use of any object code <span class="codeReserved">in</span> the Content.  Check the Redistributor's license that was </td></tr>
  <tr><td>24</td><td>provided with the Content.  If no such license exists, contact the Redistributor.  Unless otherwise</td></tr>
  <tr><td>25</td><td>indicated below, the terms and conditions of the EPL still apply to any source code <span class="codeReserved">in</span> the Content</td></tr>
  <tr><td>26</td><td>and such source code may be obtained at &lt;<span class="codeReserved">a</span> href=<span class="codeString">"http://www.eclipse.org/"</span>&gt;http:<span class="codeComment">//www.eclipse.org&lt;/a&gt;.&lt;/p&gt;</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>&lt;/<span class="codeReserved">body</span>&gt;&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. paho.javascript-1.0.3 / CONTRIBUTING.md</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td># Contributing to Paho</td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td>Thanks for your interest in this project!</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td>You can contribute bugfixes and new features by sending pull requests through GitHub.</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td>## Legal</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>In order for your contribution to be accepted, it must comply with the Eclipse Foundation IP policy.</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>Please read the [Eclipse Foundation policy on accepting contributions via Git](http://wiki.eclipse.org/Development_Resources/Contributing_via_Git).</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>1. Sign the [Eclipse CLA](http://www.eclipse.org/legal/CLA.php)</td></tr>
  <tr><td>14</td><td>  1. Register for an Eclipse Foundation User ID. You can register [here](https://dev.eclipse.org/site_login/createaccount.php).</td></tr>
  <tr><td>15</td><td>  2. Log into the [Projects Portal](https://projects.eclipse.org/), and click on the '[Eclipse CLA](https://projects.eclipse.org/user/sign/cla)' link.</td></tr>
  <tr><td>16</td><td>2. Go to your [account settings](https://dev.eclipse.org/site_login/myaccount.php#open_tab_accountsettings) and add your GitHub username to your account.</td></tr>
  <tr><td>17</td><td>3. Make sure that you _sign-off_ your Git commits in the following format:</td></tr>
  <tr><td>18</td><td>  ``` Signed-off-by: John Smith <johnsmith@nowhere.com> ``` This is usually at the bottom of the commit message. You can automate this by adding the '-s' flag when you make the commits. e.g.   ```git commit -s -m "Adding a cool feature"```</td></tr>
  <tr><td>19</td><td>4. Ensure that the email address that you make your commits with is the same one you used to sign up to the Eclipse Foundation website with.</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>## Contributing a change</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>## Contributing a change</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>1. [Fork the repository on GitHub](https://github.com/eclipse/paho.mqtt.javascript/fork)</td></tr>
  <tr><td>26</td><td>2. Clone the forked repository onto your computer: ``` git clone https://github.com/<your username>/paho.mqtt.javascript.git ```</td></tr>
  <tr><td>27</td><td>3. Create a new branch from the latest ```develop``` branch with ```git checkout -b YOUR_BRANCH_NAME origin/develop```</td></tr>
  <tr><td>28</td><td>4. Make your changes</td></tr>
  <tr><td>29</td><td>5. If developing a new feature, make sure to include JUnit tests.</td></tr>
  <tr><td>30</td><td>6. Ensure that all new and existing tests pass.</td></tr>
  <tr><td>31</td><td>7. Commit the changes into the branch: ``` git commit -s ``` Make sure that your commit message is meaningful and describes your changes correctly.</td></tr>
  <tr><td>32</td><td>8. If you have a lot of commits for the change, squash them into a single / few commits.</td></tr>
  <tr><td>33</td><td>9. Push the changes in your branch to your forked repository.</td></tr>
  <tr><td>34</td><td>10. Finally, go to [https://github.com/eclipse/paho.mqtt.javascript](https://github.com/eclipse/paho.mqtt.javascript) and create a pull request from your "YOUR_BRANCH_NAME" branch to the ```develop``` one to request review and merge of the commits in your pushed branch.</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>What happens next depends on the content of the patch. If it is 100% authored</td></tr>
  <tr><td>38</td><td>by the contributor and is less than 1000 lines (and meets the needs of the</td></tr>
  <tr><td>39</td><td>project), then it can be pulled into the main repository. If not, more steps</td></tr>
  <tr><td>40</td><td>are required. These are detailed in the</td></tr>
  <tr><td>41</td><td>[legal process poster](http://www.eclipse.org/legal/EclipseLegalProcessPoster.pdf).</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td>## Developer resources:</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>Information regarding source code management, builds, coding standards, and more.</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>- [https://projects.eclipse.org/projects/iot.paho/developer](https://projects.eclipse.org/projects/iot.paho/developer)</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td>Contact:</td></tr>
  <tr><td>53</td><td>--------</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>Contact the project developers via the project's development</td></tr>
  <tr><td>56</td><td>[mailing list](https://dev.eclipse.org/mailman/listinfo/paho-dev).</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>Search for bugs:</td></tr>
  <tr><td>59</td><td>----------------</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>This project uses GitHub Issues here: [github.com/eclipse/paho.mqtt.javascript/issues](https://github.com/eclipse/paho.mqtt.javascript/issues) to track ongoing development and issues.</td></tr>
  <tr><td>62</td><td></td></tr>
  <tr><td>63</td><td>Create a new bug:</td></tr>
  <tr><td>64</td><td>-----------------</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>Be sure to search for existing bugs before you create another one. Remember that contributions are always welcome!</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>- [Create new Paho bug](https://github.com/eclipse/paho.mqtt.javascript/issues/new)</td></tr>
  <tr><td>69</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. paho.javascript-1.0.3 / edl-v10</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td></td></tr>
  <tr><td>2</td><td>Eclipse Distribution License - v 1.0</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>Copyright (c) 2007, Eclipse Foundation, Inc. and its licensors.</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td>All rights reserved.</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td>    Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</td></tr>
  <tr><td>11</td><td>    Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</td></tr>
  <tr><td>12</td><td>    Neither the name of the Eclipse Foundation, Inc. nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. </td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. paho.javascript-1.0.3 / epl-v10</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>Eclipse Public License - v 1.0</td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td>THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE PUBLIC LICENSE (&quot;AGREEMENT&quot;). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT&#039;S ACCEPTANCE OF THIS AGREEMENT.</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td>1. DEFINITIONS</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td>&quot;Contribution&quot; means:</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>a) in the case of the initial Contributor, the initial code and documentation distributed under this Agreement, and</td></tr>
  <tr><td>10</td><td>b) in the case of each subsequent Contributor:</td></tr>
  <tr><td>11</td><td>i) changes to the Program, and</td></tr>
  <tr><td>12</td><td>ii) additions to the Program;</td></tr>
  <tr><td>13</td><td>where such changes and/or additions to the Program originate from and are distributed by that particular Contributor. A Contribution &#039;originates&#039; from a Contributor if it was added to the Program by such Contributor itself or anyone acting on such Contributor&#039;s behalf. Contributions do not include additions to the Program which: (i) are separate modules of software distributed in conjunction with the Program under their own license agreement, and (ii) are not derivative works of the Program.</td></tr>
  <tr><td>14</td><td>&quot;Contributor&quot; means any person or entity that distributes the Program.</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td>&quot;Licensed Patents&quot; mean patent claims licensable by a Contributor which are necessarily infringed by the use or sale of its Contribution alone or when combined with the Program.</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>&quot;Program&quot; means the Contributions distributed in accordance with this Agreement.</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td>&quot;Recipient&quot; means anyone who receives the Program under this Agreement, including all Contributors.</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>2. GRANT OF RIGHTS</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>a) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, distribute and sublicense the Contribution of such Contributor, if any, and such derivative works, in source code and object code form.</td></tr>
  <tr><td>25</td><td>b) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free patent license under Licensed Patents to make, use, sell, offer to sell, import and otherwise transfer the Contribution of such Contributor, if any, in source code and object code form. This patent license shall apply to the combination of the Contribution and the Program if, at the time the Contribution is added by the Contributor, such addition of the Contribution causes such combination to be covered by the Licensed Patents. The patent license shall not apply to any other combinations which include the Contribution. No hardware per se is licensed hereunder.</td></tr>
  <tr><td>26</td><td>c) Recipient understands that although each Contributor grants the licenses to its Contributions set forth herein, no assurances are provided by any Contributor that the Program does not infringe the patent or other intellectual property rights of any other entity. Each Contributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow Recipient to distribute the Program, it is Recipient&#039;s responsibility to acquire that license before distributing the Program.</td></tr>
  <tr><td>27</td><td>d) Each Contributor represents that to its knowledge it has sufficient copyright rights in its Contribution, if any, to grant the copyright license set forth in this Agreement.</td></tr>
  <tr><td>28</td><td>3. REQUIREMENTS</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>A Contributor may choose to distribute the Program in object code form under its own license agreement, provided that:</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>a) it complies with the terms and conditions of this Agreement; and</td></tr>
  <tr><td>33</td><td>b) its license agreement:</td></tr>
  <tr><td>34</td><td>i) effectively disclaims on behalf of all Contributors all warranties and conditions, express and implied, including warranties or conditions of title and non-infringement, and implied warranties or conditions of merchantability and fitness for a particular purpose;</td></tr>
  <tr><td>35</td><td>ii) effectively excludes on behalf of all Contributors all liability for damages, including direct, indirect, special, incidental and consequential damages, such as lost profits;</td></tr>
  <tr><td>36</td><td>iii) states that any provisions which differ from this Agreement are offered by that Contributor alone and not by any other party; and</td></tr>
  <tr><td>37</td><td>iv) states that source code for the Program is available from such Contributor, and informs licensees how to obtain it in a reasonable manner on or through a medium customarily used for software exchange.</td></tr>
  <tr><td>38</td><td>When the Program is made available in source code form:</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>a) it must be made available under this Agreement; and</td></tr>
  <tr><td>41</td><td>b) a copy of this Agreement must be included with each copy of the Program.</td></tr>
  <tr><td>42</td><td>Contributors may not remove or alter any copyright notices contained within the Program.</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td>Each Contributor must identify itself as the originator of its Contribution, if any, in a manner that reasonably allows subsequent Recipients to identify the originator of the Contribution.</td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td>4. COMMERCIAL DISTRIBUTION</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this license is intended to facilitate the commercial use of the Program, the Contributor who includes the Program in a commercial product offering should do so in a manner which does not create potential liability for other Contributors. Therefore, if a Contributor includes the Program in a commercial product offering, such Contributor (&quot;Commercial Contributor&quot;) hereby agrees to defend and indemnify every other Contributor (&quot;Indemnified Contributor&quot;) against any losses, damages and costs (collectively &quot;Losses&quot;) arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Contributor to the extent caused by the acts or omissions of such Commercial Contributor in connection with its distribution of the Program in a commercial product offering. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Contributor must: a) promptly notify the Commercial Contributor in writing of such claim, and b) allow the Commercial Contributor to control, and cooperate with the Commercial Contributor in, the defense and any related settlement negotiations. The Indemnified Contributor may participate in any such claim at its own expense.</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>For example, a Contributor might include the Program in a commercial product offering, Product X. That Contributor is then a Commercial Contributor. If that Commercial Contributor then makes performance claims, or offers warranties related to Product X, those performance claims and warranties are such Commercial Contributor&#039;s responsibility alone. Under this section, the Commercial Contributor would have to defend claims against the other Contributors related to those performance claims and warranties, and if a court requires any other Contributor to pay any damages as a result, the Commercial Contributor must pay those damages.</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td>5. NO WARRANTY</td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, THE PROGRAM IS PROVIDED ON AN &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely responsible for determining the appropriateness of using and distributing the Program and assumes all risks associated with its exercise of rights under this Agreement , including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations.</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>6. DISCLAIMER OF LIABILITY</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</td></tr>
  <tr><td>59</td><td></td></tr>
  <tr><td>60</td><td>7. GENERAL</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>If any provision of this Agreement is invalid or unenforceable under applicable law, it shall not affect the validity or enforceability of the remainder of the terms of this Agreement, and without further action by the parties hereto, such provision shall be reformed to the minimum extent necessary to make such provision valid and enforceable.</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>If Recipient institutes patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Program itself (excluding combinations of the Program with other software or hardware) infringes such Recipient&#039;s patent(s), then such Recipient&#039;s rights granted under Section 2(b) shall terminate as of the date such litigation is filed.</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>All Recipient&#039;s rights under this Agreement shall terminate if it fails to comply with any of the material terms or conditions of this Agreement and does not cure such failure in a reasonable period of time after becoming aware of such noncompliance. If all Recipient&#039;s rights under this Agreement terminate, Recipient agrees to cease use and distribution of the Program as soon as reasonably practicable. However, Recipient&#039;s obligations under this Agreement and any licenses granted by Recipient relating to the Program shall continue and survive.</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>Everyone is permitted to copy and distribute copies of this Agreement, but in order to avoid inconsistency the Agreement is copyrighted and may only be modified in the following manner. The Agreement Steward reserves the right to publish new versions (including revisions) of this Agreement from time to time. No one other than the Agreement Steward has the right to modify this Agreement. The Eclipse Foundation is the initial Agreement Steward. The Eclipse Foundation may assign the responsibility to serve as the Agreement Steward to a suitable separate entity. Each new version of the Agreement will be given a distinguishing version number. The Program (including Contributions) may always be distributed subject to the version of the Agreement under which it was received. In addition, after a new version of the Agreement is published, Contributor may elect to distribute the Program (including its Contributions) under the new version. Except as expressly stated in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to the intellectual property of any Contributor under this Agreement, whether expressly, by implication, estoppel or otherwise. All rights in the Program not expressly granted under this Agreement are reserved.</td></tr>
  <tr><td>69</td><td></td></tr>
  <tr><td>70</td><td>This Agreement is governed by the laws of the State of New York and the intellectual property laws of the United States of America. No party to this Agreement will bring a legal action under this Agreement more than one year after the cause of action arose. Each party waives its rights to a jury trial in any resulting litigation.</td></tr>
  <tr><td>71</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. paho.javascript-1.0.3 / paho-mqtt-min.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/*******************************************************************************</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * Copyright (c) 2013, 2016 IBM Corp.</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * All rights reserved. This program and the accompanying materials</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * are made available under the terms of the Eclipse Public License v1.0</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * and Eclipse Distribution License v1.0 which accompany <span class="codeReserved">this</span> distribution.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * The Eclipse Public License is available at</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *    http:<span class="codeComment">//www.eclipse.org/legal/epl-v10.html</span></span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> * and the Eclipse Distribution License is available at</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> *   http:<span class="codeComment">//www.eclipse.org/org/documents/edl-v10.php.</span></span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> *******************************************************************************/</span></td></tr>
  <tr><td>14</td><td>(<span class="codeReserved">function</span>(p,s){<span class="codeString">&quot;object&quot;</span>===<span class="codeReserved">typeof</span> exports&&<span class="codeString">&quot;object&quot;</span>===<span class="codeReserved">typeof</span> module?module.exports=s():<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>===<span class="codeReserved">typeof</span> define&&define.amd?define(s):<span class="codeString">&quot;object&quot;</span>===<span class="codeReserved">typeof</span> exports?exports=s():(<span class="codeString">&quot;undefined&quot;</span>===<span class="codeReserved">typeof</span> p.Paho&&(p.Paho={}),p.Paho.MQTT=s())})(<span class="codeReserved">this</span>,<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> <span class="codeReserved">function</span>(p){<span class="codeReserved">function</span> s(a,b,c){b[c++]=a&gt;&gt;8;b[c++]=a%256;<span class="codeReserved">return</span> c}<span class="codeReserved">function</span> u(a,b,c,k){k=s(b,c,k);D(a,c,k);<span class="codeReserved">return</span> k+b}<span class="codeReserved">function</span> n(a){<span class="codeReserved">for</span>(var b=0,c=0;c&lt;<span class="codeReserved">a</span>.length;c++){var k=a.charCodeAt(c);2047&lt;<span class="codeReserved">k</span>?(55296&lt;=k&&56319&gt;=k&&(c++,b++),b+=3):127&lt;<span class="codeReserved">k</span>?b+=2:b++}<span class="codeReserved">return</span> b}</td></tr>
  <tr><td>15</td><td><span class="codeReserved">function</span> D(a,b,c){<span class="codeReserved">for</span>(var k=0;k&lt;<span class="codeReserved">a</span>.length;k++){var e=a.charCodeAt(k);<span class="codeReserved">if</span>(55296&lt;=e&&56319&gt;=e){var g=a.charCodeAt(++k);<span class="codeReserved">if</span>(isNaN(g))<span class="codeReserved">throw</span> Error(f(h.MALFORMED_UNICODE,[e,g]));e=(e-55296&lt;&lt;<span class="codeReserved">10</span>)+(g-56320)+65536}127&gt;=e?b[c++]=e:(2047&gt;=e?b[c++]=e&gt;&gt;6&31|192:(65535&gt;=e?b[c++]=e&gt;&gt;12&15|224:(b[c++]=e&gt;&gt;18&7|240,b[c++]=e&gt;&gt;12&63|128),b[c++]=e&gt;&gt;6&63|128),b[c++]=e&63|128)}<span class="codeReserved">return</span> b}<span class="codeReserved">function</span> E(a,b,c){<span class="codeReserved">for</span>(var k=<span class="codeString">&quot;&quot;</span>,e,g=b;g&lt;<span class="codeReserved">b</span>+c;){e=a[g++];<span class="codeReserved">if</span>(!(128&gt;e)){var m=a[g++]-128;<span class="codeReserved">if</span>(0&gt;m)<span class="codeReserved">throw</span> Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),</td></tr>
  <tr><td>16</td><td><span class="codeString">&quot;&quot;</span>]));<span class="codeReserved">if</span>(224&gt;e)e=64*(e-192)+m;<span class="codeReserved">else</span>{var d=a[g++]-128;<span class="codeReserved">if</span>(0&gt;d)<span class="codeReserved">throw</span> Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),d.toString(16)]));<span class="codeReserved">if</span>(240&gt;e)e=4096*(e-224)+64*m+d;<span class="codeReserved">else</span>{var l=a[g++]-128;<span class="codeReserved">if</span>(0&gt;l)<span class="codeReserved">throw</span> Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),d.toString(16),l.toString(16)]));<span class="codeReserved">if</span>(248&gt;e)e=262144*(e-240)+4096*m+64*d+l;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),d.toString(16),l.toString(16)]));}}}65535&lt;<span class="codeReserved">e</span>&&(e-=65536,k+=String.fromCharCode(55296+(e&gt;&gt;10)),e=56320+(e&</td></tr>
  <tr><td>17</td><td>1023));k+=String.fromCharCode(e)}<span class="codeReserved">return</span> k}var z=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">for</span>(var c <span class="codeReserved">in</span> a)<span class="codeReserved">if</span>(a.hasOwnProperty(c))<span class="codeReserved">if</span>(b.hasOwnProperty(c)){<span class="codeReserved">if</span>(<span class="codeReserved">typeof</span> a[c]!==b[c])<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a[c],c]));}<span class="codeReserved">else</span>{c=<span class="codeString">&quot;Unknown property, &quot;</span>+c+<span class="codeString">&quot;. Valid properties are:&quot;</span>;<span class="codeReserved">for</span>(var k <span class="codeReserved">in</span> b)b.hasOwnProperty(k)&&(c=c+<span class="codeString">&quot; &quot;</span>+k);<span class="codeReserved">throw</span> Error(c);}},v=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">return</span> <span class="codeReserved">function</span>(){<span class="codeReserved">return</span> a.apply(b,arguments)}},h={OK:{code:0,text:<span class="codeString">&quot;AMQJSC0000I OK.&quot;</span>},CONNECT_TIMEOUT:{code:1,text:<span class="codeString">&quot;AMQJSC0001E Connect timed out.&quot;</span>},SUBSCRIBE_TIMEOUT:{code:2,</td></tr>
  <tr><td>18</td><td>text:<span class="codeString">&quot;AMQJS0002E Subscribe timed out.&quot;</span>},UNSUBSCRIBE_TIMEOUT:{code:3,text:<span class="codeString">&quot;AMQJS0003E Unsubscribe timed out.&quot;</span>},PING_TIMEOUT:{code:4,text:<span class="codeString">&quot;AMQJS0004E Ping timed out.&quot;</span>},INTERNAL_ERROR:{code:5,text:<span class="codeString">&quot;AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}&quot;</span>},CONNACK_RETURNCODE:{code:6,text:<span class="codeString">&quot;AMQJS0006E Bad Connack <span class="codeReserved">return</span> code:{0} {1}.&quot;</span>},SOCKET_ERROR:{code:7,text:<span class="codeString">&quot;AMQJS0007E Socket error:{0}.&quot;</span>},SOCKET_CLOSE:{code:8,text:<span class="codeString">&quot;AMQJS0008I Socket closed.&quot;</span>},MALFORMED_UTF:{code:9,text:<span class="codeString">&quot;AMQJS0009E Malformed UTF data:{0} {1} {2}.&quot;</span>},</td></tr>
  <tr><td>19</td><td>UNSUPPORTED:{code:10,text:<span class="codeString">&quot;AMQJS0010E {0} is not supported by <span class="codeReserved">this</span> browser.&quot;</span>},INVALID_STATE:{code:11,text:<span class="codeString">&quot;AMQJS0011E Invalid state {0}.&quot;</span>},INVALID_TYPE:{code:12,text:<span class="codeString">&quot;AMQJS0012E Invalid type {0} <span class="codeReserved">for</span> {1}.&quot;</span>},INVALID_ARGUMENT:{code:13,text:<span class="codeString">&quot;AMQJS0013E Invalid argument {0} <span class="codeReserved">for</span> {1}.&quot;</span>},UNSUPPORTED_OPERATION:{code:14,text:<span class="codeString">&quot;AMQJS0014E Unsupported operation.&quot;</span>},INVALID_STORED_DATA:{code:15,text:<span class="codeString">&quot;AMQJS0015E Invalid data <span class="codeReserved">in</span> local storage key\x3d{0} value\x3d{1}.&quot;</span>},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:<span class="codeString">&quot;AMQJS0016E Invalid MQTT message type {0}.&quot;</span>},</td></tr>
  <tr><td>20</td><td>MALFORMED_UNICODE:{code:17,text:<span class="codeString">&quot;AMQJS0017E Malformed Unicode string:{0} {1}.&quot;</span>},BUFFER_FULL:{code:18,text:<span class="codeString">&quot;AMQJS0018E Message buffer is full, maximum buffer size: {0}.&quot;</span>}},H={0:<span class="codeString">&quot;Connection Accepted&quot;</span>,1:<span class="codeString">&quot;Connection Refused: unacceptable protocol version&quot;</span>,2:<span class="codeString">&quot;Connection Refused: identifier rejected&quot;</span>,3:<span class="codeString">&quot;Connection Refused: server unavailable&quot;</span>,4:<span class="codeString">&quot;Connection Refused: bad user name or password&quot;</span>,5:<span class="codeString">&quot;Connection Refused: not authorized&quot;</span>},f=<span class="codeReserved">function</span>(a,b){var c=a.text;<span class="codeReserved">if</span>(b)<span class="codeReserved">for</span>(var k,e,g=0;g&lt;<span class="codeReserved">b</span>.length;g++)<span class="codeReserved">if</span>(k=<span class="codeString">&quot;{&quot;</span>+</td></tr>
  <tr><td>21</td><td>g+<span class="codeString">&quot;}&quot;</span>,e=c.indexOf(k),0&lt;<span class="codeReserved">e</span>)var h=c.substring(0,e),c=c.substring(e+k.length),c=h+b[g]+c;<span class="codeReserved">return</span> c},A=[0,6,77,81,73,115,100,112,3],B=[0,4,77,81,84,84,4],q=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">this</span>.type=a;<span class="codeReserved">for</span>(var c <span class="codeReserved">in</span> b)b.hasOwnProperty(c)&&(<span class="codeReserved">this</span>[c]=b[c])};q.prototype.encode=<span class="codeReserved">function</span>(){var a=(<span class="codeReserved">this</span>.type&15)&lt;&lt;<span class="codeReserved">4</span>,b=0,c=[],k=0,e;void 0!==<span class="codeReserved">this</span>.messageIdentifier&&(b+=2);<span class="codeReserved">switch</span>(<span class="codeReserved">this</span>.type){<span class="codeReserved">case</span> 1:<span class="codeReserved">switch</span>(<span class="codeReserved">this</span>.mqttVersion){<span class="codeReserved">case</span> 3:b+=A.length+3;<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 4:b+=B.length+3}b+=n(<span class="codeReserved">this</span>.clientId)+2;void 0!==<span class="codeReserved">this</span>.willMessage&&(b+=n(<span class="codeReserved">this</span>.willMessage.destinationName)+</td></tr>
  <tr><td>22</td><td>2,e=<span class="codeReserved">this</span>.willMessage.payloadBytes,e <span class="codeReserved">instanceof</span> Uint8Array||(e=<span class="codeReserved">new</span> Uint8Array(h)),b+=e.byteLength+2);void 0!==<span class="codeReserved">this</span>.userName&&(b+=n(<span class="codeReserved">this</span>.userName)+2);void 0!==<span class="codeReserved">this</span>.password&&(b+=n(<span class="codeReserved">this</span>.password)+2);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 8:<span class="codeReserved">for</span>(var a=a|2,g=0;g&lt;<span class="codeReserved">this</span>.topics.length;g++)c[g]=n(<span class="codeReserved">this</span>.topics[g]),b+=c[g]+2;b+=<span class="codeReserved">this</span>.requestedQos.length;<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 10:a|=2;<span class="codeReserved">for</span>(g=0;g&lt;<span class="codeReserved">this</span>.topics.length;g++)c[g]=n(<span class="codeReserved">this</span>.topics[g]),b+=c[g]+2;<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 6:a|=2;<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 3:<span class="codeReserved">this</span>.payloadMessage.duplicate&&(a|=8);a=a|=<span class="codeReserved">this</span>.payloadMessage.qos&lt;&lt;<span class="codeReserved">1</span>;<span class="codeReserved">this</span>.payloadMessage.retained&&</td></tr>
  <tr><td>23</td><td>(a|=1);var k=n(<span class="codeReserved">this</span>.payloadMessage.destinationName),h=<span class="codeReserved">this</span>.payloadMessage.payloadBytes,b=b+(k+2)+h.byteLength;h <span class="codeReserved">instanceof</span> ArrayBuffer?h=<span class="codeReserved">new</span> Uint8Array(h):h <span class="codeReserved">instanceof</span> Uint8Array||(h=<span class="codeReserved">new</span> Uint8Array(h.buffer))}var f=b,g=Array(1),d=0;<span class="codeReserved">do</span>{var t=f%128,f=f&gt;&gt;7;0&lt;<span class="codeReserved">f</span>&&(t|=128);g[d++]=t}<span class="codeReserved">while</span>(0&lt;<span class="codeReserved">f</span>&&4&gt;d);f=g.length+1;b=<span class="codeReserved">new</span> ArrayBuffer(b+f);d=<span class="codeReserved">new</span> Uint8Array(b);d[0]=a;d.set(g,1);<span class="codeReserved">if</span>(3==<span class="codeReserved">this</span>.type)f=u(<span class="codeReserved">this</span>.payloadMessage.destinationName,k,d,f);<span class="codeReserved">else</span> <span class="codeReserved">if</span>(1==<span class="codeReserved">this</span>.type){<span class="codeReserved">switch</span>(<span class="codeReserved">this</span>.mqttVersion){<span class="codeReserved">case</span> 3:d.set(A,f);f+=A.length;</td></tr>
  <tr><td>24</td><td><span class="codeReserved">break</span>;<span class="codeReserved">case</span> 4:d.set(B,f),f+=B.length}a=0;<span class="codeReserved">this</span>.cleanSession&&(a=2);void 0!==<span class="codeReserved">this</span>.willMessage&&(a=a|4|<span class="codeReserved">this</span>.willMessage.qos&lt;&lt;<span class="codeReserved">3</span>,<span class="codeReserved">this</span>.willMessage.retained&&(a|=32));void 0!==<span class="codeReserved">this</span>.userName&&(a|=128);void 0!==<span class="codeReserved">this</span>.password&&(a|=64);d[f++]=a;f=s(<span class="codeReserved">this</span>.keepAliveInterval,d,f)}void 0!==<span class="codeReserved">this</span>.messageIdentifier&&(f=s(<span class="codeReserved">this</span>.messageIdentifier,d,f));<span class="codeReserved">switch</span>(<span class="codeReserved">this</span>.type){<span class="codeReserved">case</span> 1:f=u(<span class="codeReserved">this</span>.clientId,n(<span class="codeReserved">this</span>.clientId),d,f);void 0!==<span class="codeReserved">this</span>.willMessage&&(f=u(<span class="codeReserved">this</span>.willMessage.destinationName,n(<span class="codeReserved">this</span>.willMessage.destinationName),d,f),</td></tr>
  <tr><td>25</td><td>f=s(e.byteLength,d,f),d.set(e,f),f+=e.byteLength);void 0!==<span class="codeReserved">this</span>.userName&&(f=u(<span class="codeReserved">this</span>.userName,n(<span class="codeReserved">this</span>.userName),d,f));void 0!==<span class="codeReserved">this</span>.password&&u(<span class="codeReserved">this</span>.password,n(<span class="codeReserved">this</span>.password),d,f);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 3:d.set(h,f);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 8:<span class="codeReserved">for</span>(g=0;g&lt;<span class="codeReserved">this</span>.topics.length;g++)f=u(<span class="codeReserved">this</span>.topics[g],c[g],d,f),d[f++]=<span class="codeReserved">this</span>.requestedQos[g];<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 10:<span class="codeReserved">for</span>(g=0;g&lt;<span class="codeReserved">this</span>.topics.length;g++)f=u(<span class="codeReserved">this</span>.topics[g],c[g],d,f)}<span class="codeReserved">return</span> b};var F=<span class="codeReserved">function</span>(a,b,c){<span class="codeReserved">this</span>._client=a;<span class="codeReserved">this</span>._window=b;<span class="codeReserved">this</span>._keepAliveInterval=1E3*c;<span class="codeReserved">this</span>.isReset=!1;var k=(<span class="codeReserved">new</span> q(12)).encode(),</td></tr>
  <tr><td>26</td><td>e=<span class="codeReserved">function</span>(a){<span class="codeReserved">return</span> <span class="codeReserved">function</span>(){<span class="codeReserved">return</span> g.apply(a)}},g=<span class="codeReserved">function</span>(){<span class="codeReserved">this</span>.isReset?(<span class="codeReserved">this</span>.isReset=!1,<span class="codeReserved">this</span>._client._trace(<span class="codeString">&quot;Pinger.doPing&quot;</span>,<span class="codeString">&quot;send PINGREQ&quot;</span>),<span class="codeReserved">this</span>._client.socket.send(k),<span class="codeReserved">this</span>.timeout=<span class="codeReserved">this</span>._window.setTimeout(e(<span class="codeReserved">this</span>),<span class="codeReserved">this</span>._keepAliveInterval)):(<span class="codeReserved">this</span>._client._trace(<span class="codeString">&quot;Pinger.doPing&quot;</span>,<span class="codeString">&quot;Timed out&quot;</span>),<span class="codeReserved">this</span>._client._disconnected(h.PING_TIMEOUT.code,f(h.PING_TIMEOUT)))};<span class="codeReserved">this</span>.reset=<span class="codeReserved">function</span>(){<span class="codeReserved">this</span>.isReset=!0;<span class="codeReserved">this</span>._window.clearTimeout(<span class="codeReserved">this</span>.timeout);0&lt;<span class="codeReserved">this</span>._keepAliveInterval&&(<span class="codeReserved">this</span>.timeout=setTimeout(e(<span class="codeReserved">this</span>),</td></tr>
  <tr><td>27</td><td><span class="codeReserved">this</span>._keepAliveInterval))};<span class="codeReserved">this</span>.cancel=<span class="codeReserved">function</span>(){<span class="codeReserved">this</span>._window.clearTimeout(<span class="codeReserved">this</span>.timeout)}},w=<span class="codeReserved">function</span>(a,b,c,f,e){<span class="codeReserved">this</span>._window=b;c||(c=30);<span class="codeReserved">this</span>.timeout=setTimeout(<span class="codeReserved">function</span>(a,b,c){<span class="codeReserved">return</span> <span class="codeReserved">function</span>(){<span class="codeReserved">return</span> a.apply(b,c)}}(f,a,e),1E3*c);<span class="codeReserved">this</span>.cancel=<span class="codeReserved">function</span>(){<span class="codeReserved">this</span>._window.clearTimeout(<span class="codeReserved">this</span>.timeout)}},d=<span class="codeReserved">function</span>(a,b,c,d,e){<span class="codeReserved">if</span>(!(<span class="codeString">&quot;WebSocket&quot;</span><span class="codeReserved">in</span> p&&<span class="codeReserved">null</span>!==p.WebSocket))<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED,[<span class="codeString">&quot;WebSocket&quot;</span>]));<span class="codeReserved">if</span>(!(<span class="codeString">&quot;localStorage&quot;</span><span class="codeReserved">in</span> p&&<span class="codeReserved">null</span>!==p.localStorage))<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED,[<span class="codeString">&quot;localStorage&quot;</span>]));</td></tr>
  <tr><td>28</td><td><span class="codeReserved">if</span>(!(<span class="codeString">&quot;ArrayBuffer&quot;</span><span class="codeReserved">in</span> p&&<span class="codeReserved">null</span>!==p.ArrayBuffer))<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED,[<span class="codeString">&quot;ArrayBuffer&quot;</span>]));<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Paho.MQTT.Client&quot;</span>,a,b,c,d,e);<span class="codeReserved">this</span>.host=b;<span class="codeReserved">this</span>.port=c;<span class="codeReserved">this</span>.path=d;<span class="codeReserved">this</span>.uri=a;<span class="codeReserved">this</span>.clientId=e;<span class="codeReserved">this</span>._wsuri=<span class="codeReserved">null</span>;<span class="codeReserved">this</span>._localKey=b+<span class="codeString">&quot;:&quot;</span>+c+(<span class="codeString">&quot;/mqtt&quot;</span>!=d?<span class="codeString">&quot;:&quot;</span>+d:<span class="codeString">&quot;&quot;</span>)+<span class="codeString">&quot;:&quot;</span>+e+<span class="codeString">&quot;:&quot;</span>;<span class="codeReserved">this</span>._msg_queue=[];<span class="codeReserved">this</span>._buffered_msg_queue=[];<span class="codeReserved">this</span>._sentMessages={};<span class="codeReserved">this</span>._receivedMessages={};<span class="codeReserved">this</span>._notify_msg_sent={};<span class="codeReserved">this</span>._message_identifier=1;<span class="codeReserved">this</span>._sequence=0;<span class="codeReserved">for</span>(var g <span class="codeReserved">in</span> localStorage)0!==g.indexOf(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey)&&0!==</td></tr>
  <tr><td>29</td><td>g.indexOf(<span class="codeString">&quot;Received:&quot;</span>+<span class="codeReserved">this</span>._localKey)||<span class="codeReserved">this</span>.restore(g)};d.prototype.host=<span class="codeReserved">null</span>;d.prototype.port=<span class="codeReserved">null</span>;d.prototype.path=<span class="codeReserved">null</span>;d.prototype.uri=<span class="codeReserved">null</span>;d.prototype.clientId=<span class="codeReserved">null</span>;d.prototype.socket=<span class="codeReserved">null</span>;d.prototype.connected=!1;d.prototype.maxMessageIdentifier=65536;d.prototype.connectOptions=<span class="codeReserved">null</span>;d.prototype.hostIndex=<span class="codeReserved">null</span>;d.prototype.onConnected=<span class="codeReserved">null</span>;d.prototype.onConnectionLost=<span class="codeReserved">null</span>;d.prototype.onMessageDelivered=<span class="codeReserved">null</span>;d.prototype.onMessageArrived=<span class="codeReserved">null</span>;d.prototype.traceFunction=<span class="codeReserved">null</span>;d.prototype._msg_queue=</td></tr>
  <tr><td>30</td><td><span class="codeReserved">null</span>;d.prototype._buffered_msg_queue=<span class="codeReserved">null</span>;d.prototype._connectTimeout=<span class="codeReserved">null</span>;d.prototype.sendPinger=<span class="codeReserved">null</span>;d.prototype.receivePinger=<span class="codeReserved">null</span>;d.prototype._reconnectInterval=1;d.prototype._reconnecting=!1;d.prototype._reconnectTimeout=<span class="codeReserved">null</span>;d.prototype.disconnectedPublishing=!1;d.prototype.disconnectedBufferSize=5E3;d.prototype.receiveBuffer=<span class="codeReserved">null</span>;d.prototype._traceBuffer=<span class="codeReserved">null</span>;d.prototype._MAX_TRACE_ENTRIES=100;d.prototype.connect=<span class="codeReserved">function</span>(a){var b=<span class="codeReserved">this</span>._traceMask(a,<span class="codeString">&quot;password&quot;</span>);<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.connect&quot;</span>,</td></tr>
  <tr><td>31</td><td>b,<span class="codeReserved">this</span>.socket,<span class="codeReserved">this</span>.connected);<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.connected)<span class="codeReserved">throw</span> Error(f(h.INVALID_STATE,[<span class="codeString">&quot;already connected&quot;</span>]));<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.socket)<span class="codeReserved">throw</span> Error(f(h.INVALID_STATE,[<span class="codeString">&quot;already connected&quot;</span>]));<span class="codeReserved">this</span>._reconnecting&&(<span class="codeReserved">this</span>._reconnectTimeout.cancel(),<span class="codeReserved">this</span>._reconnectTimeout=<span class="codeReserved">null</span>,<span class="codeReserved">this</span>._reconnecting=!1);<span class="codeReserved">this</span>.connectOptions=a;<span class="codeReserved">this</span>._reconnectInterval=1;<span class="codeReserved">this</span>._reconnecting=!1;a.uris?(<span class="codeReserved">this</span>.hostIndex=0,<span class="codeReserved">this</span>._doConnect(a.uris[0])):<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.uri)};d.prototype.subscribe=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.subscribe&quot;</span>,a,b);<span class="codeReserved">if</span>(!<span class="codeReserved">this</span>.connected)<span class="codeReserved">throw</span> Error(f(h.INVALID_STATE,</td></tr>
  <tr><td>32</td><td>[<span class="codeString">&quot;not connected&quot;</span>]));var c=<span class="codeReserved">new</span> q(8);c.topics=[a];c.requestedQos=void 0!==b.qos?[b.qos]:[0];b.onSuccess&&(c.onSuccess=<span class="codeReserved">function</span>(a){b.onSuccess({invocationContext:b.invocationContext,grantedQos:a})});b.onFailure&&(c.onFailure=<span class="codeReserved">function</span>(a){b.onFailure({invocationContext:b.invocationContext,errorCode:a,errorMessage:f(a)})});b.timeout&&(c.timeOut=<span class="codeReserved">new</span> w(<span class="codeReserved">this</span>,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:h.SUBSCRIBE_TIMEOUT.code,errorMessage:f(h.SUBSCRIBE_TIMEOUT)}]));<span class="codeReserved">this</span>._requires_ack(c);</td></tr>
  <tr><td>33</td><td><span class="codeReserved">this</span>._schedule_message(c)};d.prototype.unsubscribe=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.unsubscribe&quot;</span>,a,b);<span class="codeReserved">if</span>(!<span class="codeReserved">this</span>.connected)<span class="codeReserved">throw</span> Error(f(h.INVALID_STATE,[<span class="codeString">&quot;not connected&quot;</span>]));var c=<span class="codeReserved">new</span> q(10);c.topics=[a];b.onSuccess&&(c.callback=<span class="codeReserved">function</span>(){b.onSuccess({invocationContext:b.invocationContext})});b.timeout&&(c.timeOut=<span class="codeReserved">new</span> w(<span class="codeReserved">this</span>,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:h.UNSUBSCRIBE_TIMEOUT.code,errorMessage:f(h.UNSUBSCRIBE_TIMEOUT)}]));<span class="codeReserved">this</span>._requires_ack(c);<span class="codeReserved">this</span>._schedule_message(c)};</td></tr>
  <tr><td>34</td><td>d.prototype.send=<span class="codeReserved">function</span>(a){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.send&quot;</span>,a);wireMessage=<span class="codeReserved">new</span> q(3);wireMessage.payloadMessage=a;<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.connected)0&lt;<span class="codeReserved">a</span>.qos?<span class="codeReserved">this</span>._requires_ack(wireMessage):<span class="codeReserved">this</span>.onMessageDelivered&&(<span class="codeReserved">this</span>._notify_msg_sent[wireMessage]=<span class="codeReserved">this</span>.onMessageDelivered(wireMessage.payloadMessage)),<span class="codeReserved">this</span>._schedule_message(wireMessage);<span class="codeReserved">else</span> <span class="codeReserved">if</span>(<span class="codeReserved">this</span>._reconnecting&&<span class="codeReserved">this</span>.disconnectedPublishing){<span class="codeReserved">if</span>(Object.keys(<span class="codeReserved">this</span>._sentMessages).length+<span class="codeReserved">this</span>._buffered_msg_queue.length&gt;<span class="codeReserved">this</span>.disconnectedBufferSize)<span class="codeReserved">throw</span> Error(f(h.BUFFER_FULL,</td></tr>
  <tr><td>35</td><td>[<span class="codeReserved">this</span>.disconnectedBufferSize]));0&lt;<span class="codeReserved">a</span>.qos?<span class="codeReserved">this</span>._requires_ack(wireMessage):(wireMessage.sequence=++<span class="codeReserved">this</span>._sequence,<span class="codeReserved">this</span>._buffered_msg_queue.push(wireMessage))}<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_STATE,[<span class="codeString">&quot;not connected&quot;</span>]));};d.prototype.disconnect=<span class="codeReserved">function</span>(){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.disconnect&quot;</span>);<span class="codeReserved">this</span>._reconnecting&&(<span class="codeReserved">this</span>._reconnectTimeout.cancel(),<span class="codeReserved">this</span>._reconnectTimeout=<span class="codeReserved">null</span>,<span class="codeReserved">this</span>._reconnecting=!1);<span class="codeReserved">if</span>(!<span class="codeReserved">this</span>.socket)<span class="codeReserved">throw</span> Error(f(h.INVALID_STATE,[<span class="codeString">&quot;not connecting or connected&quot;</span>]));wireMessage=<span class="codeReserved">new</span> q(14);<span class="codeReserved">this</span>._notify_msg_sent[wireMessage]=</td></tr>
  <tr><td>36</td><td>v(<span class="codeReserved">this</span>._disconnected,<span class="codeReserved">this</span>);<span class="codeReserved">this</span>._schedule_message(wireMessage)};d.prototype.getTraceLog=<span class="codeReserved">function</span>(){<span class="codeReserved">if</span>(<span class="codeReserved">null</span>!==<span class="codeReserved">this</span>._traceBuffer){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.getTraceLog&quot;</span>,<span class="codeReserved">new</span> Date);<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.getTraceLog <span class="codeReserved">in</span> flight messages&quot;</span>,<span class="codeReserved">this</span>._sentMessages.length);<span class="codeReserved">for</span>(var a <span class="codeReserved">in</span> <span class="codeReserved">this</span>._sentMessages)<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;_sentMessages &quot;</span>,a,<span class="codeReserved">this</span>._sentMessages[a]);<span class="codeReserved">for</span>(a <span class="codeReserved">in</span> <span class="codeReserved">this</span>._receivedMessages)<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;_receivedMessages &quot;</span>,a,<span class="codeReserved">this</span>._receivedMessages[a]);<span class="codeReserved">return</span> <span class="codeReserved">this</span>._traceBuffer}};d.prototype.startTrace=<span class="codeReserved">function</span>(){<span class="codeReserved">null</span>===<span class="codeReserved">this</span>._traceBuffer&&</td></tr>
  <tr><td>37</td><td>(<span class="codeReserved">this</span>._traceBuffer=[]);<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.startTrace&quot;</span>,<span class="codeReserved">new</span> Date,<span class="codeString">&quot;1.0.3&quot;</span>)};d.prototype.stopTrace=<span class="codeReserved">function</span>(){delete <span class="codeReserved">this</span>._traceBuffer};d.prototype._doConnect=<span class="codeReserved">function</span>(a){<span class="codeReserved">this</span>.connectOptions.useSSL&&(a=a.split(<span class="codeString">&quot;:&quot;</span>),a[0]=<span class="codeString">&quot;wss&quot;</span>,a=a.join(<span class="codeString">&quot;:&quot;</span>));<span class="codeReserved">this</span>._wsuri=a;<span class="codeReserved">this</span>.connected=!1;<span class="codeReserved">this</span>.socket=4&gt;<span class="codeReserved">this</span>.connectOptions.mqttVersion?<span class="codeReserved">new</span> WebSocket(a,[<span class="codeString">&quot;mqttv3.1&quot;</span>]):<span class="codeReserved">new</span> WebSocket(a,[<span class="codeString">&quot;mqtt&quot;</span>]);<span class="codeReserved">this</span>.socket.binaryType=<span class="codeString">&quot;arraybuffer&quot;</span>;<span class="codeReserved">this</span>.socket.onopen=v(<span class="codeReserved">this</span>._on_socket_open,<span class="codeReserved">this</span>);<span class="codeReserved">this</span>.socket.onmessage=v(<span class="codeReserved">this</span>._on_socket_message,</td></tr>
  <tr><td>38</td><td><span class="codeReserved">this</span>);<span class="codeReserved">this</span>.socket.onerror=v(<span class="codeReserved">this</span>._on_socket_error,<span class="codeReserved">this</span>);<span class="codeReserved">this</span>.socket.onclose=v(<span class="codeReserved">this</span>._on_socket_close,<span class="codeReserved">this</span>);<span class="codeReserved">this</span>.sendPinger=<span class="codeReserved">new</span> F(<span class="codeReserved">this</span>,window,<span class="codeReserved">this</span>.connectOptions.keepAliveInterval);<span class="codeReserved">this</span>.receivePinger=<span class="codeReserved">new</span> F(<span class="codeReserved">this</span>,window,<span class="codeReserved">this</span>.connectOptions.keepAliveInterval);<span class="codeReserved">this</span>._connectTimeout&&(<span class="codeReserved">this</span>._connectTimeout.cancel(),<span class="codeReserved">this</span>._connectTimeout=<span class="codeReserved">null</span>);<span class="codeReserved">this</span>._connectTimeout=<span class="codeReserved">new</span> w(<span class="codeReserved">this</span>,window,<span class="codeReserved">this</span>.connectOptions.timeout,<span class="codeReserved">this</span>._disconnected,[h.CONNECT_TIMEOUT.code,f(h.CONNECT_TIMEOUT)])};d.prototype._schedule_message=<span class="codeReserved">function</span>(a){<span class="codeReserved">this</span>._msg_queue.push(a);</td></tr>
  <tr><td>39</td><td><span class="codeReserved">this</span>.connected&&<span class="codeReserved">this</span>._process_queue()};d.prototype.store=<span class="codeReserved">function</span>(a,b){var c={type:b.type,messageIdentifier:b.messageIdentifier,version:1};<span class="codeReserved">switch</span>(b.type){<span class="codeReserved">case</span> 3:b.pubRecReceived&&(c.pubRecReceived=!0);c.payloadMessage={};<span class="codeReserved">for</span>(var d=<span class="codeString">&quot;&quot;</span>,e=b.payloadMessage.payloadBytes,g=0;g&lt;<span class="codeReserved">e</span>.length;g++)d=15&gt;=e[g]?d+<span class="codeString">&quot;0&quot;</span>+e[g].toString(16):d+e[g].toString(16);c.payloadMessage.payloadHex=d;c.payloadMessage.qos=b.payloadMessage.qos;c.payloadMessage.destinationName=b.payloadMessage.destinationName;b.payloadMessage.duplicate&&</td></tr>
  <tr><td>40</td><td>(c.payloadMessage.duplicate=!0);b.payloadMessage.retained&&(c.payloadMessage.retained=!0);0===a.indexOf(<span class="codeString">&quot;Sent:&quot;</span>)&&(void 0===b.sequence&&(b.sequence=++<span class="codeReserved">this</span>._sequence),c.sequence=b.sequence);<span class="codeReserved">break</span>;<span class="codeReserved">default</span>:<span class="codeReserved">throw</span> Error(f(h.INVALID_STORED_DATA,[key,c]));}localStorage.setItem(a+<span class="codeReserved">this</span>._localKey+b.messageIdentifier,JSON.stringify(c))};d.prototype.restore=<span class="codeReserved">function</span>(a){var b=localStorage.getItem(a),c=JSON.parse(b),d=<span class="codeReserved">new</span> q(c.type,c);<span class="codeReserved">switch</span>(c.type){<span class="codeReserved">case</span> 3:<span class="codeReserved">for</span>(var b=c.payloadMessage.payloadHex,e=<span class="codeReserved">new</span> ArrayBuffer(b.length/</td></tr>
  <tr><td>41</td><td>2),e=<span class="codeReserved">new</span> Uint8Array(e),g=0;2&lt;=b.length;){var m=parseInt(b.substring(0,2),16),b=b.substring(2,b.length);e[g++]=m}b=<span class="codeReserved">new</span> Paho.MQTT.Message(e);b.qos=c.payloadMessage.qos;b.destinationName=c.payloadMessage.destinationName;c.payloadMessage.duplicate&&(b.duplicate=!0);c.payloadMessage.retained&&(b.retained=!0);d.payloadMessage=b;<span class="codeReserved">break</span>;<span class="codeReserved">default</span>:<span class="codeReserved">throw</span> Error(f(h.INVALID_STORED_DATA,[a,b]));}0===a.indexOf(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey)?(d.payloadMessage.duplicate=!0,<span class="codeReserved">this</span>._sentMessages[d.messageIdentifier]=d):0===a.indexOf(<span class="codeString">&quot;Received:&quot;</span>+</td></tr>
  <tr><td>42</td><td><span class="codeReserved">this</span>._localKey)&&(<span class="codeReserved">this</span>._receivedMessages[d.messageIdentifier]=d)};d.prototype._process_queue=<span class="codeReserved">function</span>(){<span class="codeReserved">for</span>(var a=<span class="codeReserved">null</span>,b=<span class="codeReserved">this</span>._msg_queue.reverse();a=b.pop();)<span class="codeReserved">this</span>._socket_send(a),<span class="codeReserved">this</span>._notify_msg_sent[a]&&(<span class="codeReserved">this</span>._notify_msg_sent[a](),delete <span class="codeReserved">this</span>._notify_msg_sent[a])};d.prototype._requires_ack=<span class="codeReserved">function</span>(a){var b=Object.keys(<span class="codeReserved">this</span>._sentMessages).length;<span class="codeReserved">if</span>(b&gt;<span class="codeReserved">this</span>.maxMessageIdentifier)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Too many messages:&quot;</span>+b);<span class="codeReserved">for</span>(;void 0!==<span class="codeReserved">this</span>._sentMessages[<span class="codeReserved">this</span>._message_identifier];)<span class="codeReserved">this</span>._message_identifier++;</td></tr>
  <tr><td>43</td><td>a.messageIdentifier=<span class="codeReserved">this</span>._message_identifier;<span class="codeReserved">this</span>._sentMessages[a.messageIdentifier]=a;3===a.type&&<span class="codeReserved">this</span>.store(<span class="codeString">&quot;Sent:&quot;</span>,a);<span class="codeReserved">this</span>._message_identifier===<span class="codeReserved">this</span>.maxMessageIdentifier&&(<span class="codeReserved">this</span>._message_identifier=1)};d.prototype._on_socket_open=<span class="codeReserved">function</span>(){var a=<span class="codeReserved">new</span> q(1,<span class="codeReserved">this</span>.connectOptions);a.clientId=<span class="codeReserved">this</span>.clientId;<span class="codeReserved">this</span>._socket_send(a)};d.prototype._on_socket_message=<span class="codeReserved">function</span>(a){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._on_socket_message&quot;</span>,a.data);a=<span class="codeReserved">this</span>._deframeMessages(a.data);<span class="codeReserved">for</span>(var b=0;b&lt;<span class="codeReserved">a</span>.length;b+=1)<span class="codeReserved">this</span>._handleMessage(a[b])};</td></tr>
  <tr><td>44</td><td>d.prototype._deframeMessages=<span class="codeReserved">function</span>(a){a=<span class="codeReserved">new</span> Uint8Array(a);var b=[];<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.receiveBuffer){var c=<span class="codeReserved">new</span> Uint8Array(<span class="codeReserved">this</span>.receiveBuffer.length+a.length);c.set(<span class="codeReserved">this</span>.receiveBuffer);c.set(a,<span class="codeReserved">this</span>.receiveBuffer.length);a=c;delete <span class="codeReserved">this</span>.receiveBuffer}<span class="codeReserved">try</span>{<span class="codeReserved">for</span>(c=0;c&lt;<span class="codeReserved">a</span>.length;){var d;a:{var e=a,g=c,m=g,n=e[g],l=n&gt;&gt;4,t=n&15,g=g+1,x=void 0,C=0,p=1;<span class="codeReserved">do</span>{<span class="codeReserved">if</span>(g==e.length){d=[<span class="codeReserved">null</span>,m];<span class="codeReserved">break</span> a}x=e[g++];C+=(x&127)*p;p*=128}<span class="codeReserved">while</span>(0!==(x&128));x=g+C;<span class="codeReserved">if</span>(x&gt;e.length)d=[<span class="codeReserved">null</span>,m];<span class="codeReserved">else</span>{var y=<span class="codeReserved">new</span> q(l);<span class="codeReserved">switch</span>(l){<span class="codeReserved">case</span> 2:e[g++]&1&&(y.sessionPresent=</td></tr>
  <tr><td>45</td><td>!0);y.returnCode=e[g++];<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 3:var m=t&gt;&gt;1&3,s=256*e[g]+e[g+1],g=g+2,u=E(e,g,s),g=g+s;0&lt;<span class="codeReserved">m</span>&&(y.messageIdentifier=256*e[g]+e[g+1],g+=2);var r=<span class="codeReserved">new</span> Paho.MQTT.Message(e.subarray(g,x));1==(t&1)&&(r.retained=!0);8==(t&8)&&(r.duplicate=!0);r.qos=m;r.destinationName=u;y.payloadMessage=r;<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 4:<span class="codeReserved">case</span> 5:<span class="codeReserved">case</span> 6:<span class="codeReserved">case</span> 7:<span class="codeReserved">case</span> 11:y.messageIdentifier=256*e[g]+e[g+1];<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 9:y.messageIdentifier=256*e[g]+e[g+1],g+=2,y.returnCode=e.subarray(g,x)}d=[y,x]}}var v=d[0],c=d[1];<span class="codeReserved">if</span>(<span class="codeReserved">null</span>!==v)b.push(v);<span class="codeReserved">else</span> <span class="codeReserved">break</span>}c&lt;</td></tr>
  <tr><td>46</td><td>a.length&&(<span class="codeReserved">this</span>.receiveBuffer=a.subarray(c))}<span class="codeReserved">catch</span>(w){d=<span class="codeString">&quot;undefined&quot;</span>==w.hasOwnProperty(<span class="codeString">&quot;stack&quot;</span>)?w.stack.toString():<span class="codeString">&quot;No Error Stack Available&quot;</span>;<span class="codeReserved">this</span>._disconnected(h.INTERNAL_ERROR.code,f(h.INTERNAL_ERROR,[w.message,d]));<span class="codeReserved">return</span>}<span class="codeReserved">return</span> b};d.prototype._handleMessage=<span class="codeReserved">function</span>(a){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._handleMessage&quot;</span>,a);<span class="codeReserved">try</span>{<span class="codeReserved">switch</span>(a.type){<span class="codeReserved">case</span> 2:<span class="codeReserved">this</span>._connectTimeout.cancel();<span class="codeReserved">this</span>._reconnectTimeout&&<span class="codeReserved">this</span>._reconnectTimeout.cancel();<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.connectOptions.cleanSession){<span class="codeReserved">for</span>(var b <span class="codeReserved">in</span> <span class="codeReserved">this</span>._sentMessages){var c=<span class="codeReserved">this</span>._sentMessages[b];</td></tr>
  <tr><td>47</td><td>localStorage.removeItem(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey+c.messageIdentifier)}<span class="codeReserved">this</span>._sentMessages={};<span class="codeReserved">for</span>(b <span class="codeReserved">in</span> <span class="codeReserved">this</span>._receivedMessages){var d=<span class="codeReserved">this</span>._receivedMessages[b];localStorage.removeItem(<span class="codeString">&quot;Received:&quot;</span>+<span class="codeReserved">this</span>._localKey+d.messageIdentifier)}<span class="codeReserved">this</span>._receivedMessages={}}<span class="codeReserved">if</span>(0===a.returnCode)<span class="codeReserved">this</span>.connected=!0,<span class="codeReserved">this</span>.connectOptions.uris&&(<span class="codeReserved">this</span>.hostIndex=<span class="codeReserved">this</span>.connectOptions.uris.length);<span class="codeReserved">else</span>{<span class="codeReserved">this</span>._disconnected(h.CONNACK_RETURNCODE.code,f(h.CONNACK_RETURNCODE,[a.returnCode,H[a.returnCode]]));<span class="codeReserved">break</span>}a=[];<span class="codeReserved">for</span>(var e <span class="codeReserved">in</span> <span class="codeReserved">this</span>._sentMessages)<span class="codeReserved">this</span>._sentMessages.hasOwnProperty(e)&&</td></tr>
  <tr><td>48</td><td>a.push(<span class="codeReserved">this</span>._sentMessages[e]);<span class="codeReserved">if</span>(0&lt;<span class="codeReserved">this</span>._buffered_msg_queue.length){e=<span class="codeReserved">null</span>;<span class="codeReserved">for</span>(var g=<span class="codeReserved">this</span>._buffered_msg_queue.reverse();e=g.pop();)a.push(e),<span class="codeReserved">this</span>.onMessageDelivered&&(<span class="codeReserved">this</span>._notify_msg_sent[e]=<span class="codeReserved">this</span>.onMessageDelivered(e.payloadMessage))}a=a.sort(<span class="codeReserved">function</span>(a,b){<span class="codeReserved">return</span> a.sequence-b.sequence});<span class="codeReserved">for</span>(var g=0,m=a.length;g&lt;<span class="codeReserved">m</span>;g++)<span class="codeReserved">if</span>(c=a[g],3==c.type&&c.pubRecReceived){var n=<span class="codeReserved">new</span> q(6,{messageIdentifier:c.messageIdentifier});<span class="codeReserved">this</span>._schedule_message(n)}<span class="codeReserved">else</span> <span class="codeReserved">this</span>._schedule_message(c);<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.connectOptions.onSuccess)<span class="codeReserved">this</span>.connectOptions.onSuccess({invocationContext:<span class="codeReserved">this</span>.connectOptions.invocationContext});</td></tr>
  <tr><td>49</td><td>c=!1;<span class="codeReserved">this</span>._reconnecting&&(c=!0,<span class="codeReserved">this</span>._reconnectInterval=1,<span class="codeReserved">this</span>._reconnecting=!1);<span class="codeReserved">this</span>._connected(c,<span class="codeReserved">this</span>._wsuri);<span class="codeReserved">this</span>._process_queue();<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 3:<span class="codeReserved">this</span>._receivePublish(a);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 4:<span class="codeReserved">if</span>(c=<span class="codeReserved">this</span>._sentMessages[a.messageIdentifier])<span class="codeReserved">if</span>(delete <span class="codeReserved">this</span>._sentMessages[a.messageIdentifier],localStorage.removeItem(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey+a.messageIdentifier),<span class="codeReserved">this</span>.onMessageDelivered)<span class="codeReserved">this</span>.onMessageDelivered(c.payloadMessage);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 5:<span class="codeReserved">if</span>(c=<span class="codeReserved">this</span>._sentMessages[a.messageIdentifier])c.pubRecReceived=!0,n=<span class="codeReserved">new</span> q(6,{messageIdentifier:a.messageIdentifier}),</td></tr>
  <tr><td>50</td><td><span class="codeReserved">this</span>.store(<span class="codeString">&quot;Sent:&quot;</span>,c),<span class="codeReserved">this</span>._schedule_message(n);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 6:d=<span class="codeReserved">this</span>._receivedMessages[a.messageIdentifier];localStorage.removeItem(<span class="codeString">&quot;Received:&quot;</span>+<span class="codeReserved">this</span>._localKey+a.messageIdentifier);d&&(<span class="codeReserved">this</span>._receiveMessage(d),delete <span class="codeReserved">this</span>._receivedMessages[a.messageIdentifier]);var l=<span class="codeReserved">new</span> q(7,{messageIdentifier:a.messageIdentifier});<span class="codeReserved">this</span>._schedule_message(l);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 7:c=<span class="codeReserved">this</span>._sentMessages[a.messageIdentifier];delete <span class="codeReserved">this</span>._sentMessages[a.messageIdentifier];localStorage.removeItem(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey+a.messageIdentifier);</td></tr>
  <tr><td>51</td><td><span class="codeReserved">if</span>(<span class="codeReserved">this</span>.onMessageDelivered)<span class="codeReserved">this</span>.onMessageDelivered(c.payloadMessage);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 9:<span class="codeReserved">if</span>(c=<span class="codeReserved">this</span>._sentMessages[a.messageIdentifier]){c.timeOut&&c.timeOut.cancel();<span class="codeReserved">if</span>(128===a.returnCode[0]){<span class="codeReserved">if</span>(c.onFailure)c.onFailure(a.returnCode)}<span class="codeReserved">else</span> <span class="codeReserved">if</span>(c.onSuccess)c.onSuccess(a.returnCode);delete <span class="codeReserved">this</span>._sentMessages[a.messageIdentifier]}<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 11:<span class="codeReserved">if</span>(c=<span class="codeReserved">this</span>._sentMessages[a.messageIdentifier])c.timeOut&&c.timeOut.cancel(),c.callback&&c.callback(),delete <span class="codeReserved">this</span>._sentMessages[a.messageIdentifier];<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 13:<span class="codeReserved">this</span>.sendPinger.reset();</td></tr>
  <tr><td>52</td><td><span class="codeReserved">break</span>;<span class="codeReserved">case</span> 14:<span class="codeReserved">this</span>._disconnected(h.INVALID_MQTT_MESSAGE_TYPE.code,f(h.INVALID_MQTT_MESSAGE_TYPE,[a.type]));<span class="codeReserved">break</span>;<span class="codeReserved">default</span>:<span class="codeReserved">this</span>._disconnected(h.INVALID_MQTT_MESSAGE_TYPE.code,f(h.INVALID_MQTT_MESSAGE_TYPE,[a.type]))}}<span class="codeReserved">catch</span>(t){c=<span class="codeString">&quot;undefined&quot;</span>==t.hasOwnProperty(<span class="codeString">&quot;stack&quot;</span>)?t.stack.toString():<span class="codeString">&quot;No Error Stack Available&quot;</span>,<span class="codeReserved">this</span>._disconnected(h.INTERNAL_ERROR.code,f(h.INTERNAL_ERROR,[t.message,c]))}};d.prototype._on_socket_error=<span class="codeReserved">function</span>(a){<span class="codeReserved">this</span>._reconnecting||<span class="codeReserved">this</span>._disconnected(h.SOCKET_ERROR.code,f(h.SOCKET_ERROR,</td></tr>
  <tr><td>53</td><td>[a.data]))};d.prototype._on_socket_close=<span class="codeReserved">function</span>(){<span class="codeReserved">this</span>._reconnecting||<span class="codeReserved">this</span>._disconnected(h.SOCKET_CLOSE.code,f(h.SOCKET_CLOSE))};d.prototype._socket_send=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(1==a.type){var b=<span class="codeReserved">this</span>._traceMask(a,<span class="codeString">&quot;password&quot;</span>);<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._socket_send&quot;</span>,b)}<span class="codeReserved">else</span> <span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._socket_send&quot;</span>,a);<span class="codeReserved">this</span>.socket.send(a.encode());<span class="codeReserved">this</span>.sendPinger.reset()};d.prototype._receivePublish=<span class="codeReserved">function</span>(a){<span class="codeReserved">switch</span>(a.payloadMessage.qos){<span class="codeReserved">case</span> <span class="codeString">&quot;undefined&quot;</span>:<span class="codeReserved">case</span> 0:<span class="codeReserved">this</span>._receiveMessage(a);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 1:var b=<span class="codeReserved">new</span> q(4,{messageIdentifier:a.messageIdentifier});</td></tr>
  <tr><td>54</td><td><span class="codeReserved">this</span>._schedule_message(b);<span class="codeReserved">this</span>._receiveMessage(a);<span class="codeReserved">break</span>;<span class="codeReserved">case</span> 2:<span class="codeReserved">this</span>._receivedMessages[a.messageIdentifier]=a;<span class="codeReserved">this</span>.store(<span class="codeString">&quot;Received:&quot;</span>,a);a=<span class="codeReserved">new</span> q(5,{messageIdentifier:a.messageIdentifier});<span class="codeReserved">this</span>._schedule_message(a);<span class="codeReserved">break</span>;<span class="codeReserved">default</span>:<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invaild qos\x3d&quot;</span>+wireMmessage.payloadMessage.qos);}};d.prototype._receiveMessage=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.onMessageArrived)<span class="codeReserved">this</span>.onMessageArrived(a.payloadMessage)};d.prototype._connected=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.onConnected)<span class="codeReserved">this</span>.onConnected(a,b)};d.prototype._reconnect=</td></tr>
  <tr><td>55</td><td><span class="codeReserved">function</span>(){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._reconnect&quot;</span>);<span class="codeReserved">this</span>.connected||(<span class="codeReserved">this</span>._reconnecting=!0,<span class="codeReserved">this</span>.sendPinger.cancel(),<span class="codeReserved">this</span>.receivePinger.cancel(),128&gt;<span class="codeReserved">this</span>._reconnectInterval&&(<span class="codeReserved">this</span>._reconnectInterval*=2),<span class="codeReserved">this</span>.connectOptions.uris?(<span class="codeReserved">this</span>.hostIndex=0,<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.connectOptions.uris[0])):<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.uri))};d.prototype._disconnected=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._disconnected&quot;</span>,a,b);<span class="codeReserved">if</span>(void 0!==a&&<span class="codeReserved">this</span>._reconnecting)<span class="codeReserved">this</span>._reconnectTimeout=<span class="codeReserved">new</span> w(<span class="codeReserved">this</span>,window,<span class="codeReserved">this</span>._reconnectInterval,<span class="codeReserved">this</span>._reconnect);</td></tr>
  <tr><td>56</td><td><span class="codeReserved">else</span> <span class="codeReserved">if</span>(<span class="codeReserved">this</span>.sendPinger.cancel(),<span class="codeReserved">this</span>.receivePinger.cancel(),<span class="codeReserved">this</span>._connectTimeout&&(<span class="codeReserved">this</span>._connectTimeout.cancel(),<span class="codeReserved">this</span>._connectTimeout=<span class="codeReserved">null</span>),<span class="codeReserved">this</span>._msg_queue=[],<span class="codeReserved">this</span>._buffered_msg_queue=[],<span class="codeReserved">this</span>._notify_msg_sent={},<span class="codeReserved">this</span>.socket&&(<span class="codeReserved">this</span>.socket.onopen=<span class="codeReserved">null</span>,<span class="codeReserved">this</span>.socket.onmessage=<span class="codeReserved">null</span>,<span class="codeReserved">this</span>.socket.onerror=<span class="codeReserved">null</span>,<span class="codeReserved">this</span>.socket.onclose=<span class="codeReserved">null</span>,1===<span class="codeReserved">this</span>.socket.readyState&&<span class="codeReserved">this</span>.socket.close(),delete <span class="codeReserved">this</span>.socket),<span class="codeReserved">this</span>.connectOptions.uris&&<span class="codeReserved">this</span>.hostIndex&lt;<span class="codeReserved">this</span>.connectOptions.uris.length-1)<span class="codeReserved">this</span>.hostIndex++,<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.connectOptions.uris[<span class="codeReserved">this</span>.hostIndex]);</td></tr>
  <tr><td>57</td><td><span class="codeReserved">else</span> <span class="codeReserved">if</span>(void 0===a&&(a=h.OK.code,b=f(h.OK)),<span class="codeReserved">this</span>.connected){<span class="codeReserved">this</span>.connected=!1;<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.onConnectionLost)<span class="codeReserved">this</span>.onConnectionLost({errorCode:a,errorMessage:b,reconnect:<span class="codeReserved">this</span>.connectOptions.reconnect,uri:<span class="codeReserved">this</span>._wsuri});a!==h.OK.code&&<span class="codeReserved">this</span>.connectOptions.reconnect&&(<span class="codeReserved">this</span>._reconnectInterval=1,<span class="codeReserved">this</span>._reconnect())}<span class="codeReserved">else</span> <span class="codeReserved">if</span>(4===<span class="codeReserved">this</span>.connectOptions.mqttVersion&&!1===<span class="codeReserved">this</span>.connectOptions.mqttVersionExplicit)<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Failed to connect V4, dropping back to V3&quot;</span>),<span class="codeReserved">this</span>.connectOptions.mqttVersion=3,<span class="codeReserved">this</span>.connectOptions.uris?</td></tr>
  <tr><td>58</td><td>(<span class="codeReserved">this</span>.hostIndex=0,<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.connectOptions.uris[0])):<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.uri);<span class="codeReserved">else</span> <span class="codeReserved">if</span>(<span class="codeReserved">this</span>.connectOptions.onFailure)<span class="codeReserved">this</span>.connectOptions.onFailure({invocationContext:<span class="codeReserved">this</span>.connectOptions.invocationContext,errorCode:a,errorMessage:b})};d.prototype._trace=<span class="codeReserved">function</span>(){<span class="codeReserved">if</span>(<span class="codeReserved">this</span>.traceFunction){<span class="codeReserved">for</span>(var a <span class="codeReserved">in</span> arguments)<span class="codeString">&quot;undefined&quot;</span>!==<span class="codeReserved">typeof</span> arguments[a]&&arguments.splice(a,1,JSON.stringify(arguments[a]));a=Array.prototype.slice.call(arguments).join(<span class="codeString">&quot;&quot;</span>);<span class="codeReserved">this</span>.traceFunction({severity:<span class="codeString">&quot;Debug&quot;</span>,message:a})}<span class="codeReserved">if</span>(<span class="codeReserved">null</span>!==</td></tr>
  <tr><td>59</td><td><span class="codeReserved">this</span>._traceBuffer){a=0;<span class="codeReserved">for</span>(var b=arguments.length;a&lt;<span class="codeReserved">b</span>;a++)<span class="codeReserved">this</span>._traceBuffer.length==<span class="codeReserved">this</span>._MAX_TRACE_ENTRIES&&<span class="codeReserved">this</span>._traceBuffer.shift(),0===a?<span class="codeReserved">this</span>._traceBuffer.push(arguments[a]):<span class="codeString">&quot;undefined&quot;</span>===<span class="codeReserved">typeof</span> arguments[a]?<span class="codeReserved">this</span>._traceBuffer.push(arguments[a]):<span class="codeReserved">this</span>._traceBuffer.push(<span class="codeString">&quot;  &quot;</span>+JSON.stringify(arguments[a]))}};d.prototype._traceMask=<span class="codeReserved">function</span>(a,b){var c={},d;<span class="codeReserved">for</span>(d <span class="codeReserved">in</span> a)a.hasOwnProperty(d)&&(c[d]=d==b?<span class="codeString">&quot;******&quot;</span>:a[d]);<span class="codeReserved">return</span> c};var G=<span class="codeReserved">function</span>(a,b,c,k){var e;<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> a)<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,</td></tr>
  <tr><td>60</td><td>[<span class="codeReserved">typeof</span> a,<span class="codeString">&quot;host&quot;</span>]));<span class="codeReserved">if</span>(2==arguments.length){k=b;e=a;var g=e.match(<span class="codeString">/^(wss?):\/</span>\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);<span class="codeReserved">if</span>(g)a=g[4]||g[2],b=parseInt(g[7]),c=g[8];<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a,<span class="codeString">&quot;host&quot;</span>]));}<span class="codeReserved">else</span>{3==arguments.length&&(k=c,c=<span class="codeString">&quot;/mqtt&quot;</span>);<span class="codeReserved">if</span>(<span class="codeString">&quot;number&quot;</span>!==<span class="codeReserved">typeof</span> b||0&gt;b)<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> b,<span class="codeString">&quot;port&quot;</span>]));<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> c)<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> c,<span class="codeString">&quot;path&quot;</span>]));e=<span class="codeString">&quot;ws:&#47;&#47;&quot;</span>+(-1!==a.indexOf(<span class="codeString">&quot;:&quot;</span>)&&<span class="codeString">&quot;[&quot;</span>!==a.slice(0,1)&&<span class="codeString">&quot;]&quot;</span>!==a.slice(-1)?<span class="codeString">&quot;[&quot;</span>+a+<span class="codeString">&quot;]&quot;</span>:a)+<span class="codeString">&quot;:&quot;</span>+b+c}<span class="codeReserved">for</span>(var m=</td></tr>
  <tr><td>61</td><td>g=0;m&lt;<span class="codeReserved">k</span>.length;m++){var n=k.charCodeAt(m);55296&lt;=n&&56319&gt;=n&&m++;g++}<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> k||65535&lt;<span class="codeReserved">g</span>)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[k,<span class="codeString">&quot;clientId&quot;</span>]));var l=<span class="codeReserved">new</span> d(e,a,b,c,k);<span class="codeReserved">this</span>._getHost=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> a};<span class="codeReserved">this</span>._setHost=<span class="codeReserved">function</span>(){<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED_OPERATION));};<span class="codeReserved">this</span>._getPort=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> b};<span class="codeReserved">this</span>._setPort=<span class="codeReserved">function</span>(){<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED_OPERATION));};<span class="codeReserved">this</span>._getPath=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> c};<span class="codeReserved">this</span>._setPath=<span class="codeReserved">function</span>(){<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED_OPERATION));};<span class="codeReserved">this</span>._getURI=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> e};</td></tr>
  <tr><td>62</td><td><span class="codeReserved">this</span>._setURI=<span class="codeReserved">function</span>(){<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED_OPERATION));};<span class="codeReserved">this</span>._getClientId=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.clientId};<span class="codeReserved">this</span>._setClientId=<span class="codeReserved">function</span>(){<span class="codeReserved">throw</span> Error(f(h.UNSUPPORTED_OPERATION));};<span class="codeReserved">this</span>._getOnConnected=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.onConnected};<span class="codeReserved">this</span>._setOnConnected=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>===<span class="codeReserved">typeof</span> a)l.onConnected=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a,<span class="codeString">&quot;onConnected&quot;</span>]));};<span class="codeReserved">this</span>._getDisconnectedPublishing=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.disconnectedPublishing};<span class="codeReserved">this</span>._setDisconnectedPublishing=<span class="codeReserved">function</span>(a){l.disconnectedPublishing=</td></tr>
  <tr><td>63</td><td>a};<span class="codeReserved">this</span>._getDisconnectedBufferSize=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.disconnectedBufferSize};<span class="codeReserved">this</span>._setDisconnectedBufferSize=<span class="codeReserved">function</span>(a){l.disconnectedBufferSize=a};<span class="codeReserved">this</span>._getOnConnectionLost=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.onConnectionLost};<span class="codeReserved">this</span>._setOnConnectionLost=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>===<span class="codeReserved">typeof</span> a)l.onConnectionLost=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a,<span class="codeString">&quot;onConnectionLost&quot;</span>]));};<span class="codeReserved">this</span>._getOnMessageDelivered=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.onMessageDelivered};<span class="codeReserved">this</span>._setOnMessageDelivered=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>===<span class="codeReserved">typeof</span> a)l.onMessageDelivered=</td></tr>
  <tr><td>64</td><td>a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a,<span class="codeString">&quot;onMessageDelivered&quot;</span>]));};<span class="codeReserved">this</span>._getOnMessageArrived=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.onMessageArrived};<span class="codeReserved">this</span>._setOnMessageArrived=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>===<span class="codeReserved">typeof</span> a)l.onMessageArrived=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a,<span class="codeString">&quot;onMessageArrived&quot;</span>]));};<span class="codeReserved">this</span>._getTrace=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.traceFunction};<span class="codeReserved">this</span>._setTrace=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>===<span class="codeReserved">typeof</span> a)l.traceFunction=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a,<span class="codeString">&quot;onTrace&quot;</span>]));};<span class="codeReserved">this</span>.connect=<span class="codeReserved">function</span>(a){a=a||{};z(a,</td></tr>
  <tr><td>65</td><td>{timeout:<span class="codeString">&quot;number&quot;</span>,userName:<span class="codeString">&quot;string&quot;</span>,password:<span class="codeString">&quot;string&quot;</span>,willMessage:<span class="codeString">&quot;object&quot;</span>,keepAliveInterval:<span class="codeString">&quot;number&quot;</span>,cleanSession:<span class="codeString">&quot;boolean&quot;</span>,useSSL:<span class="codeString">&quot;boolean&quot;</span>,invocationContext:<span class="codeString">&quot;object&quot;</span>,onSuccess:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,onFailure:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,hosts:<span class="codeString">&quot;object&quot;</span>,ports:<span class="codeString">&quot;object&quot;</span>,reconnect:<span class="codeString">&quot;boolean&quot;</span>,mqttVersion:<span class="codeString">&quot;number&quot;</span>,mqttVersionExplicit:<span class="codeString">&quot;boolean&quot;</span>,uris:<span class="codeString">&quot;object&quot;</span>});void 0===a.keepAliveInterval&&(a.keepAliveInterval=60);<span class="codeReserved">if</span>(4&lt;<span class="codeReserved">a</span>.mqttVersion||3&gt;a.mqttVersion)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.mqttVersion,<span class="codeString">&quot;connectOptions.mqttVersion&quot;</span>]));void 0===</td></tr>
  <tr><td>66</td><td>a.mqttVersion?(a.mqttVersionExplicit=!1,a.mqttVersion=4):a.mqttVersionExplicit=!0;<span class="codeReserved">if</span>(void 0!==a.password&&void 0===a.userName)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.password,<span class="codeString">&quot;connectOptions.password&quot;</span>]));<span class="codeReserved">if</span>(a.willMessage){<span class="codeReserved">if</span>(!(a.willMessage <span class="codeReserved">instanceof</span> r))<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[a.willMessage,<span class="codeString">&quot;connectOptions.willMessage&quot;</span>]));a.willMessage.stringPayload=<span class="codeReserved">null</span>;<span class="codeReserved">if</span>(<span class="codeString">&quot;undefined&quot;</span>===<span class="codeReserved">typeof</span> a.willMessage.destinationName)<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a.willMessage.destinationName,<span class="codeString">&quot;connectOptions.willMessage.destinationName&quot;</span>]));</td></tr>
  <tr><td>67</td><td>}<span class="codeString">&quot;undefined&quot;</span>===<span class="codeReserved">typeof</span> a.cleanSession&&(a.cleanSession=!0);<span class="codeReserved">if</span>(a.hosts){<span class="codeReserved">if</span>(!(a.hosts <span class="codeReserved">instanceof</span> Array))<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.hosts,<span class="codeString">&quot;connectOptions.hosts&quot;</span>]));<span class="codeReserved">if</span>(1&gt;a.hosts.length)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.hosts,<span class="codeString">&quot;connectOptions.hosts&quot;</span>]));<span class="codeReserved">for</span>(var b=!1,d=0;d&lt;<span class="codeReserved">a</span>.hosts.length;d++){<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> a.hosts[d])<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a.hosts[d],<span class="codeString">&quot;connectOptions.hosts[&quot;</span>+d+<span class="codeString">&quot;]&quot;</span>]));<span class="codeReserved">if</span>(<span class="codeString">/^(wss?):\/</span>\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(a.hosts[d]))<span class="codeReserved">if</span>(0===d)b=!0;<span class="codeReserved">else</span>{<span class="codeReserved">if</span>(!b)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,</td></tr>
  <tr><td>68</td><td>[a.hosts[d],<span class="codeString">&quot;connectOptions.hosts[&quot;</span>+d+<span class="codeString">&quot;]&quot;</span>]));}<span class="codeReserved">else</span> <span class="codeReserved">if</span>(b)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.hosts[d],<span class="codeString">&quot;connectOptions.hosts[&quot;</span>+d+<span class="codeString">&quot;]&quot;</span>]));}<span class="codeReserved">if</span>(b)a.uris=a.hosts;<span class="codeReserved">else</span>{<span class="codeReserved">if</span>(!a.ports)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.ports,<span class="codeString">&quot;connectOptions.ports&quot;</span>]));<span class="codeReserved">if</span>(!(a.ports <span class="codeReserved">instanceof</span> Array))<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.ports,<span class="codeString">&quot;connectOptions.ports&quot;</span>]));<span class="codeReserved">if</span>(a.hosts.length!==a.ports.length)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a.ports,<span class="codeString">&quot;connectOptions.ports&quot;</span>]));a.uris=[];<span class="codeReserved">for</span>(d=0;d&lt;<span class="codeReserved">a</span>.hosts.length;d++){<span class="codeReserved">if</span>(<span class="codeString">&quot;number&quot;</span>!==<span class="codeReserved">typeof</span> a.ports[d]||</td></tr>
  <tr><td>69</td><td>0&gt;a.ports[d])<span class="codeReserved">throw</span> Error(f(h.INVALID_TYPE,[<span class="codeReserved">typeof</span> a.ports[d],<span class="codeString">&quot;connectOptions.ports[&quot;</span>+d+<span class="codeString">&quot;]&quot;</span>]));var b=a.hosts[d],g=a.ports[d];e=<span class="codeString">&quot;ws:&#47;&#47;&quot;</span>+(-1!==b.indexOf(<span class="codeString">&quot;:&quot;</span>)?<span class="codeString">&quot;[&quot;</span>+b+<span class="codeString">&quot;]&quot;</span>:b)+<span class="codeString">&quot;:&quot;</span>+g+c;a.uris.push(e)}}}l.connect(a)};<span class="codeReserved">this</span>.subscribe=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> a)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+a);b=b||{};z(b,{qos:<span class="codeString">&quot;number&quot;</span>,invocationContext:<span class="codeString">&quot;object&quot;</span>,onSuccess:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,onFailure:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,timeout:<span class="codeString">&quot;number&quot;</span>});<span class="codeReserved">if</span>(b.timeout&&!b.onFailure)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;subscribeOptions.timeout specified with no onFailure callback.&quot;</span>);</td></tr>
  <tr><td>70</td><td><span class="codeReserved">if</span>(<span class="codeString">&quot;undefined&quot;</span>!==<span class="codeReserved">typeof</span> b.qos&&0!==b.qos&&1!==b.qos&&2!==b.qos)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[b.qos,<span class="codeString">&quot;subscribeOptions.qos&quot;</span>]));l.subscribe(a,b)};<span class="codeReserved">this</span>.unsubscribe=<span class="codeReserved">function</span>(a,b){<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> a)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+a);b=b||{};z(b,{invocationContext:<span class="codeString">&quot;object&quot;</span>,onSuccess:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,onFailure:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,timeout:<span class="codeString">&quot;number&quot;</span>});<span class="codeReserved">if</span>(b.timeout&&!b.onFailure)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;unsubscribeOptions.timeout specified with no onFailure callback.&quot;</span>);l.unsubscribe(a,b)};<span class="codeReserved">this</span>.send=<span class="codeReserved">function</span>(a,b,c,d){var e;<span class="codeReserved">if</span>(0===</td></tr>
  <tr><td>71</td><td>arguments.length)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invalid argument.length&quot;</span>);<span class="codeReserved">if</span>(1==arguments.length){<span class="codeReserved">if</span>(!(a <span class="codeReserved">instanceof</span> r)&&<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> a)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+<span class="codeReserved">typeof</span> a);e=a;<span class="codeReserved">if</span>(<span class="codeString">&quot;undefined&quot;</span>===<span class="codeReserved">typeof</span> e.destinationName)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[e.destinationName,<span class="codeString">&quot;Message.destinationName&quot;</span>]));}<span class="codeReserved">else</span> e=<span class="codeReserved">new</span> r(b),e.destinationName=a,3&lt;=arguments.length&&(e.qos=c),4&lt;=arguments.length&&(e.retained=d);l.send(e)};<span class="codeReserved">this</span>.publish=<span class="codeReserved">function</span>(a,b,c,d){console.log(<span class="codeString">&quot;Publising message to: &quot;</span>,a);var e;<span class="codeReserved">if</span>(0===arguments.length)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invalid argument.length&quot;</span>);</td></tr>
  <tr><td>72</td><td><span class="codeReserved">if</span>(1==arguments.length){<span class="codeReserved">if</span>(!(a <span class="codeReserved">instanceof</span> r)&&<span class="codeString">&quot;string&quot;</span>!==<span class="codeReserved">typeof</span> a)<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+<span class="codeReserved">typeof</span> a);e=a;<span class="codeReserved">if</span>(<span class="codeString">&quot;undefined&quot;</span>===<span class="codeReserved">typeof</span> e.destinationName)<span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[e.destinationName,<span class="codeString">&quot;Message.destinationName&quot;</span>]));}<span class="codeReserved">else</span> e=<span class="codeReserved">new</span> r(b),e.destinationName=a,3&lt;=arguments.length&&(e.qos=c),4&lt;=arguments.length&&(e.retained=d);l.send(e)};<span class="codeReserved">this</span>.disconnect=<span class="codeReserved">function</span>(){l.disconnect()};<span class="codeReserved">this</span>.getTraceLog=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.getTraceLog()};<span class="codeReserved">this</span>.startTrace=<span class="codeReserved">function</span>(){l.startTrace()};<span class="codeReserved">this</span>.stopTrace=</td></tr>
  <tr><td>73</td><td><span class="codeReserved">function</span>(){l.stopTrace()};<span class="codeReserved">this</span>.isConnected=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> l.connected}};G.prototype={get host(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getHost()},set host(a){<span class="codeReserved">this</span>._setHost(a)},get port(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPort()},set port(a){<span class="codeReserved">this</span>._setPort(a)},get path(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPath()},set path(a){<span class="codeReserved">this</span>._setPath(a)},get clientId(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getClientId()},set clientId(a){<span class="codeReserved">this</span>._setClientId(a)},get onConnected(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnConnected()},set onConnected(a){<span class="codeReserved">this</span>._setOnConnected(a)},get disconnectedPublishing(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDisconnectedPublishing()},</td></tr>
  <tr><td>74</td><td>set disconnectedPublishing(a){<span class="codeReserved">this</span>._setDisconnectedPublishing(a)},get disconnectedBufferSize(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDisconnectedBufferSize()},set disconnectedBufferSize(a){<span class="codeReserved">this</span>._setDisconnectedBufferSize(a)},get onConnectionLost(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnConnectionLost()},set onConnectionLost(a){<span class="codeReserved">this</span>._setOnConnectionLost(a)},get onMessageDelivered(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnMessageDelivered()},set onMessageDelivered(a){<span class="codeReserved">this</span>._setOnMessageDelivered(a)},get onMessageArrived(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnMessageArrived()},set onMessageArrived(a){<span class="codeReserved">this</span>._setOnMessageArrived(a)},</td></tr>
  <tr><td>75</td><td>get trace(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getTrace()},set trace(a){<span class="codeReserved">this</span>._setTrace(a)}};var r=<span class="codeReserved">function</span>(a){var b;<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>===<span class="codeReserved">typeof</span> a||a <span class="codeReserved">instanceof</span> ArrayBuffer||a <span class="codeReserved">instanceof</span> Int8Array||a <span class="codeReserved">instanceof</span> Uint8Array||a <span class="codeReserved">instanceof</span> Int16Array||a <span class="codeReserved">instanceof</span> Uint16Array||a <span class="codeReserved">instanceof</span> Int32Array||a <span class="codeReserved">instanceof</span> Uint32Array||a <span class="codeReserved">instanceof</span> Float32Array||a <span class="codeReserved">instanceof</span> Float64Array)b=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> f(h.INVALID_ARGUMENT,[a,<span class="codeString">&quot;newPayload&quot;</span>]);<span class="codeReserved">this</span>._getPayloadString=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span><span class="codeString">&quot;string&quot;</span>===<span class="codeReserved">typeof</span> b?b:E(b,0,b.length)};<span class="codeReserved">this</span>._getPayloadBytes=</td></tr>
  <tr><td>76</td><td><span class="codeReserved">function</span>(){<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>===<span class="codeReserved">typeof</span> b){var a=<span class="codeReserved">new</span> ArrayBuffer(n(b)),a=<span class="codeReserved">new</span> Uint8Array(a);D(b,a,0);<span class="codeReserved">return</span> a}<span class="codeReserved">return</span> b};var c;<span class="codeReserved">this</span>._getDestinationName=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> c};<span class="codeReserved">this</span>._setDestinationName=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeString">&quot;string&quot;</span>===<span class="codeReserved">typeof</span> a)c=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a,<span class="codeString">&quot;newDestinationName&quot;</span>]));};var d=0;<span class="codeReserved">this</span>._getQos=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> d};<span class="codeReserved">this</span>._setQos=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(0===a||1===a||2===a)d=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+a);};var e=!1;<span class="codeReserved">this</span>._getRetained=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> e};<span class="codeReserved">this</span>._setRetained=<span class="codeReserved">function</span>(a){<span class="codeReserved">if</span>(<span class="codeString">&quot;boolean&quot;</span>===</td></tr>
  <tr><td>77</td><td><span class="codeReserved">typeof</span> a)e=a;<span class="codeReserved">else</span> <span class="codeReserved">throw</span> Error(f(h.INVALID_ARGUMENT,[a,<span class="codeString">&quot;newRetained&quot;</span>]));};var g=!1;<span class="codeReserved">this</span>._getDuplicate=<span class="codeReserved">function</span>(){<span class="codeReserved">return</span> g};<span class="codeReserved">this</span>._setDuplicate=<span class="codeReserved">function</span>(a){g=a}};r.prototype={get payloadString(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPayloadString()},get payloadBytes(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPayloadBytes()},get destinationName(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDestinationName()},set destinationName(a){<span class="codeReserved">this</span>._setDestinationName(a)},get topic(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDestinationName()},set topic(a){<span class="codeReserved">this</span>._setDestinationName(a)},get qos(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getQos()},</td></tr>
  <tr><td>78</td><td>set qos(a){<span class="codeReserved">this</span>._setQos(a)},get retained(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getRetained()},set retained(a){<span class="codeReserved">this</span>._setRetained(a)},get duplicate(){<span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDuplicate()},set duplicate(a){<span class="codeReserved">this</span>._setDuplicate(a)}};<span class="codeReserved">return</span>{Client:G,Message:r}}(window)});</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. paho.javascript-1.0.3 / paho-mqtt.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/*******************************************************************************</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * Copyright (c) 2013 IBM Corp.</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * All rights reserved. This program and the accompanying materials</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * are made available under the terms of the Eclipse Public License v1.0</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * and Eclipse Distribution License v1.0 which accompany <span class="codeReserved">this</span> distribution.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * The Eclipse Public License is available at</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *    http:<span class="codeComment">//www.eclipse.org/legal/epl-v10.html</span></span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> * and the Eclipse Distribution License is available at</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> *   http:<span class="codeComment">//www.eclipse.org/org/documents/edl-v10.php.</span></span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> * Contributors:</span></td></tr>
  <tr><td>14</td><td><span class="codeComment"> *    Andrew Banks - initial API and implementation and initial documentation</span></td></tr>
  <tr><td>15</td><td><span class="codeComment"> *******************************************************************************/</span></td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td><span class="codeComment">// Only expose a single object name <span class="codeReserved">in</span> the global namespace.</span></td></tr>
  <tr><td>19</td><td><span class="codeComment">// Everything must go through <span class="codeReserved">this</span> module. Global Paho.MQTT module</span></td></tr>
  <tr><td>20</td><td><span class="codeComment">// only has a single <span class="codeReserved">public</span> <span class="codeReserved">function</span>, client, which returns</span></td></tr>
  <tr><td>21</td><td><span class="codeComment">// a Paho.MQTT client object given connection details.</span></td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>24</td><td><span class="codeComment"> * Send and receive messages using web browsers.</span></td></tr>
  <tr><td>25</td><td><span class="codeComment"> * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>26</td><td><span class="codeComment"> * This programming interface lets a JavaScript client application use the MQTT V3.1 or</span></td></tr>
  <tr><td>27</td><td><span class="codeComment"> * V3.1.1 protocol to connect to an MQTT-supporting messaging server.</span></td></tr>
  <tr><td>28</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>29</td><td><span class="codeComment"> * The <span class="codeReserved">function</span> supported includes:</span></td></tr>
  <tr><td>30</td><td><span class="codeComment"> * &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>31</td><td><span class="codeComment"> * &lt;<span class="codeReserved">li</span>&gt;Connecting to and disconnecting <span class="codeReserved">from</span> a server. The server is identified by its host name and port number.</span></td></tr>
  <tr><td>32</td><td><span class="codeComment"> * &lt;<span class="codeReserved">li</span>&gt;Specifying options that relate to the communications link with the server,</span></td></tr>
  <tr><td>33</td><td><span class="codeComment"> * <span class="codeReserved">for</span> example the frequency of keep-alive heartbeats, and whether SSL/TLS is required.</span></td></tr>
  <tr><td>34</td><td><span class="codeComment"> * &lt;<span class="codeReserved">li</span>&gt;Subscribing to and receiving messages <span class="codeReserved">from</span> MQTT Topics.</span></td></tr>
  <tr><td>35</td><td><span class="codeComment"> * &lt;<span class="codeReserved">li</span>&gt;Publishing messages to MQTT Topics.</span></td></tr>
  <tr><td>36</td><td><span class="codeComment"> * &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>37</td><td><span class="codeComment"> * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>38</td><td><span class="codeComment"> * The API consists of two main objects:</span></td></tr>
  <tr><td>39</td><td><span class="codeComment"> * &lt;<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * &lt;<span class="codeReserved">dt</span>&gt;&lt;<span class="codeReserved">b</span>&gt;{@link Paho.MQTT.Client}&lt;/<span class="codeReserved">b</span>&gt;&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * &lt;<span class="codeReserved">dd</span>&gt;This contains methods that provide the functionality of the API,</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> * including provision of callbacks that notify the application when a message</span></td></tr>
  <tr><td>43</td><td><span class="codeComment"> * arrives <span class="codeReserved">from</span> or is delivered to the messaging server,</span></td></tr>
  <tr><td>44</td><td><span class="codeComment"> * or when the status of its connection to the messaging server changes.&lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>45</td><td><span class="codeComment"> * &lt;<span class="codeReserved">dt</span>&gt;&lt;<span class="codeReserved">b</span>&gt;{@link Paho.MQTT.Message}&lt;/<span class="codeReserved">b</span>&gt;&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>46</td><td><span class="codeComment"> * &lt;<span class="codeReserved">dd</span>&gt;This encapsulates the payload of the message along with various attributes</span></td></tr>
  <tr><td>47</td><td><span class="codeComment"> * associated with its delivery, <span class="codeReserved">in</span> particular the destination to which it has</span></td></tr>
  <tr><td>48</td><td><span class="codeComment"> * been (or is about to be) sent.&lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * &lt;/<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * The programming interface validates parameters passed to it, and will <span class="codeReserved">throw</span></span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> * an Error containing an error message intended <span class="codeReserved">for</span> developer use, <span class="codeReserved">if</span> it detects</span></td></tr>
  <tr><td>53</td><td><span class="codeComment"> * an error with any parameter.</span></td></tr>
  <tr><td>54</td><td><span class="codeComment"> * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>55</td><td><span class="codeComment"> * Example:</span></td></tr>
  <tr><td>56</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>57</td><td><span class="codeComment"> * &lt;<span class="codeReserved">code</span>&gt;&lt;<span class="codeReserved">pre</span>&gt;</span></td></tr>
  <tr><td>58</td><td><span class="codeComment">client = <span class="codeReserved">new</span> Paho.MQTT.Client(location.hostname, Number(location.port), <span class="codeString">&quot;clientId&quot;</span>);</span></td></tr>
  <tr><td>59</td><td><span class="codeComment">client.onConnectionLost = onConnectionLost;</span></td></tr>
  <tr><td>60</td><td><span class="codeComment">client.onMessageArrived = onMessageArrived;</span></td></tr>
  <tr><td>61</td><td><span class="codeComment">client.connect({onSuccess:onConnect});</span></td></tr>
  <tr><td>62</td><td><span class="codeComment"></span></td></tr>
  <tr><td>63</td><td><span class="codeComment"><span class="codeReserved">function</span> onConnect() {</span></td></tr>
  <tr><td>64</td><td><span class="codeComment">  <span class="codeComment">// Once a connection has been made, make a subscription and send a message.</span></span></td></tr>
  <tr><td>65</td><td><span class="codeComment">  console.log(<span class="codeString">&quot;onConnect&quot;</span>);</span></td></tr>
  <tr><td>66</td><td><span class="codeComment">  client.subscribe(<span class="codeString">&quot;/World&quot;</span>);</span></td></tr>
  <tr><td>67</td><td><span class="codeComment">  message = <span class="codeReserved">new</span> Paho.MQTT.Message(<span class="codeString">&quot;Hello&quot;</span>);</span></td></tr>
  <tr><td>68</td><td><span class="codeComment">  message.destinationName = <span class="codeString">&quot;/World&quot;</span>;</span></td></tr>
  <tr><td>69</td><td><span class="codeComment">  client.send(message);</span></td></tr>
  <tr><td>70</td><td><span class="codeComment">};</span></td></tr>
  <tr><td>71</td><td><span class="codeComment"><span class="codeReserved">function</span> onConnectionLost(responseObject) {</span></td></tr>
  <tr><td>72</td><td><span class="codeComment">  <span class="codeReserved">if</span> (responseObject.errorCode !== 0)</span></td></tr>
  <tr><td>73</td><td><span class="codeComment">	console.log(<span class="codeString">&quot;onConnectionLost:&quot;</span>+responseObject.errorMessage);</span></td></tr>
  <tr><td>74</td><td><span class="codeComment">};</span></td></tr>
  <tr><td>75</td><td><span class="codeComment"><span class="codeReserved">function</span> onMessageArrived(message) {</span></td></tr>
  <tr><td>76</td><td><span class="codeComment">  console.log(<span class="codeString">&quot;onMessageArrived:&quot;</span>+message.payloadString);</span></td></tr>
  <tr><td>77</td><td><span class="codeComment">  client.disconnect();</span></td></tr>
  <tr><td>78</td><td><span class="codeComment">};</span></td></tr>
  <tr><td>79</td><td><span class="codeComment"> * &lt;/<span class="codeReserved">pre</span>&gt;&lt;/<span class="codeReserved">code</span>&gt;</span></td></tr>
  <tr><td>80</td><td><span class="codeComment"> * @namespace Paho.MQTT</span></td></tr>
  <tr><td>81</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>82</td><td></td></tr>
  <tr><td>83</td><td><span class="codeComment">/* jshint shadow:<span class="codeReserved">true</span> */</span></td></tr>
  <tr><td>84</td><td>(<span class="codeReserved">function</span> ExportLibrary(root, factory) {</td></tr>
  <tr><td>85</td><td>	<span class="codeReserved">if</span>(<span class="codeReserved">typeof</span> exports === <span class="codeString">&#039;object&#039;</span> && <span class="codeReserved">typeof</span> module === <span class="codeString">&#039;object&#039;</span>){</td></tr>
  <tr><td>86</td><td>		module.exports = factory();</td></tr>
  <tr><td>87</td><td>	} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> define === <span class="codeString">&#039;<span class="codeReserved">function</span>&#039;</span> && define.amd){</td></tr>
  <tr><td>88</td><td>		define(factory);</td></tr>
  <tr><td>89</td><td>	} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> exports === <span class="codeString">&#039;object&#039;</span>){</td></tr>
  <tr><td>90</td><td>		exports = factory();</td></tr>
  <tr><td>91</td><td>	} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>92</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> root.Paho === <span class="codeString">&#039;undefined&#039;</span>){</td></tr>
  <tr><td>93</td><td>			root.Paho = {};</td></tr>
  <tr><td>94</td><td>		}</td></tr>
  <tr><td>95</td><td>		root.Paho.MQTT = factory();</td></tr>
  <tr><td>96</td><td>	}</td></tr>
  <tr><td>97</td><td>})(<span class="codeReserved">this</span>, <span class="codeReserved">function</span> LibraryFactory(){</td></tr>
  <tr><td>98</td><td></td></tr>
  <tr><td>99</td><td></td></tr>
  <tr><td>100</td><td>var PahoMQTT = (<span class="codeReserved">function</span> (global) {</td></tr>
  <tr><td>101</td><td></td></tr>
  <tr><td>102</td><td>	<span class="codeComment">// Private variables below, these are only visible inside the <span class="codeReserved">function</span> closure</span></td></tr>
  <tr><td>103</td><td>	<span class="codeComment">// which is used to define the module.</span></td></tr>
  <tr><td>104</td><td></td></tr>
  <tr><td>105</td><td>	var version = <span class="codeString">&quot;@VERSION@&quot;</span>;</td></tr>
  <tr><td>106</td><td>	var buildLevel = <span class="codeString">&quot;@BUILDLEVEL@&quot;</span>;</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>109</td><td><span class="codeComment">	 * Unique message type identifiers, with associated</span></td></tr>
  <tr><td>110</td><td><span class="codeComment">	 * associated integer values.</span></td></tr>
  <tr><td>111</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>112</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>113</td><td>	var MESSAGE_TYPE = {</td></tr>
  <tr><td>114</td><td>		CONNECT: 1,</td></tr>
  <tr><td>115</td><td>		CONNACK: 2,</td></tr>
  <tr><td>116</td><td>		PUBLISH: 3,</td></tr>
  <tr><td>117</td><td>		PUBACK: 4,</td></tr>
  <tr><td>118</td><td>		PUBREC: 5,</td></tr>
  <tr><td>119</td><td>		PUBREL: 6,</td></tr>
  <tr><td>120</td><td>		PUBCOMP: 7,</td></tr>
  <tr><td>121</td><td>		SUBSCRIBE: 8,</td></tr>
  <tr><td>122</td><td>		SUBACK: 9,</td></tr>
  <tr><td>123</td><td>		UNSUBSCRIBE: 10,</td></tr>
  <tr><td>124</td><td>		UNSUBACK: 11,</td></tr>
  <tr><td>125</td><td>		PINGREQ: 12,</td></tr>
  <tr><td>126</td><td>		PINGRESP: 13,</td></tr>
  <tr><td>127</td><td>		DISCONNECT: 14</td></tr>
  <tr><td>128</td><td>	};</td></tr>
  <tr><td>129</td><td></td></tr>
  <tr><td>130</td><td>	<span class="codeComment">// Collection of utility methods used to simplify module code</span></td></tr>
  <tr><td>131</td><td>	<span class="codeComment">// and promote the DRY pattern.</span></td></tr>
  <tr><td>132</td><td></td></tr>
  <tr><td>133</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>134</td><td><span class="codeComment">	 * Validate an object<span class="codeString">&#039;s parameter names to ensure they</span></span></td></tr>
  <tr><td>135</td><td><span class="codeComment"><span class="codeString">	 * match a list of expected variables name <span class="codeReserved">for</span> <span class="codeReserved">this</span> option</span></span></td></tr>
  <tr><td>136</td><td><span class="codeComment"><span class="codeString">	 * type. Used to ensure option object passed into the API don&#039;</span>t</span></td></tr>
  <tr><td>137</td><td><span class="codeComment">	 * contain erroneous parameters.</span></td></tr>
  <tr><td>138</td><td><span class="codeComment">	 * @param {Object} obj - User options object</span></td></tr>
  <tr><td>139</td><td><span class="codeComment">	 * @param {Object} keys - valid keys and types that may exist <span class="codeReserved">in</span> obj.</span></td></tr>
  <tr><td>140</td><td><span class="codeComment">	 * @throws {Error} Invalid option parameter found.</span></td></tr>
  <tr><td>141</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>142</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>143</td><td>	var validate = <span class="codeReserved">function</span>(obj, keys) {</td></tr>
  <tr><td>144</td><td>		<span class="codeReserved">for</span> (var key <span class="codeReserved">in</span> obj) {</td></tr>
  <tr><td>145</td><td>			<span class="codeReserved">if</span> (obj.hasOwnProperty(key)) {</td></tr>
  <tr><td>146</td><td>				<span class="codeReserved">if</span> (keys.hasOwnProperty(key)) {</td></tr>
  <tr><td>147</td><td>					<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> obj[key] !== keys[key])</td></tr>
  <tr><td>148</td><td>					   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> obj[key], key]));</td></tr>
  <tr><td>149</td><td>				} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>150</td><td>					var errorStr = <span class="codeString">&quot;Unknown property, &quot;</span> + key + <span class="codeString">&quot;. Valid properties are:&quot;</span>;</td></tr>
  <tr><td>151</td><td>					<span class="codeReserved">for</span> (var validKey <span class="codeReserved">in</span> keys)</td></tr>
  <tr><td>152</td><td>						<span class="codeReserved">if</span> (keys.hasOwnProperty(validKey))</td></tr>
  <tr><td>153</td><td>							errorStr = errorStr+<span class="codeString">&quot; &quot;</span>+validKey;</td></tr>
  <tr><td>154</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(errorStr);</td></tr>
  <tr><td>155</td><td>				}</td></tr>
  <tr><td>156</td><td>			}</td></tr>
  <tr><td>157</td><td>		}</td></tr>
  <tr><td>158</td><td>	};</td></tr>
  <tr><td>159</td><td></td></tr>
  <tr><td>160</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>161</td><td><span class="codeComment">	 * Return a <span class="codeReserved">new</span> <span class="codeReserved">function</span> which runs the user <span class="codeReserved">function</span> bound</span></td></tr>
  <tr><td>162</td><td><span class="codeComment">	 * to a fixed scope.</span></td></tr>
  <tr><td>163</td><td><span class="codeComment">	 * @param {<span class="codeReserved">function</span>} User <span class="codeReserved">function</span></span></td></tr>
  <tr><td>164</td><td><span class="codeComment">	 * @param {object} Function scope</span></td></tr>
  <tr><td>165</td><td><span class="codeComment">	 * @<span class="codeReserved">return</span> {<span class="codeReserved">function</span>} User <span class="codeReserved">function</span> bound to another scope</span></td></tr>
  <tr><td>166</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>167</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>168</td><td>	var scope = <span class="codeReserved">function</span> (f, scope) {</td></tr>
  <tr><td>169</td><td>		<span class="codeReserved">return</span> <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>170</td><td>			<span class="codeReserved">return</span> f.apply(scope, arguments);</td></tr>
  <tr><td>171</td><td>		};</td></tr>
  <tr><td>172</td><td>	};</td></tr>
  <tr><td>173</td><td></td></tr>
  <tr><td>174</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>175</td><td><span class="codeComment">	 * Unique message type identifiers, with associated</span></td></tr>
  <tr><td>176</td><td><span class="codeComment">	 * associated integer values.</span></td></tr>
  <tr><td>177</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>178</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>179</td><td>	var ERROR = {</td></tr>
  <tr><td>180</td><td>		OK: {code:0, text:<span class="codeString">&quot;AMQJSC0000I OK.&quot;</span>},</td></tr>
  <tr><td>181</td><td>		CONNECT_TIMEOUT: {code:1, text:<span class="codeString">&quot;AMQJSC0001E Connect timed out.&quot;</span>},</td></tr>
  <tr><td>182</td><td>		SUBSCRIBE_TIMEOUT: {code:2, text:<span class="codeString">&quot;AMQJS0002E Subscribe timed out.&quot;</span>},</td></tr>
  <tr><td>183</td><td>		UNSUBSCRIBE_TIMEOUT: {code:3, text:<span class="codeString">&quot;AMQJS0003E Unsubscribe timed out.&quot;</span>},</td></tr>
  <tr><td>184</td><td>		PING_TIMEOUT: {code:4, text:<span class="codeString">&quot;AMQJS0004E Ping timed out.&quot;</span>},</td></tr>
  <tr><td>185</td><td>		INTERNAL_ERROR: {code:5, text:<span class="codeString">&quot;AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}&quot;</span>},</td></tr>
  <tr><td>186</td><td>		CONNACK_RETURNCODE: {code:6, text:<span class="codeString">&quot;AMQJS0006E Bad Connack <span class="codeReserved">return</span> code:{0} {1}.&quot;</span>},</td></tr>
  <tr><td>187</td><td>		SOCKET_ERROR: {code:7, text:<span class="codeString">&quot;AMQJS0007E Socket error:{0}.&quot;</span>},</td></tr>
  <tr><td>188</td><td>		SOCKET_CLOSE: {code:8, text:<span class="codeString">&quot;AMQJS0008I Socket closed.&quot;</span>},</td></tr>
  <tr><td>189</td><td>		MALFORMED_UTF: {code:9, text:<span class="codeString">&quot;AMQJS0009E Malformed UTF data:{0} {1} {2}.&quot;</span>},</td></tr>
  <tr><td>190</td><td>		UNSUPPORTED: {code:10, text:<span class="codeString">&quot;AMQJS0010E {0} is not supported by <span class="codeReserved">this</span> browser.&quot;</span>},</td></tr>
  <tr><td>191</td><td>		INVALID_STATE: {code:11, text:<span class="codeString">&quot;AMQJS0011E Invalid state {0}.&quot;</span>},</td></tr>
  <tr><td>192</td><td>		INVALID_TYPE: {code:12, text:<span class="codeString">&quot;AMQJS0012E Invalid type {0} <span class="codeReserved">for</span> {1}.&quot;</span>},</td></tr>
  <tr><td>193</td><td>		INVALID_ARGUMENT: {code:13, text:<span class="codeString">&quot;AMQJS0013E Invalid argument {0} <span class="codeReserved">for</span> {1}.&quot;</span>},</td></tr>
  <tr><td>194</td><td>		UNSUPPORTED_OPERATION: {code:14, text:<span class="codeString">&quot;AMQJS0014E Unsupported operation.&quot;</span>},</td></tr>
  <tr><td>195</td><td>		INVALID_STORED_DATA: {code:15, text:<span class="codeString">&quot;AMQJS0015E Invalid data <span class="codeReserved">in</span> local storage key={0} value={1}.&quot;</span>},</td></tr>
  <tr><td>196</td><td>		INVALID_MQTT_MESSAGE_TYPE: {code:16, text:<span class="codeString">&quot;AMQJS0016E Invalid MQTT message type {0}.&quot;</span>},</td></tr>
  <tr><td>197</td><td>		MALFORMED_UNICODE: {code:17, text:<span class="codeString">&quot;AMQJS0017E Malformed Unicode string:{0} {1}.&quot;</span>},</td></tr>
  <tr><td>198</td><td>		BUFFER_FULL: {code:18, text:<span class="codeString">&quot;AMQJS0018E Message buffer is full, maximum buffer size: {0}.&quot;</span>},</td></tr>
  <tr><td>199</td><td>	};</td></tr>
  <tr><td>200</td><td></td></tr>
  <tr><td>201</td><td>	<span class="codeComment">/** CONNACK RC Meaning. */</span></td></tr>
  <tr><td>202</td><td>	var CONNACK_RC = {</td></tr>
  <tr><td>203</td><td>		0:<span class="codeString">&quot;Connection Accepted&quot;</span>,</td></tr>
  <tr><td>204</td><td>		1:<span class="codeString">&quot;Connection Refused: unacceptable protocol version&quot;</span>,</td></tr>
  <tr><td>205</td><td>		2:<span class="codeString">&quot;Connection Refused: identifier rejected&quot;</span>,</td></tr>
  <tr><td>206</td><td>		3:<span class="codeString">&quot;Connection Refused: server unavailable&quot;</span>,</td></tr>
  <tr><td>207</td><td>		4:<span class="codeString">&quot;Connection Refused: bad user name or password&quot;</span>,</td></tr>
  <tr><td>208</td><td>		5:<span class="codeString">&quot;Connection Refused: not authorized&quot;</span></td></tr>
  <tr><td>209</td><td>	};</td></tr>
  <tr><td>210</td><td></td></tr>
  <tr><td>211</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>212</td><td><span class="codeComment">	 * Format an error message text.</span></td></tr>
  <tr><td>213</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>214</td><td><span class="codeComment">	 * @param {error} ERROR.<span class="codeReserved">KEY</span> value above.</span></td></tr>
  <tr><td>215</td><td><span class="codeComment">	 * @param {substitutions} [array] substituted into the text.</span></td></tr>
  <tr><td>216</td><td><span class="codeComment">	 * @<span class="codeReserved">return</span> the text with the substitutions made.</span></td></tr>
  <tr><td>217</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>218</td><td>	var format = <span class="codeReserved">function</span>(error, substitutions) {</td></tr>
  <tr><td>219</td><td>		var text = error.text;</td></tr>
  <tr><td>220</td><td>		<span class="codeReserved">if</span> (substitutions) {</td></tr>
  <tr><td>221</td><td>		  var field,start;</td></tr>
  <tr><td>222</td><td>		  <span class="codeReserved">for</span> (var i=0; i&lt;<span class="codeReserved">substitutions</span>.length; i++) {</td></tr>
  <tr><td>223</td><td>			field = <span class="codeString">&quot;{&quot;</span>+i+<span class="codeString">&quot;}&quot;</span>;</td></tr>
  <tr><td>224</td><td>			start = text.indexOf(field);</td></tr>
  <tr><td>225</td><td>			<span class="codeReserved">if</span>(start &gt; 0) {</td></tr>
  <tr><td>226</td><td>				var part1 = text.substring(0,start);</td></tr>
  <tr><td>227</td><td>				var part2 = text.substring(start+field.length);</td></tr>
  <tr><td>228</td><td>				text = part1+substitutions[i]+part2;</td></tr>
  <tr><td>229</td><td>			}</td></tr>
  <tr><td>230</td><td>		  }</td></tr>
  <tr><td>231</td><td>		}</td></tr>
  <tr><td>232</td><td>		<span class="codeReserved">return</span> text;</td></tr>
  <tr><td>233</td><td>	};</td></tr>
  <tr><td>234</td><td></td></tr>
  <tr><td>235</td><td>	<span class="codeComment">//MQTT protocol and version          6    M    Q    I    s    d    p    3</span></td></tr>
  <tr><td>236</td><td>	var MqttProtoIdentifierv3 = [0x00,0x06,0x4d,0x51,0x49,0x73,0x64,0x70,0x03];</td></tr>
  <tr><td>237</td><td>	<span class="codeComment">//MQTT proto/version <span class="codeReserved">for</span> 311         4    M    Q    T    T    4</span></td></tr>
  <tr><td>238</td><td>	var MqttProtoIdentifierv4 = [0x00,0x04,0x4d,0x51,0x54,0x54,0x04];</td></tr>
  <tr><td>239</td><td></td></tr>
  <tr><td>240</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>241</td><td><span class="codeComment">	 * Construct an MQTT wire protocol message.</span></td></tr>
  <tr><td>242</td><td><span class="codeComment">	 * @param type MQTT packet type.</span></td></tr>
  <tr><td>243</td><td><span class="codeComment">	 * @param options optional wire message attributes.</span></td></tr>
  <tr><td>244</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>245</td><td><span class="codeComment">	 * Optional properties</span></td></tr>
  <tr><td>246</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>247</td><td><span class="codeComment">	 * messageIdentifier: message ID <span class="codeReserved">in</span> the range [0..65535]</span></td></tr>
  <tr><td>248</td><td><span class="codeComment">	 * payloadMessage:	Application Message - PUBLISH only</span></td></tr>
  <tr><td>249</td><td><span class="codeComment">	 * connectStrings:	array of 0 or more Strings to be put into the CONNECT payload</span></td></tr>
  <tr><td>250</td><td><span class="codeComment">	 * topics:			array of strings (SUBSCRIBE, UNSUBSCRIBE)</span></td></tr>
  <tr><td>251</td><td><span class="codeComment">	 * requestQoS:		array of QoS values [0..2]</span></td></tr>
  <tr><td>252</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>253</td><td><span class="codeComment">	 * <span class="codeString">&quot;Flag&quot;</span> properties</span></td></tr>
  <tr><td>254</td><td><span class="codeComment">	 * cleanSession:	<span class="codeReserved">true</span> <span class="codeReserved">if</span> present / <span class="codeReserved">false</span> <span class="codeReserved">if</span> absent (CONNECT)</span></td></tr>
  <tr><td>255</td><td><span class="codeComment">	 * willMessage:  	<span class="codeReserved">true</span> <span class="codeReserved">if</span> present / <span class="codeReserved">false</span> <span class="codeReserved">if</span> absent (CONNECT)</span></td></tr>
  <tr><td>256</td><td><span class="codeComment">	 * isRetained:		<span class="codeReserved">true</span> <span class="codeReserved">if</span> present / <span class="codeReserved">false</span> <span class="codeReserved">if</span> absent (CONNECT)</span></td></tr>
  <tr><td>257</td><td><span class="codeComment">	 * userName:		<span class="codeReserved">true</span> <span class="codeReserved">if</span> present / <span class="codeReserved">false</span> <span class="codeReserved">if</span> absent (CONNECT)</span></td></tr>
  <tr><td>258</td><td><span class="codeComment">	 * password:		<span class="codeReserved">true</span> <span class="codeReserved">if</span> present / <span class="codeReserved">false</span> <span class="codeReserved">if</span> absent (CONNECT)</span></td></tr>
  <tr><td>259</td><td><span class="codeComment">	 * keepAliveInterval:	integer [0..65535]  (CONNECT)</span></td></tr>
  <tr><td>260</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>261</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>262</td><td><span class="codeComment">	 * @ignore</span></td></tr>
  <tr><td>263</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>264</td><td>	var WireMessage = <span class="codeReserved">function</span> (type, options) {</td></tr>
  <tr><td>265</td><td>		<span class="codeReserved">this</span>.type = type;</td></tr>
  <tr><td>266</td><td>		<span class="codeReserved">for</span> (var name <span class="codeReserved">in</span> options) {</td></tr>
  <tr><td>267</td><td>			<span class="codeReserved">if</span> (options.hasOwnProperty(name)) {</td></tr>
  <tr><td>268</td><td>				<span class="codeReserved">this</span>[name] = options[name];</td></tr>
  <tr><td>269</td><td>			}</td></tr>
  <tr><td>270</td><td>		}</td></tr>
  <tr><td>271</td><td>	};</td></tr>
  <tr><td>272</td><td></td></tr>
  <tr><td>273</td><td>	WireMessage.prototype.encode = <span class="codeReserved">function</span>() {</td></tr>
  <tr><td>274</td><td>		<span class="codeComment">// Compute the first byte of the fixed header</span></td></tr>
  <tr><td>275</td><td>		var first = ((<span class="codeReserved">this</span>.type & 0x0f) &lt;&lt; 4);</td></tr>
  <tr><td>276</td><td></td></tr>
  <tr><td>277</td><td>		<span class="codeComment">/*</span></td></tr>
  <tr><td>278</td><td><span class="codeComment">		 * Now calculate the length of the variable header + payload by adding up the lengths</span></td></tr>
  <tr><td>279</td><td><span class="codeComment">		 * of all the component parts</span></td></tr>
  <tr><td>280</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>281</td><td></td></tr>
  <tr><td>282</td><td>		var remLength = 0;</td></tr>
  <tr><td>283</td><td>		var topicStrLength = [];</td></tr>
  <tr><td>284</td><td>		var destinationNameLength = 0;</td></tr>
  <tr><td>285</td><td>		var willMessagePayloadBytes;</td></tr>
  <tr><td>286</td><td></td></tr>
  <tr><td>287</td><td>		<span class="codeComment">// <span class="codeReserved">if</span> the message contains a messageIdentifier then we need two bytes <span class="codeReserved">for</span> that</span></td></tr>
  <tr><td>288</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.messageIdentifier !== undefined)</td></tr>
  <tr><td>289</td><td>			remLength += 2;</td></tr>
  <tr><td>290</td><td></td></tr>
  <tr><td>291</td><td>		<span class="codeReserved">switch</span>(<span class="codeReserved">this</span>.type) {</td></tr>
  <tr><td>292</td><td>			<span class="codeComment">// If <span class="codeReserved">this</span> a Connect then we need to include 12 bytes <span class="codeReserved">for</span> its header</span></td></tr>
  <tr><td>293</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.CONNECT:</td></tr>
  <tr><td>294</td><td>				<span class="codeReserved">switch</span>(<span class="codeReserved">this</span>.mqttVersion) {</td></tr>
  <tr><td>295</td><td>					<span class="codeReserved">case</span> 3:</td></tr>
  <tr><td>296</td><td>						remLength += MqttProtoIdentifierv3.length + 3;</td></tr>
  <tr><td>297</td><td>						<span class="codeReserved">break</span>;</td></tr>
  <tr><td>298</td><td>					<span class="codeReserved">case</span> 4:</td></tr>
  <tr><td>299</td><td>						remLength += MqttProtoIdentifierv4.length + 3;</td></tr>
  <tr><td>300</td><td>						<span class="codeReserved">break</span>;</td></tr>
  <tr><td>301</td><td>				}</td></tr>
  <tr><td>302</td><td></td></tr>
  <tr><td>303</td><td>				remLength += UTF8Length(<span class="codeReserved">this</span>.clientId) + 2;</td></tr>
  <tr><td>304</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.willMessage !== undefined) {</td></tr>
  <tr><td>305</td><td>					remLength += UTF8Length(<span class="codeReserved">this</span>.willMessage.destinationName) + 2;</td></tr>
  <tr><td>306</td><td>					<span class="codeComment">// Will message is always a string, sent <span class="codeReserved">as</span> UTF-8 characters with a preceding length.</span></td></tr>
  <tr><td>307</td><td>					willMessagePayloadBytes = <span class="codeReserved">this</span>.willMessage.payloadBytes;</td></tr>
  <tr><td>308</td><td>					<span class="codeReserved">if</span> (!(willMessagePayloadBytes <span class="codeReserved">instanceof</span> Uint8Array))</td></tr>
  <tr><td>309</td><td>						willMessagePayloadBytes = <span class="codeReserved">new</span> Uint8Array(payloadBytes);</td></tr>
  <tr><td>310</td><td>					remLength += willMessagePayloadBytes.byteLength +2;</td></tr>
  <tr><td>311</td><td>				}</td></tr>
  <tr><td>312</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.userName !== undefined)</td></tr>
  <tr><td>313</td><td>					remLength += UTF8Length(<span class="codeReserved">this</span>.userName) + 2;</td></tr>
  <tr><td>314</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.password !== undefined)</td></tr>
  <tr><td>315</td><td>					remLength += UTF8Length(<span class="codeReserved">this</span>.password) + 2;</td></tr>
  <tr><td>316</td><td>			<span class="codeReserved">break</span>;</td></tr>
  <tr><td>317</td><td></td></tr>
  <tr><td>318</td><td>			<span class="codeComment">// Subscribe, Unsubscribe can both contain topic strings</span></td></tr>
  <tr><td>319</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.SUBSCRIBE:</td></tr>
  <tr><td>320</td><td>				first |= 0x02; <span class="codeComment">// Qos = 1;</span></td></tr>
  <tr><td>321</td><td>				<span class="codeReserved">for</span> ( var i = 0; i &lt; <span class="codeReserved">this</span>.topics.length; i++) {</td></tr>
  <tr><td>322</td><td>					topicStrLength[i] = UTF8Length(<span class="codeReserved">this</span>.topics[i]);</td></tr>
  <tr><td>323</td><td>					remLength += topicStrLength[i] + 2;</td></tr>
  <tr><td>324</td><td>				}</td></tr>
  <tr><td>325</td><td>				remLength += <span class="codeReserved">this</span>.requestedQos.length; <span class="codeComment">// 1 byte <span class="codeReserved">for</span> each topic&#039;s Qos</span></td></tr>
  <tr><td>326</td><td>				<span class="codeComment">// QoS on Subscribe only</span></td></tr>
  <tr><td>327</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>328</td><td></td></tr>
  <tr><td>329</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.UNSUBSCRIBE:</td></tr>
  <tr><td>330</td><td>				first |= 0x02; <span class="codeComment">// Qos = 1;</span></td></tr>
  <tr><td>331</td><td>				<span class="codeReserved">for</span> ( var i = 0; i &lt; <span class="codeReserved">this</span>.topics.length; i++) {</td></tr>
  <tr><td>332</td><td>					topicStrLength[i] = UTF8Length(<span class="codeReserved">this</span>.topics[i]);</td></tr>
  <tr><td>333</td><td>					remLength += topicStrLength[i] + 2;</td></tr>
  <tr><td>334</td><td>				}</td></tr>
  <tr><td>335</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>336</td><td></td></tr>
  <tr><td>337</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBREL:</td></tr>
  <tr><td>338</td><td>				first |= 0x02; <span class="codeComment">// Qos = 1;</span></td></tr>
  <tr><td>339</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>340</td><td></td></tr>
  <tr><td>341</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBLISH:</td></tr>
  <tr><td>342</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.payloadMessage.duplicate) first |= 0x08;</td></tr>
  <tr><td>343</td><td>				first  = first |= (<span class="codeReserved">this</span>.payloadMessage.qos &lt;&lt; 1);</td></tr>
  <tr><td>344</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.payloadMessage.retained) first |= 0x01;</td></tr>
  <tr><td>345</td><td>				destinationNameLength = UTF8Length(<span class="codeReserved">this</span>.payloadMessage.destinationName);</td></tr>
  <tr><td>346</td><td>				remLength += destinationNameLength + 2;</td></tr>
  <tr><td>347</td><td>				var payloadBytes = <span class="codeReserved">this</span>.payloadMessage.payloadBytes;</td></tr>
  <tr><td>348</td><td>				remLength += payloadBytes.byteLength;</td></tr>
  <tr><td>349</td><td>				<span class="codeReserved">if</span> (payloadBytes <span class="codeReserved">instanceof</span> ArrayBuffer)</td></tr>
  <tr><td>350</td><td>					payloadBytes = <span class="codeReserved">new</span> Uint8Array(payloadBytes);</td></tr>
  <tr><td>351</td><td>				<span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(payloadBytes <span class="codeReserved">instanceof</span> Uint8Array))</td></tr>
  <tr><td>352</td><td>					payloadBytes = <span class="codeReserved">new</span> Uint8Array(payloadBytes.buffer);</td></tr>
  <tr><td>353</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>354</td><td></td></tr>
  <tr><td>355</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.DISCONNECT:</td></tr>
  <tr><td>356</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>357</td><td></td></tr>
  <tr><td>358</td><td>			<span class="codeReserved">default</span>:</td></tr>
  <tr><td>359</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>360</td><td>		}</td></tr>
  <tr><td>361</td><td></td></tr>
  <tr><td>362</td><td>		<span class="codeComment">// Now we can allocate a buffer <span class="codeReserved">for</span> the message</span></td></tr>
  <tr><td>363</td><td></td></tr>
  <tr><td>364</td><td>		var mbi = encodeMBI(remLength);  <span class="codeComment">// Convert the length to MQTT MBI format</span></td></tr>
  <tr><td>365</td><td>		var pos = mbi.length + 1;        <span class="codeComment">// Offset of start of variable header</span></td></tr>
  <tr><td>366</td><td>		var buffer = <span class="codeReserved">new</span> ArrayBuffer(remLength + pos);</td></tr>
  <tr><td>367</td><td>		var byteStream = <span class="codeReserved">new</span> Uint8Array(buffer);    <span class="codeComment">// view it <span class="codeReserved">as</span> a sequence of bytes</span></td></tr>
  <tr><td>368</td><td></td></tr>
  <tr><td>369</td><td>		<span class="codeComment">//Write the fixed header into the buffer</span></td></tr>
  <tr><td>370</td><td>		byteStream[0] = first;</td></tr>
  <tr><td>371</td><td>		byteStream.set(mbi,1);</td></tr>
  <tr><td>372</td><td></td></tr>
  <tr><td>373</td><td>		<span class="codeComment">// If <span class="codeReserved">this</span> is a PUBLISH then the variable header starts with a topic</span></td></tr>
  <tr><td>374</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.type == MESSAGE_TYPE.PUBLISH)</td></tr>
  <tr><td>375</td><td>			pos = writeString(<span class="codeReserved">this</span>.payloadMessage.destinationName, destinationNameLength, byteStream, pos);</td></tr>
  <tr><td>376</td><td>		<span class="codeComment">// If <span class="codeReserved">this</span> is a CONNECT then the variable header contains the protocol name/version, flags and keepalive time</span></td></tr>
  <tr><td>377</td><td></td></tr>
  <tr><td>378</td><td>		<span class="codeReserved">else</span> <span class="codeReserved">if</span> (<span class="codeReserved">this</span>.type == MESSAGE_TYPE.CONNECT) {</td></tr>
  <tr><td>379</td><td>			<span class="codeReserved">switch</span> (<span class="codeReserved">this</span>.mqttVersion) {</td></tr>
  <tr><td>380</td><td>				<span class="codeReserved">case</span> 3:</td></tr>
  <tr><td>381</td><td>					byteStream.set(MqttProtoIdentifierv3, pos);</td></tr>
  <tr><td>382</td><td>					pos += MqttProtoIdentifierv3.length;</td></tr>
  <tr><td>383</td><td>					<span class="codeReserved">break</span>;</td></tr>
  <tr><td>384</td><td>				<span class="codeReserved">case</span> 4:</td></tr>
  <tr><td>385</td><td>					byteStream.set(MqttProtoIdentifierv4, pos);</td></tr>
  <tr><td>386</td><td>					pos += MqttProtoIdentifierv4.length;</td></tr>
  <tr><td>387</td><td>					<span class="codeReserved">break</span>;</td></tr>
  <tr><td>388</td><td>			}</td></tr>
  <tr><td>389</td><td>			var connectFlags = 0;</td></tr>
  <tr><td>390</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.cleanSession)</td></tr>
  <tr><td>391</td><td>				connectFlags = 0x02;</td></tr>
  <tr><td>392</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.willMessage !== undefined ) {</td></tr>
  <tr><td>393</td><td>				connectFlags |= 0x04;</td></tr>
  <tr><td>394</td><td>				connectFlags |= (<span class="codeReserved">this</span>.willMessage.qos&lt;&lt;<span class="codeReserved">3</span>);</td></tr>
  <tr><td>395</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.willMessage.retained) {</td></tr>
  <tr><td>396</td><td>					connectFlags |= 0x20;</td></tr>
  <tr><td>397</td><td>				}</td></tr>
  <tr><td>398</td><td>			}</td></tr>
  <tr><td>399</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.userName !== undefined)</td></tr>
  <tr><td>400</td><td>				connectFlags |= 0x80;</td></tr>
  <tr><td>401</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.password !== undefined)</td></tr>
  <tr><td>402</td><td>				connectFlags |= 0x40;</td></tr>
  <tr><td>403</td><td>			byteStream[pos++] = connectFlags;</td></tr>
  <tr><td>404</td><td>			pos = writeUint16 (<span class="codeReserved">this</span>.keepAliveInterval, byteStream, pos);</td></tr>
  <tr><td>405</td><td>		}</td></tr>
  <tr><td>406</td><td></td></tr>
  <tr><td>407</td><td>		<span class="codeComment">// Output the messageIdentifier - <span class="codeReserved">if</span> there is one</span></td></tr>
  <tr><td>408</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.messageIdentifier !== undefined)</td></tr>
  <tr><td>409</td><td>			pos = writeUint16 (<span class="codeReserved">this</span>.messageIdentifier, byteStream, pos);</td></tr>
  <tr><td>410</td><td></td></tr>
  <tr><td>411</td><td>		<span class="codeReserved">switch</span>(<span class="codeReserved">this</span>.type) {</td></tr>
  <tr><td>412</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.CONNECT:</td></tr>
  <tr><td>413</td><td>				pos = writeString(<span class="codeReserved">this</span>.clientId, UTF8Length(<span class="codeReserved">this</span>.clientId), byteStream, pos);</td></tr>
  <tr><td>414</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.willMessage !== undefined) {</td></tr>
  <tr><td>415</td><td>					pos = writeString(<span class="codeReserved">this</span>.willMessage.destinationName, UTF8Length(<span class="codeReserved">this</span>.willMessage.destinationName), byteStream, pos);</td></tr>
  <tr><td>416</td><td>					pos = writeUint16(willMessagePayloadBytes.byteLength, byteStream, pos);</td></tr>
  <tr><td>417</td><td>					byteStream.set(willMessagePayloadBytes, pos);</td></tr>
  <tr><td>418</td><td>					pos += willMessagePayloadBytes.byteLength;</td></tr>
  <tr><td>419</td><td></td></tr>
  <tr><td>420</td><td>				}</td></tr>
  <tr><td>421</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.userName !== undefined)</td></tr>
  <tr><td>422</td><td>				pos = writeString(<span class="codeReserved">this</span>.userName, UTF8Length(<span class="codeReserved">this</span>.userName), byteStream, pos);</td></tr>
  <tr><td>423</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.password !== undefined)</td></tr>
  <tr><td>424</td><td>				pos = writeString(<span class="codeReserved">this</span>.password, UTF8Length(<span class="codeReserved">this</span>.password), byteStream, pos);</td></tr>
  <tr><td>425</td><td>			<span class="codeReserved">break</span>;</td></tr>
  <tr><td>426</td><td></td></tr>
  <tr><td>427</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBLISH:</td></tr>
  <tr><td>428</td><td>				<span class="codeComment">// PUBLISH has a text or binary payload, <span class="codeReserved">if</span> text <span class="codeReserved">do</span> not add a 2 byte length field, just the UTF characters.</span></td></tr>
  <tr><td>429</td><td>				byteStream.set(payloadBytes, pos);</td></tr>
  <tr><td>430</td><td></td></tr>
  <tr><td>431</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>432</td><td></td></tr>
  <tr><td>433</td><td><span class="codeComment">//    	    <span class="codeReserved">case</span> MESSAGE_TYPE.PUBREC:</span></td></tr>
  <tr><td>434</td><td><span class="codeComment">//    	    <span class="codeReserved">case</span> MESSAGE_TYPE.PUBREL:</span></td></tr>
  <tr><td>435</td><td><span class="codeComment">//    	    <span class="codeReserved">case</span> MESSAGE_TYPE.PUBCOMP:</span></td></tr>
  <tr><td>436</td><td><span class="codeComment">//    	    	<span class="codeReserved">break</span>;</span></td></tr>
  <tr><td>437</td><td></td></tr>
  <tr><td>438</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.SUBSCRIBE:</td></tr>
  <tr><td>439</td><td>				<span class="codeComment">// SUBSCRIBE has a list of topic strings and request QoS</span></td></tr>
  <tr><td>440</td><td>				<span class="codeReserved">for</span> (var i=0; i&lt;<span class="codeReserved">this</span>.topics.length; i++) {</td></tr>
  <tr><td>441</td><td>					pos = writeString(<span class="codeReserved">this</span>.topics[i], topicStrLength[i], byteStream, pos);</td></tr>
  <tr><td>442</td><td>					byteStream[pos++] = <span class="codeReserved">this</span>.requestedQos[i];</td></tr>
  <tr><td>443</td><td>				}</td></tr>
  <tr><td>444</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>445</td><td></td></tr>
  <tr><td>446</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.UNSUBSCRIBE:</td></tr>
  <tr><td>447</td><td>				<span class="codeComment">// UNSUBSCRIBE has a list of topic strings</span></td></tr>
  <tr><td>448</td><td>				<span class="codeReserved">for</span> (var i=0; i&lt;<span class="codeReserved">this</span>.topics.length; i++)</td></tr>
  <tr><td>449</td><td>					pos = writeString(<span class="codeReserved">this</span>.topics[i], topicStrLength[i], byteStream, pos);</td></tr>
  <tr><td>450</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>451</td><td></td></tr>
  <tr><td>452</td><td>			<span class="codeReserved">default</span>:</td></tr>
  <tr><td>453</td><td>				<span class="codeComment">// Do nothing.</span></td></tr>
  <tr><td>454</td><td>		}</td></tr>
  <tr><td>455</td><td></td></tr>
  <tr><td>456</td><td>		<span class="codeReserved">return</span> buffer;</td></tr>
  <tr><td>457</td><td>	};</td></tr>
  <tr><td>458</td><td></td></tr>
  <tr><td>459</td><td>	<span class="codeReserved">function</span> decodeMessage(input,pos) {</td></tr>
  <tr><td>460</td><td>	    var startingPos = pos;</td></tr>
  <tr><td>461</td><td>		var first = input[pos];</td></tr>
  <tr><td>462</td><td>		var type = first &gt;&gt; 4;</td></tr>
  <tr><td>463</td><td>		var messageInfo = first &= 0x0f;</td></tr>
  <tr><td>464</td><td>		pos += 1;</td></tr>
  <tr><td>465</td><td></td></tr>
  <tr><td>466</td><td></td></tr>
  <tr><td>467</td><td>		<span class="codeComment">// Decode the remaining length (MBI format)</span></td></tr>
  <tr><td>468</td><td></td></tr>
  <tr><td>469</td><td>		var digit;</td></tr>
  <tr><td>470</td><td>		var remLength = 0;</td></tr>
  <tr><td>471</td><td>		var multiplier = 1;</td></tr>
  <tr><td>472</td><td>		<span class="codeReserved">do</span> {</td></tr>
  <tr><td>473</td><td>			<span class="codeReserved">if</span> (pos == input.length) {</td></tr>
  <tr><td>474</td><td>			    <span class="codeReserved">return</span> [<span class="codeReserved">null</span>,startingPos];</td></tr>
  <tr><td>475</td><td>			}</td></tr>
  <tr><td>476</td><td>			digit = input[pos++];</td></tr>
  <tr><td>477</td><td>			remLength += ((digit & 0x7F) * multiplier);</td></tr>
  <tr><td>478</td><td>			multiplier *= 128;</td></tr>
  <tr><td>479</td><td>		} <span class="codeReserved">while</span> ((digit & 0x80) !== 0);</td></tr>
  <tr><td>480</td><td></td></tr>
  <tr><td>481</td><td>		var endPos = pos+remLength;</td></tr>
  <tr><td>482</td><td>		<span class="codeReserved">if</span> (endPos &gt; input.length) {</td></tr>
  <tr><td>483</td><td>		    <span class="codeReserved">return</span> [<span class="codeReserved">null</span>,startingPos];</td></tr>
  <tr><td>484</td><td>		}</td></tr>
  <tr><td>485</td><td></td></tr>
  <tr><td>486</td><td>		var wireMessage = <span class="codeReserved">new</span> WireMessage(type);</td></tr>
  <tr><td>487</td><td>		<span class="codeReserved">switch</span>(type) {</td></tr>
  <tr><td>488</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.CONNACK:</td></tr>
  <tr><td>489</td><td>				var connectAcknowledgeFlags = input[pos++];</td></tr>
  <tr><td>490</td><td>				<span class="codeReserved">if</span> (connectAcknowledgeFlags & 0x01)</td></tr>
  <tr><td>491</td><td>					wireMessage.sessionPresent = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>492</td><td>				wireMessage.returnCode = input[pos++];</td></tr>
  <tr><td>493</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>494</td><td></td></tr>
  <tr><td>495</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBLISH:</td></tr>
  <tr><td>496</td><td>				var qos = (messageInfo &gt;&gt; 1) & 0x03;</td></tr>
  <tr><td>497</td><td></td></tr>
  <tr><td>498</td><td>				var len = readUint16(input, pos);</td></tr>
  <tr><td>499</td><td>				pos += 2;</td></tr>
  <tr><td>500</td><td>				var topicName = parseUTF8(input, pos, len);</td></tr>
  <tr><td>501</td><td>				pos += len;</td></tr>
  <tr><td>502</td><td>				<span class="codeComment">// If QoS 1 or 2 there will be a messageIdentifier</span></td></tr>
  <tr><td>503</td><td>				<span class="codeReserved">if</span> (qos &gt; 0) {</td></tr>
  <tr><td>504</td><td>					wireMessage.messageIdentifier = readUint16(input, pos);</td></tr>
  <tr><td>505</td><td>					pos += 2;</td></tr>
  <tr><td>506</td><td>				}</td></tr>
  <tr><td>507</td><td></td></tr>
  <tr><td>508</td><td>				var message = <span class="codeReserved">new</span> Paho.MQTT.Message(input.subarray(pos, endPos));</td></tr>
  <tr><td>509</td><td>				<span class="codeReserved">if</span> ((messageInfo & 0x01) == 0x01)</td></tr>
  <tr><td>510</td><td>					message.retained = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>511</td><td>				<span class="codeReserved">if</span> ((messageInfo & 0x08) == 0x08)</td></tr>
  <tr><td>512</td><td>					message.duplicate =  <span class="codeReserved">true</span>;</td></tr>
  <tr><td>513</td><td>				message.qos = qos;</td></tr>
  <tr><td>514</td><td>				message.destinationName = topicName;</td></tr>
  <tr><td>515</td><td>				wireMessage.payloadMessage = message;</td></tr>
  <tr><td>516</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>517</td><td></td></tr>
  <tr><td>518</td><td>			<span class="codeReserved">case</span>  MESSAGE_TYPE.PUBACK:</td></tr>
  <tr><td>519</td><td>			<span class="codeReserved">case</span>  MESSAGE_TYPE.PUBREC:</td></tr>
  <tr><td>520</td><td>			<span class="codeReserved">case</span>  MESSAGE_TYPE.PUBREL:</td></tr>
  <tr><td>521</td><td>			<span class="codeReserved">case</span>  MESSAGE_TYPE.PUBCOMP:</td></tr>
  <tr><td>522</td><td>			<span class="codeReserved">case</span>  MESSAGE_TYPE.UNSUBACK:</td></tr>
  <tr><td>523</td><td>				wireMessage.messageIdentifier = readUint16(input, pos);</td></tr>
  <tr><td>524</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>525</td><td></td></tr>
  <tr><td>526</td><td>			<span class="codeReserved">case</span>  MESSAGE_TYPE.SUBACK:</td></tr>
  <tr><td>527</td><td>				wireMessage.messageIdentifier = readUint16(input, pos);</td></tr>
  <tr><td>528</td><td>				pos += 2;</td></tr>
  <tr><td>529</td><td>				wireMessage.returnCode = input.subarray(pos, endPos);</td></tr>
  <tr><td>530</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>531</td><td></td></tr>
  <tr><td>532</td><td>			<span class="codeReserved">default</span>:</td></tr>
  <tr><td>533</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>534</td><td>		}</td></tr>
  <tr><td>535</td><td></td></tr>
  <tr><td>536</td><td>		<span class="codeReserved">return</span> [wireMessage,endPos];</td></tr>
  <tr><td>537</td><td>	}</td></tr>
  <tr><td>538</td><td></td></tr>
  <tr><td>539</td><td>	<span class="codeReserved">function</span> writeUint16(input, buffer, offset) {</td></tr>
  <tr><td>540</td><td>		buffer[offset++] = input &gt;&gt; 8;      <span class="codeComment">//MSB</span></td></tr>
  <tr><td>541</td><td>		buffer[offset++] = input % 256;     <span class="codeComment">//LSB</span></td></tr>
  <tr><td>542</td><td>		<span class="codeReserved">return</span> offset;</td></tr>
  <tr><td>543</td><td>	}</td></tr>
  <tr><td>544</td><td></td></tr>
  <tr><td>545</td><td>	<span class="codeReserved">function</span> writeString(input, utf8Length, buffer, offset) {</td></tr>
  <tr><td>546</td><td>		offset = writeUint16(utf8Length, buffer, offset);</td></tr>
  <tr><td>547</td><td>		stringToUTF8(input, buffer, offset);</td></tr>
  <tr><td>548</td><td>		<span class="codeReserved">return</span> offset + utf8Length;</td></tr>
  <tr><td>549</td><td>	}</td></tr>
  <tr><td>550</td><td></td></tr>
  <tr><td>551</td><td>	<span class="codeReserved">function</span> readUint16(buffer, offset) {</td></tr>
  <tr><td>552</td><td>		<span class="codeReserved">return</span> 256*buffer[offset] + buffer[offset+1];</td></tr>
  <tr><td>553</td><td>	}</td></tr>
  <tr><td>554</td><td></td></tr>
  <tr><td>555</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>556</td><td><span class="codeComment">	 * Encodes an MQTT Multi-Byte Integer</span></td></tr>
  <tr><td>557</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>558</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>559</td><td>	<span class="codeReserved">function</span> encodeMBI(number) {</td></tr>
  <tr><td>560</td><td>		var output = <span class="codeReserved">new</span> Array(1);</td></tr>
  <tr><td>561</td><td>		var numBytes = 0;</td></tr>
  <tr><td>562</td><td></td></tr>
  <tr><td>563</td><td>		<span class="codeReserved">do</span> {</td></tr>
  <tr><td>564</td><td>			var digit = number % 128;</td></tr>
  <tr><td>565</td><td>			number = number &gt;&gt; 7;</td></tr>
  <tr><td>566</td><td>			<span class="codeReserved">if</span> (number &gt; 0) {</td></tr>
  <tr><td>567</td><td>				digit |= 0x80;</td></tr>
  <tr><td>568</td><td>			}</td></tr>
  <tr><td>569</td><td>			output[numBytes++] = digit;</td></tr>
  <tr><td>570</td><td>		} <span class="codeReserved">while</span> ( (number &gt; 0) && (numBytes&lt;<span class="codeReserved">4</span>) );</td></tr>
  <tr><td>571</td><td></td></tr>
  <tr><td>572</td><td>		<span class="codeReserved">return</span> output;</td></tr>
  <tr><td>573</td><td>	}</td></tr>
  <tr><td>574</td><td></td></tr>
  <tr><td>575</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>576</td><td><span class="codeComment">	 * Takes a String and calculates its length <span class="codeReserved">in</span> bytes when encoded <span class="codeReserved">in</span> UTF8.</span></td></tr>
  <tr><td>577</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>578</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>579</td><td>	<span class="codeReserved">function</span> UTF8Length(input) {</td></tr>
  <tr><td>580</td><td>		var output = 0;</td></tr>
  <tr><td>581</td><td>		<span class="codeReserved">for</span> (var i = 0; i&lt;<span class="codeReserved">input</span>.length; i++)</td></tr>
  <tr><td>582</td><td>		{</td></tr>
  <tr><td>583</td><td>			var charCode = input.charCodeAt(i);</td></tr>
  <tr><td>584</td><td>				<span class="codeReserved">if</span> (charCode &gt; 0x7FF)</td></tr>
  <tr><td>585</td><td>				   {</td></tr>
  <tr><td>586</td><td>					  <span class="codeComment">// Surrogate pair means its a 4 byte character</span></td></tr>
  <tr><td>587</td><td>					  <span class="codeReserved">if</span> (0xD800 &lt;= charCode && charCode &lt;= 0xDBFF)</td></tr>
  <tr><td>588</td><td>						{</td></tr>
  <tr><td>589</td><td>						  i++;</td></tr>
  <tr><td>590</td><td>						  output++;</td></tr>
  <tr><td>591</td><td>						}</td></tr>
  <tr><td>592</td><td>				   output +=3;</td></tr>
  <tr><td>593</td><td>				   }</td></tr>
  <tr><td>594</td><td>			<span class="codeReserved">else</span> <span class="codeReserved">if</span> (charCode &gt; 0x7F)</td></tr>
  <tr><td>595</td><td>				output +=2;</td></tr>
  <tr><td>596</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>597</td><td>				output++;</td></tr>
  <tr><td>598</td><td>		}</td></tr>
  <tr><td>599</td><td>		<span class="codeReserved">return</span> output;</td></tr>
  <tr><td>600</td><td>	}</td></tr>
  <tr><td>601</td><td></td></tr>
  <tr><td>602</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>603</td><td><span class="codeComment">	 * Takes a String and writes it into an array <span class="codeReserved">as</span> UTF8 encoded bytes.</span></td></tr>
  <tr><td>604</td><td><span class="codeComment">	 * @<span class="codeReserved">private</span></span></td></tr>
  <tr><td>605</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>606</td><td>	<span class="codeReserved">function</span> stringToUTF8(input, output, start) {</td></tr>
  <tr><td>607</td><td>		var pos = start;</td></tr>
  <tr><td>608</td><td>		<span class="codeReserved">for</span> (var i = 0; i&lt;<span class="codeReserved">input</span>.length; i++) {</td></tr>
  <tr><td>609</td><td>			var charCode = input.charCodeAt(i);</td></tr>
  <tr><td>610</td><td></td></tr>
  <tr><td>611</td><td>			<span class="codeComment">// Check <span class="codeReserved">for</span> a surrogate pair.</span></td></tr>
  <tr><td>612</td><td>			<span class="codeReserved">if</span> (0xD800 &lt;= charCode && charCode &lt;= 0xDBFF) {</td></tr>
  <tr><td>613</td><td>				var lowCharCode = input.charCodeAt(++i);</td></tr>
  <tr><td>614</td><td>				<span class="codeReserved">if</span> (isNaN(lowCharCode)) {</td></tr>
  <tr><td>615</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.MALFORMED_UNICODE, [charCode, lowCharCode]));</td></tr>
  <tr><td>616</td><td>				}</td></tr>
  <tr><td>617</td><td>				charCode = ((charCode - 0xD800)&lt;&lt;<span class="codeReserved">10</span>) + (lowCharCode - 0xDC00) + 0x10000;</td></tr>
  <tr><td>618</td><td></td></tr>
  <tr><td>619</td><td>			}</td></tr>
  <tr><td>620</td><td></td></tr>
  <tr><td>621</td><td>			<span class="codeReserved">if</span> (charCode &lt;= 0x7F) {</td></tr>
  <tr><td>622</td><td>				output[pos++] = charCode;</td></tr>
  <tr><td>623</td><td>			} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (charCode &lt;= 0x7FF) {</td></tr>
  <tr><td>624</td><td>				output[pos++] = charCode&gt;&gt;6  & 0x1F | 0xC0;</td></tr>
  <tr><td>625</td><td>				output[pos++] = charCode     & 0x3F | 0x80;</td></tr>
  <tr><td>626</td><td>			} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (charCode &lt;= 0xFFFF) {</td></tr>
  <tr><td>627</td><td>				output[pos++] = charCode&gt;&gt;12 & 0x0F | 0xE0;</td></tr>
  <tr><td>628</td><td>				output[pos++] = charCode&gt;&gt;6  & 0x3F | 0x80;</td></tr>
  <tr><td>629</td><td>				output[pos++] = charCode     & 0x3F | 0x80;</td></tr>
  <tr><td>630</td><td>			} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>631</td><td>				output[pos++] = charCode&gt;&gt;18 & 0x07 | 0xF0;</td></tr>
  <tr><td>632</td><td>				output[pos++] = charCode&gt;&gt;12 & 0x3F | 0x80;</td></tr>
  <tr><td>633</td><td>				output[pos++] = charCode&gt;&gt;6  & 0x3F | 0x80;</td></tr>
  <tr><td>634</td><td>				output[pos++] = charCode     & 0x3F | 0x80;</td></tr>
  <tr><td>635</td><td>			}</td></tr>
  <tr><td>636</td><td>		}</td></tr>
  <tr><td>637</td><td>		<span class="codeReserved">return</span> output;</td></tr>
  <tr><td>638</td><td>	}</td></tr>
  <tr><td>639</td><td></td></tr>
  <tr><td>640</td><td>	<span class="codeReserved">function</span> parseUTF8(input, offset, length) {</td></tr>
  <tr><td>641</td><td>		var output = <span class="codeString">&quot;&quot;</span>;</td></tr>
  <tr><td>642</td><td>		var utf16;</td></tr>
  <tr><td>643</td><td>		var pos = offset;</td></tr>
  <tr><td>644</td><td></td></tr>
  <tr><td>645</td><td>		<span class="codeReserved">while</span> (pos &lt; offset+length)</td></tr>
  <tr><td>646</td><td>		{</td></tr>
  <tr><td>647</td><td>			var byte1 = input[pos++];</td></tr>
  <tr><td>648</td><td>			<span class="codeReserved">if</span> (byte1 &lt; 128)</td></tr>
  <tr><td>649</td><td>				utf16 = byte1;</td></tr>
  <tr><td>650</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>651</td><td>			{</td></tr>
  <tr><td>652</td><td>				var byte2 = input[pos++]-128;</td></tr>
  <tr><td>653</td><td>				<span class="codeReserved">if</span> (byte2 &lt; 0)</td></tr>
  <tr><td>654</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16),<span class="codeString">&quot;&quot;</span>]));</td></tr>
  <tr><td>655</td><td>				<span class="codeReserved">if</span> (byte1 &lt; 0xE0)             <span class="codeComment">// 2 byte character</span></td></tr>
  <tr><td>656</td><td>					utf16 = 64*(byte1-0xC0) + byte2;</td></tr>
  <tr><td>657</td><td>				<span class="codeReserved">else</span></td></tr>
  <tr><td>658</td><td>				{</td></tr>
  <tr><td>659</td><td>					var byte3 = input[pos++]-128;</td></tr>
  <tr><td>660</td><td>					<span class="codeReserved">if</span> (byte3 &lt; 0)</td></tr>
  <tr><td>661</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16)]));</td></tr>
  <tr><td>662</td><td>					<span class="codeReserved">if</span> (byte1 &lt; 0xF0)        <span class="codeComment">// 3 byte character</span></td></tr>
  <tr><td>663</td><td>						utf16 = 4096*(byte1-0xE0) + 64*byte2 + byte3;</td></tr>
  <tr><td>664</td><td>								<span class="codeReserved">else</span></td></tr>
  <tr><td>665</td><td>								{</td></tr>
  <tr><td>666</td><td>								   var byte4 = input[pos++]-128;</td></tr>
  <tr><td>667</td><td>								   <span class="codeReserved">if</span> (byte4 &lt; 0)</td></tr>
  <tr><td>668</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));</td></tr>
  <tr><td>669</td><td>								   <span class="codeReserved">if</span> (byte1 &lt; 0xF8)        <span class="codeComment">// 4 byte character</span></td></tr>
  <tr><td>670</td><td>										   utf16 = 262144*(byte1-0xF0) + 4096*byte2 + 64*byte3 + byte4;</td></tr>
  <tr><td>671</td><td>					   <span class="codeReserved">else</span>                     <span class="codeComment">// longer encodings are not supported</span></td></tr>
  <tr><td>672</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.MALFORMED_UTF, [byte1.toString(16), byte2.toString(16), byte3.toString(16), byte4.toString(16)]));</td></tr>
  <tr><td>673</td><td>								}</td></tr>
  <tr><td>674</td><td>				}</td></tr>
  <tr><td>675</td><td>			}</td></tr>
  <tr><td>676</td><td></td></tr>
  <tr><td>677</td><td>				<span class="codeReserved">if</span> (utf16 &gt; 0xFFFF)   <span class="codeComment">// 4 byte character - express <span class="codeReserved">as</span> a surrogate pair</span></td></tr>
  <tr><td>678</td><td>				  {</td></tr>
  <tr><td>679</td><td>					 utf16 -= 0x10000;</td></tr>
  <tr><td>680</td><td>					 output += String.fromCharCode(0xD800 + (utf16 &gt;&gt; 10)); <span class="codeComment">// lead character</span></td></tr>
  <tr><td>681</td><td>					 utf16 = 0xDC00 + (utf16 & 0x3FF);  <span class="codeComment">// trail character</span></td></tr>
  <tr><td>682</td><td>				  }</td></tr>
  <tr><td>683</td><td>			output += String.fromCharCode(utf16);</td></tr>
  <tr><td>684</td><td>		}</td></tr>
  <tr><td>685</td><td>		<span class="codeReserved">return</span> output;</td></tr>
  <tr><td>686</td><td>	}</td></tr>
  <tr><td>687</td><td></td></tr>
  <tr><td>688</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>689</td><td><span class="codeComment">	 * Repeat keepalive requests, monitor responses.</span></td></tr>
  <tr><td>690</td><td><span class="codeComment">	 * @ignore</span></td></tr>
  <tr><td>691</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>692</td><td>	var Pinger = <span class="codeReserved">function</span>(client, window, keepAliveInterval) {</td></tr>
  <tr><td>693</td><td>		<span class="codeReserved">this</span>._client = client;</td></tr>
  <tr><td>694</td><td>		<span class="codeReserved">this</span>._window = window;</td></tr>
  <tr><td>695</td><td>		<span class="codeReserved">this</span>._keepAliveInterval = keepAliveInterval*1000;</td></tr>
  <tr><td>696</td><td>		<span class="codeReserved">this</span>.isReset = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>697</td><td></td></tr>
  <tr><td>698</td><td>		var pingReq = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.PINGREQ).encode();</td></tr>
  <tr><td>699</td><td></td></tr>
  <tr><td>700</td><td>		var doTimeout = <span class="codeReserved">function</span> (pinger) {</td></tr>
  <tr><td>701</td><td>			<span class="codeReserved">return</span> <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>702</td><td>				<span class="codeReserved">return</span> doPing.apply(pinger);</td></tr>
  <tr><td>703</td><td>			};</td></tr>
  <tr><td>704</td><td>		};</td></tr>
  <tr><td>705</td><td></td></tr>
  <tr><td>706</td><td>		<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>707</td><td>		var doPing = <span class="codeReserved">function</span>() {</td></tr>
  <tr><td>708</td><td>			<span class="codeReserved">if</span> (!<span class="codeReserved">this</span>.isReset) {</td></tr>
  <tr><td>709</td><td>				<span class="codeReserved">this</span>._client._trace(<span class="codeString">&quot;Pinger.doPing&quot;</span>, <span class="codeString">&quot;Timed out&quot;</span>);</td></tr>
  <tr><td>710</td><td>				<span class="codeReserved">this</span>._client._disconnected( ERROR.PING_TIMEOUT.code , format(ERROR.PING_TIMEOUT));</td></tr>
  <tr><td>711</td><td>			} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>712</td><td>				<span class="codeReserved">this</span>.isReset = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>713</td><td>				<span class="codeReserved">this</span>._client._trace(<span class="codeString">&quot;Pinger.doPing&quot;</span>, <span class="codeString">&quot;send PINGREQ&quot;</span>);</td></tr>
  <tr><td>714</td><td>				<span class="codeReserved">this</span>._client.socket.send(pingReq);</td></tr>
  <tr><td>715</td><td>				<span class="codeReserved">this</span>.timeout = <span class="codeReserved">this</span>._window.setTimeout(doTimeout(<span class="codeReserved">this</span>), <span class="codeReserved">this</span>._keepAliveInterval);</td></tr>
  <tr><td>716</td><td>			}</td></tr>
  <tr><td>717</td><td>		};</td></tr>
  <tr><td>718</td><td></td></tr>
  <tr><td>719</td><td>		<span class="codeReserved">this</span>.reset = <span class="codeReserved">function</span>() {</td></tr>
  <tr><td>720</td><td>			<span class="codeReserved">this</span>.isReset = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>721</td><td>			<span class="codeReserved">this</span>._window.clearTimeout(<span class="codeReserved">this</span>.timeout);</td></tr>
  <tr><td>722</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._keepAliveInterval &gt; 0)</td></tr>
  <tr><td>723</td><td>				<span class="codeReserved">this</span>.timeout = setTimeout(doTimeout(<span class="codeReserved">this</span>), <span class="codeReserved">this</span>._keepAliveInterval);</td></tr>
  <tr><td>724</td><td>		};</td></tr>
  <tr><td>725</td><td></td></tr>
  <tr><td>726</td><td>		<span class="codeReserved">this</span>.cancel = <span class="codeReserved">function</span>() {</td></tr>
  <tr><td>727</td><td>			<span class="codeReserved">this</span>._window.clearTimeout(<span class="codeReserved">this</span>.timeout);</td></tr>
  <tr><td>728</td><td>		};</td></tr>
  <tr><td>729</td><td>	 };</td></tr>
  <tr><td>730</td><td></td></tr>
  <tr><td>731</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>732</td><td><span class="codeComment">	 * Monitor request completion.</span></td></tr>
  <tr><td>733</td><td><span class="codeComment">	 * @ignore</span></td></tr>
  <tr><td>734</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>735</td><td>	var Timeout = <span class="codeReserved">function</span>(client, window, timeoutSeconds, action, args) {</td></tr>
  <tr><td>736</td><td>		<span class="codeReserved">this</span>._window = window;</td></tr>
  <tr><td>737</td><td>		<span class="codeReserved">if</span> (!timeoutSeconds)</td></tr>
  <tr><td>738</td><td>			timeoutSeconds = 30;</td></tr>
  <tr><td>739</td><td></td></tr>
  <tr><td>740</td><td>		var doTimeout = <span class="codeReserved">function</span> (action, client, args) {</td></tr>
  <tr><td>741</td><td>			<span class="codeReserved">return</span> <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>742</td><td>				<span class="codeReserved">return</span> action.apply(client, args);</td></tr>
  <tr><td>743</td><td>			};</td></tr>
  <tr><td>744</td><td>		};</td></tr>
  <tr><td>745</td><td>		<span class="codeReserved">this</span>.timeout = setTimeout(doTimeout(action, client, args), timeoutSeconds * 1000);</td></tr>
  <tr><td>746</td><td></td></tr>
  <tr><td>747</td><td>		<span class="codeReserved">this</span>.cancel = <span class="codeReserved">function</span>() {</td></tr>
  <tr><td>748</td><td>			<span class="codeReserved">this</span>._window.clearTimeout(<span class="codeReserved">this</span>.timeout);</td></tr>
  <tr><td>749</td><td>		};</td></tr>
  <tr><td>750</td><td>	};</td></tr>
  <tr><td>751</td><td></td></tr>
  <tr><td>752</td><td>	<span class="codeComment">/*</span></td></tr>
  <tr><td>753</td><td><span class="codeComment">	 * Internal implementation of the Websockets MQTT V3.1 client.</span></td></tr>
  <tr><td>754</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>755</td><td><span class="codeComment">	 * @name Paho.MQTT.ClientImpl @<span class="codeReserved">constructor</span></span></td></tr>
  <tr><td>756</td><td><span class="codeComment">	 * @param {String} host the DNS nameof the webSocket host.</span></td></tr>
  <tr><td>757</td><td><span class="codeComment">	 * @param {Number} port the port number <span class="codeReserved">for</span> that host.</span></td></tr>
  <tr><td>758</td><td><span class="codeComment">	 * @param {String} clientId the MQ client identifier.</span></td></tr>
  <tr><td>759</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>760</td><td>	var ClientImpl = <span class="codeReserved">function</span> (uri, host, port, path, clientId) {</td></tr>
  <tr><td>761</td><td>		<span class="codeComment">// Check dependencies are satisfied <span class="codeReserved">in</span> <span class="codeReserved">this</span> browser.</span></td></tr>
  <tr><td>762</td><td>		<span class="codeReserved">if</span> (!(<span class="codeString">&quot;WebSocket&quot;</span> <span class="codeReserved">in</span> global && global.WebSocket !== <span class="codeReserved">null</span>)) {</td></tr>
  <tr><td>763</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED, [<span class="codeString">&quot;WebSocket&quot;</span>]));</td></tr>
  <tr><td>764</td><td>		}</td></tr>
  <tr><td>765</td><td>		<span class="codeReserved">if</span> (!(<span class="codeString">&quot;localStorage&quot;</span> <span class="codeReserved">in</span> global && global.localStorage !== <span class="codeReserved">null</span>)) {</td></tr>
  <tr><td>766</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED, [<span class="codeString">&quot;localStorage&quot;</span>]));</td></tr>
  <tr><td>767</td><td>		}</td></tr>
  <tr><td>768</td><td>		<span class="codeReserved">if</span> (!(<span class="codeString">&quot;ArrayBuffer&quot;</span> <span class="codeReserved">in</span> global && global.ArrayBuffer !== <span class="codeReserved">null</span>)) {</td></tr>
  <tr><td>769</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED, [<span class="codeString">&quot;ArrayBuffer&quot;</span>]));</td></tr>
  <tr><td>770</td><td>		}</td></tr>
  <tr><td>771</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Paho.MQTT.Client&quot;</span>, uri, host, port, path, clientId);</td></tr>
  <tr><td>772</td><td></td></tr>
  <tr><td>773</td><td>		<span class="codeReserved">this</span>.host = host;</td></tr>
  <tr><td>774</td><td>		<span class="codeReserved">this</span>.port = port;</td></tr>
  <tr><td>775</td><td>		<span class="codeReserved">this</span>.path = path;</td></tr>
  <tr><td>776</td><td>		<span class="codeReserved">this</span>.uri = uri;</td></tr>
  <tr><td>777</td><td>		<span class="codeReserved">this</span>.clientId = clientId;</td></tr>
  <tr><td>778</td><td>		<span class="codeReserved">this</span>._wsuri = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>779</td><td></td></tr>
  <tr><td>780</td><td>		<span class="codeComment">// Local storagekeys are qualified with the following string.</span></td></tr>
  <tr><td>781</td><td>		<span class="codeComment">// The conditional inclusion of path <span class="codeReserved">in</span> the key is <span class="codeReserved">for</span> backward</span></td></tr>
  <tr><td>782</td><td>		<span class="codeComment">// compatibility to when the path was not configurable and assumed to</span></td></tr>
  <tr><td>783</td><td>		<span class="codeComment">// be /mqtt</span></td></tr>
  <tr><td>784</td><td>		<span class="codeReserved">this</span>._localKey=host+<span class="codeString">&quot;:&quot;</span>+port+(path!=<span class="codeString">&quot;/mqtt&quot;</span>?<span class="codeString">&quot;:&quot;</span>+path:<span class="codeString">&quot;&quot;</span>)+<span class="codeString">&quot;:&quot;</span>+clientId+<span class="codeString">&quot;:&quot;</span>;</td></tr>
  <tr><td>785</td><td></td></tr>
  <tr><td>786</td><td>		<span class="codeComment">// Create <span class="codeReserved">private</span> instance-only message queue</span></td></tr>
  <tr><td>787</td><td>		<span class="codeComment">// Internal queue of messages to be sent, <span class="codeReserved">in</span> sending order.</span></td></tr>
  <tr><td>788</td><td>		<span class="codeReserved">this</span>._msg_queue = [];</td></tr>
  <tr><td>789</td><td>		<span class="codeReserved">this</span>._buffered_msg_queue = [];</td></tr>
  <tr><td>790</td><td></td></tr>
  <tr><td>791</td><td>		<span class="codeComment">// Messages we have sent and are expecting a response <span class="codeReserved">for</span>, indexed by their respective message ids.</span></td></tr>
  <tr><td>792</td><td>		<span class="codeReserved">this</span>._sentMessages = {};</td></tr>
  <tr><td>793</td><td></td></tr>
  <tr><td>794</td><td>		<span class="codeComment">// Messages we have received and acknowleged and are expecting a confirm message <span class="codeReserved">for</span></span></td></tr>
  <tr><td>795</td><td>		<span class="codeComment">// indexed by their respective message ids.</span></td></tr>
  <tr><td>796</td><td>		<span class="codeReserved">this</span>._receivedMessages = {};</td></tr>
  <tr><td>797</td><td></td></tr>
  <tr><td>798</td><td>		<span class="codeComment">// Internal list of callbacks to be executed when messages</span></td></tr>
  <tr><td>799</td><td>		<span class="codeComment">// have been successfully sent over web socket, e.g. disconnect</span></td></tr>
  <tr><td>800</td><td>		<span class="codeComment">// when it doesn&#039;t have to wait <span class="codeReserved">for</span> ACK, just message is dispatched.</span></td></tr>
  <tr><td>801</td><td>		<span class="codeReserved">this</span>._notify_msg_sent = {};</td></tr>
  <tr><td>802</td><td></td></tr>
  <tr><td>803</td><td>		<span class="codeComment">// Unique identifier <span class="codeReserved">for</span> SEND messages, incrementing</span></td></tr>
  <tr><td>804</td><td>		<span class="codeComment">// counter <span class="codeReserved">as</span> messages are sent.</span></td></tr>
  <tr><td>805</td><td>		<span class="codeReserved">this</span>._message_identifier = 1;</td></tr>
  <tr><td>806</td><td></td></tr>
  <tr><td>807</td><td>		<span class="codeComment">// Used to determine the transmission sequence of stored sent messages.</span></td></tr>
  <tr><td>808</td><td>		<span class="codeReserved">this</span>._sequence = 0;</td></tr>
  <tr><td>809</td><td></td></tr>
  <tr><td>810</td><td></td></tr>
  <tr><td>811</td><td>		<span class="codeComment">// Load the local state, <span class="codeReserved">if</span> any, <span class="codeReserved">from</span> the saved version, only restore state relevant to <span class="codeReserved">this</span> client.</span></td></tr>
  <tr><td>812</td><td>		<span class="codeReserved">for</span> (var key <span class="codeReserved">in</span> localStorage)</td></tr>
  <tr><td>813</td><td>			<span class="codeReserved">if</span> (   key.indexOf(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey) === 0 || key.indexOf(<span class="codeString">&quot;Received:&quot;</span>+<span class="codeReserved">this</span>._localKey) === 0)</td></tr>
  <tr><td>814</td><td>			<span class="codeReserved">this</span>.restore(key);</td></tr>
  <tr><td>815</td><td>	};</td></tr>
  <tr><td>816</td><td></td></tr>
  <tr><td>817</td><td>	<span class="codeComment">// Messaging Client <span class="codeReserved">public</span> instance members.</span></td></tr>
  <tr><td>818</td><td>	ClientImpl.prototype.host = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>819</td><td>	ClientImpl.prototype.port = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>820</td><td>	ClientImpl.prototype.path = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>821</td><td>	ClientImpl.prototype.uri = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>822</td><td>	ClientImpl.prototype.clientId = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>823</td><td></td></tr>
  <tr><td>824</td><td>	<span class="codeComment">// Messaging Client <span class="codeReserved">private</span> instance members.</span></td></tr>
  <tr><td>825</td><td>	ClientImpl.prototype.socket = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>826</td><td>	<span class="codeComment">/* <span class="codeReserved">true</span> once we have received an acknowledgement to a CONNECT packet. */</span></td></tr>
  <tr><td>827</td><td>	ClientImpl.prototype.connected = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>828</td><td>	<span class="codeComment">/* The largest message identifier allowed, may not be larger than 2**16 but</span></td></tr>
  <tr><td>829</td><td><span class="codeComment">	 * <span class="codeReserved">if</span> set smaller reduces the maximum number of outbound messages allowed.</span></td></tr>
  <tr><td>830</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>831</td><td>	ClientImpl.prototype.maxMessageIdentifier = 65536;</td></tr>
  <tr><td>832</td><td>	ClientImpl.prototype.connectOptions = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>833</td><td>	ClientImpl.prototype.hostIndex = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>834</td><td>	ClientImpl.prototype.onConnected = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>835</td><td>	ClientImpl.prototype.onConnectionLost = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>836</td><td>	ClientImpl.prototype.onMessageDelivered = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>837</td><td>	ClientImpl.prototype.onMessageArrived = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>838</td><td>	ClientImpl.prototype.traceFunction = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>839</td><td>	ClientImpl.prototype._msg_queue = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>840</td><td>	ClientImpl.prototype._buffered_msg_queue = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>841</td><td>	ClientImpl.prototype._connectTimeout = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>842</td><td>	<span class="codeComment">/* The sendPinger monitors how long we allow before we send data to prove to the server that we are alive. */</span></td></tr>
  <tr><td>843</td><td>	ClientImpl.prototype.sendPinger = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>844</td><td>	<span class="codeComment">/* The receivePinger monitors how long we allow before we require evidence that the server is alive. */</span></td></tr>
  <tr><td>845</td><td>	ClientImpl.prototype.receivePinger = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>846</td><td>	ClientImpl.prototype._reconnectInterval = 1; <span class="codeComment">// Reconnect Delay, starts at 1 second</span></td></tr>
  <tr><td>847</td><td>	ClientImpl.prototype._reconnecting = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>848</td><td>	ClientImpl.prototype._reconnectTimeout = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>849</td><td>	ClientImpl.prototype.disconnectedPublishing = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>850</td><td>	ClientImpl.prototype.disconnectedBufferSize = 5000;</td></tr>
  <tr><td>851</td><td></td></tr>
  <tr><td>852</td><td>	ClientImpl.prototype.receiveBuffer = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>853</td><td></td></tr>
  <tr><td>854</td><td>	ClientImpl.prototype._traceBuffer = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>855</td><td>	ClientImpl.prototype._MAX_TRACE_ENTRIES = 100;</td></tr>
  <tr><td>856</td><td></td></tr>
  <tr><td>857</td><td>	ClientImpl.prototype.connect = <span class="codeReserved">function</span> (connectOptions) {</td></tr>
  <tr><td>858</td><td>		var connectOptionsMasked = <span class="codeReserved">this</span>._traceMask(connectOptions, <span class="codeString">&quot;password&quot;</span>);</td></tr>
  <tr><td>859</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.connect&quot;</span>, connectOptionsMasked, <span class="codeReserved">this</span>.socket, <span class="codeReserved">this</span>.connected);</td></tr>
  <tr><td>860</td><td></td></tr>
  <tr><td>861</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connected)</td></tr>
  <tr><td>862</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_STATE, [<span class="codeString">&quot;already connected&quot;</span>]));</td></tr>
  <tr><td>863</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.socket)</td></tr>
  <tr><td>864</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_STATE, [<span class="codeString">&quot;already connected&quot;</span>]));</td></tr>
  <tr><td>865</td><td></td></tr>
  <tr><td>866</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._reconnecting) {</td></tr>
  <tr><td>867</td><td>			<span class="codeComment">// connect() <span class="codeReserved">function</span> is called <span class="codeReserved">while</span> reconnect is <span class="codeReserved">in</span> progress.</span></td></tr>
  <tr><td>868</td><td>			<span class="codeComment">// Terminate the auto reconnect process to use <span class="codeReserved">new</span> connect options.</span></td></tr>
  <tr><td>869</td><td>			<span class="codeReserved">this</span>._reconnectTimeout.cancel();</td></tr>
  <tr><td>870</td><td>			<span class="codeReserved">this</span>._reconnectTimeout = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>871</td><td>			<span class="codeReserved">this</span>._reconnecting = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>872</td><td>		}</td></tr>
  <tr><td>873</td><td></td></tr>
  <tr><td>874</td><td>		<span class="codeReserved">this</span>.connectOptions = connectOptions;</td></tr>
  <tr><td>875</td><td>		<span class="codeReserved">this</span>._reconnectInterval = 1;</td></tr>
  <tr><td>876</td><td>		<span class="codeReserved">this</span>._reconnecting = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>877</td><td>		<span class="codeReserved">if</span> (connectOptions.uris) {</td></tr>
  <tr><td>878</td><td>			<span class="codeReserved">this</span>.hostIndex = 0;</td></tr>
  <tr><td>879</td><td>			<span class="codeReserved">this</span>._doConnect(connectOptions.uris[0]);</td></tr>
  <tr><td>880</td><td>		} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>881</td><td>			<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.uri);</td></tr>
  <tr><td>882</td><td>		}</td></tr>
  <tr><td>883</td><td></td></tr>
  <tr><td>884</td><td>	};</td></tr>
  <tr><td>885</td><td></td></tr>
  <tr><td>886</td><td>	ClientImpl.prototype.subscribe = <span class="codeReserved">function</span> (filter, subscribeOptions) {</td></tr>
  <tr><td>887</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.subscribe&quot;</span>, filter, subscribeOptions);</td></tr>
  <tr><td>888</td><td></td></tr>
  <tr><td>889</td><td>		<span class="codeReserved">if</span> (!<span class="codeReserved">this</span>.connected)</td></tr>
  <tr><td>890</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_STATE, [<span class="codeString">&quot;not connected&quot;</span>]));</td></tr>
  <tr><td>891</td><td></td></tr>
  <tr><td>892</td><td>		var wireMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.SUBSCRIBE);</td></tr>
  <tr><td>893</td><td>		wireMessage.topics=[filter];</td></tr>
  <tr><td>894</td><td>		<span class="codeReserved">if</span> (subscribeOptions.qos !== undefined)</td></tr>
  <tr><td>895</td><td>			wireMessage.requestedQos = [subscribeOptions.qos];</td></tr>
  <tr><td>896</td><td>		<span class="codeReserved">else</span></td></tr>
  <tr><td>897</td><td>			wireMessage.requestedQos = [0];</td></tr>
  <tr><td>898</td><td></td></tr>
  <tr><td>899</td><td>		<span class="codeReserved">if</span> (subscribeOptions.onSuccess) {</td></tr>
  <tr><td>900</td><td>			wireMessage.onSuccess = <span class="codeReserved">function</span>(grantedQos) {subscribeOptions.onSuccess({invocationContext:subscribeOptions.invocationContext,grantedQos:grantedQos});};</td></tr>
  <tr><td>901</td><td>		}</td></tr>
  <tr><td>902</td><td></td></tr>
  <tr><td>903</td><td>		<span class="codeReserved">if</span> (subscribeOptions.onFailure) {</td></tr>
  <tr><td>904</td><td>			wireMessage.onFailure = <span class="codeReserved">function</span>(errorCode) {subscribeOptions.onFailure({invocationContext:subscribeOptions.invocationContext,errorCode:errorCode, errorMessage:format(errorCode)});};</td></tr>
  <tr><td>905</td><td>		}</td></tr>
  <tr><td>906</td><td></td></tr>
  <tr><td>907</td><td>		<span class="codeReserved">if</span> (subscribeOptions.timeout) {</td></tr>
  <tr><td>908</td><td>			wireMessage.timeOut = <span class="codeReserved">new</span> Timeout(<span class="codeReserved">this</span>, window, subscribeOptions.timeout, subscribeOptions.onFailure,</td></tr>
  <tr><td>909</td><td>						[{invocationContext:subscribeOptions.invocationContext,</td></tr>
  <tr><td>910</td><td>						errorCode:ERROR.SUBSCRIBE_TIMEOUT.code,</td></tr>
  <tr><td>911</td><td>						errorMessage:format(ERROR.SUBSCRIBE_TIMEOUT)}]);</td></tr>
  <tr><td>912</td><td>		}</td></tr>
  <tr><td>913</td><td></td></tr>
  <tr><td>914</td><td>		<span class="codeComment">// All subscriptions <span class="codeReserved">return</span> a SUBACK.</span></td></tr>
  <tr><td>915</td><td>		<span class="codeReserved">this</span>._requires_ack(wireMessage);</td></tr>
  <tr><td>916</td><td>		<span class="codeReserved">this</span>._schedule_message(wireMessage);</td></tr>
  <tr><td>917</td><td>	};</td></tr>
  <tr><td>918</td><td></td></tr>
  <tr><td>919</td><td>	<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>920</td><td>	ClientImpl.prototype.unsubscribe = <span class="codeReserved">function</span>(filter, unsubscribeOptions) {</td></tr>
  <tr><td>921</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.unsubscribe&quot;</span>, filter, unsubscribeOptions);</td></tr>
  <tr><td>922</td><td></td></tr>
  <tr><td>923</td><td>		<span class="codeReserved">if</span> (!<span class="codeReserved">this</span>.connected)</td></tr>
  <tr><td>924</td><td>		   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_STATE, [<span class="codeString">&quot;not connected&quot;</span>]));</td></tr>
  <tr><td>925</td><td></td></tr>
  <tr><td>926</td><td>		var wireMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.UNSUBSCRIBE);</td></tr>
  <tr><td>927</td><td>		wireMessage.topics = [filter];</td></tr>
  <tr><td>928</td><td></td></tr>
  <tr><td>929</td><td>		<span class="codeReserved">if</span> (unsubscribeOptions.onSuccess) {</td></tr>
  <tr><td>930</td><td>			wireMessage.callback = <span class="codeReserved">function</span>() {unsubscribeOptions.onSuccess({invocationContext:unsubscribeOptions.invocationContext});};</td></tr>
  <tr><td>931</td><td>		}</td></tr>
  <tr><td>932</td><td>		<span class="codeReserved">if</span> (unsubscribeOptions.timeout) {</td></tr>
  <tr><td>933</td><td>			wireMessage.timeOut = <span class="codeReserved">new</span> Timeout(<span class="codeReserved">this</span>, window, unsubscribeOptions.timeout, unsubscribeOptions.onFailure,</td></tr>
  <tr><td>934</td><td>					  [{invocationContext:unsubscribeOptions.invocationContext,</td></tr>
  <tr><td>935</td><td>						errorCode:ERROR.UNSUBSCRIBE_TIMEOUT.code,</td></tr>
  <tr><td>936</td><td>						errorMessage:format(ERROR.UNSUBSCRIBE_TIMEOUT)}]);</td></tr>
  <tr><td>937</td><td>		}</td></tr>
  <tr><td>938</td><td></td></tr>
  <tr><td>939</td><td>		<span class="codeComment">// All unsubscribes <span class="codeReserved">return</span> a SUBACK.</span></td></tr>
  <tr><td>940</td><td>		<span class="codeReserved">this</span>._requires_ack(wireMessage);</td></tr>
  <tr><td>941</td><td>		<span class="codeReserved">this</span>._schedule_message(wireMessage);</td></tr>
  <tr><td>942</td><td>	};</td></tr>
  <tr><td>943</td><td></td></tr>
  <tr><td>944</td><td>	ClientImpl.prototype.send = <span class="codeReserved">function</span> (message) {</td></tr>
  <tr><td>945</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.send&quot;</span>, message);</td></tr>
  <tr><td>946</td><td></td></tr>
  <tr><td>947</td><td>		wireMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.PUBLISH);</td></tr>
  <tr><td>948</td><td>		wireMessage.payloadMessage = message;</td></tr>
  <tr><td>949</td><td></td></tr>
  <tr><td>950</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connected) {</td></tr>
  <tr><td>951</td><td>			<span class="codeComment">// Mark qos 1 & 2 message <span class="codeReserved">as</span> <span class="codeString">&quot;ACK required&quot;</span></span></td></tr>
  <tr><td>952</td><td>			<span class="codeComment">// For qos 0 message, invoke onMessageDelivered callback <span class="codeReserved">if</span> there is one.</span></td></tr>
  <tr><td>953</td><td>			<span class="codeComment">// Then schedule the message.</span></td></tr>
  <tr><td>954</td><td>			<span class="codeReserved">if</span> (message.qos &gt; 0) {</td></tr>
  <tr><td>955</td><td>			<span class="codeReserved">this</span>._requires_ack(wireMessage);</td></tr>
  <tr><td>956</td><td>			} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (<span class="codeReserved">this</span>.onMessageDelivered) {</td></tr>
  <tr><td>957</td><td>			<span class="codeReserved">this</span>._notify_msg_sent[wireMessage] = <span class="codeReserved">this</span>.onMessageDelivered(wireMessage.payloadMessage);</td></tr>
  <tr><td>958</td><td>			}</td></tr>
  <tr><td>959</td><td>		<span class="codeReserved">this</span>._schedule_message(wireMessage);</td></tr>
  <tr><td>960</td><td>		} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>961</td><td>			<span class="codeComment">// Currently disconnected, will not schedule <span class="codeReserved">this</span> message</span></td></tr>
  <tr><td>962</td><td>			<span class="codeComment">// Check <span class="codeReserved">if</span> reconnecting is <span class="codeReserved">in</span> progress and disconnected publish is enabled.</span></td></tr>
  <tr><td>963</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._reconnecting && <span class="codeReserved">this</span>.disconnectedPublishing) {</td></tr>
  <tr><td>964</td><td>				<span class="codeComment">// Check the limit which include the <span class="codeString">&quot;required ACK&quot;</span> messages</span></td></tr>
  <tr><td>965</td><td>				var messageCount = Object.keys(<span class="codeReserved">this</span>._sentMessages).length + <span class="codeReserved">this</span>._buffered_msg_queue.length;</td></tr>
  <tr><td>966</td><td>				<span class="codeReserved">if</span> (messageCount &gt; <span class="codeReserved">this</span>.disconnectedBufferSize) {</td></tr>
  <tr><td>967</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.BUFFER_FULL, [<span class="codeReserved">this</span>.disconnectedBufferSize]));</td></tr>
  <tr><td>968</td><td>				} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>969</td><td>					<span class="codeReserved">if</span> (message.qos &gt; 0) {</td></tr>
  <tr><td>970</td><td>						<span class="codeComment">// Mark <span class="codeReserved">this</span> message <span class="codeReserved">as</span> <span class="codeString">&quot;ACK required&quot;</span></span></td></tr>
  <tr><td>971</td><td>						<span class="codeReserved">this</span>._requires_ack(wireMessage);</td></tr>
  <tr><td>972</td><td>					} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>973</td><td>						wireMessage.sequence = ++<span class="codeReserved">this</span>._sequence;</td></tr>
  <tr><td>974</td><td>						<span class="codeReserved">this</span>._buffered_msg_queue.push(wireMessage);</td></tr>
  <tr><td>975</td><td>					}</td></tr>
  <tr><td>976</td><td>				}</td></tr>
  <tr><td>977</td><td>			} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>978</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_STATE, [<span class="codeString">&quot;not connected&quot;</span>]));</td></tr>
  <tr><td>979</td><td>			}</td></tr>
  <tr><td>980</td><td>		}</td></tr>
  <tr><td>981</td><td>	};</td></tr>
  <tr><td>982</td><td></td></tr>
  <tr><td>983</td><td>	ClientImpl.prototype.disconnect = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>984</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.disconnect&quot;</span>);</td></tr>
  <tr><td>985</td><td></td></tr>
  <tr><td>986</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._reconnecting) {</td></tr>
  <tr><td>987</td><td>			<span class="codeComment">// disconnect() <span class="codeReserved">function</span> is called <span class="codeReserved">while</span> reconnect is <span class="codeReserved">in</span> progress.</span></td></tr>
  <tr><td>988</td><td>			<span class="codeComment">// Terminate the auto reconnect process.</span></td></tr>
  <tr><td>989</td><td>			<span class="codeReserved">this</span>._reconnectTimeout.cancel();</td></tr>
  <tr><td>990</td><td>			<span class="codeReserved">this</span>._reconnectTimeout = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>991</td><td>			<span class="codeReserved">this</span>._reconnecting = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>992</td><td>		}</td></tr>
  <tr><td>993</td><td></td></tr>
  <tr><td>994</td><td>		<span class="codeReserved">if</span> (!<span class="codeReserved">this</span>.socket)</td></tr>
  <tr><td>995</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_STATE, [<span class="codeString">&quot;not connecting or connected&quot;</span>]));</td></tr>
  <tr><td>996</td><td></td></tr>
  <tr><td>997</td><td>		wireMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.DISCONNECT);</td></tr>
  <tr><td>998</td><td></td></tr>
  <tr><td>999</td><td>		<span class="codeComment">// Run the disconnected call back <span class="codeReserved">as</span> soon <span class="codeReserved">as</span> the message has been sent,</span></td></tr>
  <tr><td>1000</td><td>		<span class="codeComment">// <span class="codeReserved">in</span> <span class="codeReserved">case</span> of a failure later on <span class="codeReserved">in</span> the disconnect processing.</span></td></tr>
  <tr><td>1001</td><td>		<span class="codeComment">// <span class="codeReserved">as</span> a consequence, the _disconected call back may be run several times.</span></td></tr>
  <tr><td>1002</td><td>		<span class="codeReserved">this</span>._notify_msg_sent[wireMessage] = scope(<span class="codeReserved">this</span>._disconnected, <span class="codeReserved">this</span>);</td></tr>
  <tr><td>1003</td><td></td></tr>
  <tr><td>1004</td><td>		<span class="codeReserved">this</span>._schedule_message(wireMessage);</td></tr>
  <tr><td>1005</td><td>	};</td></tr>
  <tr><td>1006</td><td></td></tr>
  <tr><td>1007</td><td>	ClientImpl.prototype.getTraceLog = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1008</td><td>		<span class="codeReserved">if</span> ( <span class="codeReserved">this</span>._traceBuffer !== <span class="codeReserved">null</span> ) {</td></tr>
  <tr><td>1009</td><td>			<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.getTraceLog&quot;</span>, <span class="codeReserved">new</span> Date());</td></tr>
  <tr><td>1010</td><td>			<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.getTraceLog <span class="codeReserved">in</span> flight messages&quot;</span>, <span class="codeReserved">this</span>._sentMessages.length);</td></tr>
  <tr><td>1011</td><td>			<span class="codeReserved">for</span> (var key <span class="codeReserved">in</span> <span class="codeReserved">this</span>._sentMessages)</td></tr>
  <tr><td>1012</td><td>				<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;_sentMessages &quot;</span>,key, <span class="codeReserved">this</span>._sentMessages[key]);</td></tr>
  <tr><td>1013</td><td>			<span class="codeReserved">for</span> (var key <span class="codeReserved">in</span> <span class="codeReserved">this</span>._receivedMessages)</td></tr>
  <tr><td>1014</td><td>				<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;_receivedMessages &quot;</span>,key, <span class="codeReserved">this</span>._receivedMessages[key]);</td></tr>
  <tr><td>1015</td><td></td></tr>
  <tr><td>1016</td><td>			<span class="codeReserved">return</span> <span class="codeReserved">this</span>._traceBuffer;</td></tr>
  <tr><td>1017</td><td>		}</td></tr>
  <tr><td>1018</td><td>	};</td></tr>
  <tr><td>1019</td><td></td></tr>
  <tr><td>1020</td><td>	ClientImpl.prototype.startTrace = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1021</td><td>		<span class="codeReserved">if</span> ( <span class="codeReserved">this</span>._traceBuffer === <span class="codeReserved">null</span> ) {</td></tr>
  <tr><td>1022</td><td>			<span class="codeReserved">this</span>._traceBuffer = [];</td></tr>
  <tr><td>1023</td><td>		}</td></tr>
  <tr><td>1024</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client.startTrace&quot;</span>, <span class="codeReserved">new</span> Date(), version);</td></tr>
  <tr><td>1025</td><td>	};</td></tr>
  <tr><td>1026</td><td></td></tr>
  <tr><td>1027</td><td>	ClientImpl.prototype.stopTrace = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1028</td><td>		delete <span class="codeReserved">this</span>._traceBuffer;</td></tr>
  <tr><td>1029</td><td>	};</td></tr>
  <tr><td>1030</td><td></td></tr>
  <tr><td>1031</td><td>	ClientImpl.prototype._doConnect = <span class="codeReserved">function</span> (wsurl) {</td></tr>
  <tr><td>1032</td><td>		<span class="codeComment">// When the socket is open, <span class="codeReserved">this</span> client will send the CONNECT WireMessage using the saved parameters.</span></td></tr>
  <tr><td>1033</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.useSSL) {</td></tr>
  <tr><td>1034</td><td>		    var uriParts = wsurl.split(<span class="codeString">&quot;:&quot;</span>);</td></tr>
  <tr><td>1035</td><td>		    uriParts[0] = <span class="codeString">&quot;wss&quot;</span>;</td></tr>
  <tr><td>1036</td><td>		    wsurl = uriParts.join(<span class="codeString">&quot;:&quot;</span>);</td></tr>
  <tr><td>1037</td><td>		}</td></tr>
  <tr><td>1038</td><td>		<span class="codeReserved">this</span>._wsuri = wsurl;</td></tr>
  <tr><td>1039</td><td>		<span class="codeReserved">this</span>.connected = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>1040</td><td></td></tr>
  <tr><td>1041</td><td></td></tr>
  <tr><td>1042</td><td></td></tr>
  <tr><td>1043</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.mqttVersion &lt; 4) {</td></tr>
  <tr><td>1044</td><td>			<span class="codeReserved">this</span>.socket = <span class="codeReserved">new</span> WebSocket(wsurl, [<span class="codeString">&quot;mqttv3.1&quot;</span>]);</td></tr>
  <tr><td>1045</td><td>		} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1046</td><td>			<span class="codeReserved">this</span>.socket = <span class="codeReserved">new</span> WebSocket(wsurl, [<span class="codeString">&quot;mqtt&quot;</span>]);</td></tr>
  <tr><td>1047</td><td>		}</td></tr>
  <tr><td>1048</td><td>		<span class="codeReserved">this</span>.socket.binaryType = <span class="codeString">&#039;arraybuffer&#039;</span>;</td></tr>
  <tr><td>1049</td><td>		<span class="codeReserved">this</span>.socket.onopen = scope(<span class="codeReserved">this</span>._on_socket_open, <span class="codeReserved">this</span>);</td></tr>
  <tr><td>1050</td><td>		<span class="codeReserved">this</span>.socket.onmessage = scope(<span class="codeReserved">this</span>._on_socket_message, <span class="codeReserved">this</span>);</td></tr>
  <tr><td>1051</td><td>		<span class="codeReserved">this</span>.socket.onerror = scope(<span class="codeReserved">this</span>._on_socket_error, <span class="codeReserved">this</span>);</td></tr>
  <tr><td>1052</td><td>		<span class="codeReserved">this</span>.socket.onclose = scope(<span class="codeReserved">this</span>._on_socket_close, <span class="codeReserved">this</span>);</td></tr>
  <tr><td>1053</td><td></td></tr>
  <tr><td>1054</td><td>		<span class="codeReserved">this</span>.sendPinger = <span class="codeReserved">new</span> Pinger(<span class="codeReserved">this</span>, window, <span class="codeReserved">this</span>.connectOptions.keepAliveInterval);</td></tr>
  <tr><td>1055</td><td>		<span class="codeReserved">this</span>.receivePinger = <span class="codeReserved">new</span> Pinger(<span class="codeReserved">this</span>, window, <span class="codeReserved">this</span>.connectOptions.keepAliveInterval);</td></tr>
  <tr><td>1056</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._connectTimeout) {</td></tr>
  <tr><td>1057</td><td>			<span class="codeReserved">this</span>._connectTimeout.cancel();</td></tr>
  <tr><td>1058</td><td>			<span class="codeReserved">this</span>._connectTimeout = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1059</td><td>		}</td></tr>
  <tr><td>1060</td><td>		<span class="codeReserved">this</span>._connectTimeout = <span class="codeReserved">new</span> Timeout(<span class="codeReserved">this</span>, window, <span class="codeReserved">this</span>.connectOptions.timeout, <span class="codeReserved">this</span>._disconnected,  [ERROR.CONNECT_TIMEOUT.code, format(ERROR.CONNECT_TIMEOUT)]);</td></tr>
  <tr><td>1061</td><td>	};</td></tr>
  <tr><td>1062</td><td></td></tr>
  <tr><td>1063</td><td></td></tr>
  <tr><td>1064</td><td>	<span class="codeComment">// Schedule a <span class="codeReserved">new</span> message to be sent over the WebSockets</span></td></tr>
  <tr><td>1065</td><td>	<span class="codeComment">// connection. CONNECT messages cause WebSocket connection</span></td></tr>
  <tr><td>1066</td><td>	<span class="codeComment">// to be started. All other messages are queued internally</span></td></tr>
  <tr><td>1067</td><td>	<span class="codeComment">// until <span class="codeReserved">this</span> has happened. When WS connection starts, process</span></td></tr>
  <tr><td>1068</td><td>	<span class="codeComment">// all outstanding messages.</span></td></tr>
  <tr><td>1069</td><td>	ClientImpl.prototype._schedule_message = <span class="codeReserved">function</span> (message) {</td></tr>
  <tr><td>1070</td><td>		<span class="codeReserved">this</span>._msg_queue.push(message);</td></tr>
  <tr><td>1071</td><td>		<span class="codeComment">// Process outstanding messages <span class="codeReserved">in</span> the queue <span class="codeReserved">if</span> we have an  open socket, and have received CONNACK.</span></td></tr>
  <tr><td>1072</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connected) {</td></tr>
  <tr><td>1073</td><td>			<span class="codeReserved">this</span>._process_queue();</td></tr>
  <tr><td>1074</td><td>		}</td></tr>
  <tr><td>1075</td><td>	};</td></tr>
  <tr><td>1076</td><td></td></tr>
  <tr><td>1077</td><td>	ClientImpl.prototype.store = <span class="codeReserved">function</span>(prefix, wireMessage) {</td></tr>
  <tr><td>1078</td><td>		var storedMessage = {type:wireMessage.type, messageIdentifier:wireMessage.messageIdentifier, version:1};</td></tr>
  <tr><td>1079</td><td></td></tr>
  <tr><td>1080</td><td>		<span class="codeReserved">switch</span>(wireMessage.type) {</td></tr>
  <tr><td>1081</td><td>		  <span class="codeReserved">case</span> MESSAGE_TYPE.PUBLISH:</td></tr>
  <tr><td>1082</td><td>			  <span class="codeReserved">if</span>(wireMessage.pubRecReceived)</td></tr>
  <tr><td>1083</td><td>				  storedMessage.pubRecReceived = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1084</td><td></td></tr>
  <tr><td>1085</td><td>			  <span class="codeComment">// Convert the payload to a hex string.</span></td></tr>
  <tr><td>1086</td><td>			  storedMessage.payloadMessage = {};</td></tr>
  <tr><td>1087</td><td>			  var hex = <span class="codeString">&quot;&quot;</span>;</td></tr>
  <tr><td>1088</td><td>			  var messageBytes = wireMessage.payloadMessage.payloadBytes;</td></tr>
  <tr><td>1089</td><td>			  <span class="codeReserved">for</span> (var i=0; i&lt;<span class="codeReserved">messageBytes</span>.length; i++) {</td></tr>
  <tr><td>1090</td><td>				<span class="codeReserved">if</span> (messageBytes[i] &lt;= 0xF)</td></tr>
  <tr><td>1091</td><td>				  hex = hex+<span class="codeString">&quot;0&quot;</span>+messageBytes[i].toString(16);</td></tr>
  <tr><td>1092</td><td>				<span class="codeReserved">else</span></td></tr>
  <tr><td>1093</td><td>				  hex = hex+messageBytes[i].toString(16);</td></tr>
  <tr><td>1094</td><td>			  }</td></tr>
  <tr><td>1095</td><td>			  storedMessage.payloadMessage.payloadHex = hex;</td></tr>
  <tr><td>1096</td><td></td></tr>
  <tr><td>1097</td><td>			  storedMessage.payloadMessage.qos = wireMessage.payloadMessage.qos;</td></tr>
  <tr><td>1098</td><td>			  storedMessage.payloadMessage.destinationName = wireMessage.payloadMessage.destinationName;</td></tr>
  <tr><td>1099</td><td>			  <span class="codeReserved">if</span> (wireMessage.payloadMessage.duplicate)</td></tr>
  <tr><td>1100</td><td>				  storedMessage.payloadMessage.duplicate = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1101</td><td>			  <span class="codeReserved">if</span> (wireMessage.payloadMessage.retained)</td></tr>
  <tr><td>1102</td><td>				  storedMessage.payloadMessage.retained = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1103</td><td></td></tr>
  <tr><td>1104</td><td>			  <span class="codeComment">// Add a sequence number to sent messages.</span></td></tr>
  <tr><td>1105</td><td>			  <span class="codeReserved">if</span> ( prefix.indexOf(<span class="codeString">&quot;Sent:&quot;</span>) === 0 ) {</td></tr>
  <tr><td>1106</td><td>				  <span class="codeReserved">if</span> ( wireMessage.sequence === undefined )</td></tr>
  <tr><td>1107</td><td>					  wireMessage.sequence = ++<span class="codeReserved">this</span>._sequence;</td></tr>
  <tr><td>1108</td><td>				  storedMessage.sequence = wireMessage.sequence;</td></tr>
  <tr><td>1109</td><td>			  }</td></tr>
  <tr><td>1110</td><td>			  <span class="codeReserved">break</span>;</td></tr>
  <tr><td>1111</td><td></td></tr>
  <tr><td>1112</td><td>			<span class="codeReserved">default</span>:</td></tr>
  <tr><td>1113</td><td>				<span class="codeReserved">throw</span> Error(format(ERROR.INVALID_STORED_DATA, [key, storedMessage]));</td></tr>
  <tr><td>1114</td><td>		}</td></tr>
  <tr><td>1115</td><td>		localStorage.setItem(prefix+<span class="codeReserved">this</span>._localKey+wireMessage.messageIdentifier, JSON.stringify(storedMessage));</td></tr>
  <tr><td>1116</td><td>	};</td></tr>
  <tr><td>1117</td><td></td></tr>
  <tr><td>1118</td><td>	ClientImpl.prototype.restore = <span class="codeReserved">function</span>(key) {</td></tr>
  <tr><td>1119</td><td>		var value = localStorage.getItem(key);</td></tr>
  <tr><td>1120</td><td>		var storedMessage = JSON.parse(value);</td></tr>
  <tr><td>1121</td><td></td></tr>
  <tr><td>1122</td><td>		var wireMessage = <span class="codeReserved">new</span> WireMessage(storedMessage.type, storedMessage);</td></tr>
  <tr><td>1123</td><td></td></tr>
  <tr><td>1124</td><td>		<span class="codeReserved">switch</span>(storedMessage.type) {</td></tr>
  <tr><td>1125</td><td>		  <span class="codeReserved">case</span> MESSAGE_TYPE.PUBLISH:</td></tr>
  <tr><td>1126</td><td>			  <span class="codeComment">// Replace the payload message with a Message object.</span></td></tr>
  <tr><td>1127</td><td>			  var hex = storedMessage.payloadMessage.payloadHex;</td></tr>
  <tr><td>1128</td><td>			  var buffer = <span class="codeReserved">new</span> ArrayBuffer((hex.length)/2);</td></tr>
  <tr><td>1129</td><td>			  var byteStream = <span class="codeReserved">new</span> Uint8Array(buffer);</td></tr>
  <tr><td>1130</td><td>			  var i = 0;</td></tr>
  <tr><td>1131</td><td>			  <span class="codeReserved">while</span> (hex.length &gt;= 2) {</td></tr>
  <tr><td>1132</td><td>				  var x = parseInt(hex.substring(0, 2), 16);</td></tr>
  <tr><td>1133</td><td>				  hex = hex.substring(2, hex.length);</td></tr>
  <tr><td>1134</td><td>				  byteStream[i++] = x;</td></tr>
  <tr><td>1135</td><td>			  }</td></tr>
  <tr><td>1136</td><td>			  var payloadMessage = <span class="codeReserved">new</span> Paho.MQTT.Message(byteStream);</td></tr>
  <tr><td>1137</td><td></td></tr>
  <tr><td>1138</td><td>			  payloadMessage.qos = storedMessage.payloadMessage.qos;</td></tr>
  <tr><td>1139</td><td>			  payloadMessage.destinationName = storedMessage.payloadMessage.destinationName;</td></tr>
  <tr><td>1140</td><td>			  <span class="codeReserved">if</span> (storedMessage.payloadMessage.duplicate)</td></tr>
  <tr><td>1141</td><td>				  payloadMessage.duplicate = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1142</td><td>			  <span class="codeReserved">if</span> (storedMessage.payloadMessage.retained)</td></tr>
  <tr><td>1143</td><td>				  payloadMessage.retained = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1144</td><td>			  wireMessage.payloadMessage = payloadMessage;</td></tr>
  <tr><td>1145</td><td></td></tr>
  <tr><td>1146</td><td>			  <span class="codeReserved">break</span>;</td></tr>
  <tr><td>1147</td><td></td></tr>
  <tr><td>1148</td><td>			<span class="codeReserved">default</span>:</td></tr>
  <tr><td>1149</td><td>			  <span class="codeReserved">throw</span> Error(format(ERROR.INVALID_STORED_DATA, [key, value]));</td></tr>
  <tr><td>1150</td><td>		}</td></tr>
  <tr><td>1151</td><td></td></tr>
  <tr><td>1152</td><td>		<span class="codeReserved">if</span> (key.indexOf(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey) === 0) {</td></tr>
  <tr><td>1153</td><td>			wireMessage.payloadMessage.duplicate = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1154</td><td>			<span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier] = wireMessage;</td></tr>
  <tr><td>1155</td><td>		} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (key.indexOf(<span class="codeString">&quot;Received:&quot;</span>+<span class="codeReserved">this</span>._localKey) === 0) {</td></tr>
  <tr><td>1156</td><td>			<span class="codeReserved">this</span>._receivedMessages[wireMessage.messageIdentifier] = wireMessage;</td></tr>
  <tr><td>1157</td><td>		}</td></tr>
  <tr><td>1158</td><td>	};</td></tr>
  <tr><td>1159</td><td></td></tr>
  <tr><td>1160</td><td>	ClientImpl.prototype._process_queue = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1161</td><td>		var message = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1162</td><td>		<span class="codeComment">// Process messages <span class="codeReserved">in</span> order they were added</span></td></tr>
  <tr><td>1163</td><td>		var fifo = <span class="codeReserved">this</span>._msg_queue.reverse();</td></tr>
  <tr><td>1164</td><td></td></tr>
  <tr><td>1165</td><td>		<span class="codeComment">// Send all queued messages down socket connection</span></td></tr>
  <tr><td>1166</td><td>		<span class="codeReserved">while</span> ((message = fifo.pop())) {</td></tr>
  <tr><td>1167</td><td>			<span class="codeReserved">this</span>._socket_send(message);</td></tr>
  <tr><td>1168</td><td>			<span class="codeComment">// Notify listeners that message was successfully sent</span></td></tr>
  <tr><td>1169</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._notify_msg_sent[message]) {</td></tr>
  <tr><td>1170</td><td>				<span class="codeReserved">this</span>._notify_msg_sent[message]();</td></tr>
  <tr><td>1171</td><td>				delete <span class="codeReserved">this</span>._notify_msg_sent[message];</td></tr>
  <tr><td>1172</td><td>			}</td></tr>
  <tr><td>1173</td><td>		}</td></tr>
  <tr><td>1174</td><td>	};</td></tr>
  <tr><td>1175</td><td></td></tr>
  <tr><td>1176</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>1177</td><td><span class="codeComment">	 * Expect an ACK response <span class="codeReserved">for</span> <span class="codeReserved">this</span> message. Add message to the set of <span class="codeReserved">in</span> progress</span></td></tr>
  <tr><td>1178</td><td><span class="codeComment">	 * messages and set an unused identifier <span class="codeReserved">in</span> <span class="codeReserved">this</span> message.</span></td></tr>
  <tr><td>1179</td><td><span class="codeComment">	 * @ignore</span></td></tr>
  <tr><td>1180</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>1181</td><td>	ClientImpl.prototype._requires_ack = <span class="codeReserved">function</span> (wireMessage) {</td></tr>
  <tr><td>1182</td><td>		var messageCount = Object.keys(<span class="codeReserved">this</span>._sentMessages).length;</td></tr>
  <tr><td>1183</td><td>		<span class="codeReserved">if</span> (messageCount &gt; <span class="codeReserved">this</span>.maxMessageIdentifier)</td></tr>
  <tr><td>1184</td><td>			<span class="codeReserved">throw</span> Error (<span class="codeString">&quot;Too many messages:&quot;</span>+messageCount);</td></tr>
  <tr><td>1185</td><td></td></tr>
  <tr><td>1186</td><td>		<span class="codeReserved">while</span>(<span class="codeReserved">this</span>._sentMessages[<span class="codeReserved">this</span>._message_identifier] !== undefined) {</td></tr>
  <tr><td>1187</td><td>			<span class="codeReserved">this</span>._message_identifier++;</td></tr>
  <tr><td>1188</td><td>		}</td></tr>
  <tr><td>1189</td><td>		wireMessage.messageIdentifier = <span class="codeReserved">this</span>._message_identifier;</td></tr>
  <tr><td>1190</td><td>		<span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier] = wireMessage;</td></tr>
  <tr><td>1191</td><td>		<span class="codeReserved">if</span> (wireMessage.type === MESSAGE_TYPE.PUBLISH) {</td></tr>
  <tr><td>1192</td><td>			<span class="codeReserved">this</span>.store(<span class="codeString">&quot;Sent:&quot;</span>, wireMessage);</td></tr>
  <tr><td>1193</td><td>		}</td></tr>
  <tr><td>1194</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._message_identifier === <span class="codeReserved">this</span>.maxMessageIdentifier) {</td></tr>
  <tr><td>1195</td><td>			<span class="codeReserved">this</span>._message_identifier = 1;</td></tr>
  <tr><td>1196</td><td>		}</td></tr>
  <tr><td>1197</td><td>	};</td></tr>
  <tr><td>1198</td><td></td></tr>
  <tr><td>1199</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>1200</td><td><span class="codeComment">	 * Called when the underlying websocket has been opened.</span></td></tr>
  <tr><td>1201</td><td><span class="codeComment">	 * @ignore</span></td></tr>
  <tr><td>1202</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>1203</td><td>	ClientImpl.prototype._on_socket_open = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1204</td><td>		<span class="codeComment">// Create the CONNECT message object.</span></td></tr>
  <tr><td>1205</td><td>		var wireMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.CONNECT, <span class="codeReserved">this</span>.connectOptions);</td></tr>
  <tr><td>1206</td><td>		wireMessage.clientId = <span class="codeReserved">this</span>.clientId;</td></tr>
  <tr><td>1207</td><td>		<span class="codeReserved">this</span>._socket_send(wireMessage);</td></tr>
  <tr><td>1208</td><td>	};</td></tr>
  <tr><td>1209</td><td></td></tr>
  <tr><td>1210</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>1211</td><td><span class="codeComment">	 * Called when the underlying websocket has received a complete packet.</span></td></tr>
  <tr><td>1212</td><td><span class="codeComment">	 * @ignore</span></td></tr>
  <tr><td>1213</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>1214</td><td>	ClientImpl.prototype._on_socket_message = <span class="codeReserved">function</span> (event) {</td></tr>
  <tr><td>1215</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._on_socket_message&quot;</span>, event.data);</td></tr>
  <tr><td>1216</td><td>		var messages = <span class="codeReserved">this</span>._deframeMessages(event.data);</td></tr>
  <tr><td>1217</td><td>		<span class="codeReserved">for</span> (var i = 0; i &lt; messages.length; i+=1) {</td></tr>
  <tr><td>1218</td><td>		    <span class="codeReserved">this</span>._handleMessage(messages[i]);</td></tr>
  <tr><td>1219</td><td>		}</td></tr>
  <tr><td>1220</td><td>	};</td></tr>
  <tr><td>1221</td><td></td></tr>
  <tr><td>1222</td><td>	ClientImpl.prototype._deframeMessages = <span class="codeReserved">function</span>(data) {</td></tr>
  <tr><td>1223</td><td>		var byteArray = <span class="codeReserved">new</span> Uint8Array(data);</td></tr>
  <tr><td>1224</td><td>		var messages = [];</td></tr>
  <tr><td>1225</td><td>	    <span class="codeReserved">if</span> (<span class="codeReserved">this</span>.receiveBuffer) {</td></tr>
  <tr><td>1226</td><td>	        var newData = <span class="codeReserved">new</span> Uint8Array(<span class="codeReserved">this</span>.receiveBuffer.length+byteArray.length);</td></tr>
  <tr><td>1227</td><td>	        newData.set(<span class="codeReserved">this</span>.receiveBuffer);</td></tr>
  <tr><td>1228</td><td>	        newData.set(byteArray,<span class="codeReserved">this</span>.receiveBuffer.length);</td></tr>
  <tr><td>1229</td><td>	        byteArray = newData;</td></tr>
  <tr><td>1230</td><td>	        delete <span class="codeReserved">this</span>.receiveBuffer;</td></tr>
  <tr><td>1231</td><td>	    }</td></tr>
  <tr><td>1232</td><td>		<span class="codeReserved">try</span> {</td></tr>
  <tr><td>1233</td><td>		    var offset = 0;</td></tr>
  <tr><td>1234</td><td>		    <span class="codeReserved">while</span>(offset &lt; byteArray.length) {</td></tr>
  <tr><td>1235</td><td>		        var result = decodeMessage(byteArray,offset);</td></tr>
  <tr><td>1236</td><td>		        var wireMessage = result[0];</td></tr>
  <tr><td>1237</td><td>		        offset = result[1];</td></tr>
  <tr><td>1238</td><td>		        <span class="codeReserved">if</span> (wireMessage !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>1239</td><td>		            messages.push(wireMessage);</td></tr>
  <tr><td>1240</td><td>		        } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1241</td><td>		            <span class="codeReserved">break</span>;</td></tr>
  <tr><td>1242</td><td>		        }</td></tr>
  <tr><td>1243</td><td>		    }</td></tr>
  <tr><td>1244</td><td>		    <span class="codeReserved">if</span> (offset &lt; byteArray.length) {</td></tr>
  <tr><td>1245</td><td>		    	<span class="codeReserved">this</span>.receiveBuffer = byteArray.subarray(offset);</td></tr>
  <tr><td>1246</td><td>		    }</td></tr>
  <tr><td>1247</td><td>		} <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>1248</td><td>			var errorStack = ((error.hasOwnProperty(<span class="codeString">&#039;stack&#039;</span>) == <span class="codeString">&#039;undefined&#039;</span>) ? error.stack.toString() : <span class="codeString">&quot;No Error Stack Available&quot;</span>);</td></tr>
  <tr><td>1249</td><td>			<span class="codeReserved">this</span>._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));</td></tr>
  <tr><td>1250</td><td>			<span class="codeReserved">return</span>;</td></tr>
  <tr><td>1251</td><td>		}</td></tr>
  <tr><td>1252</td><td>		<span class="codeReserved">return</span> messages;</td></tr>
  <tr><td>1253</td><td>	};</td></tr>
  <tr><td>1254</td><td></td></tr>
  <tr><td>1255</td><td>	ClientImpl.prototype._handleMessage = <span class="codeReserved">function</span>(wireMessage) {</td></tr>
  <tr><td>1256</td><td></td></tr>
  <tr><td>1257</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._handleMessage&quot;</span>, wireMessage);</td></tr>
  <tr><td>1258</td><td></td></tr>
  <tr><td>1259</td><td>		<span class="codeReserved">try</span> {</td></tr>
  <tr><td>1260</td><td>			<span class="codeReserved">switch</span>(wireMessage.type) {</td></tr>
  <tr><td>1261</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.CONNACK:</td></tr>
  <tr><td>1262</td><td>				<span class="codeReserved">this</span>._connectTimeout.cancel();</td></tr>
  <tr><td>1263</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._reconnectTimeout)</td></tr>
  <tr><td>1264</td><td>					<span class="codeReserved">this</span>._reconnectTimeout.cancel();</td></tr>
  <tr><td>1265</td><td></td></tr>
  <tr><td>1266</td><td>				<span class="codeComment">// If we have started using clean session then clear up the local state.</span></td></tr>
  <tr><td>1267</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.cleanSession) {</td></tr>
  <tr><td>1268</td><td>					<span class="codeReserved">for</span> (var key <span class="codeReserved">in</span> <span class="codeReserved">this</span>._sentMessages) {</td></tr>
  <tr><td>1269</td><td>						var sentMessage = <span class="codeReserved">this</span>._sentMessages[key];</td></tr>
  <tr><td>1270</td><td>						localStorage.removeItem(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey+sentMessage.messageIdentifier);</td></tr>
  <tr><td>1271</td><td>					}</td></tr>
  <tr><td>1272</td><td>					<span class="codeReserved">this</span>._sentMessages = {};</td></tr>
  <tr><td>1273</td><td></td></tr>
  <tr><td>1274</td><td>					<span class="codeReserved">for</span> (var key <span class="codeReserved">in</span> <span class="codeReserved">this</span>._receivedMessages) {</td></tr>
  <tr><td>1275</td><td>						var receivedMessage = <span class="codeReserved">this</span>._receivedMessages[key];</td></tr>
  <tr><td>1276</td><td>						localStorage.removeItem(<span class="codeString">&quot;Received:&quot;</span>+<span class="codeReserved">this</span>._localKey+receivedMessage.messageIdentifier);</td></tr>
  <tr><td>1277</td><td>					}</td></tr>
  <tr><td>1278</td><td>					<span class="codeReserved">this</span>._receivedMessages = {};</td></tr>
  <tr><td>1279</td><td>				}</td></tr>
  <tr><td>1280</td><td>				<span class="codeComment">// Client connected and ready <span class="codeReserved">for</span> business.</span></td></tr>
  <tr><td>1281</td><td>				<span class="codeReserved">if</span> (wireMessage.returnCode === 0) {</td></tr>
  <tr><td>1282</td><td></td></tr>
  <tr><td>1283</td><td>					<span class="codeReserved">this</span>.connected = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1284</td><td>					<span class="codeComment">// Jump to the end of the list of uris and stop looking <span class="codeReserved">for</span> a good host.</span></td></tr>
  <tr><td>1285</td><td></td></tr>
  <tr><td>1286</td><td>					<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.uris)</td></tr>
  <tr><td>1287</td><td>            <span class="codeReserved">this</span>.hostIndex = <span class="codeReserved">this</span>.connectOptions.uris.length;</td></tr>
  <tr><td>1288</td><td></td></tr>
  <tr><td>1289</td><td>				} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1290</td><td>					<span class="codeReserved">this</span>._disconnected(ERROR.CONNACK_RETURNCODE.code , format(ERROR.CONNACK_RETURNCODE, [wireMessage.returnCode, CONNACK_RC[wireMessage.returnCode]]));</td></tr>
  <tr><td>1291</td><td>					<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1292</td><td>				}</td></tr>
  <tr><td>1293</td><td></td></tr>
  <tr><td>1294</td><td>				<span class="codeComment">// Resend messages.</span></td></tr>
  <tr><td>1295</td><td>				var sequencedMessages = [];</td></tr>
  <tr><td>1296</td><td>				<span class="codeReserved">for</span> (var msgId <span class="codeReserved">in</span> <span class="codeReserved">this</span>._sentMessages) {</td></tr>
  <tr><td>1297</td><td>					<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._sentMessages.hasOwnProperty(msgId))</td></tr>
  <tr><td>1298</td><td>						sequencedMessages.push(<span class="codeReserved">this</span>._sentMessages[msgId]);</td></tr>
  <tr><td>1299</td><td>				}</td></tr>
  <tr><td>1300</td><td></td></tr>
  <tr><td>1301</td><td>				<span class="codeComment">// Also schedule qos 0 buffered messages <span class="codeReserved">if</span> any</span></td></tr>
  <tr><td>1302</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._buffered_msg_queue.length &gt; 0) {</td></tr>
  <tr><td>1303</td><td>					var msg = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1304</td><td>					var fifo = <span class="codeReserved">this</span>._buffered_msg_queue.reverse();</td></tr>
  <tr><td>1305</td><td>					<span class="codeReserved">while</span> ((msg = fifo.pop())) {</td></tr>
  <tr><td>1306</td><td>						sequencedMessages.push(msg);</td></tr>
  <tr><td>1307</td><td>						<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.onMessageDelivered)</td></tr>
  <tr><td>1308</td><td>							<span class="codeReserved">this</span>._notify_msg_sent[msg] = <span class="codeReserved">this</span>.onMessageDelivered(msg.payloadMessage);</td></tr>
  <tr><td>1309</td><td>					}</td></tr>
  <tr><td>1310</td><td>				}</td></tr>
  <tr><td>1311</td><td></td></tr>
  <tr><td>1312</td><td>				<span class="codeComment">// Sort sentMessages into the original sent order.</span></td></tr>
  <tr><td>1313</td><td>				var sequencedMessages = sequencedMessages.sort(<span class="codeReserved">function</span>(a,b) {<span class="codeReserved">return</span> a.sequence - b.sequence;} );</td></tr>
  <tr><td>1314</td><td>				<span class="codeReserved">for</span> (var i=0, len=sequencedMessages.length; i&lt;<span class="codeReserved">len</span>; i++) {</td></tr>
  <tr><td>1315</td><td>					var sentMessage = sequencedMessages[i];</td></tr>
  <tr><td>1316</td><td>					<span class="codeReserved">if</span> (sentMessage.type == MESSAGE_TYPE.PUBLISH && sentMessage.pubRecReceived) {</td></tr>
  <tr><td>1317</td><td>						var pubRelMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:sentMessage.messageIdentifier});</td></tr>
  <tr><td>1318</td><td>						<span class="codeReserved">this</span>._schedule_message(pubRelMessage);</td></tr>
  <tr><td>1319</td><td>					} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1320</td><td>						<span class="codeReserved">this</span>._schedule_message(sentMessage);</td></tr>
  <tr><td>1321</td><td>				}</td></tr>
  <tr><td>1322</td><td>				}</td></tr>
  <tr><td>1323</td><td></td></tr>
  <tr><td>1324</td><td>				<span class="codeComment">// Execute the connectOptions.onSuccess callback <span class="codeReserved">if</span> there is one.</span></td></tr>
  <tr><td>1325</td><td>        <span class="codeComment">// Will also now <span class="codeReserved">return</span> <span class="codeReserved">if</span> <span class="codeReserved">this</span> connection was the result of an automatic</span></td></tr>
  <tr><td>1326</td><td>        <span class="codeComment">// reconnect and which URI was successfully connected to.</span></td></tr>
  <tr><td>1327</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.onSuccess) {</td></tr>
  <tr><td>1328</td><td>					<span class="codeReserved">this</span>.connectOptions.onSuccess({invocationContext:<span class="codeReserved">this</span>.connectOptions.invocationContext});</td></tr>
  <tr><td>1329</td><td>				}</td></tr>
  <tr><td>1330</td><td></td></tr>
  <tr><td>1331</td><td>				var reconnected = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>1332</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._reconnecting) {</td></tr>
  <tr><td>1333</td><td>					reconnected = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1334</td><td>					<span class="codeReserved">this</span>._reconnectInterval = 1;</td></tr>
  <tr><td>1335</td><td>					<span class="codeReserved">this</span>._reconnecting = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>1336</td><td>				}</td></tr>
  <tr><td>1337</td><td></td></tr>
  <tr><td>1338</td><td>				<span class="codeComment">// Execute the onConnected callback <span class="codeReserved">if</span> there is one.</span></td></tr>
  <tr><td>1339</td><td>				<span class="codeReserved">this</span>._connected(reconnected, <span class="codeReserved">this</span>._wsuri);</td></tr>
  <tr><td>1340</td><td></td></tr>
  <tr><td>1341</td><td>				<span class="codeComment">// Process all queued messages now that the connection is established.</span></td></tr>
  <tr><td>1342</td><td>				<span class="codeReserved">this</span>._process_queue();</td></tr>
  <tr><td>1343</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1344</td><td></td></tr>
  <tr><td>1345</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBLISH:</td></tr>
  <tr><td>1346</td><td>				<span class="codeReserved">this</span>._receivePublish(wireMessage);</td></tr>
  <tr><td>1347</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1348</td><td></td></tr>
  <tr><td>1349</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBACK:</td></tr>
  <tr><td>1350</td><td>				var sentMessage = <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1351</td><td>				 <span class="codeComment">// If <span class="codeReserved">this</span> is a re flow of a PUBACK after we have restarted receivedMessage will not exist.</span></td></tr>
  <tr><td>1352</td><td>				<span class="codeReserved">if</span> (sentMessage) {</td></tr>
  <tr><td>1353</td><td>					delete <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1354</td><td>					localStorage.removeItem(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey+wireMessage.messageIdentifier);</td></tr>
  <tr><td>1355</td><td>					<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.onMessageDelivered)</td></tr>
  <tr><td>1356</td><td>						<span class="codeReserved">this</span>.onMessageDelivered(sentMessage.payloadMessage);</td></tr>
  <tr><td>1357</td><td>				}</td></tr>
  <tr><td>1358</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1359</td><td></td></tr>
  <tr><td>1360</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBREC:</td></tr>
  <tr><td>1361</td><td>				var sentMessage = <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1362</td><td>				<span class="codeComment">// If <span class="codeReserved">this</span> is a re flow of a PUBREC after we have restarted receivedMessage will not exist.</span></td></tr>
  <tr><td>1363</td><td>				<span class="codeReserved">if</span> (sentMessage) {</td></tr>
  <tr><td>1364</td><td>					sentMessage.pubRecReceived = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1365</td><td>					var pubRelMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.PUBREL, {messageIdentifier:wireMessage.messageIdentifier});</td></tr>
  <tr><td>1366</td><td>					<span class="codeReserved">this</span>.store(<span class="codeString">&quot;Sent:&quot;</span>, sentMessage);</td></tr>
  <tr><td>1367</td><td>					<span class="codeReserved">this</span>._schedule_message(pubRelMessage);</td></tr>
  <tr><td>1368</td><td>				}</td></tr>
  <tr><td>1369</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1370</td><td></td></tr>
  <tr><td>1371</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBREL:</td></tr>
  <tr><td>1372</td><td>				var receivedMessage = <span class="codeReserved">this</span>._receivedMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1373</td><td>				localStorage.removeItem(<span class="codeString">&quot;Received:&quot;</span>+<span class="codeReserved">this</span>._localKey+wireMessage.messageIdentifier);</td></tr>
  <tr><td>1374</td><td>				<span class="codeComment">// If <span class="codeReserved">this</span> is a re flow of a PUBREL after we have restarted receivedMessage will not exist.</span></td></tr>
  <tr><td>1375</td><td>				<span class="codeReserved">if</span> (receivedMessage) {</td></tr>
  <tr><td>1376</td><td>					<span class="codeReserved">this</span>._receiveMessage(receivedMessage);</td></tr>
  <tr><td>1377</td><td>					delete <span class="codeReserved">this</span>._receivedMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1378</td><td>				}</td></tr>
  <tr><td>1379</td><td>				<span class="codeComment">// Always flow PubComp, we may have previously flowed PubComp but the server lost it and restarted.</span></td></tr>
  <tr><td>1380</td><td>				var pubCompMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.PUBCOMP, {messageIdentifier:wireMessage.messageIdentifier});</td></tr>
  <tr><td>1381</td><td>				<span class="codeReserved">this</span>._schedule_message(pubCompMessage);</td></tr>
  <tr><td>1382</td><td></td></tr>
  <tr><td>1383</td><td></td></tr>
  <tr><td>1384</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1385</td><td></td></tr>
  <tr><td>1386</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PUBCOMP:</td></tr>
  <tr><td>1387</td><td>				var sentMessage = <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1388</td><td>				delete <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1389</td><td>				localStorage.removeItem(<span class="codeString">&quot;Sent:&quot;</span>+<span class="codeReserved">this</span>._localKey+wireMessage.messageIdentifier);</td></tr>
  <tr><td>1390</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.onMessageDelivered)</td></tr>
  <tr><td>1391</td><td>					<span class="codeReserved">this</span>.onMessageDelivered(sentMessage.payloadMessage);</td></tr>
  <tr><td>1392</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1393</td><td></td></tr>
  <tr><td>1394</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.SUBACK:</td></tr>
  <tr><td>1395</td><td>				var sentMessage = <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1396</td><td>				<span class="codeReserved">if</span> (sentMessage) {</td></tr>
  <tr><td>1397</td><td>					<span class="codeReserved">if</span>(sentMessage.timeOut)</td></tr>
  <tr><td>1398</td><td>						sentMessage.timeOut.cancel();</td></tr>
  <tr><td>1399</td><td>					<span class="codeComment">// This will need to be fixed when we add multiple topic support</span></td></tr>
  <tr><td>1400</td><td>          			<span class="codeReserved">if</span> (wireMessage.returnCode[0] === 0x80) {</td></tr>
  <tr><td>1401</td><td>						<span class="codeReserved">if</span> (sentMessage.onFailure) {</td></tr>
  <tr><td>1402</td><td>							sentMessage.onFailure(wireMessage.returnCode);</td></tr>
  <tr><td>1403</td><td>						}</td></tr>
  <tr><td>1404</td><td>					} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (sentMessage.onSuccess) {</td></tr>
  <tr><td>1405</td><td>						sentMessage.onSuccess(wireMessage.returnCode);</td></tr>
  <tr><td>1406</td><td>					}</td></tr>
  <tr><td>1407</td><td>					delete <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1408</td><td>				}</td></tr>
  <tr><td>1409</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1410</td><td></td></tr>
  <tr><td>1411</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.UNSUBACK:</td></tr>
  <tr><td>1412</td><td>				var sentMessage = <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1413</td><td>				<span class="codeReserved">if</span> (sentMessage) {</td></tr>
  <tr><td>1414</td><td>					<span class="codeReserved">if</span> (sentMessage.timeOut)</td></tr>
  <tr><td>1415</td><td>						sentMessage.timeOut.cancel();</td></tr>
  <tr><td>1416</td><td>					<span class="codeReserved">if</span> (sentMessage.callback) {</td></tr>
  <tr><td>1417</td><td>						sentMessage.callback();</td></tr>
  <tr><td>1418</td><td>					}</td></tr>
  <tr><td>1419</td><td>					delete <span class="codeReserved">this</span>._sentMessages[wireMessage.messageIdentifier];</td></tr>
  <tr><td>1420</td><td>				}</td></tr>
  <tr><td>1421</td><td></td></tr>
  <tr><td>1422</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1423</td><td></td></tr>
  <tr><td>1424</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.PINGRESP:</td></tr>
  <tr><td>1425</td><td>				<span class="codeComment">/* The sendPinger or receivePinger may have sent a ping, the receivePinger has already been reset. */</span></td></tr>
  <tr><td>1426</td><td>				<span class="codeReserved">this</span>.sendPinger.reset();</td></tr>
  <tr><td>1427</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1428</td><td></td></tr>
  <tr><td>1429</td><td>			<span class="codeReserved">case</span> MESSAGE_TYPE.DISCONNECT:</td></tr>
  <tr><td>1430</td><td>				<span class="codeComment">// Clients <span class="codeReserved">do</span> not expect to receive disconnect packets.</span></td></tr>
  <tr><td>1431</td><td>				<span class="codeReserved">this</span>._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));</td></tr>
  <tr><td>1432</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1433</td><td></td></tr>
  <tr><td>1434</td><td>			<span class="codeReserved">default</span>:</td></tr>
  <tr><td>1435</td><td>				<span class="codeReserved">this</span>._disconnected(ERROR.INVALID_MQTT_MESSAGE_TYPE.code , format(ERROR.INVALID_MQTT_MESSAGE_TYPE, [wireMessage.type]));</td></tr>
  <tr><td>1436</td><td>			}</td></tr>
  <tr><td>1437</td><td>		} <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>1438</td><td>			var errorStack = ((error.hasOwnProperty(<span class="codeString">&#039;stack&#039;</span>) == <span class="codeString">&#039;undefined&#039;</span>) ? error.stack.toString() : <span class="codeString">&quot;No Error Stack Available&quot;</span>);</td></tr>
  <tr><td>1439</td><td>			<span class="codeReserved">this</span>._disconnected(ERROR.INTERNAL_ERROR.code , format(ERROR.INTERNAL_ERROR, [error.message,errorStack]));</td></tr>
  <tr><td>1440</td><td>			<span class="codeReserved">return</span>;</td></tr>
  <tr><td>1441</td><td>		}</td></tr>
  <tr><td>1442</td><td>	};</td></tr>
  <tr><td>1443</td><td></td></tr>
  <tr><td>1444</td><td>	<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>1445</td><td>	ClientImpl.prototype._on_socket_error = <span class="codeReserved">function</span> (error) {</td></tr>
  <tr><td>1446</td><td>		<span class="codeReserved">if</span> (!<span class="codeReserved">this</span>._reconnecting) {</td></tr>
  <tr><td>1447</td><td>		<span class="codeReserved">this</span>._disconnected(ERROR.SOCKET_ERROR.code , format(ERROR.SOCKET_ERROR, [error.data]));</td></tr>
  <tr><td>1448</td><td>		}</td></tr>
  <tr><td>1449</td><td>	};</td></tr>
  <tr><td>1450</td><td></td></tr>
  <tr><td>1451</td><td>	<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>1452</td><td>	ClientImpl.prototype._on_socket_close = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1453</td><td>		<span class="codeReserved">if</span> (!<span class="codeReserved">this</span>._reconnecting) {</td></tr>
  <tr><td>1454</td><td>		<span class="codeReserved">this</span>._disconnected(ERROR.SOCKET_CLOSE.code , format(ERROR.SOCKET_CLOSE));</td></tr>
  <tr><td>1455</td><td>		}</td></tr>
  <tr><td>1456</td><td>	};</td></tr>
  <tr><td>1457</td><td></td></tr>
  <tr><td>1458</td><td>	<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>1459</td><td>	ClientImpl.prototype._socket_send = <span class="codeReserved">function</span> (wireMessage) {</td></tr>
  <tr><td>1460</td><td></td></tr>
  <tr><td>1461</td><td>		<span class="codeReserved">if</span> (wireMessage.type == 1) {</td></tr>
  <tr><td>1462</td><td>			var wireMessageMasked = <span class="codeReserved">this</span>._traceMask(wireMessage, <span class="codeString">&quot;password&quot;</span>);</td></tr>
  <tr><td>1463</td><td>			<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._socket_send&quot;</span>, wireMessageMasked);</td></tr>
  <tr><td>1464</td><td>		}</td></tr>
  <tr><td>1465</td><td>		<span class="codeReserved">else</span> <span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._socket_send&quot;</span>, wireMessage);</td></tr>
  <tr><td>1466</td><td></td></tr>
  <tr><td>1467</td><td>		<span class="codeReserved">this</span>.socket.send(wireMessage.encode());</td></tr>
  <tr><td>1468</td><td>		<span class="codeComment">/* We have proved to the server we are alive. */</span></td></tr>
  <tr><td>1469</td><td>		<span class="codeReserved">this</span>.sendPinger.reset();</td></tr>
  <tr><td>1470</td><td>	};</td></tr>
  <tr><td>1471</td><td></td></tr>
  <tr><td>1472</td><td>	<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>1473</td><td>	ClientImpl.prototype._receivePublish = <span class="codeReserved">function</span> (wireMessage) {</td></tr>
  <tr><td>1474</td><td>		<span class="codeReserved">switch</span>(wireMessage.payloadMessage.qos) {</td></tr>
  <tr><td>1475</td><td>			<span class="codeReserved">case</span> <span class="codeString">&quot;undefined&quot;</span>:</td></tr>
  <tr><td>1476</td><td>			<span class="codeReserved">case</span> 0:</td></tr>
  <tr><td>1477</td><td>				<span class="codeReserved">this</span>._receiveMessage(wireMessage);</td></tr>
  <tr><td>1478</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1479</td><td></td></tr>
  <tr><td>1480</td><td>			<span class="codeReserved">case</span> 1:</td></tr>
  <tr><td>1481</td><td>				var pubAckMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.PUBACK, {messageIdentifier:wireMessage.messageIdentifier});</td></tr>
  <tr><td>1482</td><td>				<span class="codeReserved">this</span>._schedule_message(pubAckMessage);</td></tr>
  <tr><td>1483</td><td>				<span class="codeReserved">this</span>._receiveMessage(wireMessage);</td></tr>
  <tr><td>1484</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1485</td><td></td></tr>
  <tr><td>1486</td><td>			<span class="codeReserved">case</span> 2:</td></tr>
  <tr><td>1487</td><td>				<span class="codeReserved">this</span>._receivedMessages[wireMessage.messageIdentifier] = wireMessage;</td></tr>
  <tr><td>1488</td><td>				<span class="codeReserved">this</span>.store(<span class="codeString">&quot;Received:&quot;</span>, wireMessage);</td></tr>
  <tr><td>1489</td><td>				var pubRecMessage = <span class="codeReserved">new</span> WireMessage(MESSAGE_TYPE.PUBREC, {messageIdentifier:wireMessage.messageIdentifier});</td></tr>
  <tr><td>1490</td><td>				<span class="codeReserved">this</span>._schedule_message(pubRecMessage);</td></tr>
  <tr><td>1491</td><td></td></tr>
  <tr><td>1492</td><td>				<span class="codeReserved">break</span>;</td></tr>
  <tr><td>1493</td><td></td></tr>
  <tr><td>1494</td><td>			<span class="codeReserved">default</span>:</td></tr>
  <tr><td>1495</td><td>				<span class="codeReserved">throw</span> Error(<span class="codeString">&quot;Invaild qos=&quot;</span>+wireMmessage.payloadMessage.qos);</td></tr>
  <tr><td>1496</td><td>		}</td></tr>
  <tr><td>1497</td><td>	};</td></tr>
  <tr><td>1498</td><td></td></tr>
  <tr><td>1499</td><td>	<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>1500</td><td>	ClientImpl.prototype._receiveMessage = <span class="codeReserved">function</span> (wireMessage) {</td></tr>
  <tr><td>1501</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.onMessageArrived) {</td></tr>
  <tr><td>1502</td><td>			<span class="codeReserved">this</span>.onMessageArrived(wireMessage.payloadMessage);</td></tr>
  <tr><td>1503</td><td>		}</td></tr>
  <tr><td>1504</td><td>	};</td></tr>
  <tr><td>1505</td><td></td></tr>
  <tr><td>1506</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>1507</td><td><span class="codeComment">	 * Client has connected.</span></td></tr>
  <tr><td>1508</td><td><span class="codeComment">	 * @param {reconnect} [boolean] indicate <span class="codeReserved">if</span> <span class="codeReserved">this</span> was a result of reconnect operation.</span></td></tr>
  <tr><td>1509</td><td><span class="codeComment">	 * @param {uri} [string] fully qualified WebSocket URI of the server.</span></td></tr>
  <tr><td>1510</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>1511</td><td>	ClientImpl.prototype._connected = <span class="codeReserved">function</span> (reconnect, uri) {</td></tr>
  <tr><td>1512</td><td>		<span class="codeComment">// Execute the onConnected callback <span class="codeReserved">if</span> there is one.</span></td></tr>
  <tr><td>1513</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.onConnected)</td></tr>
  <tr><td>1514</td><td>			<span class="codeReserved">this</span>.onConnected(reconnect, uri);</td></tr>
  <tr><td>1515</td><td>	};</td></tr>
  <tr><td>1516</td><td></td></tr>
  <tr><td>1517</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>1518</td><td><span class="codeComment">	 * Attempts to reconnect the client to the server.</span></td></tr>
  <tr><td>1519</td><td><span class="codeComment">   * For each reconnect attempt, will double the reconnect interval</span></td></tr>
  <tr><td>1520</td><td><span class="codeComment">   * up to 128 seconds.</span></td></tr>
  <tr><td>1521</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>1522</td><td>	ClientImpl.prototype._reconnect = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1523</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._reconnect&quot;</span>);</td></tr>
  <tr><td>1524</td><td>		<span class="codeReserved">if</span> (!<span class="codeReserved">this</span>.connected) {</td></tr>
  <tr><td>1525</td><td>			<span class="codeReserved">this</span>._reconnecting = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1526</td><td>			<span class="codeReserved">this</span>.sendPinger.cancel();</td></tr>
  <tr><td>1527</td><td>			<span class="codeReserved">this</span>.receivePinger.cancel();</td></tr>
  <tr><td>1528</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._reconnectInterval &lt; 128)</td></tr>
  <tr><td>1529</td><td>				<span class="codeReserved">this</span>._reconnectInterval = <span class="codeReserved">this</span>._reconnectInterval * 2;</td></tr>
  <tr><td>1530</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.uris) {</td></tr>
  <tr><td>1531</td><td>				<span class="codeReserved">this</span>.hostIndex = 0;</td></tr>
  <tr><td>1532</td><td>				<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.connectOptions.uris[0]);</td></tr>
  <tr><td>1533</td><td>			} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1534</td><td>				<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.uri);</td></tr>
  <tr><td>1535</td><td>			}</td></tr>
  <tr><td>1536</td><td>		}</td></tr>
  <tr><td>1537</td><td>	};</td></tr>
  <tr><td>1538</td><td></td></tr>
  <tr><td>1539</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>1540</td><td><span class="codeComment">	 * Client has disconnected either at its own request or because the server</span></td></tr>
  <tr><td>1541</td><td><span class="codeComment">	 * or network disconnected it. Remove all non-durable state.</span></td></tr>
  <tr><td>1542</td><td><span class="codeComment">	 * @param {errorCode} [number] the error number.</span></td></tr>
  <tr><td>1543</td><td><span class="codeComment">	 * @param {errorText} [string] the error text.</span></td></tr>
  <tr><td>1544</td><td><span class="codeComment">	 * @ignore</span></td></tr>
  <tr><td>1545</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>1546</td><td>	ClientImpl.prototype._disconnected = <span class="codeReserved">function</span> (errorCode, errorText) {</td></tr>
  <tr><td>1547</td><td>		<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Client._disconnected&quot;</span>, errorCode, errorText);</td></tr>
  <tr><td>1548</td><td></td></tr>
  <tr><td>1549</td><td>		<span class="codeReserved">if</span> (errorCode !== undefined && <span class="codeReserved">this</span>._reconnecting) {</td></tr>
  <tr><td>1550</td><td>      <span class="codeComment">//Continue automatic reconnect process</span></td></tr>
  <tr><td>1551</td><td>  		<span class="codeReserved">this</span>._reconnectTimeout = <span class="codeReserved">new</span> Timeout(<span class="codeReserved">this</span>, window, <span class="codeReserved">this</span>._reconnectInterval, <span class="codeReserved">this</span>._reconnect);</td></tr>
  <tr><td>1552</td><td>			<span class="codeReserved">return</span>;</td></tr>
  <tr><td>1553</td><td>		}</td></tr>
  <tr><td>1554</td><td></td></tr>
  <tr><td>1555</td><td>		<span class="codeReserved">this</span>.sendPinger.cancel();</td></tr>
  <tr><td>1556</td><td>		<span class="codeReserved">this</span>.receivePinger.cancel();</td></tr>
  <tr><td>1557</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>._connectTimeout) {</td></tr>
  <tr><td>1558</td><td>			<span class="codeReserved">this</span>._connectTimeout.cancel();</td></tr>
  <tr><td>1559</td><td>			<span class="codeReserved">this</span>._connectTimeout = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1560</td><td>		}</td></tr>
  <tr><td>1561</td><td></td></tr>
  <tr><td>1562</td><td>		<span class="codeComment">// Clear message buffers.</span></td></tr>
  <tr><td>1563</td><td>		<span class="codeReserved">this</span>._msg_queue = [];</td></tr>
  <tr><td>1564</td><td>		<span class="codeReserved">this</span>._buffered_msg_queue = [];</td></tr>
  <tr><td>1565</td><td>		<span class="codeReserved">this</span>._notify_msg_sent = {};</td></tr>
  <tr><td>1566</td><td></td></tr>
  <tr><td>1567</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.socket) {</td></tr>
  <tr><td>1568</td><td>			<span class="codeComment">// Cancel all socket callbacks so that they cannot be driven again by <span class="codeReserved">this</span> socket.</span></td></tr>
  <tr><td>1569</td><td>			<span class="codeReserved">this</span>.socket.onopen = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1570</td><td>			<span class="codeReserved">this</span>.socket.onmessage = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1571</td><td>			<span class="codeReserved">this</span>.socket.onerror = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1572</td><td>			<span class="codeReserved">this</span>.socket.onclose = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1573</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.socket.readyState === 1)</td></tr>
  <tr><td>1574</td><td>				<span class="codeReserved">this</span>.socket.close();</td></tr>
  <tr><td>1575</td><td>			delete <span class="codeReserved">this</span>.socket;</td></tr>
  <tr><td>1576</td><td>		}</td></tr>
  <tr><td>1577</td><td></td></tr>
  <tr><td>1578</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.uris && <span class="codeReserved">this</span>.hostIndex &lt; <span class="codeReserved">this</span>.connectOptions.uris.length-1) {</td></tr>
  <tr><td>1579</td><td>			<span class="codeComment">// Try the next host.</span></td></tr>
  <tr><td>1580</td><td>			<span class="codeReserved">this</span>.hostIndex++;</td></tr>
  <tr><td>1581</td><td>			<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.connectOptions.uris[<span class="codeReserved">this</span>.hostIndex]);</td></tr>
  <tr><td>1582</td><td>		} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1583</td><td></td></tr>
  <tr><td>1584</td><td>			<span class="codeReserved">if</span> (errorCode === undefined) {</td></tr>
  <tr><td>1585</td><td>				errorCode = ERROR.OK.code;</td></tr>
  <tr><td>1586</td><td>				errorText = format(ERROR.OK);</td></tr>
  <tr><td>1587</td><td>			}</td></tr>
  <tr><td>1588</td><td></td></tr>
  <tr><td>1589</td><td>			<span class="codeComment">// Run any application callbacks last <span class="codeReserved">as</span> they may attempt to reconnect and hence create a <span class="codeReserved">new</span> socket.</span></td></tr>
  <tr><td>1590</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connected) {</td></tr>
  <tr><td>1591</td><td>				<span class="codeReserved">this</span>.connected = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>1592</td><td>				<span class="codeComment">// Execute the connectionLostCallback <span class="codeReserved">if</span> there is one, and we were connected.</span></td></tr>
  <tr><td>1593</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.onConnectionLost) {</td></tr>
  <tr><td>1594</td><td>					<span class="codeReserved">this</span>.onConnectionLost({errorCode:errorCode, errorMessage:errorText, reconnect:<span class="codeReserved">this</span>.connectOptions.reconnect, uri:<span class="codeReserved">this</span>._wsuri});</td></tr>
  <tr><td>1595</td><td>				}</td></tr>
  <tr><td>1596</td><td>				<span class="codeReserved">if</span> (errorCode !== ERROR.OK.code && <span class="codeReserved">this</span>.connectOptions.reconnect) {</td></tr>
  <tr><td>1597</td><td>					<span class="codeComment">// Start automatic reconnect process <span class="codeReserved">for</span> the very first time since last successful connect.</span></td></tr>
  <tr><td>1598</td><td>					<span class="codeReserved">this</span>._reconnectInterval = 1;</td></tr>
  <tr><td>1599</td><td>					<span class="codeReserved">this</span>._reconnect();</td></tr>
  <tr><td>1600</td><td>					<span class="codeReserved">return</span>;</td></tr>
  <tr><td>1601</td><td>				}</td></tr>
  <tr><td>1602</td><td>			} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1603</td><td>				<span class="codeComment">// Otherwise we never had a connection, so indicate that the connect has failed.</span></td></tr>
  <tr><td>1604</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.mqttVersion === 4 && <span class="codeReserved">this</span>.connectOptions.mqttVersionExplicit === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>1605</td><td>					<span class="codeReserved">this</span>._trace(<span class="codeString">&quot;Failed to connect V4, dropping back to V3&quot;</span>);</td></tr>
  <tr><td>1606</td><td>					<span class="codeReserved">this</span>.connectOptions.mqttVersion = 3;</td></tr>
  <tr><td>1607</td><td>					<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.connectOptions.uris) {</td></tr>
  <tr><td>1608</td><td>						<span class="codeReserved">this</span>.hostIndex = 0;</td></tr>
  <tr><td>1609</td><td>						<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.connectOptions.uris[0]);</td></tr>
  <tr><td>1610</td><td>					} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1611</td><td>						<span class="codeReserved">this</span>._doConnect(<span class="codeReserved">this</span>.uri);</td></tr>
  <tr><td>1612</td><td>					}</td></tr>
  <tr><td>1613</td><td>				} <span class="codeReserved">else</span> <span class="codeReserved">if</span>(<span class="codeReserved">this</span>.connectOptions.onFailure) {</td></tr>
  <tr><td>1614</td><td>					<span class="codeReserved">this</span>.connectOptions.onFailure({invocationContext:<span class="codeReserved">this</span>.connectOptions.invocationContext, errorCode:errorCode, errorMessage:errorText});</td></tr>
  <tr><td>1615</td><td>				}</td></tr>
  <tr><td>1616</td><td>			}</td></tr>
  <tr><td>1617</td><td>		}</td></tr>
  <tr><td>1618</td><td>	};</td></tr>
  <tr><td>1619</td><td></td></tr>
  <tr><td>1620</td><td>	<span class="codeComment">/** @ignore */</span></td></tr>
  <tr><td>1621</td><td>	ClientImpl.prototype._trace = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>1622</td><td>		<span class="codeComment">// Pass trace message back to client<span class="codeString">&#039;s callback <span class="codeReserved">function</span></span></span></td></tr>
  <tr><td>1623</td><td><span class="codeString">		<span class="codeReserved">if</span> (<span class="codeReserved">this</span>.traceFunction) {</span></td></tr>
  <tr><td>1624</td><td><span class="codeString">			<span class="codeReserved">for</span> (var i <span class="codeReserved">in</span> arguments)</span></td></tr>
  <tr><td>1625</td><td><span class="codeString">			{</span></td></tr>
  <tr><td>1626</td><td><span class="codeString">				<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> arguments[i] !== &quot;undefined&quot;)</span></td></tr>
  <tr><td>1627</td><td><span class="codeString">					arguments.splice(i, 1, JSON.stringify(arguments[i]));</span></td></tr>
  <tr><td>1628</td><td><span class="codeString">			}</span></td></tr>
  <tr><td>1629</td><td><span class="codeString">			var record = Array.prototype.slice.call(arguments).join(&quot;&quot;);</span></td></tr>
  <tr><td>1630</td><td><span class="codeString">			<span class="codeReserved">this</span>.traceFunction ({severity: &quot;Debug&quot;, message: record	});</span></td></tr>
  <tr><td>1631</td><td><span class="codeString">		}</span></td></tr>
  <tr><td>1632</td><td><span class="codeString"></span></td></tr>
  <tr><td>1633</td><td><span class="codeString">		&#47;&#47;buffer style trace</span></td></tr>
  <tr><td>1634</td><td><span class="codeString">		<span class="codeReserved">if</span> ( <span class="codeReserved">this</span>._traceBuffer !== <span class="codeReserved">null</span> ) {</span></td></tr>
  <tr><td>1635</td><td><span class="codeString">			<span class="codeReserved">for</span> (var i = 0, max = arguments.length; i &lt; max; i++) {</span></td></tr>
  <tr><td>1636</td><td><span class="codeString">				<span class="codeReserved">if</span> ( <span class="codeReserved">this</span>._traceBuffer.length == <span class="codeReserved">this</span>._MAX_TRACE_ENTRIES ) {</span></td></tr>
  <tr><td>1637</td><td><span class="codeString">					<span class="codeReserved">this</span>._traceBuffer.shift();</span></td></tr>
  <tr><td>1638</td><td><span class="codeString">				}</span></td></tr>
  <tr><td>1639</td><td><span class="codeString">				<span class="codeReserved">if</span> (i === 0) <span class="codeReserved">this</span>._traceBuffer.push(arguments[i]);</span></td></tr>
  <tr><td>1640</td><td><span class="codeString">				<span class="codeReserved">else</span> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> arguments[i] === &quot;undefined&quot; ) <span class="codeReserved">this</span>._traceBuffer.push(arguments[i]);</span></td></tr>
  <tr><td>1641</td><td><span class="codeString">				<span class="codeReserved">else</span> <span class="codeReserved">this</span>._traceBuffer.push(&quot;  &quot;+JSON.stringify(arguments[i]));</span></td></tr>
  <tr><td>1642</td><td><span class="codeString">		   }</span></td></tr>
  <tr><td>1643</td><td><span class="codeString">		}</span></td></tr>
  <tr><td>1644</td><td><span class="codeString">	};</span></td></tr>
  <tr><td>1645</td><td><span class="codeString"></span></td></tr>
  <tr><td>1646</td><td><span class="codeString">	<span class="codeComment">/** @ignore */</span></span></td></tr>
  <tr><td>1647</td><td><span class="codeString">	ClientImpl.prototype._traceMask = <span class="codeReserved">function</span> (traceObject, masked) {</span></td></tr>
  <tr><td>1648</td><td><span class="codeString">		var traceObjectMasked = {};</span></td></tr>
  <tr><td>1649</td><td><span class="codeString">		<span class="codeReserved">for</span> (var attr <span class="codeReserved">in</span> traceObject) {</span></td></tr>
  <tr><td>1650</td><td><span class="codeString">			<span class="codeReserved">if</span> (traceObject.hasOwnProperty(attr)) {</span></td></tr>
  <tr><td>1651</td><td><span class="codeString">				<span class="codeReserved">if</span> (attr == masked)</span></td></tr>
  <tr><td>1652</td><td><span class="codeString">					traceObjectMasked[attr] = &quot;******&quot;;</span></td></tr>
  <tr><td>1653</td><td><span class="codeString">				<span class="codeReserved">else</span></span></td></tr>
  <tr><td>1654</td><td><span class="codeString">					traceObjectMasked[attr] = traceObject[attr];</span></td></tr>
  <tr><td>1655</td><td><span class="codeString">			}</span></td></tr>
  <tr><td>1656</td><td><span class="codeString">		}</span></td></tr>
  <tr><td>1657</td><td><span class="codeString">		<span class="codeReserved">return</span> traceObjectMasked;</span></td></tr>
  <tr><td>1658</td><td><span class="codeString">	};</span></td></tr>
  <tr><td>1659</td><td><span class="codeString"></span></td></tr>
  <tr><td>1660</td><td><span class="codeString">	&#47;&#47; ------------------------------------------------------------------------</span></td></tr>
  <tr><td>1661</td><td><span class="codeString">	&#47;&#47; Public Programming interface.</span></td></tr>
  <tr><td>1662</td><td><span class="codeString">	&#47;&#47; ------------------------------------------------------------------------</span></td></tr>
  <tr><td>1663</td><td><span class="codeString"></span></td></tr>
  <tr><td>1664</td><td><span class="codeString">	<span class="codeComment">/**</span></span></td></tr>
  <tr><td>1665</td><td><span class="codeComment"><span class="codeString">	 * The JavaScript application communicates to the server using a {@link Paho.MQTT.Client} object.</span></span></td></tr>
  <tr><td>1666</td><td><span class="codeComment"><span class="codeString">	 * &lt;<span class="codeReserved">p</span>&gt;</span></span></td></tr>
  <tr><td>1667</td><td><span class="codeComment"><span class="codeString">	 * Most applications will create just one Client object and then call its connect() method,</span></span></td></tr>
  <tr><td>1668</td><td><span class="codeComment"><span class="codeString">	 * however applications can create more than one Client object <span class="codeReserved">if</span> they wish.</span></span></td></tr>
  <tr><td>1669</td><td><span class="codeComment"><span class="codeString">	 * In <span class="codeReserved">this</span> <span class="codeReserved">case</span> the combination of host, port and clientId attributes must be different <span class="codeReserved">for</span> each Client object.</span></span></td></tr>
  <tr><td>1670</td><td><span class="codeComment"><span class="codeString">	 * &lt;<span class="codeReserved">p</span>&gt;</span></span></td></tr>
  <tr><td>1671</td><td><span class="codeComment"><span class="codeString">	 * The send, subscribe and unsubscribe methods are implemented <span class="codeReserved">as</span> asynchronous JavaScript methods</span></span></td></tr>
  <tr><td>1672</td><td><span class="codeComment"><span class="codeString">	 * (even though the underlying protocol exchange might be synchronous <span class="codeReserved">in</span> nature).</span></span></td></tr>
  <tr><td>1673</td><td><span class="codeComment"><span class="codeString">	 * This means they signal their completion by calling back to the application,</span></span></td></tr>
  <tr><td>1674</td><td><span class="codeComment"><span class="codeString">	 * via Success or Failure callback functions provided by the application on the method <span class="codeReserved">in</span> question.</span></span></td></tr>
  <tr><td>1675</td><td><span class="codeComment"><span class="codeString">	 * Such callbacks are called at most once per method invocation and <span class="codeReserved">do</span> not persist beyond the lifetime</span></span></td></tr>
  <tr><td>1676</td><td><span class="codeComment"><span class="codeString">	 * of the script that made the invocation.</span></span></td></tr>
  <tr><td>1677</td><td><span class="codeComment"><span class="codeString">	 * &lt;<span class="codeReserved">p</span>&gt;</span></span></td></tr>
  <tr><td>1678</td><td><span class="codeComment"><span class="codeString">	 * In contrast there are some callback functions, most notably &lt;<span class="codeReserved">i</span>&gt;onMessageArrived&lt;/<span class="codeReserved">i</span>&gt;,</span></span></td></tr>
  <tr><td>1679</td><td><span class="codeComment"><span class="codeString">	 * that are defined on the {@link Paho.MQTT.Client} object.</span></span></td></tr>
  <tr><td>1680</td><td><span class="codeComment"><span class="codeString">	 * These may get called multiple times, and aren&#039;</span>t directly related to specific method invocations made by the client.</span></td></tr>
  <tr><td>1681</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>1682</td><td><span class="codeComment">	 * @name Paho.MQTT.Client</span></td></tr>
  <tr><td>1683</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>1684</td><td><span class="codeComment">	 * @<span class="codeReserved">constructor</span></span></td></tr>
  <tr><td>1685</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>1686</td><td><span class="codeComment">	 * @param {string} host - the address of the messaging server, <span class="codeReserved">as</span> a fully qualified WebSocket URI, <span class="codeReserved">as</span> a DNS name or dotted decimal IP address.</span></td></tr>
  <tr><td>1687</td><td><span class="codeComment">	 * @param {number} port - the port number to connect to - only required <span class="codeReserved">if</span> host is not a URI</span></td></tr>
  <tr><td>1688</td><td><span class="codeComment">	 * @param {string} path - the path on the host to connect to - only used <span class="codeReserved">if</span> host is not a URI. Default: <span class="codeString">&#039;/mqtt&#039;</span>.</span></td></tr>
  <tr><td>1689</td><td><span class="codeComment">	 * @param {string} clientId - the Messaging client identifier, between 1 and 23 characters <span class="codeReserved">in</span> length.</span></td></tr>
  <tr><td>1690</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>1691</td><td><span class="codeComment">	 * @property {string} host - &lt;<span class="codeReserved">i</span>&gt;read only&lt;/<span class="codeReserved">i</span>&gt; the server<span class="codeString">&#039;s DNS hostname or dotted decimal IP address.</span></span></td></tr>
  <tr><td>1692</td><td><span class="codeComment"><span class="codeString">	 * @property {number} port - &lt;<span class="codeReserved">i</span>&gt;read only&lt;/<span class="codeReserved">i</span>&gt; the server&#039;</span>s port.</span></td></tr>
  <tr><td>1693</td><td><span class="codeComment">	 * @property {string} path - &lt;<span class="codeReserved">i</span>&gt;read only&lt;/<span class="codeReserved">i</span>&gt; the server&#039;s path.</span></td></tr>
  <tr><td>1694</td><td><span class="codeComment">	 * @property {string} clientId - &lt;<span class="codeReserved">i</span>&gt;read only&lt;/<span class="codeReserved">i</span>&gt; used when connecting to the server.</span></td></tr>
  <tr><td>1695</td><td><span class="codeComment">	 * @property {<span class="codeReserved">function</span>} onConnectionLost - called when a connection has been lost.</span></td></tr>
  <tr><td>1696</td><td><span class="codeComment">	 *                            after a connect() method has succeeded.</span></td></tr>
  <tr><td>1697</td><td><span class="codeComment">	 *                            Establish the call back used when a connection has been lost. The connection may be</span></td></tr>
  <tr><td>1698</td><td><span class="codeComment">	 *                            lost because the client initiates a disconnect or because the server or network</span></td></tr>
  <tr><td>1699</td><td><span class="codeComment">	 *                            cause the client to be disconnected. The disconnect call back may be called without</span></td></tr>
  <tr><td>1700</td><td><span class="codeComment">	 *                            the connectionComplete call back being invoked <span class="codeReserved">if</span>, <span class="codeReserved">for</span> example the client fails to</span></td></tr>
  <tr><td>1701</td><td><span class="codeComment">	 *                            connect.</span></td></tr>
  <tr><td>1702</td><td><span class="codeComment">	 *                            A single response object parameter is passed to the onConnectionLost callback containing the following fields:</span></td></tr>
  <tr><td>1703</td><td><span class="codeComment">	 *                            &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1704</td><td><span class="codeComment">	 *                            &lt;<span class="codeReserved">li</span>&gt;errorCode</span></td></tr>
  <tr><td>1705</td><td><span class="codeComment">	 *                            &lt;<span class="codeReserved">li</span>&gt;errorMessage</span></td></tr>
  <tr><td>1706</td><td><span class="codeComment">	 *                            &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1707</td><td><span class="codeComment">	 * @property {<span class="codeReserved">function</span>} onMessageDelivered - called when a message has been delivered.</span></td></tr>
  <tr><td>1708</td><td><span class="codeComment">	 *                            All processing that <span class="codeReserved">this</span> Client will ever <span class="codeReserved">do</span> has been completed. So, <span class="codeReserved">for</span> example,</span></td></tr>
  <tr><td>1709</td><td><span class="codeComment">	 *                            <span class="codeReserved">in</span> the <span class="codeReserved">case</span> of a Qos=2 message sent by <span class="codeReserved">this</span> client, the PubComp flow has been received <span class="codeReserved">from</span> the server</span></td></tr>
  <tr><td>1710</td><td><span class="codeComment">	 *                            and the message has been removed <span class="codeReserved">from</span> persistent storage before <span class="codeReserved">this</span> callback is invoked.</span></td></tr>
  <tr><td>1711</td><td><span class="codeComment">	 *                            Parameters passed to the onMessageDelivered callback are:</span></td></tr>
  <tr><td>1712</td><td><span class="codeComment">	 *                            &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1713</td><td><span class="codeComment">	 *                            &lt;<span class="codeReserved">li</span>&gt;{@link Paho.MQTT.Message} that was delivered.</span></td></tr>
  <tr><td>1714</td><td><span class="codeComment">	 *                            &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1715</td><td><span class="codeComment">	 * @property {<span class="codeReserved">function</span>} onMessageArrived - called when a message has arrived <span class="codeReserved">in</span> <span class="codeReserved">this</span> Paho.MQTT.client.</span></td></tr>
  <tr><td>1716</td><td><span class="codeComment">	 *                            Parameters passed to the onMessageArrived callback are:</span></td></tr>
  <tr><td>1717</td><td><span class="codeComment">	 *                            &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1718</td><td><span class="codeComment">	 *                            &lt;<span class="codeReserved">li</span>&gt;{@link Paho.MQTT.Message} that has arrived.</span></td></tr>
  <tr><td>1719</td><td><span class="codeComment">	 *                            &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1720</td><td><span class="codeComment">	 * @property {<span class="codeReserved">function</span>} onConnected - called when a connection is successfully made to the server.</span></td></tr>
  <tr><td>1721</td><td><span class="codeComment">	 *                                  after a connect() method.</span></td></tr>
  <tr><td>1722</td><td><span class="codeComment">	 *                                  Parameters passed to the onConnected callback are:</span></td></tr>
  <tr><td>1723</td><td><span class="codeComment">	 *                                  &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1724</td><td><span class="codeComment">	 *                                  &lt;<span class="codeReserved">li</span>&gt;reconnect (boolean) - If <span class="codeReserved">true</span>, the connection was the result of a reconnect.&lt;/<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>1725</td><td><span class="codeComment">	 *                                  &lt;<span class="codeReserved">li</span>&gt;URI (string) - The URI used to connect to the server.&lt;/<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>1726</td><td><span class="codeComment">	 *                                  &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1727</td><td><span class="codeComment">	 * @property {boolean} disconnectedPublishing - <span class="codeReserved">if</span> set, will enable disconnected publishing <span class="codeReserved">in</span></span></td></tr>
  <tr><td>1728</td><td><span class="codeComment">	 *                                            <span class="codeReserved">in</span> the event that the connection to the server is lost.</span></td></tr>
  <tr><td>1729</td><td><span class="codeComment">	 * @property {number} disconnectedBufferSize - Used to set the maximum number of messages that the disconnected</span></td></tr>
  <tr><td>1730</td><td><span class="codeComment">	 *                                             buffer will hold before rejecting <span class="codeReserved">new</span> messages. Default size: 5000 messages</span></td></tr>
  <tr><td>1731</td><td><span class="codeComment">	 * @property {<span class="codeReserved">function</span>} trace - called whenever trace is called. TODO</span></td></tr>
  <tr><td>1732</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>1733</td><td>	var Client = <span class="codeReserved">function</span> (host, port, path, clientId) {</td></tr>
  <tr><td>1734</td><td></td></tr>
  <tr><td>1735</td><td>	    var uri;</td></tr>
  <tr><td>1736</td><td></td></tr>
  <tr><td>1737</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> host !== <span class="codeString">&quot;string&quot;</span>)</td></tr>
  <tr><td>1738</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> host, <span class="codeString">&quot;host&quot;</span>]));</td></tr>
  <tr><td>1739</td><td></td></tr>
  <tr><td>1740</td><td>	    <span class="codeReserved">if</span> (arguments.length == 2) {</td></tr>
  <tr><td>1741</td><td>	        <span class="codeComment">// host: must be full ws:// uri</span></td></tr>
  <tr><td>1742</td><td>	        <span class="codeComment">// port: clientId</span></td></tr>
  <tr><td>1743</td><td>	        clientId = port;</td></tr>
  <tr><td>1744</td><td>	        uri = host;</td></tr>
  <tr><td>1745</td><td>	        var match = uri.match(<span class="codeString">/^(wss?):\/</span>\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);</td></tr>
  <tr><td>1746</td><td>	        <span class="codeReserved">if</span> (match) {</td></tr>
  <tr><td>1747</td><td>	            host = match[4]||match[2];</td></tr>
  <tr><td>1748</td><td>	            port = parseInt(match[7]);</td></tr>
  <tr><td>1749</td><td>	            path = match[8];</td></tr>
  <tr><td>1750</td><td>	        } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1751</td><td>	            <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT,[host,<span class="codeString">&quot;host&quot;</span>]));</td></tr>
  <tr><td>1752</td><td>	        }</td></tr>
  <tr><td>1753</td><td>	    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1754</td><td>	        <span class="codeReserved">if</span> (arguments.length == 3) {</td></tr>
  <tr><td>1755</td><td>				clientId = path;</td></tr>
  <tr><td>1756</td><td>				path = <span class="codeString">&quot;/mqtt&quot;</span>;</td></tr>
  <tr><td>1757</td><td>			}</td></tr>
  <tr><td>1758</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> port !== <span class="codeString">&quot;number&quot;</span> || port &lt; 0)</td></tr>
  <tr><td>1759</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> port, <span class="codeString">&quot;port&quot;</span>]));</td></tr>
  <tr><td>1760</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> path !== <span class="codeString">&quot;string&quot;</span>)</td></tr>
  <tr><td>1761</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> path, <span class="codeString">&quot;path&quot;</span>]));</td></tr>
  <tr><td>1762</td><td></td></tr>
  <tr><td>1763</td><td>			var ipv6AddSBracket = (host.indexOf(<span class="codeString">&quot;:&quot;</span>) !== -1 && host.slice(0,1) !== <span class="codeString">&quot;[&quot;</span> && host.slice(-1) !== <span class="codeString">&quot;]&quot;</span>);</td></tr>
  <tr><td>1764</td><td>			uri = <span class="codeString">&quot;ws:&#47;&#47;&quot;</span>+(ipv6AddSBracket?<span class="codeString">&quot;[&quot;</span>+host+<span class="codeString">&quot;]&quot;</span>:host)+<span class="codeString">&quot;:&quot;</span>+port+path;</td></tr>
  <tr><td>1765</td><td>		}</td></tr>
  <tr><td>1766</td><td></td></tr>
  <tr><td>1767</td><td>		var clientIdLength = 0;</td></tr>
  <tr><td>1768</td><td>		<span class="codeReserved">for</span> (var i = 0; i&lt;<span class="codeReserved">clientId</span>.length; i++) {</td></tr>
  <tr><td>1769</td><td>			var charCode = clientId.charCodeAt(i);</td></tr>
  <tr><td>1770</td><td>			<span class="codeReserved">if</span> (0xD800 &lt;= charCode && charCode &lt;= 0xDBFF)  {</td></tr>
  <tr><td>1771</td><td>				 i++; <span class="codeComment">// Surrogate pair.</span></td></tr>
  <tr><td>1772</td><td>			}</td></tr>
  <tr><td>1773</td><td>			clientIdLength++;</td></tr>
  <tr><td>1774</td><td>		}</td></tr>
  <tr><td>1775</td><td>		<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> clientId !== <span class="codeString">&quot;string&quot;</span> || clientIdLength &gt; 65535)</td></tr>
  <tr><td>1776</td><td>			<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [clientId, <span class="codeString">&quot;clientId&quot;</span>]));</td></tr>
  <tr><td>1777</td><td></td></tr>
  <tr><td>1778</td><td>		var client = <span class="codeReserved">new</span> ClientImpl(uri, host, port, path, clientId);</td></tr>
  <tr><td>1779</td><td>		<span class="codeReserved">this</span>._getHost =  <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> host; };</td></tr>
  <tr><td>1780</td><td>		<span class="codeReserved">this</span>._setHost = <span class="codeReserved">function</span>() { <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED_OPERATION)); };</td></tr>
  <tr><td>1781</td><td></td></tr>
  <tr><td>1782</td><td>		<span class="codeReserved">this</span>._getPort = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> port; };</td></tr>
  <tr><td>1783</td><td>		<span class="codeReserved">this</span>._setPort = <span class="codeReserved">function</span>() { <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED_OPERATION)); };</td></tr>
  <tr><td>1784</td><td></td></tr>
  <tr><td>1785</td><td>		<span class="codeReserved">this</span>._getPath = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> path; };</td></tr>
  <tr><td>1786</td><td>		<span class="codeReserved">this</span>._setPath = <span class="codeReserved">function</span>() { <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED_OPERATION)); };</td></tr>
  <tr><td>1787</td><td></td></tr>
  <tr><td>1788</td><td>		<span class="codeReserved">this</span>._getURI = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> uri; };</td></tr>
  <tr><td>1789</td><td>		<span class="codeReserved">this</span>._setURI = <span class="codeReserved">function</span>() { <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED_OPERATION)); };</td></tr>
  <tr><td>1790</td><td></td></tr>
  <tr><td>1791</td><td>		<span class="codeReserved">this</span>._getClientId = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.clientId; };</td></tr>
  <tr><td>1792</td><td>		<span class="codeReserved">this</span>._setClientId = <span class="codeReserved">function</span>() { <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.UNSUPPORTED_OPERATION)); };</td></tr>
  <tr><td>1793</td><td></td></tr>
  <tr><td>1794</td><td>		<span class="codeReserved">this</span>._getOnConnected = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.onConnected; };</td></tr>
  <tr><td>1795</td><td>		<span class="codeReserved">this</span>._setOnConnected = <span class="codeReserved">function</span>(newOnConnected) {</td></tr>
  <tr><td>1796</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> newOnConnected === <span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>)</td></tr>
  <tr><td>1797</td><td>				client.onConnected = newOnConnected;</td></tr>
  <tr><td>1798</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>1799</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> newOnConnected, <span class="codeString">&quot;onConnected&quot;</span>]));</td></tr>
  <tr><td>1800</td><td>		};</td></tr>
  <tr><td>1801</td><td></td></tr>
  <tr><td>1802</td><td>		<span class="codeReserved">this</span>._getDisconnectedPublishing = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.disconnectedPublishing; };</td></tr>
  <tr><td>1803</td><td>		<span class="codeReserved">this</span>._setDisconnectedPublishing = <span class="codeReserved">function</span>(newDisconnectedPublishing) {</td></tr>
  <tr><td>1804</td><td>			client.disconnectedPublishing = newDisconnectedPublishing;</td></tr>
  <tr><td>1805</td><td>		};</td></tr>
  <tr><td>1806</td><td></td></tr>
  <tr><td>1807</td><td>		<span class="codeReserved">this</span>._getDisconnectedBufferSize = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.disconnectedBufferSize; };</td></tr>
  <tr><td>1808</td><td>		<span class="codeReserved">this</span>._setDisconnectedBufferSize = <span class="codeReserved">function</span>(newDisconnectedBufferSize) {</td></tr>
  <tr><td>1809</td><td>			client.disconnectedBufferSize = newDisconnectedBufferSize;</td></tr>
  <tr><td>1810</td><td>		};</td></tr>
  <tr><td>1811</td><td></td></tr>
  <tr><td>1812</td><td>		<span class="codeReserved">this</span>._getOnConnectionLost = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.onConnectionLost; };</td></tr>
  <tr><td>1813</td><td>		<span class="codeReserved">this</span>._setOnConnectionLost = <span class="codeReserved">function</span>(newOnConnectionLost) {</td></tr>
  <tr><td>1814</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> newOnConnectionLost === <span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>)</td></tr>
  <tr><td>1815</td><td>				client.onConnectionLost = newOnConnectionLost;</td></tr>
  <tr><td>1816</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>1817</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> newOnConnectionLost, <span class="codeString">&quot;onConnectionLost&quot;</span>]));</td></tr>
  <tr><td>1818</td><td>		};</td></tr>
  <tr><td>1819</td><td></td></tr>
  <tr><td>1820</td><td>		<span class="codeReserved">this</span>._getOnMessageDelivered = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.onMessageDelivered; };</td></tr>
  <tr><td>1821</td><td>		<span class="codeReserved">this</span>._setOnMessageDelivered = <span class="codeReserved">function</span>(newOnMessageDelivered) {</td></tr>
  <tr><td>1822</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> newOnMessageDelivered === <span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>)</td></tr>
  <tr><td>1823</td><td>				client.onMessageDelivered = newOnMessageDelivered;</td></tr>
  <tr><td>1824</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>1825</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> newOnMessageDelivered, <span class="codeString">&quot;onMessageDelivered&quot;</span>]));</td></tr>
  <tr><td>1826</td><td>		};</td></tr>
  <tr><td>1827</td><td></td></tr>
  <tr><td>1828</td><td>		<span class="codeReserved">this</span>._getOnMessageArrived = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.onMessageArrived; };</td></tr>
  <tr><td>1829</td><td>		<span class="codeReserved">this</span>._setOnMessageArrived = <span class="codeReserved">function</span>(newOnMessageArrived) {</td></tr>
  <tr><td>1830</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> newOnMessageArrived === <span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>)</td></tr>
  <tr><td>1831</td><td>				client.onMessageArrived = newOnMessageArrived;</td></tr>
  <tr><td>1832</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>1833</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> newOnMessageArrived, <span class="codeString">&quot;onMessageArrived&quot;</span>]));</td></tr>
  <tr><td>1834</td><td>		};</td></tr>
  <tr><td>1835</td><td></td></tr>
  <tr><td>1836</td><td>		<span class="codeReserved">this</span>._getTrace = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> client.traceFunction; };</td></tr>
  <tr><td>1837</td><td>		<span class="codeReserved">this</span>._setTrace = <span class="codeReserved">function</span>(trace) {</td></tr>
  <tr><td>1838</td><td>			<span class="codeReserved">if</span>(<span class="codeReserved">typeof</span> trace === <span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>){</td></tr>
  <tr><td>1839</td><td>				client.traceFunction = trace;</td></tr>
  <tr><td>1840</td><td>			}<span class="codeReserved">else</span>{</td></tr>
  <tr><td>1841</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> trace, <span class="codeString">&quot;onTrace&quot;</span>]));</td></tr>
  <tr><td>1842</td><td>			}</td></tr>
  <tr><td>1843</td><td>		};</td></tr>
  <tr><td>1844</td><td></td></tr>
  <tr><td>1845</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>1846</td><td><span class="codeComment">		 * Connect <span class="codeReserved">this</span> Messaging client to its server.</span></td></tr>
  <tr><td>1847</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>1848</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#connect</span></td></tr>
  <tr><td>1849</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>1850</td><td><span class="codeComment">		 * @param {object} connectOptions - Attributes used with the connection.</span></td></tr>
  <tr><td>1851</td><td><span class="codeComment">		 * @param {number} connectOptions.timeout - If the connect has not succeeded within <span class="codeReserved">this</span></span></td></tr>
  <tr><td>1852</td><td><span class="codeComment">		 *                    number of seconds, it is deemed to have failed.</span></td></tr>
  <tr><td>1853</td><td><span class="codeComment">		 *                    The <span class="codeReserved">default</span> is 30 seconds.</span></td></tr>
  <tr><td>1854</td><td><span class="codeComment">		 * @param {string} connectOptions.userName - Authentication username <span class="codeReserved">for</span> <span class="codeReserved">this</span> connection.</span></td></tr>
  <tr><td>1855</td><td><span class="codeComment">		 * @param {string} connectOptions.password - Authentication password <span class="codeReserved">for</span> <span class="codeReserved">this</span> connection.</span></td></tr>
  <tr><td>1856</td><td><span class="codeComment">		 * @param {Paho.MQTT.Message} connectOptions.willMessage - sent by the server when the client</span></td></tr>
  <tr><td>1857</td><td><span class="codeComment">		 *                    disconnects abnormally.</span></td></tr>
  <tr><td>1858</td><td><span class="codeComment">		 * @param {number} connectOptions.keepAliveInterval - the server disconnects <span class="codeReserved">this</span> client <span class="codeReserved">if</span></span></td></tr>
  <tr><td>1859</td><td><span class="codeComment">		 *                    there is no activity <span class="codeReserved">for</span> <span class="codeReserved">this</span> number of seconds.</span></td></tr>
  <tr><td>1860</td><td><span class="codeComment">		 *                    The <span class="codeReserved">default</span> value of 60 seconds is assumed <span class="codeReserved">if</span> not set.</span></td></tr>
  <tr><td>1861</td><td><span class="codeComment">		 * @param {boolean} connectOptions.cleanSession - <span class="codeReserved">if</span> <span class="codeReserved">true</span>(<span class="codeReserved">default</span>) the client and server</span></td></tr>
  <tr><td>1862</td><td><span class="codeComment">		 *                    persistent state is deleted on successful connect.</span></td></tr>
  <tr><td>1863</td><td><span class="codeComment">		 * @param {boolean} connectOptions.useSSL - <span class="codeReserved">if</span> present and <span class="codeReserved">true</span>, use an SSL Websocket connection.</span></td></tr>
  <tr><td>1864</td><td><span class="codeComment">		 * @param {object} connectOptions.invocationContext - passed to the onSuccess callback or onFailure callback.</span></td></tr>
  <tr><td>1865</td><td><span class="codeComment">		 * @param {<span class="codeReserved">function</span>} connectOptions.onSuccess - called when the connect acknowledgement</span></td></tr>
  <tr><td>1866</td><td><span class="codeComment">		 *                    has been received <span class="codeReserved">from</span> the server.</span></td></tr>
  <tr><td>1867</td><td><span class="codeComment">		 * A single response object parameter is passed to the onSuccess callback containing the following fields:</span></td></tr>
  <tr><td>1868</td><td><span class="codeComment">		 * &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1869</td><td><span class="codeComment">		 * &lt;<span class="codeReserved">li</span>&gt;invocationContext <span class="codeReserved">as</span> passed <span class="codeReserved">in</span> to the onSuccess method <span class="codeReserved">in</span> the connectOptions.</span></td></tr>
  <tr><td>1870</td><td><span class="codeComment">		 * &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1871</td><td><span class="codeComment">     * @param {<span class="codeReserved">function</span>} connectOptions.onFailure - called when the connect request has failed or timed out.</span></td></tr>
  <tr><td>1872</td><td><span class="codeComment">		 * A single response object parameter is passed to the onFailure callback containing the following fields:</span></td></tr>
  <tr><td>1873</td><td><span class="codeComment">		 * &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1874</td><td><span class="codeComment">		 * &lt;<span class="codeReserved">li</span>&gt;invocationContext <span class="codeReserved">as</span> passed <span class="codeReserved">in</span> to the onFailure method <span class="codeReserved">in</span> the connectOptions.</span></td></tr>
  <tr><td>1875</td><td><span class="codeComment">		 * &lt;<span class="codeReserved">li</span>&gt;errorCode a number indicating the nature of the error.</span></td></tr>
  <tr><td>1876</td><td><span class="codeComment">		 * &lt;<span class="codeReserved">li</span>&gt;errorMessage text describing the error.</span></td></tr>
  <tr><td>1877</td><td><span class="codeComment">		 * &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>1878</td><td><span class="codeComment">     * @param {array} connectOptions.hosts - If present <span class="codeReserved">this</span> contains either a set of hostnames or fully qualified</span></td></tr>
  <tr><td>1879</td><td><span class="codeComment">		 * WebSocket URIs (ws:<span class="codeComment">//iot.eclipse.org:80/ws), that are tried <span class="codeReserved">in</span> order <span class="codeReserved">in</span> place</span></span></td></tr>
  <tr><td>1880</td><td><span class="codeComment">		 * of the host and port paramater on the construtor. The hosts are tried one at at time <span class="codeReserved">in</span> order until</span></td></tr>
  <tr><td>1881</td><td><span class="codeComment">		 * one of then succeeds.</span></td></tr>
  <tr><td>1882</td><td><span class="codeComment">     * @param {array} connectOptions.ports - If present the set of ports matching the hosts. If hosts contains URIs, <span class="codeReserved">this</span> property</span></td></tr>
  <tr><td>1883</td><td><span class="codeComment">		 * is not used.</span></td></tr>
  <tr><td>1884</td><td><span class="codeComment">     * @param {boolean} connectOptions.reconnect - Sets whether the client will automatically attempt to reconnect</span></td></tr>
  <tr><td>1885</td><td><span class="codeComment">     * to the server <span class="codeReserved">if</span> the connection is lost.</span></td></tr>
  <tr><td>1886</td><td><span class="codeComment">     *&lt;<span class="codeReserved">ul</span>&gt;</span></td></tr>
  <tr><td>1887</td><td><span class="codeComment">     *&lt;<span class="codeReserved">li</span>&gt;If set to <span class="codeReserved">false</span>, the client will not attempt to automatically reconnect to the server <span class="codeReserved">in</span> the event that the</span></td></tr>
  <tr><td>1888</td><td><span class="codeComment">     * connection is lost.&lt;/<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>1889</td><td><span class="codeComment">     *&lt;<span class="codeReserved">li</span>&gt;If set to <span class="codeReserved">true</span>, <span class="codeReserved">in</span> the event that the connection is lost, the client will attempt to reconnect to the server.</span></td></tr>
  <tr><td>1890</td><td><span class="codeComment">     * It will initially wait 1 second before it attempts to reconnect, <span class="codeReserved">for</span> every failed reconnect attempt, the delay</span></td></tr>
  <tr><td>1891</td><td><span class="codeComment">     * will double until it is at 2 minutes at which point the delay will stay at 2 minutes.&lt;/<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>1892</td><td><span class="codeComment">     *&lt;/<span class="codeReserved">ul</span>&gt;</span></td></tr>
  <tr><td>1893</td><td><span class="codeComment">     * @param {number} connectOptions.mqttVersion - The version of MQTT to use to connect to the MQTT Broker.</span></td></tr>
  <tr><td>1894</td><td><span class="codeComment">     *&lt;<span class="codeReserved">ul</span>&gt;</span></td></tr>
  <tr><td>1895</td><td><span class="codeComment">     *&lt;<span class="codeReserved">li</span>&gt;3 - MQTT V3.1&lt;/<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>1896</td><td><span class="codeComment">     *&lt;<span class="codeReserved">li</span>&gt;4 - MQTT V3.1.1&lt;/<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>1897</td><td><span class="codeComment">     *&lt;/<span class="codeReserved">ul</span>&gt;</span></td></tr>
  <tr><td>1898</td><td><span class="codeComment">     * @param {boolean} connectOptions.mqttVersionExplicit - If set to <span class="codeReserved">true</span>, will force the connection to use the</span></td></tr>
  <tr><td>1899</td><td><span class="codeComment">     * selected MQTT Version or will fail to connect.</span></td></tr>
  <tr><td>1900</td><td><span class="codeComment">     * @param {array} connectOptions.uris - If present, should contain a list of fully qualified WebSocket uris</span></td></tr>
  <tr><td>1901</td><td><span class="codeComment">     * (e.g. ws:<span class="codeComment">//iot.eclipse.org:80/ws), that are tried <span class="codeReserved">in</span> order <span class="codeReserved">in</span> place of the host and port parameter of the construtor.</span></span></td></tr>
  <tr><td>1902</td><td><span class="codeComment">     * The uris are tried one at a time <span class="codeReserved">in</span> order until one of them succeeds. Do not use <span class="codeReserved">this</span> <span class="codeReserved">in</span> conjunction with hosts <span class="codeReserved">as</span></span></td></tr>
  <tr><td>1903</td><td><span class="codeComment">     * the hosts array will be converted to uris and will overwrite <span class="codeReserved">this</span> property.</span></td></tr>
  <tr><td>1904</td><td><span class="codeComment">		 * @throws {InvalidState} If the client is not <span class="codeReserved">in</span> disconnected state. The client must have received connectionLost</span></td></tr>
  <tr><td>1905</td><td><span class="codeComment">		 * or disconnected before calling connect <span class="codeReserved">for</span> a second or subsequent time.</span></td></tr>
  <tr><td>1906</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>1907</td><td>		<span class="codeReserved">this</span>.connect = <span class="codeReserved">function</span> (connectOptions) {</td></tr>
  <tr><td>1908</td><td>			connectOptions = connectOptions || {} ;</td></tr>
  <tr><td>1909</td><td>			validate(connectOptions,  {timeout:<span class="codeString">&quot;number&quot;</span>,</td></tr>
  <tr><td>1910</td><td>									   userName:<span class="codeString">&quot;string&quot;</span>,</td></tr>
  <tr><td>1911</td><td>									   password:<span class="codeString">&quot;string&quot;</span>,</td></tr>
  <tr><td>1912</td><td>									   willMessage:<span class="codeString">&quot;object&quot;</span>,</td></tr>
  <tr><td>1913</td><td>									   keepAliveInterval:<span class="codeString">&quot;number&quot;</span>,</td></tr>
  <tr><td>1914</td><td>									   cleanSession:<span class="codeString">&quot;boolean&quot;</span>,</td></tr>
  <tr><td>1915</td><td>									   useSSL:<span class="codeString">&quot;boolean&quot;</span>,</td></tr>
  <tr><td>1916</td><td>									   invocationContext:<span class="codeString">&quot;object&quot;</span>,</td></tr>
  <tr><td>1917</td><td>									   onSuccess:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,</td></tr>
  <tr><td>1918</td><td>									   onFailure:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,</td></tr>
  <tr><td>1919</td><td>									   hosts:<span class="codeString">&quot;object&quot;</span>,</td></tr>
  <tr><td>1920</td><td>									   ports:<span class="codeString">&quot;object&quot;</span>,</td></tr>
  <tr><td>1921</td><td>									   reconnect:<span class="codeString">&quot;boolean&quot;</span>,</td></tr>
  <tr><td>1922</td><td>									   mqttVersion:<span class="codeString">&quot;number&quot;</span>,</td></tr>
  <tr><td>1923</td><td>									   mqttVersionExplicit:<span class="codeString">&quot;boolean&quot;</span>,</td></tr>
  <tr><td>1924</td><td>									   uris: <span class="codeString">&quot;object&quot;</span>});</td></tr>
  <tr><td>1925</td><td></td></tr>
  <tr><td>1926</td><td>			<span class="codeComment">// If no keep alive interval is set, assume 60 seconds.</span></td></tr>
  <tr><td>1927</td><td>			<span class="codeReserved">if</span> (connectOptions.keepAliveInterval === undefined)</td></tr>
  <tr><td>1928</td><td>				connectOptions.keepAliveInterval = 60;</td></tr>
  <tr><td>1929</td><td></td></tr>
  <tr><td>1930</td><td>			<span class="codeReserved">if</span> (connectOptions.mqttVersion &gt; 4 || connectOptions.mqttVersion &lt; 3) {</td></tr>
  <tr><td>1931</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.mqttVersion, <span class="codeString">&quot;connectOptions.mqttVersion&quot;</span>]));</td></tr>
  <tr><td>1932</td><td>			}</td></tr>
  <tr><td>1933</td><td></td></tr>
  <tr><td>1934</td><td>			<span class="codeReserved">if</span> (connectOptions.mqttVersion === undefined) {</td></tr>
  <tr><td>1935</td><td>				connectOptions.mqttVersionExplicit = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>1936</td><td>				connectOptions.mqttVersion = 4;</td></tr>
  <tr><td>1937</td><td>			} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>1938</td><td>				connectOptions.mqttVersionExplicit = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1939</td><td>			}</td></tr>
  <tr><td>1940</td><td></td></tr>
  <tr><td>1941</td><td>			<span class="codeComment">//Check that <span class="codeReserved">if</span> password is set, so is username</span></td></tr>
  <tr><td>1942</td><td>			<span class="codeReserved">if</span> (connectOptions.password !== undefined && connectOptions.userName === undefined)</td></tr>
  <tr><td>1943</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.password, <span class="codeString">&quot;connectOptions.password&quot;</span>]));</td></tr>
  <tr><td>1944</td><td></td></tr>
  <tr><td>1945</td><td>			<span class="codeReserved">if</span> (connectOptions.willMessage) {</td></tr>
  <tr><td>1946</td><td>				<span class="codeReserved">if</span> (!(connectOptions.willMessage <span class="codeReserved">instanceof</span> Message))</td></tr>
  <tr><td>1947</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [connectOptions.willMessage, <span class="codeString">&quot;connectOptions.willMessage&quot;</span>]));</td></tr>
  <tr><td>1948</td><td>				<span class="codeComment">// The will message must have a payload that can be represented <span class="codeReserved">as</span> a string.</span></td></tr>
  <tr><td>1949</td><td>				<span class="codeComment">// Cause the willMessage to <span class="codeReserved">throw</span> an exception <span class="codeReserved">if</span> <span class="codeReserved">this</span> is not the <span class="codeReserved">case</span>.</span></td></tr>
  <tr><td>1950</td><td>				connectOptions.willMessage.stringPayload = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>1951</td><td></td></tr>
  <tr><td>1952</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> connectOptions.willMessage.destinationName === <span class="codeString">&quot;undefined&quot;</span>)</td></tr>
  <tr><td>1953</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> connectOptions.willMessage.destinationName, <span class="codeString">&quot;connectOptions.willMessage.destinationName&quot;</span>]));</td></tr>
  <tr><td>1954</td><td>			}</td></tr>
  <tr><td>1955</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> connectOptions.cleanSession === <span class="codeString">&quot;undefined&quot;</span>)</td></tr>
  <tr><td>1956</td><td>				connectOptions.cleanSession = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1957</td><td>			<span class="codeReserved">if</span> (connectOptions.hosts) {</td></tr>
  <tr><td>1958</td><td></td></tr>
  <tr><td>1959</td><td>				<span class="codeReserved">if</span> (!(connectOptions.hosts <span class="codeReserved">instanceof</span> Array) )</td></tr>
  <tr><td>1960</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, <span class="codeString">&quot;connectOptions.hosts&quot;</span>]));</td></tr>
  <tr><td>1961</td><td>				<span class="codeReserved">if</span> (connectOptions.hosts.length &lt;<span class="codeReserved">1</span> )</td></tr>
  <tr><td>1962</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts, <span class="codeString">&quot;connectOptions.hosts&quot;</span>]));</td></tr>
  <tr><td>1963</td><td></td></tr>
  <tr><td>1964</td><td>				var usingURIs = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>1965</td><td>				<span class="codeReserved">for</span> (var i = 0; i&lt;<span class="codeReserved">connectOptions</span>.hosts.length; i++) {</td></tr>
  <tr><td>1966</td><td>					<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> connectOptions.hosts[i] !== <span class="codeString">&quot;string&quot;</span>)</td></tr>
  <tr><td>1967</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> connectOptions.hosts[i], <span class="codeString">&quot;connectOptions.hosts[&quot;</span>+i+<span class="codeString">&quot;]&quot;</span>]));</td></tr>
  <tr><td>1968</td><td>					<span class="codeReserved">if</span> (<span class="codeString">/^(wss?):\/</span>\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(connectOptions.hosts[i])) {</td></tr>
  <tr><td>1969</td><td>						<span class="codeReserved">if</span> (i === 0) {</td></tr>
  <tr><td>1970</td><td>							usingURIs = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>1971</td><td>						} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!usingURIs) {</td></tr>
  <tr><td>1972</td><td>							<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], <span class="codeString">&quot;connectOptions.hosts[&quot;</span>+i+<span class="codeString">&quot;]&quot;</span>]));</td></tr>
  <tr><td>1973</td><td>						}</td></tr>
  <tr><td>1974</td><td>					} <span class="codeReserved">else</span> <span class="codeReserved">if</span> (usingURIs) {</td></tr>
  <tr><td>1975</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.hosts[i], <span class="codeString">&quot;connectOptions.hosts[&quot;</span>+i+<span class="codeString">&quot;]&quot;</span>]));</td></tr>
  <tr><td>1976</td><td>					}</td></tr>
  <tr><td>1977</td><td>				}</td></tr>
  <tr><td>1978</td><td></td></tr>
  <tr><td>1979</td><td>				<span class="codeReserved">if</span> (!usingURIs) {</td></tr>
  <tr><td>1980</td><td>					<span class="codeReserved">if</span> (!connectOptions.ports)</td></tr>
  <tr><td>1981</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, <span class="codeString">&quot;connectOptions.ports&quot;</span>]));</td></tr>
  <tr><td>1982</td><td>					<span class="codeReserved">if</span> (!(connectOptions.ports <span class="codeReserved">instanceof</span> Array) )</td></tr>
  <tr><td>1983</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, <span class="codeString">&quot;connectOptions.ports&quot;</span>]));</td></tr>
  <tr><td>1984</td><td>					<span class="codeReserved">if</span> (connectOptions.hosts.length !== connectOptions.ports.length)</td></tr>
  <tr><td>1985</td><td>						<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [connectOptions.ports, <span class="codeString">&quot;connectOptions.ports&quot;</span>]));</td></tr>
  <tr><td>1986</td><td></td></tr>
  <tr><td>1987</td><td>					connectOptions.uris = [];</td></tr>
  <tr><td>1988</td><td></td></tr>
  <tr><td>1989</td><td>					<span class="codeReserved">for</span> (var i = 0; i&lt;<span class="codeReserved">connectOptions</span>.hosts.length; i++) {</td></tr>
  <tr><td>1990</td><td>						<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> connectOptions.ports[i] !== <span class="codeString">&quot;number&quot;</span> || connectOptions.ports[i] &lt; 0)</td></tr>
  <tr><td>1991</td><td>							<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_TYPE, [<span class="codeReserved">typeof</span> connectOptions.ports[i], <span class="codeString">&quot;connectOptions.ports[&quot;</span>+i+<span class="codeString">&quot;]&quot;</span>]));</td></tr>
  <tr><td>1992</td><td>						var host = connectOptions.hosts[i];</td></tr>
  <tr><td>1993</td><td>						var port = connectOptions.ports[i];</td></tr>
  <tr><td>1994</td><td></td></tr>
  <tr><td>1995</td><td>						var ipv6 = (host.indexOf(<span class="codeString">&quot;:&quot;</span>) !== -1);</td></tr>
  <tr><td>1996</td><td>						uri = <span class="codeString">&quot;ws:&#47;&#47;&quot;</span>+(ipv6?<span class="codeString">&quot;[&quot;</span>+host+<span class="codeString">&quot;]&quot;</span>:host)+<span class="codeString">&quot;:&quot;</span>+port+path;</td></tr>
  <tr><td>1997</td><td>						connectOptions.uris.push(uri);</td></tr>
  <tr><td>1998</td><td>					}</td></tr>
  <tr><td>1999</td><td>				} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>2000</td><td>					connectOptions.uris = connectOptions.hosts;</td></tr>
  <tr><td>2001</td><td>				}</td></tr>
  <tr><td>2002</td><td>			}</td></tr>
  <tr><td>2003</td><td></td></tr>
  <tr><td>2004</td><td>			client.connect(connectOptions);</td></tr>
  <tr><td>2005</td><td>		};</td></tr>
  <tr><td>2006</td><td></td></tr>
  <tr><td>2007</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2008</td><td><span class="codeComment">		 * Subscribe <span class="codeReserved">for</span> messages, request receipt of a copy of messages sent to the destinations described by the filter.</span></td></tr>
  <tr><td>2009</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2010</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#subscribe</span></td></tr>
  <tr><td>2011</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2012</td><td><span class="codeComment">		 * @param {string} filter describing the destinations to receive messages <span class="codeReserved">from</span>.</span></td></tr>
  <tr><td>2013</td><td><span class="codeComment">		 * &lt;<span class="codeReserved">br</span>&gt;</span></td></tr>
  <tr><td>2014</td><td><span class="codeComment">		 * @param {object} subscribeOptions - used to control the subscription</span></td></tr>
  <tr><td>2015</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2016</td><td><span class="codeComment">		 * @param {number} subscribeOptions.qos - the maiximum qos of any publications sent</span></td></tr>
  <tr><td>2017</td><td><span class="codeComment">		 *                                  <span class="codeReserved">as</span> a result of making <span class="codeReserved">this</span> subscription.</span></td></tr>
  <tr><td>2018</td><td><span class="codeComment">		 * @param {object} subscribeOptions.invocationContext - passed to the onSuccess callback</span></td></tr>
  <tr><td>2019</td><td><span class="codeComment">		 *                                  or onFailure callback.</span></td></tr>
  <tr><td>2020</td><td><span class="codeComment">		 * @param {<span class="codeReserved">function</span>} subscribeOptions.onSuccess - called when the subscribe acknowledgement</span></td></tr>
  <tr><td>2021</td><td><span class="codeComment">		 *                                  has been received <span class="codeReserved">from</span> the server.</span></td></tr>
  <tr><td>2022</td><td><span class="codeComment">		 *                                  A single response object parameter is passed to the onSuccess callback containing the following fields:</span></td></tr>
  <tr><td>2023</td><td><span class="codeComment">		 *                                  &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2024</td><td><span class="codeComment">		 *                                  &lt;<span class="codeReserved">li</span>&gt;invocationContext <span class="codeReserved">if</span> set <span class="codeReserved">in</span> the subscribeOptions.</span></td></tr>
  <tr><td>2025</td><td><span class="codeComment">		 *                                  &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2026</td><td><span class="codeComment">		 * @param {<span class="codeReserved">function</span>} subscribeOptions.onFailure - called when the subscribe request has failed or timed out.</span></td></tr>
  <tr><td>2027</td><td><span class="codeComment">		 *                                  A single response object parameter is passed to the onFailure callback containing the following fields:</span></td></tr>
  <tr><td>2028</td><td><span class="codeComment">		 *                                  &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2029</td><td><span class="codeComment">		 *                                  &lt;<span class="codeReserved">li</span>&gt;invocationContext - <span class="codeReserved">if</span> set <span class="codeReserved">in</span> the subscribeOptions.</span></td></tr>
  <tr><td>2030</td><td><span class="codeComment">		 *                                  &lt;<span class="codeReserved">li</span>&gt;errorCode - a number indicating the nature of the error.</span></td></tr>
  <tr><td>2031</td><td><span class="codeComment">		 *                                  &lt;<span class="codeReserved">li</span>&gt;errorMessage - text describing the error.</span></td></tr>
  <tr><td>2032</td><td><span class="codeComment">		 *                                  &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2033</td><td><span class="codeComment">		 * @param {number} subscribeOptions.timeout - which, <span class="codeReserved">if</span> present, determines the number of</span></td></tr>
  <tr><td>2034</td><td><span class="codeComment">		 *                                  seconds after which the onFailure calback is called.</span></td></tr>
  <tr><td>2035</td><td><span class="codeComment">		 *                                  The presence of a timeout does not prevent the onSuccess</span></td></tr>
  <tr><td>2036</td><td><span class="codeComment">		 *                                  callback <span class="codeReserved">from</span> being called when the subscribe completes.</span></td></tr>
  <tr><td>2037</td><td><span class="codeComment">		 * @throws {InvalidState} <span class="codeReserved">if</span> the client is not <span class="codeReserved">in</span> connected state.</span></td></tr>
  <tr><td>2038</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2039</td><td>		<span class="codeReserved">this</span>.subscribe = <span class="codeReserved">function</span> (filter, subscribeOptions) {</td></tr>
  <tr><td>2040</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> filter !== <span class="codeString">&quot;string&quot;</span>)</td></tr>
  <tr><td>2041</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+filter);</td></tr>
  <tr><td>2042</td><td>			subscribeOptions = subscribeOptions || {} ;</td></tr>
  <tr><td>2043</td><td>			validate(subscribeOptions,  {qos:<span class="codeString">&quot;number&quot;</span>,</td></tr>
  <tr><td>2044</td><td>										 invocationContext:<span class="codeString">&quot;object&quot;</span>,</td></tr>
  <tr><td>2045</td><td>										 onSuccess:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,</td></tr>
  <tr><td>2046</td><td>										 onFailure:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,</td></tr>
  <tr><td>2047</td><td>										 timeout:<span class="codeString">&quot;number&quot;</span></td></tr>
  <tr><td>2048</td><td>										});</td></tr>
  <tr><td>2049</td><td>			<span class="codeReserved">if</span> (subscribeOptions.timeout && !subscribeOptions.onFailure)</td></tr>
  <tr><td>2050</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;subscribeOptions.timeout specified with no onFailure callback.&quot;</span>);</td></tr>
  <tr><td>2051</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> subscribeOptions.qos !== <span class="codeString">&quot;undefined&quot;</span> && !(subscribeOptions.qos === 0 || subscribeOptions.qos === 1 || subscribeOptions.qos === 2 ))</td></tr>
  <tr><td>2052</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [subscribeOptions.qos, <span class="codeString">&quot;subscribeOptions.qos&quot;</span>]));</td></tr>
  <tr><td>2053</td><td>			client.subscribe(filter, subscribeOptions);</td></tr>
  <tr><td>2054</td><td>		};</td></tr>
  <tr><td>2055</td><td></td></tr>
  <tr><td>2056</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2057</td><td><span class="codeComment">		 * Unsubscribe <span class="codeReserved">for</span> messages, stop receiving messages sent to destinations described by the filter.</span></td></tr>
  <tr><td>2058</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2059</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#unsubscribe</span></td></tr>
  <tr><td>2060</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2061</td><td><span class="codeComment">		 * @param {string} filter - describing the destinations to receive messages <span class="codeReserved">from</span>.</span></td></tr>
  <tr><td>2062</td><td><span class="codeComment">		 * @param {object} unsubscribeOptions - used to control the subscription</span></td></tr>
  <tr><td>2063</td><td><span class="codeComment">		 * @param {object} unsubscribeOptions.invocationContext - passed to the onSuccess callback</span></td></tr>
  <tr><td>2064</td><td><span class="codeComment">		                                      or onFailure callback.</span></td></tr>
  <tr><td>2065</td><td><span class="codeComment">		 * @param {<span class="codeReserved">function</span>} unsubscribeOptions.onSuccess - called when the unsubscribe acknowledgement has been received <span class="codeReserved">from</span> the server.</span></td></tr>
  <tr><td>2066</td><td><span class="codeComment">		 *                                    A single response object parameter is passed to the</span></td></tr>
  <tr><td>2067</td><td><span class="codeComment">		 *                                    onSuccess callback containing the following fields:</span></td></tr>
  <tr><td>2068</td><td><span class="codeComment">		 *                                    &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2069</td><td><span class="codeComment">		 *                                    &lt;<span class="codeReserved">li</span>&gt;invocationContext - <span class="codeReserved">if</span> set <span class="codeReserved">in</span> the unsubscribeOptions.</span></td></tr>
  <tr><td>2070</td><td><span class="codeComment">		 *                                    &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2071</td><td><span class="codeComment">		 * @param {<span class="codeReserved">function</span>} unsubscribeOptions.onFailure called when the unsubscribe request has failed or timed out.</span></td></tr>
  <tr><td>2072</td><td><span class="codeComment">		 *                                    A single response object parameter is passed to the onFailure callback containing the following fields:</span></td></tr>
  <tr><td>2073</td><td><span class="codeComment">		 *                                    &lt;<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2074</td><td><span class="codeComment">		 *                                    &lt;<span class="codeReserved">li</span>&gt;invocationContext - <span class="codeReserved">if</span> set <span class="codeReserved">in</span> the unsubscribeOptions.</span></td></tr>
  <tr><td>2075</td><td><span class="codeComment">		 *                                    &lt;<span class="codeReserved">li</span>&gt;errorCode - a number indicating the nature of the error.</span></td></tr>
  <tr><td>2076</td><td><span class="codeComment">		 *                                    &lt;<span class="codeReserved">li</span>&gt;errorMessage - text describing the error.</span></td></tr>
  <tr><td>2077</td><td><span class="codeComment">		 *                                    &lt;/<span class="codeReserved">ol</span>&gt;</span></td></tr>
  <tr><td>2078</td><td><span class="codeComment">		 * @param {number} unsubscribeOptions.timeout - which, <span class="codeReserved">if</span> present, determines the number of seconds</span></td></tr>
  <tr><td>2079</td><td><span class="codeComment">		 *                                    after which the onFailure callback is called. The presence of</span></td></tr>
  <tr><td>2080</td><td><span class="codeComment">		 *                                    a timeout does not prevent the onSuccess callback <span class="codeReserved">from</span> being</span></td></tr>
  <tr><td>2081</td><td><span class="codeComment">		 *                                    called when the unsubscribe completes</span></td></tr>
  <tr><td>2082</td><td><span class="codeComment">		 * @throws {InvalidState} <span class="codeReserved">if</span> the client is not <span class="codeReserved">in</span> connected state.</span></td></tr>
  <tr><td>2083</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2084</td><td>		<span class="codeReserved">this</span>.unsubscribe = <span class="codeReserved">function</span> (filter, unsubscribeOptions) {</td></tr>
  <tr><td>2085</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> filter !== <span class="codeString">&quot;string&quot;</span>)</td></tr>
  <tr><td>2086</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+filter);</td></tr>
  <tr><td>2087</td><td>			unsubscribeOptions = unsubscribeOptions || {} ;</td></tr>
  <tr><td>2088</td><td>			validate(unsubscribeOptions,  {invocationContext:<span class="codeString">&quot;object&quot;</span>,</td></tr>
  <tr><td>2089</td><td>										   onSuccess:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,</td></tr>
  <tr><td>2090</td><td>										   onFailure:<span class="codeString">&quot;<span class="codeReserved">function</span>&quot;</span>,</td></tr>
  <tr><td>2091</td><td>										   timeout:<span class="codeString">&quot;number&quot;</span></td></tr>
  <tr><td>2092</td><td>										  });</td></tr>
  <tr><td>2093</td><td>			<span class="codeReserved">if</span> (unsubscribeOptions.timeout && !unsubscribeOptions.onFailure)</td></tr>
  <tr><td>2094</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;unsubscribeOptions.timeout specified with no onFailure callback.&quot;</span>);</td></tr>
  <tr><td>2095</td><td>			client.unsubscribe(filter, unsubscribeOptions);</td></tr>
  <tr><td>2096</td><td>		};</td></tr>
  <tr><td>2097</td><td></td></tr>
  <tr><td>2098</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2099</td><td><span class="codeComment">		 * Send a message to the consumers of the destination <span class="codeReserved">in</span> the Message.</span></td></tr>
  <tr><td>2100</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2101</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#send</span></td></tr>
  <tr><td>2102</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2103</td><td><span class="codeComment">		 * @param {string|Paho.MQTT.Message} topic - &lt;<span class="codeReserved">b</span>&gt;mandatory&lt;/<span class="codeReserved">b</span>&gt; The name of the destination to which the message is to be sent.</span></td></tr>
  <tr><td>2104</td><td><span class="codeComment">		 * 					   - If it is the only parameter, used <span class="codeReserved">as</span> Paho.MQTT.Message object.</span></td></tr>
  <tr><td>2105</td><td><span class="codeComment">		 * @param {String|ArrayBuffer} payload - The message data to be sent.</span></td></tr>
  <tr><td>2106</td><td><span class="codeComment">		 * @param {number} qos The Quality of Service used to deliver the message.</span></td></tr>
  <tr><td>2107</td><td><span class="codeComment">		 * 		&lt;<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>2108</td><td><span class="codeComment">		 * 			&lt;<span class="codeReserved">dt</span>&gt;0 Best effort (<span class="codeReserved">default</span>).</span></td></tr>
  <tr><td>2109</td><td><span class="codeComment">		 *     			&lt;<span class="codeReserved">dt</span>&gt;1 At least once.</span></td></tr>
  <tr><td>2110</td><td><span class="codeComment">		 *     			&lt;<span class="codeReserved">dt</span>&gt;2 Exactly once.</span></td></tr>
  <tr><td>2111</td><td><span class="codeComment">		 * 		&lt;/<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>2112</td><td><span class="codeComment">		 * @param {Boolean} retained If <span class="codeReserved">true</span>, the message is to be retained by the server and delivered</span></td></tr>
  <tr><td>2113</td><td><span class="codeComment">		 *                     to both current and future subscriptions.</span></td></tr>
  <tr><td>2114</td><td><span class="codeComment">		 *                     If <span class="codeReserved">false</span> the server only delivers the message to current subscribers, <span class="codeReserved">this</span> is the <span class="codeReserved">default</span> <span class="codeReserved">for</span> <span class="codeReserved">new</span> Messages.</span></td></tr>
  <tr><td>2115</td><td><span class="codeComment">		 *                     A received message has the retained boolean set to <span class="codeReserved">true</span> <span class="codeReserved">if</span> the message was published</span></td></tr>
  <tr><td>2116</td><td><span class="codeComment">		 *                     with the retained boolean set to <span class="codeReserved">true</span></span></td></tr>
  <tr><td>2117</td><td><span class="codeComment">		 *                     and the subscrption was made after the message has been published.</span></td></tr>
  <tr><td>2118</td><td><span class="codeComment">		 * @throws {InvalidState} <span class="codeReserved">if</span> the client is not connected.</span></td></tr>
  <tr><td>2119</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2120</td><td>		<span class="codeReserved">this</span>.send = <span class="codeReserved">function</span> (topic,payload,qos,retained) {</td></tr>
  <tr><td>2121</td><td>			var message ;</td></tr>
  <tr><td>2122</td><td></td></tr>
  <tr><td>2123</td><td>			<span class="codeReserved">if</span>(arguments.length === 0){</td></tr>
  <tr><td>2124</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;Invalid argument.&quot;</span>+<span class="codeString">&quot;length&quot;</span>);</td></tr>
  <tr><td>2125</td><td></td></tr>
  <tr><td>2126</td><td>			}<span class="codeReserved">else</span> <span class="codeReserved">if</span>(arguments.length == 1) {</td></tr>
  <tr><td>2127</td><td></td></tr>
  <tr><td>2128</td><td>				<span class="codeReserved">if</span> (!(topic <span class="codeReserved">instanceof</span> Message) && (<span class="codeReserved">typeof</span> topic !== <span class="codeString">&quot;string&quot;</span>))</td></tr>
  <tr><td>2129</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+ <span class="codeReserved">typeof</span> topic);</td></tr>
  <tr><td>2130</td><td></td></tr>
  <tr><td>2131</td><td>				message = topic;</td></tr>
  <tr><td>2132</td><td>				<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> message.destinationName === <span class="codeString">&quot;undefined&quot;</span>)</td></tr>
  <tr><td>2133</td><td>					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,<span class="codeString">&quot;Message.destinationName&quot;</span>]));</td></tr>
  <tr><td>2134</td><td>				client.send(message);</td></tr>
  <tr><td>2135</td><td></td></tr>
  <tr><td>2136</td><td>			}<span class="codeReserved">else</span> {</td></tr>
  <tr><td>2137</td><td>				<span class="codeComment">//parameter checking <span class="codeReserved">in</span> Message object</span></td></tr>
  <tr><td>2138</td><td>				message = <span class="codeReserved">new</span> Message(payload);</td></tr>
  <tr><td>2139</td><td>				message.destinationName = topic;</td></tr>
  <tr><td>2140</td><td>				<span class="codeReserved">if</span>(arguments.length &gt;= 3)</td></tr>
  <tr><td>2141</td><td>					message.qos = qos;</td></tr>
  <tr><td>2142</td><td>				<span class="codeReserved">if</span>(arguments.length &gt;= 4)</td></tr>
  <tr><td>2143</td><td>					message.retained = retained;</td></tr>
  <tr><td>2144</td><td>				client.send(message);</td></tr>
  <tr><td>2145</td><td>			}</td></tr>
  <tr><td>2146</td><td>		};</td></tr>
  <tr><td>2147</td><td></td></tr>
  <tr><td>2148</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2149</td><td><span class="codeComment">		 * Publish a message to the consumers of the destination <span class="codeReserved">in</span> the Message.</span></td></tr>
  <tr><td>2150</td><td><span class="codeComment">		 * Synonym <span class="codeReserved">for</span> Paho.Mqtt.Client#send</span></td></tr>
  <tr><td>2151</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2152</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#publish</span></td></tr>
  <tr><td>2153</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2154</td><td><span class="codeComment">		 * @param {string|Paho.MQTT.Message} topic - &lt;<span class="codeReserved">b</span>&gt;mandatory&lt;/<span class="codeReserved">b</span>&gt; The name of the topic to which the message is to be published.</span></td></tr>
  <tr><td>2155</td><td><span class="codeComment">		 * 					   - If it is the only parameter, used <span class="codeReserved">as</span> Paho.MQTT.Message object.</span></td></tr>
  <tr><td>2156</td><td><span class="codeComment">		 * @param {String|ArrayBuffer} payload - The message data to be published.</span></td></tr>
  <tr><td>2157</td><td><span class="codeComment">		 * @param {number} qos The Quality of Service used to deliver the message.</span></td></tr>
  <tr><td>2158</td><td><span class="codeComment">		 * 		&lt;<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>2159</td><td><span class="codeComment">		 * 			&lt;<span class="codeReserved">dt</span>&gt;0 Best effort (<span class="codeReserved">default</span>).</span></td></tr>
  <tr><td>2160</td><td><span class="codeComment">		 *     			&lt;<span class="codeReserved">dt</span>&gt;1 At least once.</span></td></tr>
  <tr><td>2161</td><td><span class="codeComment">		 *     			&lt;<span class="codeReserved">dt</span>&gt;2 Exactly once.</span></td></tr>
  <tr><td>2162</td><td><span class="codeComment">		 * 		&lt;/<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>2163</td><td><span class="codeComment">		 * @param {Boolean} retained If <span class="codeReserved">true</span>, the message is to be retained by the server and delivered</span></td></tr>
  <tr><td>2164</td><td><span class="codeComment">		 *                     to both current and future subscriptions.</span></td></tr>
  <tr><td>2165</td><td><span class="codeComment">		 *                     If <span class="codeReserved">false</span> the server only delivers the message to current subscribers, <span class="codeReserved">this</span> is the <span class="codeReserved">default</span> <span class="codeReserved">for</span> <span class="codeReserved">new</span> Messages.</span></td></tr>
  <tr><td>2166</td><td><span class="codeComment">		 *                     A received message has the retained boolean set to <span class="codeReserved">true</span> <span class="codeReserved">if</span> the message was published</span></td></tr>
  <tr><td>2167</td><td><span class="codeComment">		 *                     with the retained boolean set to <span class="codeReserved">true</span></span></td></tr>
  <tr><td>2168</td><td><span class="codeComment">		 *                     and the subscrption was made after the message has been published.</span></td></tr>
  <tr><td>2169</td><td><span class="codeComment">		 * @throws {InvalidState} <span class="codeReserved">if</span> the client is not connected.</span></td></tr>
  <tr><td>2170</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2171</td><td>		 <span class="codeReserved">this</span>.publish = <span class="codeReserved">function</span>(topic,payload,qos,retained) {</td></tr>
  <tr><td>2172</td><td>			 console.log(<span class="codeString">&quot;Publising message to: &quot;</span>, topic);</td></tr>
  <tr><td>2173</td><td>			 var message ;</td></tr>
  <tr><td>2174</td><td></td></tr>
  <tr><td>2175</td><td> 			<span class="codeReserved">if</span>(arguments.length === 0){</td></tr>
  <tr><td>2176</td><td> 				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;Invalid argument.&quot;</span>+<span class="codeString">&quot;length&quot;</span>);</td></tr>
  <tr><td>2177</td><td></td></tr>
  <tr><td>2178</td><td> 			}<span class="codeReserved">else</span> <span class="codeReserved">if</span>(arguments.length == 1) {</td></tr>
  <tr><td>2179</td><td></td></tr>
  <tr><td>2180</td><td> 				<span class="codeReserved">if</span> (!(topic <span class="codeReserved">instanceof</span> Message) && (<span class="codeReserved">typeof</span> topic !== <span class="codeString">&quot;string&quot;</span>))</td></tr>
  <tr><td>2181</td><td> 					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+ <span class="codeReserved">typeof</span> topic);</td></tr>
  <tr><td>2182</td><td></td></tr>
  <tr><td>2183</td><td> 				message = topic;</td></tr>
  <tr><td>2184</td><td> 				<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> message.destinationName === <span class="codeString">&quot;undefined&quot;</span>)</td></tr>
  <tr><td>2185</td><td> 					<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT,[message.destinationName,<span class="codeString">&quot;Message.destinationName&quot;</span>]));</td></tr>
  <tr><td>2186</td><td> 				client.send(message);</td></tr>
  <tr><td>2187</td><td></td></tr>
  <tr><td>2188</td><td> 			}<span class="codeReserved">else</span> {</td></tr>
  <tr><td>2189</td><td> 				<span class="codeComment">//parameter checking <span class="codeReserved">in</span> Message object</span></td></tr>
  <tr><td>2190</td><td> 				message = <span class="codeReserved">new</span> Message(payload);</td></tr>
  <tr><td>2191</td><td> 				message.destinationName = topic;</td></tr>
  <tr><td>2192</td><td> 				<span class="codeReserved">if</span>(arguments.length &gt;= 3)</td></tr>
  <tr><td>2193</td><td> 					message.qos = qos;</td></tr>
  <tr><td>2194</td><td> 				<span class="codeReserved">if</span>(arguments.length &gt;= 4)</td></tr>
  <tr><td>2195</td><td> 					message.retained = retained;</td></tr>
  <tr><td>2196</td><td> 				client.send(message);</td></tr>
  <tr><td>2197</td><td> 			}</td></tr>
  <tr><td>2198</td><td>		};</td></tr>
  <tr><td>2199</td><td></td></tr>
  <tr><td>2200</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2201</td><td><span class="codeComment">		 * Normal disconnect of <span class="codeReserved">this</span> Messaging client <span class="codeReserved">from</span> its server.</span></td></tr>
  <tr><td>2202</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2203</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#disconnect</span></td></tr>
  <tr><td>2204</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2205</td><td><span class="codeComment">		 * @throws {InvalidState} <span class="codeReserved">if</span> the client is already disconnected.</span></td></tr>
  <tr><td>2206</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2207</td><td>		<span class="codeReserved">this</span>.disconnect = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>2208</td><td>			client.disconnect();</td></tr>
  <tr><td>2209</td><td>		};</td></tr>
  <tr><td>2210</td><td></td></tr>
  <tr><td>2211</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2212</td><td><span class="codeComment">		 * Get the contents of the trace log.</span></td></tr>
  <tr><td>2213</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2214</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#getTraceLog</span></td></tr>
  <tr><td>2215</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2216</td><td><span class="codeComment">		 * @<span class="codeReserved">return</span> {Object[]} tracebuffer containing the time ordered trace records.</span></td></tr>
  <tr><td>2217</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2218</td><td>		<span class="codeReserved">this</span>.getTraceLog = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>2219</td><td>			<span class="codeReserved">return</span> client.getTraceLog();</td></tr>
  <tr><td>2220</td><td>		};</td></tr>
  <tr><td>2221</td><td></td></tr>
  <tr><td>2222</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2223</td><td><span class="codeComment">		 * Start tracing.</span></td></tr>
  <tr><td>2224</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2225</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#startTrace</span></td></tr>
  <tr><td>2226</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2227</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2228</td><td>		<span class="codeReserved">this</span>.startTrace = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>2229</td><td>			client.startTrace();</td></tr>
  <tr><td>2230</td><td>		};</td></tr>
  <tr><td>2231</td><td></td></tr>
  <tr><td>2232</td><td>		<span class="codeComment">/**</span></td></tr>
  <tr><td>2233</td><td><span class="codeComment">		 * Stop tracing.</span></td></tr>
  <tr><td>2234</td><td><span class="codeComment">		 *</span></td></tr>
  <tr><td>2235</td><td><span class="codeComment">		 * @name Paho.MQTT.Client#stopTrace</span></td></tr>
  <tr><td>2236</td><td><span class="codeComment">		 * @<span class="codeReserved">function</span></span></td></tr>
  <tr><td>2237</td><td><span class="codeComment">		 */</span></td></tr>
  <tr><td>2238</td><td>		<span class="codeReserved">this</span>.stopTrace = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>2239</td><td>			client.stopTrace();</td></tr>
  <tr><td>2240</td><td>		};</td></tr>
  <tr><td>2241</td><td></td></tr>
  <tr><td>2242</td><td>		<span class="codeReserved">this</span>.isConnected = <span class="codeReserved">function</span>() {</td></tr>
  <tr><td>2243</td><td>			<span class="codeReserved">return</span> client.connected;</td></tr>
  <tr><td>2244</td><td>		};</td></tr>
  <tr><td>2245</td><td>	};</td></tr>
  <tr><td>2246</td><td></td></tr>
  <tr><td>2247</td><td>	Client.prototype = {</td></tr>
  <tr><td>2248</td><td>		get host() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getHost(); },</td></tr>
  <tr><td>2249</td><td>		set host(newHost) { <span class="codeReserved">this</span>._setHost(newHost); },</td></tr>
  <tr><td>2250</td><td></td></tr>
  <tr><td>2251</td><td>		get port() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPort(); },</td></tr>
  <tr><td>2252</td><td>		set port(newPort) { <span class="codeReserved">this</span>._setPort(newPort); },</td></tr>
  <tr><td>2253</td><td></td></tr>
  <tr><td>2254</td><td>		get path() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPath(); },</td></tr>
  <tr><td>2255</td><td>		set path(newPath) { <span class="codeReserved">this</span>._setPath(newPath); },</td></tr>
  <tr><td>2256</td><td></td></tr>
  <tr><td>2257</td><td>		get clientId() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getClientId(); },</td></tr>
  <tr><td>2258</td><td>		set clientId(newClientId) { <span class="codeReserved">this</span>._setClientId(newClientId); },</td></tr>
  <tr><td>2259</td><td></td></tr>
  <tr><td>2260</td><td>		get onConnected() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnConnected(); },</td></tr>
  <tr><td>2261</td><td>		set onConnected(newOnConnected) { <span class="codeReserved">this</span>._setOnConnected(newOnConnected); },</td></tr>
  <tr><td>2262</td><td></td></tr>
  <tr><td>2263</td><td>		get disconnectedPublishing() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDisconnectedPublishing(); },</td></tr>
  <tr><td>2264</td><td>		set disconnectedPublishing(newDisconnectedPublishing) { <span class="codeReserved">this</span>._setDisconnectedPublishing(newDisconnectedPublishing); },</td></tr>
  <tr><td>2265</td><td></td></tr>
  <tr><td>2266</td><td>		get disconnectedBufferSize() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDisconnectedBufferSize(); },</td></tr>
  <tr><td>2267</td><td>		set disconnectedBufferSize(newDisconnectedBufferSize) { <span class="codeReserved">this</span>._setDisconnectedBufferSize(newDisconnectedBufferSize); },</td></tr>
  <tr><td>2268</td><td></td></tr>
  <tr><td>2269</td><td>		get onConnectionLost() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnConnectionLost(); },</td></tr>
  <tr><td>2270</td><td>		set onConnectionLost(newOnConnectionLost) { <span class="codeReserved">this</span>._setOnConnectionLost(newOnConnectionLost); },</td></tr>
  <tr><td>2271</td><td></td></tr>
  <tr><td>2272</td><td>		get onMessageDelivered() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnMessageDelivered(); },</td></tr>
  <tr><td>2273</td><td>		set onMessageDelivered(newOnMessageDelivered) { <span class="codeReserved">this</span>._setOnMessageDelivered(newOnMessageDelivered); },</td></tr>
  <tr><td>2274</td><td></td></tr>
  <tr><td>2275</td><td>		get onMessageArrived() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getOnMessageArrived(); },</td></tr>
  <tr><td>2276</td><td>		set onMessageArrived(newOnMessageArrived) { <span class="codeReserved">this</span>._setOnMessageArrived(newOnMessageArrived); },</td></tr>
  <tr><td>2277</td><td></td></tr>
  <tr><td>2278</td><td>		get trace() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getTrace(); },</td></tr>
  <tr><td>2279</td><td>		set trace(newTraceFunction) { <span class="codeReserved">this</span>._setTrace(newTraceFunction); }</td></tr>
  <tr><td>2280</td><td></td></tr>
  <tr><td>2281</td><td>	};</td></tr>
  <tr><td>2282</td><td></td></tr>
  <tr><td>2283</td><td>	<span class="codeComment">/**</span></td></tr>
  <tr><td>2284</td><td><span class="codeComment">	 * An application message, sent or received.</span></td></tr>
  <tr><td>2285</td><td><span class="codeComment">	 * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>2286</td><td><span class="codeComment">	 * All attributes may be <span class="codeReserved">null</span>, which implies the <span class="codeReserved">default</span> values.</span></td></tr>
  <tr><td>2287</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>2288</td><td><span class="codeComment">	 * @name Paho.MQTT.Message</span></td></tr>
  <tr><td>2289</td><td><span class="codeComment">	 * @<span class="codeReserved">constructor</span></span></td></tr>
  <tr><td>2290</td><td><span class="codeComment">	 * @param {String|ArrayBuffer} payload The message data to be sent.</span></td></tr>
  <tr><td>2291</td><td><span class="codeComment">	 * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>2292</td><td><span class="codeComment">	 * @property {string} payloadString &lt;<span class="codeReserved">i</span>&gt;read only&lt;/<span class="codeReserved">i</span>&gt; The payload <span class="codeReserved">as</span> a string <span class="codeReserved">if</span> the payload consists of valid UTF-8 characters.</span></td></tr>
  <tr><td>2293</td><td><span class="codeComment">	 * @property {ArrayBuffer} payloadBytes &lt;<span class="codeReserved">i</span>&gt;read only&lt;/<span class="codeReserved">i</span>&gt; The payload <span class="codeReserved">as</span> an ArrayBuffer.</span></td></tr>
  <tr><td>2294</td><td><span class="codeComment">	 * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>2295</td><td><span class="codeComment">	 * @property {string} destinationName &lt;<span class="codeReserved">b</span>&gt;mandatory&lt;/<span class="codeReserved">b</span>&gt; The name of the destination to which the message is to be sent</span></td></tr>
  <tr><td>2296</td><td><span class="codeComment">	 *                    (<span class="codeReserved">for</span> messages about to be sent) or the name of the destination <span class="codeReserved">from</span> which the message has been received.</span></td></tr>
  <tr><td>2297</td><td><span class="codeComment">	 *                    (<span class="codeReserved">for</span> messages received by the onMessage <span class="codeReserved">function</span>).</span></td></tr>
  <tr><td>2298</td><td><span class="codeComment">	 * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>2299</td><td><span class="codeComment">	 * @property {number} qos The Quality of Service used to deliver the message.</span></td></tr>
  <tr><td>2300</td><td><span class="codeComment">	 * &lt;<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>2301</td><td><span class="codeComment">	 *     &lt;<span class="codeReserved">dt</span>&gt;0 Best effort (<span class="codeReserved">default</span>).</span></td></tr>
  <tr><td>2302</td><td><span class="codeComment">	 *     &lt;<span class="codeReserved">dt</span>&gt;1 At least once.</span></td></tr>
  <tr><td>2303</td><td><span class="codeComment">	 *     &lt;<span class="codeReserved">dt</span>&gt;2 Exactly once.</span></td></tr>
  <tr><td>2304</td><td><span class="codeComment">	 * &lt;/<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>2305</td><td><span class="codeComment">	 * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>2306</td><td><span class="codeComment">	 * @property {Boolean} retained If <span class="codeReserved">true</span>, the message is to be retained by the server and delivered</span></td></tr>
  <tr><td>2307</td><td><span class="codeComment">	 *                     to both current and future subscriptions.</span></td></tr>
  <tr><td>2308</td><td><span class="codeComment">	 *                     If <span class="codeReserved">false</span> the server only delivers the message to current subscribers, <span class="codeReserved">this</span> is the <span class="codeReserved">default</span> <span class="codeReserved">for</span> <span class="codeReserved">new</span> Messages.</span></td></tr>
  <tr><td>2309</td><td><span class="codeComment">	 *                     A received message has the retained boolean set to <span class="codeReserved">true</span> <span class="codeReserved">if</span> the message was published</span></td></tr>
  <tr><td>2310</td><td><span class="codeComment">	 *                     with the retained boolean set to <span class="codeReserved">true</span></span></td></tr>
  <tr><td>2311</td><td><span class="codeComment">	 *                     and the subscrption was made after the message has been published.</span></td></tr>
  <tr><td>2312</td><td><span class="codeComment">	 * &lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>2313</td><td><span class="codeComment">	 * @property {Boolean} duplicate &lt;<span class="codeReserved">i</span>&gt;read only&lt;/<span class="codeReserved">i</span>&gt; If <span class="codeReserved">true</span>, <span class="codeReserved">this</span> message might be a duplicate of one which has already been received.</span></td></tr>
  <tr><td>2314</td><td><span class="codeComment">	 *                     This is only set on messages received <span class="codeReserved">from</span> the server.</span></td></tr>
  <tr><td>2315</td><td><span class="codeComment">	 *</span></td></tr>
  <tr><td>2316</td><td><span class="codeComment">	 */</span></td></tr>
  <tr><td>2317</td><td>	var Message = <span class="codeReserved">function</span> (newPayload) {</td></tr>
  <tr><td>2318</td><td>		var payload;</td></tr>
  <tr><td>2319</td><td>		<span class="codeReserved">if</span> (   <span class="codeReserved">typeof</span> newPayload === <span class="codeString">&quot;string&quot;</span> ||</td></tr>
  <tr><td>2320</td><td>		newPayload <span class="codeReserved">instanceof</span> ArrayBuffer ||</td></tr>
  <tr><td>2321</td><td>		newPayload <span class="codeReserved">instanceof</span> Int8Array   ||</td></tr>
  <tr><td>2322</td><td>		newPayload <span class="codeReserved">instanceof</span> Uint8Array  ||</td></tr>
  <tr><td>2323</td><td>		newPayload <span class="codeReserved">instanceof</span> Int16Array  ||</td></tr>
  <tr><td>2324</td><td>		newPayload <span class="codeReserved">instanceof</span> Uint16Array ||</td></tr>
  <tr><td>2325</td><td>		newPayload <span class="codeReserved">instanceof</span> Int32Array  ||</td></tr>
  <tr><td>2326</td><td>		newPayload <span class="codeReserved">instanceof</span> Uint32Array ||</td></tr>
  <tr><td>2327</td><td>		newPayload <span class="codeReserved">instanceof</span> Float32Array ||</td></tr>
  <tr><td>2328</td><td>		newPayload <span class="codeReserved">instanceof</span> Float64Array</td></tr>
  <tr><td>2329</td><td>		   ) {</td></tr>
  <tr><td>2330</td><td>			payload = newPayload;</td></tr>
  <tr><td>2331</td><td>		} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>2332</td><td>			<span class="codeReserved">throw</span> (format(ERROR.INVALID_ARGUMENT, [newPayload, <span class="codeString">&quot;newPayload&quot;</span>]));</td></tr>
  <tr><td>2333</td><td>		}</td></tr>
  <tr><td>2334</td><td></td></tr>
  <tr><td>2335</td><td>		<span class="codeReserved">this</span>._getPayloadString = <span class="codeReserved">function</span> () {</td></tr>
  <tr><td>2336</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> payload === <span class="codeString">&quot;string&quot;</span>)</td></tr>
  <tr><td>2337</td><td>				<span class="codeReserved">return</span> payload;</td></tr>
  <tr><td>2338</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>2339</td><td>				<span class="codeReserved">return</span> parseUTF8(payload, 0, payload.length);</td></tr>
  <tr><td>2340</td><td>		};</td></tr>
  <tr><td>2341</td><td></td></tr>
  <tr><td>2342</td><td>		<span class="codeReserved">this</span>._getPayloadBytes = <span class="codeReserved">function</span>() {</td></tr>
  <tr><td>2343</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> payload === <span class="codeString">&quot;string&quot;</span>) {</td></tr>
  <tr><td>2344</td><td>				var buffer = <span class="codeReserved">new</span> ArrayBuffer(UTF8Length(payload));</td></tr>
  <tr><td>2345</td><td>				var byteStream = <span class="codeReserved">new</span> Uint8Array(buffer);</td></tr>
  <tr><td>2346</td><td>				stringToUTF8(payload, byteStream, 0);</td></tr>
  <tr><td>2347</td><td></td></tr>
  <tr><td>2348</td><td>				<span class="codeReserved">return</span> byteStream;</td></tr>
  <tr><td>2349</td><td>			} <span class="codeReserved">else</span> {</td></tr>
  <tr><td>2350</td><td>				<span class="codeReserved">return</span> payload;</td></tr>
  <tr><td>2351</td><td>			}</td></tr>
  <tr><td>2352</td><td>		};</td></tr>
  <tr><td>2353</td><td></td></tr>
  <tr><td>2354</td><td>		var destinationName;</td></tr>
  <tr><td>2355</td><td>		<span class="codeReserved">this</span>._getDestinationName = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> destinationName; };</td></tr>
  <tr><td>2356</td><td>		<span class="codeReserved">this</span>._setDestinationName = <span class="codeReserved">function</span>(newDestinationName) {</td></tr>
  <tr><td>2357</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> newDestinationName === <span class="codeString">&quot;string&quot;</span>)</td></tr>
  <tr><td>2358</td><td>				destinationName = newDestinationName;</td></tr>
  <tr><td>2359</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>2360</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [newDestinationName, <span class="codeString">&quot;newDestinationName&quot;</span>]));</td></tr>
  <tr><td>2361</td><td>		};</td></tr>
  <tr><td>2362</td><td></td></tr>
  <tr><td>2363</td><td>		var qos = 0;</td></tr>
  <tr><td>2364</td><td>		<span class="codeReserved">this</span>._getQos = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> qos; };</td></tr>
  <tr><td>2365</td><td>		<span class="codeReserved">this</span>._setQos = <span class="codeReserved">function</span>(newQos) {</td></tr>
  <tr><td>2366</td><td>			<span class="codeReserved">if</span> (newQos === 0 || newQos === 1 || newQos === 2 )</td></tr>
  <tr><td>2367</td><td>				qos = newQos;</td></tr>
  <tr><td>2368</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>2369</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">&quot;Invalid argument:&quot;</span>+newQos);</td></tr>
  <tr><td>2370</td><td>		};</td></tr>
  <tr><td>2371</td><td></td></tr>
  <tr><td>2372</td><td>		var retained = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>2373</td><td>		<span class="codeReserved">this</span>._getRetained = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> retained; };</td></tr>
  <tr><td>2374</td><td>		<span class="codeReserved">this</span>._setRetained = <span class="codeReserved">function</span>(newRetained) {</td></tr>
  <tr><td>2375</td><td>			<span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> newRetained === <span class="codeString">&quot;boolean&quot;</span>)</td></tr>
  <tr><td>2376</td><td>				retained = newRetained;</td></tr>
  <tr><td>2377</td><td>			<span class="codeReserved">else</span></td></tr>
  <tr><td>2378</td><td>				<span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(format(ERROR.INVALID_ARGUMENT, [newRetained, <span class="codeString">&quot;newRetained&quot;</span>]));</td></tr>
  <tr><td>2379</td><td>		};</td></tr>
  <tr><td>2380</td><td></td></tr>
  <tr><td>2381</td><td>		var duplicate = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>2382</td><td>		<span class="codeReserved">this</span>._getDuplicate = <span class="codeReserved">function</span>() { <span class="codeReserved">return</span> duplicate; };</td></tr>
  <tr><td>2383</td><td>		<span class="codeReserved">this</span>._setDuplicate = <span class="codeReserved">function</span>(newDuplicate) { duplicate = newDuplicate; };</td></tr>
  <tr><td>2384</td><td>	};</td></tr>
  <tr><td>2385</td><td></td></tr>
  <tr><td>2386</td><td>	Message.prototype = {</td></tr>
  <tr><td>2387</td><td>		get payloadString() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPayloadString(); },</td></tr>
  <tr><td>2388</td><td>		get payloadBytes() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getPayloadBytes(); },</td></tr>
  <tr><td>2389</td><td></td></tr>
  <tr><td>2390</td><td>		get destinationName() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDestinationName(); },</td></tr>
  <tr><td>2391</td><td>		set destinationName(newDestinationName) { <span class="codeReserved">this</span>._setDestinationName(newDestinationName); },</td></tr>
  <tr><td>2392</td><td></td></tr>
  <tr><td>2393</td><td>		get topic() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDestinationName(); },</td></tr>
  <tr><td>2394</td><td>		set topic(newTopic) { <span class="codeReserved">this</span>._setDestinationName(newTopic); },</td></tr>
  <tr><td>2395</td><td></td></tr>
  <tr><td>2396</td><td>		get qos() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getQos(); },</td></tr>
  <tr><td>2397</td><td>		set qos(newQos) { <span class="codeReserved">this</span>._setQos(newQos); },</td></tr>
  <tr><td>2398</td><td></td></tr>
  <tr><td>2399</td><td>		get retained() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getRetained(); },</td></tr>
  <tr><td>2400</td><td>		set retained(newRetained) { <span class="codeReserved">this</span>._setRetained(newRetained); },</td></tr>
  <tr><td>2401</td><td></td></tr>
  <tr><td>2402</td><td>		get duplicate() { <span class="codeReserved">return</span> <span class="codeReserved">this</span>._getDuplicate(); },</td></tr>
  <tr><td>2403</td><td>		set duplicate(newDuplicate) { <span class="codeReserved">this</span>._setDuplicate(newDuplicate); }</td></tr>
  <tr><td>2404</td><td>	};</td></tr>
  <tr><td>2405</td><td></td></tr>
  <tr><td>2406</td><td>	<span class="codeComment">// Module contents.</span></td></tr>
  <tr><td>2407</td><td>	<span class="codeReserved">return</span> {</td></tr>
  <tr><td>2408</td><td>		Client: Client,</td></tr>
  <tr><td>2409</td><td>		Message: Message</td></tr>
  <tr><td>2410</td><td>	};</td></tr>
  <tr><td>2411</td><td>})(window);</td></tr>
  <tr><td>2412</td><td><span class="codeReserved">return</span> PahoMQTT;</td></tr>
  <tr><td>2413</td><td>});</td></tr>
  <tr><td>2414</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >I. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ un chat sencillo.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section >
         <h1 >19. Ejemplo de streaming</h1><iframe src="/src/m15streaming/youtube.html" height="415"></iframe>
<p class="noPrint">
 <a href="/src/m15streaming/youtube.html" target="_blank" rel="noreferrer">Ãbrelo
  en otra pestaÃ±a.</a>
</p>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">&quot;es&quot;</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">&quot;UTF-8&quot;</span>&gt;</td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">&quot;viewport&quot;</span></td></tr>
  <tr><td>7</td><td>   content=<span class="codeString">&quot;width=device-width&quot;</span>&gt;</td></tr>
  <tr><td>8</td><td> &lt;<span class="codeReserved">title</span>&gt;YouTube&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>9</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">h1</span>&gt;YouTube&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">iframe</span> width=<span class="codeString">&quot;560&quot;</span> height=<span class="codeString">&quot;315&quot;</span></td></tr>
  <tr><td>14</td><td>   src=<span class="codeString">&quot;https:&#47;&#47;www.youtube.com/embed/eB6txyhHFG4?si=u6wVhxbxBNSVtKFA&quot;</span></td></tr>
  <tr><td>15</td><td>   title=<span class="codeString">&quot;YouTube video player&quot;</span> frameborder=<span class="codeString">&quot;0&quot;</span></td></tr>
  <tr><td>16</td><td>   allow=<span class="codeString">&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-<span class="codeReserved">in</span>-picture; web-share&quot;</span></td></tr>
  <tr><td>17</td><td>   referrerpolicy=<span class="codeString">&quot;strict-origin-when-cross-origin&quot;</span> allowfullscreen&gt;&lt;/<span class="codeReserved">iframe</span>&gt;</td></tr>
  <tr><td>18</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >20. Relaciones a uno en la base de datos</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m17auno/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/mBder.html">Diagrama entidad relaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/mBrel.html">Diagrama relacional</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/mCdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-agrega-html.html">agrega.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-modifica-html.html">modifica.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se muestra el acceso a bases de datos que implementan
    relaciones a uno, usando servicios.
   </p>
  </li>
  <li>
   <p>
    Se usa un select para seleccionar objetos de la base de datos.
   </p>
  </li>
  <li>
   <p>
    La tÃ©cnica aquÃ­ mostrada se usa en el lado con la llave forÃ¡nea de las
    asocioaciones uno a uno y uno a muchos.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvauno.rf.gd/" rel="noreferrer"
      target="_blank">http://srvauno.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama entidad relaciÃ³n</h1><figure>
 <img style="max-height: none;"
   src="/img/m17auno/aunoder.drawio.svg"
   alt="Diagrama entidad relaciÃ³n">
</figure>
      </section>
     <section >
         <h1 >C. Diagrama relacional</h1><figure>
 <img style="max-height: none;"
   src="/img/m17auno/aunorel.drawio.svg"
   alt="Diagrama relacional">
</figure>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m17auno/aunodeploy.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >E. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvauno.rf.gd/" rel="noreferrer"
      target="_blank">http://srvauno.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvauno.zip" download>/src/srvauno.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >F. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-agrega-html.html">agrega.html</a></p>
  </li>
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <p><a href="m-modifica-html.html">modifica.html</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-amigonoencontrado-html.html">amigonoencontrado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltaid-html.html">faltaid.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltanombre-html.html">faltanombre.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltapasid-html.html">faltapasid.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-idenblanco-html.html">idenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-nombreenblanco-html.html">nombreenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraObjeto-js.html">muestraObjeto.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveCreated-php.html">devuelveCreated.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveNoContent-php.html">devuelveNoContent.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetch-php.html">fetch.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetchAll-php.html">fetchAll.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-NOT_FOUND-php.html">NOT_FOUND.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaEntero-php.html">recuperaEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaIdEntero-php.html">recuperaIdEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-validaNombre-php.html">validaNombre.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-amigo-agrega-php.html">amigo-agrega.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-amigo-elimina-php.html">amigo-elimina.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-amigo-modifica-php.html">amigo-modifica.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-amigo-php.html">amigo.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-amigos-php.html">amigos.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-Bd-php.html">Bd.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-pasatiempo-options-php.html">pasatiempo-options.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-validaPasId-php.html">validaPasId.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >G. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Relaciones a uno&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/amigos.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   .then(render =&gt; muestraObjeto(document, render.body))</span></td></tr>
  <tr><td>19</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">h1</span>&gt;Relaciones a uno&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"agrega.html"</span>&gt;Agregar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> &lt;<span class="codeReserved">dl</span> id=<span class="codeString">"lista"</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">dt</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">dt</span>&gt;</td></tr>
  <tr><td>27</td><td>  &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;</td></tr>
  <tr><td>28</td><td> &lt;/<span class="codeReserved">dl</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. agrega.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Agregar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/pasatiempo-options.php&#039;)</span></td></tr>
  <tr><td>19</td><td><span class="codeString">   .then(options =&gt; muestraObjeto(document, options.body))</span></td></tr>
  <tr><td>20</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/amigo-agrega.php&#039;, event)</span></td></tr>
  <tr><td>23</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>24</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Agregar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>31</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>32</td><td>    Nombre *</td></tr>
  <tr><td>33</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span>&gt;</td></tr>
  <tr><td>34</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>35</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>38</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>39</td><td>    Pasatiempo</td></tr>
  <tr><td>40</td><td>    &lt;<span class="codeReserved">select</span> name=<span class="codeString">"pasId"</span>&gt;</td></tr>
  <tr><td>41</td><td>     &lt;<span class="codeReserved">option</span> value=<span class="codeString">""</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>42</td><td>    &lt;/<span class="codeReserved">select</span>&gt;</td></tr>
  <tr><td>43</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>44</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Agregar&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. modifica.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Modificar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">// Obtiene los parÃ¡metros de la pÃ¡gina.</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">const</span> params = <span class="codeReserved">new</span> URL(location.href).searchParams</td></tr>
  <tr><td>19</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"<span class="codeReserved">if</span> (params.size &gt; 0) {</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   consumeJson(&#039;srv/pasatiempo-options.php&#039;)</span></td></tr>
  <tr><td>25</td><td><span class="codeString">    .then(<span class="codeReserved">async</span> options =&gt; {</span></td></tr>
  <tr><td>26</td><td><span class="codeString">     <span class="codeReserved">const</span> modelo = <span class="codeReserved">await</span> consumeJson(&#039;srv/amigo.php?&#039; + params)</span></td></tr>
  <tr><td>27</td><td><span class="codeString">     muestraObjeto(document, options.body)</span></td></tr>
  <tr><td>28</td><td><span class="codeString">     muestraObjeto(document, modelo.body)</span></td></tr>
  <tr><td>29</td><td><span class="codeString">    })</span></td></tr>
  <tr><td>30</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>31</td><td><span class="codeString">  }"</span>&gt;</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/amigo-modifica.php&#039;, event)</span></td></tr>
  <tr><td>34</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>35</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Modificar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>  &lt;<span class="codeReserved">input</span> type=<span class="codeString">"hidden"</span> name=<span class="codeString">"id"</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>45</td><td>    Nombre *</td></tr>
  <tr><td>46</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span> value=<span class="codeString">"Cargando&hellip;"</span>&gt;</td></tr>
  <tr><td>47</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>48</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>51</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>52</td><td>    Pasatiempo</td></tr>
  <tr><td>53</td><td>    &lt;<span class="codeReserved">select</span> name=<span class="codeString">"pasId"</span>&gt;</td></tr>
  <tr><td>54</td><td>     &lt;<span class="codeReserved">option</span> value=<span class="codeString">""</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">option</span>&gt;</td></tr>
  <tr><td>55</td><td>    &lt;/<span class="codeReserved">select</span>&gt;</td></tr>
  <tr><td>56</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>57</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>62</td><td></td></tr>
  <tr><td>63</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Guardar&lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>64</td><td></td></tr>
  <tr><td>65</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> onclick=<span class="codeString">"</span></td></tr>
  <tr><td>66</td><td><span class="codeString">     <span class="codeReserved">if</span> (params.size &gt; 0 && confirm(&#039;Confirma la eliminaciÃ³n&#039;)) {</span></td></tr>
  <tr><td>67</td><td><span class="codeString">      consumeJson(&#039;srv/amigo-elimina.php?&#039; + params)</span></td></tr>
  <tr><td>68</td><td><span class="codeString">       .then(() =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>69</td><td><span class="codeString">       .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>70</td><td><span class="codeString">     }"</span>&gt;</td></tr>
  <tr><td>71</td><td>    Eliminar</td></tr>
  <tr><td>72</td><td>   &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>73</td><td></td></tr>
  <tr><td>74</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>75</td><td></td></tr>
  <tr><td>76</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >J. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m17auno/m-srv/m-amigo-agrega-php.html">srv / amigo-agrega.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/m-amigo-elimina-php.html">srv / amigo-elimina.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/m-amigo-modifica-php.html">srv / amigo-modifica.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/m-amigo-php.html">srv / amigo.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/m-amigos-php.html">srv / amigos.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/m-Bd-php.html">srv / Bd.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/m-pasatiempo-options-php.html">srv / pasatiempo-options.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-srv/m-validaPasId-php.html">srv / validaPasId.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / amigo-agrega.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaNombre.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveCreated.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaPasId.php"</span>;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>16</td><td> $pasId = recuperaEntero(<span class="codeString">"pasId"</span>);</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $nombre = validaNombre($nombre);</td></tr>
  <tr><td>19</td><td> $pasId = validaPasId($pasId);</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>22</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>23</td><td>  <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> AMIGO</span></td></tr>
  <tr><td>24</td><td><span class="codeString">    (AMI_NOMBRE, PAS_ID)</span></td></tr>
  <tr><td>25</td><td><span class="codeString">   <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>26</td><td><span class="codeString">    (:nombre, :pasId)"</span></td></tr>
  <tr><td>27</td><td> )</td></tr>
  <tr><td>28</td><td>  -&gt;execute([</td></tr>
  <tr><td>29</td><td>   <span class="codeString">":nombre"</span> =&gt; $nombre,</td></tr>
  <tr><td>30</td><td>   <span class="codeString">":pasId"</span> =&gt; $pasId</td></tr>
  <tr><td>31</td><td>  ]);</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> <span class="codeComment">/* Recupera el id generado. Si usas una secuencia, pasa como</span></td></tr>
  <tr><td>34</td><td><span class="codeComment">  * parÃ¡metro de lastInsertId el nombre de dicha secuencia y</span></td></tr>
  <tr><td>35</td><td><span class="codeComment">  * poner esta instrucciÃ³n antes del <span class="codeReserved">INSERT</span>, al cual se le</span></td></tr>
  <tr><td>36</td><td><span class="codeComment">  * pasarle el id generado. */</span></td></tr>
  <tr><td>37</td><td> $id = $conexion-&gt;lastInsertId();</td></tr>
  <tr><td>38</td><td> $encodeId = urlencode($id);</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td> devuelveCreated(<span class="codeString">"/srv/amigo.php?id=$encodeId"</span>, [</td></tr>
  <tr><td>41</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $id],</td></tr>
  <tr><td>42</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $nombre],</td></tr>
  <tr><td>43</td><td>  <span class="codeString">"pasId"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $pasId === <span class="codeReserved">null</span> ? <span class="codeString">""</span> : $pasId]</td></tr>
  <tr><td>44</td><td> ]);</td></tr>
  <tr><td>45</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>48</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>51</td><td>}</td></tr>
  <tr><td>52</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. srv / amigo-elimina.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveNoContent.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $id = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>15</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>16</td><td>  <span class="codeString">"<span class="codeReserved">DELETE</span> <span class="codeReserved">FROM</span> AMIGO</span></td></tr>
  <tr><td>17</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> AMI_ID = :id"</span></td></tr>
  <tr><td>18</td><td> )</td></tr>
  <tr><td>19</td><td>  -&gt;execute([<span class="codeString">":id"</span> =&gt; $id]);</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> devuelveNoContent();</td></tr>
  <tr><td>22</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>25</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. srv / amigo-modifica.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaEntero.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaNombre.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaPasId.php"</span>;</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> $id = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>17</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>18</td><td> $pasId = recuperaEntero(<span class="codeString">"pasId"</span>);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $nombre = validaNombre($nombre);</td></tr>
  <tr><td>21</td><td> $pasId = validaPasId($pasId);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>24</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>25</td><td>  <span class="codeString">"<span class="codeReserved">UPDATE</span> AMIGO</span></td></tr>
  <tr><td>26</td><td><span class="codeString">    <span class="codeReserved">SET</span></span></td></tr>
  <tr><td>27</td><td><span class="codeString">     AMI_NOMBRE = :nombre,</span></td></tr>
  <tr><td>28</td><td><span class="codeString">     PAS_ID = :pasId</span></td></tr>
  <tr><td>29</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> AMI_ID = :id"</span></td></tr>
  <tr><td>30</td><td> )</td></tr>
  <tr><td>31</td><td>  -&gt;execute([</td></tr>
  <tr><td>32</td><td>   <span class="codeString">":id"</span> =&gt; $id,</td></tr>
  <tr><td>33</td><td>   <span class="codeString">":nombre"</span> =&gt; $nombre,</td></tr>
  <tr><td>34</td><td>   <span class="codeString">":pasId"</span> =&gt; $pasId</td></tr>
  <tr><td>35</td><td>  ]);</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> devuelveJson([</td></tr>
  <tr><td>38</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $id],</td></tr>
  <tr><td>39</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $nombre],</td></tr>
  <tr><td>40</td><td>  <span class="codeString">"pasId"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $pasId === <span class="codeReserved">null</span> ? <span class="codeString">""</span> : $pasId]</td></tr>
  <tr><td>41</td><td> ]);</td></tr>
  <tr><td>42</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>45</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>48</td><td>}</td></tr>
  <tr><td>49</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. srv / amigo.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> $amiId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $modelo = fetch(</td></tr>
  <tr><td>19</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>20</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>21</td><td><span class="codeString">     A.AMI_NOMBRE <span class="codeReserved">AS</span> amiNombre,</span></td></tr>
  <tr><td>22</td><td><span class="codeString">     A.PAS_ID <span class="codeReserved">AS</span> pasId,</span></td></tr>
  <tr><td>23</td><td><span class="codeString">     P.PAS_NOMBRE <span class="codeReserved">AS</span> pasNombre</span></td></tr>
  <tr><td>24</td><td><span class="codeString">    <span class="codeReserved">FROM</span> AMIGO A</span></td></tr>
  <tr><td>25</td><td><span class="codeString">     <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> PASATIEMPO P</span></td></tr>
  <tr><td>26</td><td><span class="codeString">     <span class="codeReserved">ON</span> A.PAS_ID = P.PAS_ID</span></td></tr>
  <tr><td>27</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> A.AMI_ID = :amiId"</span></td></tr>
  <tr><td>28</td><td>  ),</td></tr>
  <tr><td>29</td><td>  [<span class="codeString">":amiId"</span> =&gt; $amiId]</td></tr>
  <tr><td>30</td><td> );</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> <span class="codeReserved">if</span> ($modelo === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  $amiIdHtml = htmlentities($amiId);</td></tr>
  <tr><td>35</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>36</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>37</td><td>   title: <span class="codeString">"Amigo no encontrado."</span>,</td></tr>
  <tr><td>38</td><td>   type: <span class="codeString">"/error/amigonoencontrado.html"</span>,</td></tr>
  <tr><td>39</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn amigo con el id $amiIdHtml."</span>,</td></tr>
  <tr><td>40</td><td>  );</td></tr>
  <tr><td>41</td><td> }</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> $pasId = $modelo-&gt;pasId;</td></tr>
  <tr><td>44</td><td> devuelveJson([</td></tr>
  <tr><td>45</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $amiId],</td></tr>
  <tr><td>46</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $modelo-&gt;amiNombre],</td></tr>
  <tr><td>47</td><td>  <span class="codeString">"pasId"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $pasId === <span class="codeReserved">null</span> ? <span class="codeString">""</span> : $pasId]</td></tr>
  <tr><td>48</td><td> ]);</td></tr>
  <tr><td>49</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>52</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>55</td><td>}</td></tr>
  <tr><td>56</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. srv / amigos.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $conexionexion = Bd::getConexion();</td></tr>
  <tr><td>13</td><td> $lista = fetchAll($conexionexion-&gt;query(</td></tr>
  <tr><td>14</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>15</td><td><span class="codeString">    A.AMI_ID <span class="codeReserved">AS</span> amiId,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    A.AMI_NOMBRE <span class="codeReserved">AS</span> amiNombre,</span></td></tr>
  <tr><td>17</td><td><span class="codeString">    P.PAS_NOMBRE <span class="codeReserved">AS</span> pasNombre</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   <span class="codeReserved">FROM</span> AMIGO A</span></td></tr>
  <tr><td>19</td><td><span class="codeString">    <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> PASATIEMPO P</span></td></tr>
  <tr><td>20</td><td><span class="codeString">    <span class="codeReserved">ON</span> A.PAS_ID = P.PAS_ID</span></td></tr>
  <tr><td>21</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> A.AMI_NOMBRE"</span></td></tr>
  <tr><td>22</td><td> ));</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td> $render = <span class="codeString">""</span>;</td></tr>
  <tr><td>25</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>26</td><td>  $encodeAmiId = urlencode($modelo-&gt;amiId);</td></tr>
  <tr><td>27</td><td>  $amiId = htmlentities($encodeAmiId);</td></tr>
  <tr><td>28</td><td>  $amiNombre = htmlentities($modelo-&gt;amiNombre);</td></tr>
  <tr><td>29</td><td>  $pasNombre = $modelo-&gt;pasNombre === <span class="codeReserved">null</span></td></tr>
  <tr><td>30</td><td>   ? <span class="codeString">"&lt;<span class="codeReserved">em</span>&gt;-- Sin pasatiempo --&lt;/<span class="codeReserved">em</span>&gt;"</span></td></tr>
  <tr><td>31</td><td>   : htmlentities($modelo-&gt;pasNombre);</td></tr>
  <tr><td>32</td><td>  $render .=</td></tr>
  <tr><td>33</td><td>   <span class="codeString">"&lt;<span class="codeReserved">dt</span>&gt;&lt;<span class="codeReserved">a</span> href=&#039;modifica.html?id=$amiId&#039;&gt;$amiNombre&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>34</td><td><span class="codeString">    &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">a</span> href=&#039;modifica.html?id=$amiId&#039;&gt;$pasNombre&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;"</span>;</td></tr>
  <tr><td>35</td><td> }</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> devuelveJson([<span class="codeString">"lista"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>38</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>41</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>44</td><td>}</td></tr>
  <tr><td>45</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. srv / Bd.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">class</span> Bd</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeReserved">private</span> <span class="codeReserved">static</span> ?PDO $conexion = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> <span class="codeReserved">static</span> <span class="codeReserved">function</span> getConexion(): PDO</td></tr>
  <tr><td>9</td><td> {</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">if</span> (<span class="codeReserved">self</span>::$conexion === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>   <span class="codeReserved">self</span>::$conexion = <span class="codeReserved">new</span> PDO(</td></tr>
  <tr><td>13</td><td>    <span class="codeComment">// cadena de conexiÃ³n</span></td></tr>
  <tr><td>14</td><td>    <span class="codeString">"sqlite:srvauno.db"</span>,</td></tr>
  <tr><td>15</td><td>    <span class="codeComment">// usuario</span></td></tr>
  <tr><td>16</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>    <span class="codeComment">// contraseÃ±a</span></td></tr>
  <tr><td>18</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>19</td><td>    <span class="codeComment">// Opciones: conexiones persistentes y lanza excepciones.</span></td></tr>
  <tr><td>20</td><td>    [PDO::ATTR_PERSISTENT =&gt; <span class="codeReserved">true</span>, PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION]</td></tr>
  <tr><td>21</td><td>   );</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>24</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> PASATIEMPO (</span></td></tr>
  <tr><td>25</td><td><span class="codeString">      PAS_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>26</td><td><span class="codeString">      PAS_NOMBRE <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>27</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PAS_PK</span></td></tr>
  <tr><td>28</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(PAS_ID),</span></td></tr>
  <tr><td>29</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PAS_NOM_UNQ</span></td></tr>
  <tr><td>30</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(PAS_NOMBRE),</span></td></tr>
  <tr><td>31</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PAS_NOM_NV</span></td></tr>
  <tr><td>32</td><td><span class="codeString">       CHECK(LENGTH(PAS_NOMBRE) &gt; 0)</span></td></tr>
  <tr><td>33</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>34</td><td>   );</td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>36</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> AMIGO (</span></td></tr>
  <tr><td>37</td><td><span class="codeString">      AMI_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>38</td><td><span class="codeString">      AMI_NOMBRE <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>39</td><td><span class="codeString">      PAS_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>40</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> AMI_PK</span></td></tr>
  <tr><td>41</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(AMI_ID),</span></td></tr>
  <tr><td>42</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> AMI_NOM_UNQ</span></td></tr>
  <tr><td>43</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(AMI_NOMBRE),</span></td></tr>
  <tr><td>44</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> AMI_NOM_NV</span></td></tr>
  <tr><td>45</td><td><span class="codeString">       CHECK(LENGTH(AMI_NOMBRE) &gt; 0),</span></td></tr>
  <tr><td>46</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> AMI_PAS_FK</span></td></tr>
  <tr><td>47</td><td><span class="codeString">       <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (PAS_ID) <span class="codeReserved">REFERENCES</span> PASATIEMPO(PAS_ID)</span></td></tr>
  <tr><td>48</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>49</td><td>   );</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td>   $cantidadDePasatiempos =</td></tr>
  <tr><td>52</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;query(<span class="codeString">"<span class="codeReserved">SELECT</span> COUNT(PAS_ID) <span class="codeReserved">FROM</span> PASATIEMPO"</span>)</td></tr>
  <tr><td>53</td><td>    -&gt;fetchColumn();</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>   <span class="codeReserved">if</span> ($cantidadDePasatiempos === 0) {</td></tr>
  <tr><td>56</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>57</td><td>     <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> PASATIEMPO</span></td></tr>
  <tr><td>58</td><td><span class="codeString">       (PAS_NOMBRE)</span></td></tr>
  <tr><td>59</td><td><span class="codeString">      <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>60</td><td><span class="codeString">       (&#039;Futbol&#039;),</span></td></tr>
  <tr><td>61</td><td><span class="codeString">       (&#039;Videojuegos&#039;)"</span></td></tr>
  <tr><td>62</td><td>    );</td></tr>
  <tr><td>63</td><td>   }</td></tr>
  <tr><td>64</td><td>  }</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">self</span>::$conexion;</td></tr>
  <tr><td>67</td><td> }</td></tr>
  <tr><td>68</td><td>}</td></tr>
  <tr><td>69</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. srv / pasatiempo-options.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $conexionexion = Bd::getConexion();</td></tr>
  <tr><td>13</td><td> $lista = fetchAll($conexionexion-&gt;query(</td></tr>
  <tr><td>14</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>15</td><td><span class="codeString">    PAS_ID <span class="codeReserved">AS</span> id,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    PAS_NOMBRE <span class="codeReserved">AS</span> nombre</span></td></tr>
  <tr><td>17</td><td><span class="codeString">   <span class="codeReserved">FROM</span> PASATIEMPO</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> PAS_NOMBRE"</span></td></tr>
  <tr><td>19</td><td> ));</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> $render = <span class="codeString">"&lt;<span class="codeReserved">option</span> value=&#039;&#039;&gt;-- Sin pasatiempo --&lt;/<span class="codeReserved">option</span>&gt;"</span>;</td></tr>
  <tr><td>22</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>23</td><td>  $id = htmlentities($modelo-&gt;id);</td></tr>
  <tr><td>24</td><td>  $nombre = htmlentities($modelo-&gt;nombre);</td></tr>
  <tr><td>25</td><td>  $render .= <span class="codeString">"&lt;<span class="codeReserved">option</span> value=&#039;$id&#039;&gt;{$nombre}&lt;/<span class="codeReserved">option</span>&gt;"</span>;</td></tr>
  <tr><td>26</td><td> }</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td> devuelveJson([<span class="codeString">"pasId"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>29</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>32</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. srv / validaPasId.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaPasId(<span class="codeReserved">false</span>|<span class="codeReserved">null</span>|<span class="codeReserved">int</span> $pasId)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($pasId === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>11</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>12</td><td>   title: <span class="codeString">"Falta pasId."</span>,</td></tr>
  <tr><td>13</td><td>   type: <span class="codeString">"/error/faltapasid.html"</span>,</td></tr>
  <tr><td>14</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de pasId."</span></td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $pasId;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >K. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m17auno/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m17auno/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-js/m-muestraObjeto-js.html">lib / js / muestraObjeto.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraObjeto.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraObjeto(raizHtml, objeto) {</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [nombre, definiciones] of Object.entries(objeto)) {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">if</span> (Array.isArray(definiciones)) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   muestraArray(raizHtml, nombre, definiciones)</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (definiciones !== undefined && definiciones !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">const</span> elementoHtml = buscaElementoHtml(raizHtml, nombre)</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (elementoHtml <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>    muestraInput(raizHtml, elementoHtml, definiciones)</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>   } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (elementoHtml !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> elementoHtml) {</td></tr>
  <tr><td>25</td><td>      elementoHtml[atributo] = valor</td></tr>
  <tr><td>26</td><td>     }</td></tr>
  <tr><td>27</td><td>    }</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>   }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>window[<span class="codeString">"muestraObjeto"</span>] = muestraObjeto</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } nombre</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>43</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> buscaElementoHtml(raizHtml, nombre) {</td></tr>
  <tr><td>44</td><td> <span class="codeReserved">return</span> raizHtml.querySelector(</td></tr>
  <tr><td>45</td><td>  <span class="codeString">`#${nombre},[name=&quot;${nombre}&quot;],[data-name=&quot;${nombre}&quot;]`</span>)</td></tr>
  <tr><td>46</td><td>}</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } propiedad</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {any[]} valores</span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>53</td><td><span class="codeReserved">function</span> muestraArray(raizHtml, propiedad, valores) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> <span class="codeReserved">const</span> conjunto = <span class="codeReserved">new</span> Set(valores)</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> elementos =</td></tr>
  <tr><td>57</td><td>  raizHtml.querySelectorAll(<span class="codeString">`[name=&quot;${propiedad}&quot;],[data-name=&quot;${propiedad}&quot;]`</span>)</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> <span class="codeReserved">if</span> (elementos.length === 1) {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">const</span> elemento = elementos[0]</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLSelectElement) {</td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">const</span> options = elemento.options</td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = options.length; i &lt; len; i++) {</td></tr>
  <tr><td>65</td><td>    <span class="codeReserved">const</span> option = options[i]</td></tr>
  <tr><td>66</td><td>    option.selected = conjunto.has(option.value)</td></tr>
  <tr><td>67</td><td>   }</td></tr>
  <tr><td>68</td><td>   <span class="codeReserved">return</span></td></tr>
  <tr><td>69</td><td>  }</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td> }</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = elementos.length; i &lt; len; i++) {</td></tr>
  <tr><td>74</td><td>  <span class="codeReserved">const</span> elemento = elementos[i]</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>76</td><td>   elemento.checked = conjunto.has(elemento.value)</td></tr>
  <tr><td>77</td><td>  }</td></tr>
  <tr><td>78</td><td> }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>}</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>83</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>84</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>85</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } definiciones</span></td></tr>
  <tr><td>86</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>87</td><td><span class="codeReserved">function</span> muestraInput(raizHtml, input, definiciones) {</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>  <span class="codeReserved">if</span> (atributo == <span class="codeString">"data-file"</span>) {</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>95</td><td>    input.dataset.file = valor</td></tr>
  <tr><td>96</td><td>    input.value = <span class="codeString">""</span></td></tr>
  <tr><td>97</td><td>    <span class="codeReserved">if</span> (valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>98</td><td>     img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>99</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>100</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>101</td><td>     img.<span class="codeReserved">src</span> = valor</td></tr>
  <tr><td>102</td><td>     img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>103</td><td>    }</td></tr>
  <tr><td>104</td><td>   }</td></tr>
  <tr><td>105</td><td></td></tr>
  <tr><td>106</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> input) {</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>   input[atributo] = valor</td></tr>
  <tr><td>109</td><td></td></tr>
  <tr><td>110</td><td>  }</td></tr>
  <tr><td>111</td><td> }</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td>}</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>116</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>117</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLElement } elementoHtml</span></td></tr>
  <tr><td>118</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>119</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getImgParaElementoHtml(raizHtml, elementoHtml) {</td></tr>
  <tr><td>120</td><td> <span class="codeReserved">const</span> imgId = elementoHtml.getAttribute(<span class="codeString">"data-img"</span>)</td></tr>
  <tr><td>121</td><td> <span class="codeReserved">if</span> (imgId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>122</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>123</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>124</td><td>  <span class="codeReserved">const</span> input = buscaElementoHtml(raizHtml, imgId)</td></tr>
  <tr><td>125</td><td>  <span class="codeReserved">if</span> (input <span class="codeReserved">instanceof</span> HTMLImageElement) {</td></tr>
  <tr><td>126</td><td>   <span class="codeReserved">return</span> input</td></tr>
  <tr><td>127</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>128</td><td>   <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>129</td><td>  }</td></tr>
  <tr><td>130</td><td> }</td></tr>
  <tr><td>131</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-devuelveCreated-php.html">lib / php / devuelveCreated.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-devuelveNoContent-php.html">lib / php / devuelveNoContent.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-fetch-php.html">lib / php / fetch.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-fetchAll-php.html">lib / php / fetchAll.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-NOT_FOUND-php.html">lib / php / NOT_FOUND.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-recuperaEntero-php.html">lib / php / recuperaEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-recuperaIdEntero-php.html">lib / php / recuperaIdEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-lib/m-php/m-validaNombre-php.html">lib / php / validaNombre.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveCreated.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveCreated($urlDelNuevo, $resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(201);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Location: {$urlDelNuevo}"</span>);</td></tr>
  <tr><td>17</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>18</td><td>  echo $json;</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td>}</td></tr>
  <tr><td>21</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveNoContent.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> devuelveNoContent()</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> http_response_code(204);</td></tr>
  <tr><td>6</td><td>}</td></tr>
  <tr><td>7</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / fetch.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetch(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">if</span> ($opcional === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>20</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch($mode);</td></tr>
  <tr><td>21</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>22</td><td>   $statement-&gt;setFetchMode($mode, $opcional);</td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch();</td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >9. lib / php / fetchAll.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetchAll(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>): array {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  $resultado = $opcional === <span class="codeReserved">null</span></td></tr>
  <tr><td>20</td><td>   ? $statement-&gt;fetchAll($mode)</td></tr>
  <tr><td>21</td><td>   : $statement-&gt;fetchAll($mode, $opcional);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">if</span> ($resultado === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>25</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">return</span> $resultado;</td></tr>
  <tr><td>27</td><td>  }</td></tr>
  <tr><td>28</td><td> }</td></tr>
  <tr><td>29</td><td>}</td></tr>
  <tr><td>30</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >10. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >11. lib / php / NOT_FOUND.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> NOT_FOUND = 404;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >12. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >13. lib / php / recuperaEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * Devuelve el valor entero de un parÃ¡metro recibido en el</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuekve <span class="codeReserved">false</span></span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> * Si se recibe una cadena vacÃ­a, se devuelve <span class="codeReserved">null</span>.</span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> * Si parÃ¡metro no se puede convertir a entero, se genera</span></td></tr>
  <tr><td>14</td><td><span class="codeComment"> * un error.</span></td></tr>
  <tr><td>15</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>16</td><td><span class="codeReserved">function</span> recuperaEntero(string $parametro): <span class="codeReserved">false</span>|<span class="codeReserved">null</span>|<span class="codeReserved">int</span></td></tr>
  <tr><td>17</td><td>{</td></tr>
  <tr><td>18</td><td> $valor = recuperaTexto($parametro);</td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($valor === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>21</td><td> } <span class="codeReserved">elseif</span> ($valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span>;</td></tr>
  <tr><td>23</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">return</span> (<span class="codeReserved">int</span>) trim($valor);</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >14. lib / php / recuperaIdEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> recuperaIdEntero(string $parametro): <span class="codeReserved">int</span></td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> $id = recuperaEntero($parametro);</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>14</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>15</td><td>   title: <span class="codeString">"Falta el id."</span>,</td></tr>
  <tr><td>16</td><td>   type: <span class="codeString">"/error/faltaid.html"</span>,</td></tr>
  <tr><td>17</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de id."</span>,</td></tr>
  <tr><td>18</td><td>  );</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">null</span>)</td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>22</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>23</td><td>   title: <span class="codeString">"Id en blanco."</span>,</td></tr>
  <tr><td>24</td><td>   type: <span class="codeString">"/error/idenblanco.html"</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $id;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >15. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >16. lib / php / validaNombre.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaNombre(<span class="codeReserved">false</span>|string $nombre)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($nombre === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>11</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>12</td><td>   title: <span class="codeString">"Falta el nombre."</span>,</td></tr>
  <tr><td>13</td><td>   type: <span class="codeString">"/error/faltanombre.html"</span>,</td></tr>
  <tr><td>14</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de nombre."</span></td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $trimNombre = trim($nombre);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($trimNombre === <span class="codeString">""</span>)</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>21</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>22</td><td>   title: <span class="codeString">"Nombre en blanco."</span>,</td></tr>
  <tr><td>23</td><td>   type: <span class="codeString">"/error/nombreenblanco.html"</span>,</td></tr>
  <tr><td>24</td><td>   detail: <span class="codeString">"Pon texto en el campo nombre."</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $trimNombre;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >L. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m17auno/m-error/m-amigonoencontrado-html.html">error / amigonoencontrado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/m-faltaid-html.html">error / faltaid.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/m-faltanombre-html.html">error / faltanombre.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/m-faltapasid-html.html">error / faltapasid.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/m-idenblanco-html.html">error / idenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/m-nombreenblanco-html.html">error / nombreenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m17auno/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / amigonoencontrado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Amigo no encontrada&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Amigo no encontrada&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ningÃºn amigo con el id solicitado.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / faltaid.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el id&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el id&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de id.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / faltanombre.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el nombre&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el nombre&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. error / faltapasid.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta pasId&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta pasId&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de pasId.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. error / idenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Id en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Id en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. error / nombreenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon texto en el campo nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >M. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ el acceso a bases de datos que implementan
    relaciones a uno, usando servicios..
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >21. Relaciones a muchos - Usuarios y roles</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m18amuchos/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/mBder.html">Diagrama entidad relaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/mBrel.html">Diagrama relacional</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/mCdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-agrega-html.html">agrega.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-modifica-html.html">modifica.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se muestra el acceso a bases de datos que implementan
    relaciones a muchos, usando servicios.
   </p>
  </li>
  <li>
   <p>
    Se usa varios checkbox para seleccionar objetos de la base de datos.
   </p>
  </li>
  <li>
   <p>
    La tÃ©cnica aquÃ­ mostrada se usa para el lado muchos de una asociaciÃ³n uno a
    muchos y en cualquiera de los lados de una asociaciÃ³n muchos a muchos.
   </p>
  </li>
  <li>
   <p>
    El ejemplo es una estructura de usuarios y roles.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvamuchos.rf.gd/" rel="noreferrer"
      target="_blank">http://srvamuchos.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama entidad relaciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Algunos navegadores web bloquean las interfaces que muestran etiquetas como
    <q>usuario</q>, <q>id</q>, <q>email</q>, etcÃ©tera, suponiendo que es un
    intento de engaÃ±ar al usuario; para evitar este problema, al campo con el
    nombre de usuario se le llama <q>cue</q>.
   </p>
  </li>
 </ul>
</div>
<figure>
 <img style="max-height: none;"
   src="/img/m18amuchos/amuchosder.drawio.svg"
   alt="Diagrama entidad relaciÃ³n">
</figure>
      </section>
     <section >
         <h1 >C. Diagrama relacional</h1><figure>
 <img style="max-height: none;"
   src="/img/m18amuchos/amuchosrel.drawio.svg"
   alt="Diagrama relacional">
</figure>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m18amuchos/amuchosdeploy.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >E. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvamuchos.rf.gd/" rel="noreferrer"
      target="_blank">http://srvamuchos.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvamuchos.zip" download>/src/srvamuchos.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
 <li>
  <p>
   Abre la carpeta descompactada con Visual Studio Code.
  </p>
 </li>
 <li>
  <p>
   Edita los archivos que desees.
  </p>
 </li>
 <li>
  <p>
   Haz clic derecho en <em>index.html</em>, selecciona
   <em>PHP Server: serve project</em> y se abre el navegador para que puedas
   probar localmente el ejemplo.
  </p>
 </li>
 <li>
  <p>Para depurar paso a paso haz lo siguiente:</p>
  <ol>
   <li>
    <p>
     En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
     selecciona <em>inspeccionar</em>.
    </p>
   </li>
   <li>
    <p>
     Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
     estÃ¡ en InglÃ©s).
    </p>
   </li>
   <li>
    <p>
     Selecciona el archivo donde vas a empezar a depurar.
    </p>
   </li>
   <li>
    <p>
     Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
    </p>
   </li>
   <li>
    <p>
     En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
     depurar.
   </li>
   <li>
    <p>
     Haz clic en <em>Run and Debug</em> <img alt=""
       src="/img/runanddebug.png">.
    </p>
   </li>
   <li>
    <p>
     Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
      file</em>.
    </p>
   </li>
   <li>
    <p>
     Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
     decir <em>Listen for Xdebug</em> <img alt=""
       src="/img/controleslanzadebug.png">.
    </p>
   </li>
   <li>
    <p>
     Aparece un cuadro con los controles de depuraciÃ³n
    </p>
   </li>
   <li>
    <p>
     Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
     donde vas a empezar a depurar.
    </p>
   </li>
   <li>
    <p>
     Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
    </p>
   </li>
   <li>
    <p>
     Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
     resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
     avanzar, como se muestra en
     <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
       target="_blank" rel="noreferrer">este video</a>.
    </p>
   </li>
  </ol>
 </li>
 <li>
  <p>
   SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
   (<a href="https://filezilla-project.org/" target="_blank"
     rel="noreferrer">https://filezilla-project.org/</a>)
  </p>
 </li>
 <li>
  <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
 </li>
</ol>
</div>
      </section>
     <section >
         <h1 >F. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-agrega-html.html">agrega.html</a></p>
  </li>
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <p><a href="m-modifica-html.html">modifica.html</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-cuenblanco-html.html">cuenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltacue-html.html">faltacue.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltadescripcion-html.html">faltadescripcion.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltaid-html.html">faltaid.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-idenblanco-html.html">idenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-usuarionoencontrado-html.html">usuarionoencontrado.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraObjeto-js.html">muestraObjeto.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveCreated-php.html">devuelveCreated.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveNoContent-php.html">devuelveNoContent.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetch-php.html">fetch.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetchAll-php.html">fetchAll.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-NOT_FOUND-php.html">NOT_FOUND.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaArray-php.html">recuperaArray.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaEntero-php.html">recuperaEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaIdEntero-php.html">recuperaIdEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-usuRolAgrega-php.html">usuRolAgrega.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-usuRolIds-php.html">usuRolIds.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-validaCue-php.html">validaCue.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-Bd-php.html">Bd.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-rol-checkboxes-php.html">rol-checkboxes.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-usuario-agrega-php.html">usuario-agrega.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-usuario-elimina-php.html">usuario-elimina.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-usuario-modifica-php.html">usuario-modifica.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-usuario-php.html">usuario.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-usuarios-php.html">usuarios.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-usuRolElimina-php.html">usuRolElimina.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >G. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Relaciones a muchos&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/usuarios.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">  .then(render =&gt; muestraObjeto(document, render.body))</span></td></tr>
  <tr><td>19</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">h1</span>&gt;Relaciones a muchos&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"agrega.html"</span>&gt;Agregar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> &lt;<span class="codeReserved">dl</span> id=<span class="codeString">"lista"</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">dt</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">dt</span>&gt;</td></tr>
  <tr><td>27</td><td>  &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;</td></tr>
  <tr><td>28</td><td> &lt;/<span class="codeReserved">dl</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. agrega.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Agregar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/rol-checkboxes.php&#039;)</span></td></tr>
  <tr><td>19</td><td><span class="codeString">   .then(chackBoxes =&gt; muestraObjeto(document, chackBoxes.body))</span></td></tr>
  <tr><td>20</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/usuario-agrega.php&#039;, event)</span></td></tr>
  <tr><td>23</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>24</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Agregar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>31</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>32</td><td>    <span class="codeComment">&lt;!-- Usamos cue para que los navegadores no bloqueen la pÃ¡gina. --&gt;</span></td></tr>
  <tr><td>33</td><td>    Cue *</td></tr>
  <tr><td>34</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"cue"</span>&gt;</td></tr>
  <tr><td>35</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>36</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td>  &lt;<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>   &lt;<span class="codeReserved">legend</span>&gt;Roles&lt;/<span class="codeReserved">legend</span>&gt;</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td>   &lt;<span class="codeReserved">div</span> id=<span class="codeString">"roles"</span>&gt;</td></tr>
  <tr><td>43</td><td>    &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;/<span class="codeReserved">div</span>&gt;</td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td>  &lt;/<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Agregar&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. modifica.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Modificar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">// Obtiene los parÃ¡metros de la pÃ¡gina.</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">const</span> params = <span class="codeReserved">new</span> URL(location.href).searchParams</td></tr>
  <tr><td>19</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"<span class="codeReserved">if</span> (params.size &gt; 0) {</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   consumeJson(&#039;srv/rol-checkboxes.php&#039;)</span></td></tr>
  <tr><td>25</td><td><span class="codeString">    .then(<span class="codeReserved">async</span> checkBoxes =&gt; {</span></td></tr>
  <tr><td>26</td><td><span class="codeString">     <span class="codeReserved">const</span> modelo = <span class="codeReserved">await</span> consumeJson(&#039;srv/usuario.php?&#039; + params)</span></td></tr>
  <tr><td>27</td><td><span class="codeString">     <span class="codeReserved">await</span> muestraObjeto(document, checkBoxes.body)</span></td></tr>
  <tr><td>28</td><td><span class="codeString">     <span class="codeReserved">await</span> muestraObjeto(document, modelo.body)</span></td></tr>
  <tr><td>29</td><td><span class="codeString">    })</span></td></tr>
  <tr><td>30</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>31</td><td><span class="codeString">  }"</span>&gt;</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/usuario-modifica.php&#039;, event)</span></td></tr>
  <tr><td>34</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>35</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Modificar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>  &lt;<span class="codeReserved">input</span> type=<span class="codeString">"hidden"</span> name=<span class="codeString">"id"</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>45</td><td>    <span class="codeComment">&lt;!-- Usamos cue para que los navegadores no bloqueen la pÃ¡gina. --&gt;</span></td></tr>
  <tr><td>46</td><td>    Cue *</td></tr>
  <tr><td>47</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"cue"</span> value=<span class="codeString">"Cargando&hellip;"</span>&gt;</td></tr>
  <tr><td>48</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>49</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td>  &lt;<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>52</td><td>   &lt;<span class="codeReserved">legend</span>&gt;Roles&lt;/<span class="codeReserved">legend</span>&gt;</td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>   &lt;<span class="codeReserved">div</span> id=<span class="codeString">"roles"</span>&gt;</td></tr>
  <tr><td>55</td><td>    &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>56</td><td>   &lt;/<span class="codeReserved">div</span>&gt;</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>  &lt;/<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>59</td><td></td></tr>
  <tr><td>60</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Guardar&lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> onclick=<span class="codeString">"</span></td></tr>
  <tr><td>67</td><td><span class="codeString">     <span class="codeReserved">if</span> (params.size &gt; 0 && confirm(&#039;Confirma la eliminaciÃ³n&#039;)) {</span></td></tr>
  <tr><td>68</td><td><span class="codeString">      consumeJson(&#039;srv/usuario-elimina.php?&#039; + params)</span></td></tr>
  <tr><td>69</td><td><span class="codeString">       .then(() =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>70</td><td><span class="codeString">       .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>71</td><td><span class="codeString">     }"</span>&gt;</td></tr>
  <tr><td>72</td><td>    Eliminar</td></tr>
  <tr><td>73</td><td>   &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>76</td><td></td></tr>
  <tr><td>77</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>78</td><td></td></tr>
  <tr><td>79</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>80</td><td></td></tr>
  <tr><td>81</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >J. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-Bd-php.html">srv / Bd.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-rol-checkboxes-php.html">srv / rol-checkboxes.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-usuario-agrega-php.html">srv / usuario-agrega.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-usuario-elimina-php.html">srv / usuario-elimina.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-usuario-modifica-php.html">srv / usuario-modifica.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-usuario-php.html">srv / usuario.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-usuarios-php.html">srv / usuarios.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-srv/m-usuRolElimina-php.html">srv / usuRolElimina.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / Bd.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">class</span> Bd</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeReserved">private</span> <span class="codeReserved">static</span> ?PDO $conexion = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> <span class="codeReserved">static</span> <span class="codeReserved">function</span> getConexion(): PDO</td></tr>
  <tr><td>9</td><td> {</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">if</span> (<span class="codeReserved">self</span>::$conexion === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>   <span class="codeReserved">self</span>::$conexion = <span class="codeReserved">new</span> PDO(</td></tr>
  <tr><td>13</td><td>    <span class="codeComment">// cadena de conexiÃ³n</span></td></tr>
  <tr><td>14</td><td>    <span class="codeString">"sqlite:srvamuchos.db"</span>,</td></tr>
  <tr><td>15</td><td>    <span class="codeComment">// usuario</span></td></tr>
  <tr><td>16</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>    <span class="codeComment">// contraseÃ±a</span></td></tr>
  <tr><td>18</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>19</td><td>    <span class="codeComment">// Opciones: conexiones persistentes y lanza excepciones.</span></td></tr>
  <tr><td>20</td><td>    [PDO::ATTR_PERSISTENT =&gt; <span class="codeReserved">true</span>, PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION]</td></tr>
  <tr><td>21</td><td>   );</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>24</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> USUARIO (</span></td></tr>
  <tr><td>25</td><td><span class="codeString">      USU_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>26</td><td><span class="codeString">      USU_CUE <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>27</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_PK</span></td></tr>
  <tr><td>28</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(USU_ID),</span></td></tr>
  <tr><td>29</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_CUE_UNQ</span></td></tr>
  <tr><td>30</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(USU_CUE),</span></td></tr>
  <tr><td>31</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_CUE_NV</span></td></tr>
  <tr><td>32</td><td><span class="codeString">       CHECK(LENGTH(USU_CUE) &gt; 0)</span></td></tr>
  <tr><td>33</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>34</td><td>   );</td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>36</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> ROL (</span></td></tr>
  <tr><td>37</td><td><span class="codeString">      ROL_ID <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>38</td><td><span class="codeString">      ROL_DESCRIPCION <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>39</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_PK</span></td></tr>
  <tr><td>40</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(ROL_ID),</span></td></tr>
  <tr><td>41</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_ID_NV</span></td></tr>
  <tr><td>42</td><td><span class="codeString">       CHECK(LENGTH(ROL_ID) &gt; 0),</span></td></tr>
  <tr><td>43</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_DESCR_UNQ</span></td></tr>
  <tr><td>44</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(ROL_DESCRIPCION),</span></td></tr>
  <tr><td>45</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_DESCR_NV</span></td></tr>
  <tr><td>46</td><td><span class="codeString">       CHECK(LENGTH(ROL_DESCRIPCION) &gt; 0)</span></td></tr>
  <tr><td>47</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>48</td><td>   );</td></tr>
  <tr><td>49</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>50</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> USU_ROL (</span></td></tr>
  <tr><td>51</td><td><span class="codeString">      USU_ID <span class="codeReserved">INTEGER</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>52</td><td><span class="codeString">      ROL_ID <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>53</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_ROL_PK</span></td></tr>
  <tr><td>54</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(USU_ID, ROL_ID),</span></td></tr>
  <tr><td>55</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_ROL_USU_FK</span></td></tr>
  <tr><td>56</td><td><span class="codeString">       <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (USU_ID) <span class="codeReserved">REFERENCES</span> USUARIO(USU_ID),</span></td></tr>
  <tr><td>57</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_ROL_ROL_FK</span></td></tr>
  <tr><td>58</td><td><span class="codeString">       <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (ROL_ID) <span class="codeReserved">REFERENCES</span> ROL(ROL_ID)</span></td></tr>
  <tr><td>59</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>60</td><td>   );</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>   $insert = <span class="codeReserved">self</span>::$conexion-&gt;prepare(</td></tr>
  <tr><td>63</td><td>    <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> ROL</span></td></tr>
  <tr><td>64</td><td><span class="codeString">      (ROL_ID, ROL_DESCRIPCION)</span></td></tr>
  <tr><td>65</td><td><span class="codeString">     <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>66</td><td><span class="codeString">      (:id, :descripcion)"</span></td></tr>
  <tr><td>67</td><td>   );</td></tr>
  <tr><td>68</td><td></td></tr>
  <tr><td>69</td><td>   $select =</td></tr>
  <tr><td>70</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;prepare(<span class="codeString">"<span class="codeReserved">SELECT</span> ROL_ID <span class="codeReserved">FROM</span> ROL <span class="codeReserved">WHERE</span> ROL_ID = :id"</span>);</td></tr>
  <tr><td>71</td><td></td></tr>
  <tr><td>72</td><td>   $select-&gt;execute([<span class="codeString">":id"</span> =&gt; <span class="codeString">"Administrador"</span>]);</td></tr>
  <tr><td>73</td><td>   <span class="codeReserved">if</span> ($select-&gt;fetchColumn() === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>74</td><td>    $insert-&gt;execute([</td></tr>
  <tr><td>75</td><td>     <span class="codeString">":id"</span> =&gt; <span class="codeString">"Administrador"</span>,</td></tr>
  <tr><td>76</td><td>     <span class="codeString">":descripcion"</span> =&gt; <span class="codeString">"Administra el sistema."</span></td></tr>
  <tr><td>77</td><td>    ]);</td></tr>
  <tr><td>78</td><td>   }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>   $select-&gt;execute([<span class="codeString">":id"</span> =&gt; <span class="codeString">"Cliente"</span>]);</td></tr>
  <tr><td>81</td><td>   <span class="codeReserved">if</span> ($select-&gt;fetchColumn() === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>82</td><td>    $insert-&gt;execute([</td></tr>
  <tr><td>83</td><td>     <span class="codeString">":id"</span> =&gt; <span class="codeString">"Cliente"</span>,</td></tr>
  <tr><td>84</td><td>     <span class="codeString">":descripcion"</span> =&gt; <span class="codeString">"Realiza compras."</span></td></tr>
  <tr><td>85</td><td>    ]);</td></tr>
  <tr><td>86</td><td>   }</td></tr>
  <tr><td>87</td><td>  }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">self</span>::$conexion;</td></tr>
  <tr><td>90</td><td> }</td></tr>
  <tr><td>91</td><td>}</td></tr>
  <tr><td>92</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. srv / rol-checkboxes.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $conexionexion = Bd::getConexion();</td></tr>
  <tr><td>13</td><td> $lista = fetchAll($conexionexion-&gt;query(</td></tr>
  <tr><td>14</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>15</td><td><span class="codeString">    ROL_ID <span class="codeReserved">as</span> id,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    ROL_DESCRIPCION <span class="codeReserved">as</span> descripcion</span></td></tr>
  <tr><td>17</td><td><span class="codeString">   <span class="codeReserved">FROM</span> ROL</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> ROL_ID"</span></td></tr>
  <tr><td>19</td><td> ));</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> $render = <span class="codeString">""</span>;</td></tr>
  <tr><td>22</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>23</td><td>  $id = htmlentities($modelo-&gt;id);</td></tr>
  <tr><td>24</td><td>  $descripcion = htmlentities($modelo-&gt;descripcion);</td></tr>
  <tr><td>25</td><td>  $render .=</td></tr>
  <tr><td>26</td><td>   <span class="codeString">"&lt;<span class="codeReserved">p</span>&gt;</span></td></tr>
  <tr><td>27</td><td><span class="codeString">     &lt;<span class="codeReserved">label</span> style=&#039;<span class="codeReserved">display</span>: <span class="codeReserved">flex</span>&#039;&gt;</span></td></tr>
  <tr><td>28</td><td><span class="codeString">      &lt;<span class="codeReserved">input</span> type=&#039;checkbox&#039; name=&#039;rolIds[]&#039; value=&#039;$id&#039;&gt;</span></td></tr>
  <tr><td>29</td><td><span class="codeString">      &lt;<span class="codeReserved">span</span>&gt;</span></td></tr>
  <tr><td>30</td><td><span class="codeString">       &lt;<span class="codeReserved">strong</span>&gt;$id&lt;/<span class="codeReserved">strong</span>&gt;</span></td></tr>
  <tr><td>31</td><td><span class="codeString">       &lt;<span class="codeReserved">br</span>&gt;$descripcion</span></td></tr>
  <tr><td>32</td><td><span class="codeString">      &lt;/<span class="codeReserved">span</span>&gt;</span></td></tr>
  <tr><td>33</td><td><span class="codeString">     &lt;/<span class="codeReserved">label</span>&gt;</span></td></tr>
  <tr><td>34</td><td><span class="codeString">    &lt;/<span class="codeReserved">p</span>&gt;"</span>;</td></tr>
  <tr><td>35</td><td> }</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> devuelveJson([<span class="codeString">"roles"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>38</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>41</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>44</td><td>}</td></tr>
  <tr><td>45</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. srv / usuario-agrega.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaArray.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaCue.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveCreated.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/usuRolAgrega.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $cue = recuperaTexto(<span class="codeString">"cue"</span>);</td></tr>
  <tr><td>16</td><td> $rolIds = recuperaArray(<span class="codeString">"rolIds"</span>);</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $cue = validaCue($cue);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>21</td><td> $conexion-&gt;beginTransaction();</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>24</td><td>  <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> USUARIO</span></td></tr>
  <tr><td>25</td><td><span class="codeString">    (USU_CUE)</span></td></tr>
  <tr><td>26</td><td><span class="codeString">   <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>27</td><td><span class="codeString">    (:cue)"</span></td></tr>
  <tr><td>28</td><td> )</td></tr>
  <tr><td>29</td><td>  -&gt;execute([<span class="codeString">":cue"</span> =&gt; $cue]);</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td> <span class="codeComment">/* Recupera el id generado. Si usas una secuencia, pasa como</span></td></tr>
  <tr><td>32</td><td><span class="codeComment">  * parÃ¡metro de lastInsertId el nombre de dicha secuencia y</span></td></tr>
  <tr><td>33</td><td><span class="codeComment">  * poner esta instrucciÃ³n antes del <span class="codeReserved">INSERT</span>, al cual se le</span></td></tr>
  <tr><td>34</td><td><span class="codeComment">  * pasarle el id generado. */</span></td></tr>
  <tr><td>35</td><td>  $usuId = $conexion-&gt;lastInsertId();</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> usuRolAgrega($conexion, $usuId, $rolIds);</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> $conexion-&gt;commit();</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> $encodeUsuId = urlencode($usuId);</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> devuelveCreated(<span class="codeString">"/srv/usuario.php?id=$encodeUsuId"</span>, [</td></tr>
  <tr><td>44</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $usuId],</td></tr>
  <tr><td>45</td><td>  <span class="codeString">"cue"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $cue],</td></tr>
  <tr><td>46</td><td>  <span class="codeString">"rolIds"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $rolIds],</td></tr>
  <tr><td>47</td><td> ]);</td></tr>
  <tr><td>48</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>51</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>54</td><td>}</td></tr>
  <tr><td>55</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. srv / usuario-elimina.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveNoContent.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/usuRolElimina.php"</span>;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> $usuId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>16</td><td> $conexion-&gt;beginTransaction();</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> usuRolElimina($usuId);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $stmt = $conexion-&gt;prepare(</td></tr>
  <tr><td>21</td><td>  <span class="codeString">"<span class="codeReserved">DELETE</span> <span class="codeReserved">FROM</span> USUARIO</span></td></tr>
  <tr><td>22</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> USU_ID = :id"</span></td></tr>
  <tr><td>23</td><td> )</td></tr>
  <tr><td>24</td><td>  -&gt;execute([<span class="codeString">":id"</span> =&gt; $usuId]);</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> $conexion-&gt;commit();</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td> devuelveNoContent();</td></tr>
  <tr><td>29</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>32</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. srv / usuario-modifica.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaArray.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaCue.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/usuRolAgrega.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>13</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/usuRolElimina.php"</span>;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $usuId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>18</td><td> $cue = recuperaTexto(<span class="codeString">"cue"</span>);</td></tr>
  <tr><td>19</td><td> $rolIds = recuperaArray(<span class="codeString">"rolIds"</span>);</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> $cue = validaCue($cue);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>24</td><td> $conexion-&gt;beginTransaction();</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>27</td><td>  <span class="codeString">"<span class="codeReserved">UPDATE</span> USUARIO</span></td></tr>
  <tr><td>28</td><td><span class="codeString">   <span class="codeReserved">SET</span> USU_CUE = :cue</span></td></tr>
  <tr><td>29</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> USU_ID = :id"</span></td></tr>
  <tr><td>30</td><td> )</td></tr>
  <tr><td>31</td><td>  -&gt;execute([</td></tr>
  <tr><td>32</td><td>   <span class="codeString">":id"</span> =&gt; $usuId,</td></tr>
  <tr><td>33</td><td>   <span class="codeString">":cue"</span> =&gt; $cue</td></tr>
  <tr><td>34</td><td>  ]);</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td> usuRolElimina($usuId);</td></tr>
  <tr><td>37</td><td> usuRolAgrega($conexion, $usuId, $rolIds);</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> $conexion-&gt;commit();</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> devuelveJson([</td></tr>
  <tr><td>42</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $usuId],</td></tr>
  <tr><td>43</td><td>  <span class="codeString">"cue"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $cue],</td></tr>
  <tr><td>44</td><td>  <span class="codeString">"rolIds"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $rolIds],</td></tr>
  <tr><td>45</td><td> ]);</td></tr>
  <tr><td>46</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>49</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>52</td><td>}</td></tr>
  <tr><td>53</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. srv / usuario.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/usuRolIds.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $usuId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>18</td><td> $modelo = fetch(</td></tr>
  <tr><td>19</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>20</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>21</td><td><span class="codeString">    USU_ID <span class="codeReserved">as</span> id,</span></td></tr>
  <tr><td>22</td><td><span class="codeString">    USU_CUE <span class="codeReserved">as</span> cue</span></td></tr>
  <tr><td>23</td><td><span class="codeString">   <span class="codeReserved">FROM</span> USUARIO</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> USU_ID = :usuId"</span></td></tr>
  <tr><td>25</td><td>  ),</td></tr>
  <tr><td>26</td><td>  [<span class="codeString">":usuId"</span> =&gt; $usuId]</td></tr>
  <tr><td>27</td><td> );</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> <span class="codeReserved">if</span> ($modelo === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>30</td><td>  $htmlId = htmlentities($id);</td></tr>
  <tr><td>31</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>32</td><td>   title: <span class="codeString">"Usuario no encontrado."</span>,</td></tr>
  <tr><td>33</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>34</td><td>   type: <span class="codeString">"/error/usuarionoencontrado.html"</span>,</td></tr>
  <tr><td>35</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn usuario con el id $htmlId."</span>,</td></tr>
  <tr><td>36</td><td>  );</td></tr>
  <tr><td>37</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>  $rolIds = usuRolIds($conexion, $usuId);</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>  devuelveJson([</td></tr>
  <tr><td>42</td><td>   <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $usuId],</td></tr>
  <tr><td>43</td><td>   <span class="codeString">"cue"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $modelo-&gt;cue],</td></tr>
  <tr><td>44</td><td>   <span class="codeString">"rolIds[]"</span> =&gt; $rolIds</td></tr>
  <tr><td>45</td><td>  ]);</td></tr>
  <tr><td>46</td><td> }</td></tr>
  <tr><td>47</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>50</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>53</td><td>}</td></tr>
  <tr><td>54</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. srv / usuarios.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $conexionexion = Bd::getConexion();</td></tr>
  <tr><td>13</td><td> $lista = fetchAll($conexionexion-&gt;query(</td></tr>
  <tr><td>14</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>15</td><td><span class="codeString">    U.USU_ID <span class="codeReserved">AS</span> usuId,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    U.USU_CUE <span class="codeReserved">AS</span> usuCue,</span></td></tr>
  <tr><td>17</td><td><span class="codeString">    GROUP_CONCAT(R.ROL_ID, &#039;, &#039;) <span class="codeReserved">AS</span> roles</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   <span class="codeReserved">FROM</span> USUARIO U</span></td></tr>
  <tr><td>19</td><td><span class="codeString">    <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> USU_ROL UR</span></td></tr>
  <tr><td>20</td><td><span class="codeString">    <span class="codeReserved">ON</span> U.USU_ID = UR.USU_ID</span></td></tr>
  <tr><td>21</td><td><span class="codeString">    <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> ROL R</span></td></tr>
  <tr><td>22</td><td><span class="codeString">    <span class="codeReserved">ON</span> UR.ROL_ID = R.ROL_ID</span></td></tr>
  <tr><td>23</td><td><span class="codeString">   <span class="codeReserved">GROUP</span> <span class="codeReserved">BY</span> U.USU_CUE</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> U.USU_CUE"</span></td></tr>
  <tr><td>25</td><td> ));</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> $render = <span class="codeString">""</span>;</td></tr>
  <tr><td>28</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>29</td><td>  $encodeUsuId = urlencode($modelo-&gt;usuId);</td></tr>
  <tr><td>30</td><td>  $usuId = htmlentities($encodeUsuId);</td></tr>
  <tr><td>31</td><td>  $usuCue = htmlentities($modelo-&gt;usuCue);</td></tr>
  <tr><td>32</td><td>  $roles = $modelo-&gt;roles === <span class="codeReserved">null</span> || $modelo-&gt;roles === <span class="codeString">""</span></td></tr>
  <tr><td>33</td><td>   ? <span class="codeString">"&lt;<span class="codeReserved">em</span>&gt;-- Sin roles --&lt;/<span class="codeReserved">em</span>&gt;"</span></td></tr>
  <tr><td>34</td><td>   : htmlentities($modelo-&gt;roles);</td></tr>
  <tr><td>35</td><td>  $render .=</td></tr>
  <tr><td>36</td><td>   <span class="codeString">"&lt;<span class="codeReserved">dt</span>&gt;&lt;<span class="codeReserved">a</span> href=&#039;modifica.html?id=$usuId&#039;&gt;$usuCue&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>37</td><td><span class="codeString">    &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">a</span> href=&#039;modifica.html?id=$usuId&#039;&gt;$roles&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;"</span>;</td></tr>
  <tr><td>38</td><td> }</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td> devuelveJson([<span class="codeString">"lista"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>41</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>44</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>47</td><td>}</td></tr>
  <tr><td>48</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. srv / usuRolElimina.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> usuRolElimina(<span class="codeReserved">int</span> $usuId)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>11</td><td>  <span class="codeString">"<span class="codeReserved">DELETE</span> <span class="codeReserved">FROM</span> USU_ROL</span></td></tr>
  <tr><td>12</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> USU_ID = :usuId"</span></td></tr>
  <tr><td>13</td><td> )</td></tr>
  <tr><td>14</td><td>  -&gt;execute([<span class="codeString">":usuId"</span> =&gt; $usuId]);</td></tr>
  <tr><td>15</td><td>}</td></tr>
  <tr><td>16</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >K. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-js/m-muestraObjeto-js.html">lib / js / muestraObjeto.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraObjeto.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraObjeto(raizHtml, objeto) {</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [nombre, definiciones] of Object.entries(objeto)) {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">if</span> (Array.isArray(definiciones)) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   muestraArray(raizHtml, nombre, definiciones)</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (definiciones !== undefined && definiciones !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">const</span> elementoHtml = buscaElementoHtml(raizHtml, nombre)</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (elementoHtml <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>    muestraInput(raizHtml, elementoHtml, definiciones)</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>   } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (elementoHtml !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> elementoHtml) {</td></tr>
  <tr><td>25</td><td>      elementoHtml[atributo] = valor</td></tr>
  <tr><td>26</td><td>     }</td></tr>
  <tr><td>27</td><td>    }</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>   }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>window[<span class="codeString">"muestraObjeto"</span>] = muestraObjeto</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } nombre</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>43</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> buscaElementoHtml(raizHtml, nombre) {</td></tr>
  <tr><td>44</td><td> <span class="codeReserved">return</span> raizHtml.querySelector(</td></tr>
  <tr><td>45</td><td>  <span class="codeString">`#${nombre},[name=&quot;${nombre}&quot;],[data-name=&quot;${nombre}&quot;]`</span>)</td></tr>
  <tr><td>46</td><td>}</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } propiedad</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {any[]} valores</span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>53</td><td><span class="codeReserved">function</span> muestraArray(raizHtml, propiedad, valores) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> <span class="codeReserved">const</span> conjunto = <span class="codeReserved">new</span> Set(valores)</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> elementos =</td></tr>
  <tr><td>57</td><td>  raizHtml.querySelectorAll(<span class="codeString">`[name=&quot;${propiedad}&quot;],[data-name=&quot;${propiedad}&quot;]`</span>)</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> <span class="codeReserved">if</span> (elementos.length === 1) {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">const</span> elemento = elementos[0]</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLSelectElement) {</td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">const</span> options = elemento.options</td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = options.length; i &lt; len; i++) {</td></tr>
  <tr><td>65</td><td>    <span class="codeReserved">const</span> option = options[i]</td></tr>
  <tr><td>66</td><td>    option.selected = conjunto.has(option.value)</td></tr>
  <tr><td>67</td><td>   }</td></tr>
  <tr><td>68</td><td>   <span class="codeReserved">return</span></td></tr>
  <tr><td>69</td><td>  }</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td> }</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = elementos.length; i &lt; len; i++) {</td></tr>
  <tr><td>74</td><td>  <span class="codeReserved">const</span> elemento = elementos[i]</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>76</td><td>   elemento.checked = conjunto.has(elemento.value)</td></tr>
  <tr><td>77</td><td>  }</td></tr>
  <tr><td>78</td><td> }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>}</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>83</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>84</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>85</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } definiciones</span></td></tr>
  <tr><td>86</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>87</td><td><span class="codeReserved">function</span> muestraInput(raizHtml, input, definiciones) {</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>  <span class="codeReserved">if</span> (atributo == <span class="codeString">"data-file"</span>) {</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>95</td><td>    input.dataset.file = valor</td></tr>
  <tr><td>96</td><td>    input.value = <span class="codeString">""</span></td></tr>
  <tr><td>97</td><td>    <span class="codeReserved">if</span> (valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>98</td><td>     img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>99</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>100</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>101</td><td>     img.<span class="codeReserved">src</span> = valor</td></tr>
  <tr><td>102</td><td>     img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>103</td><td>    }</td></tr>
  <tr><td>104</td><td>   }</td></tr>
  <tr><td>105</td><td></td></tr>
  <tr><td>106</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> input) {</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>   input[atributo] = valor</td></tr>
  <tr><td>109</td><td></td></tr>
  <tr><td>110</td><td>  }</td></tr>
  <tr><td>111</td><td> }</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td>}</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>116</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>117</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLElement } elementoHtml</span></td></tr>
  <tr><td>118</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>119</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getImgParaElementoHtml(raizHtml, elementoHtml) {</td></tr>
  <tr><td>120</td><td> <span class="codeReserved">const</span> imgId = elementoHtml.getAttribute(<span class="codeString">"data-img"</span>)</td></tr>
  <tr><td>121</td><td> <span class="codeReserved">if</span> (imgId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>122</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>123</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>124</td><td>  <span class="codeReserved">const</span> input = buscaElementoHtml(raizHtml, imgId)</td></tr>
  <tr><td>125</td><td>  <span class="codeReserved">if</span> (input <span class="codeReserved">instanceof</span> HTMLImageElement) {</td></tr>
  <tr><td>126</td><td>   <span class="codeReserved">return</span> input</td></tr>
  <tr><td>127</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>128</td><td>   <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>129</td><td>  }</td></tr>
  <tr><td>130</td><td> }</td></tr>
  <tr><td>131</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-devuelveCreated-php.html">lib / php / devuelveCreated.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-devuelveNoContent-php.html">lib / php / devuelveNoContent.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-fetch-php.html">lib / php / fetch.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-fetchAll-php.html">lib / php / fetchAll.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-NOT_FOUND-php.html">lib / php / NOT_FOUND.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-recuperaArray-php.html">lib / php / recuperaArray.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-recuperaEntero-php.html">lib / php / recuperaEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-recuperaIdEntero-php.html">lib / php / recuperaIdEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-usuRolAgrega-php.html">lib / php / usuRolAgrega.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-usuRolIds-php.html">lib / php / usuRolIds.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-lib/m-php/m-validaCue-php.html">lib / php / validaCue.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveCreated.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveCreated($urlDelNuevo, $resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(201);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Location: {$urlDelNuevo}"</span>);</td></tr>
  <tr><td>17</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>18</td><td>  echo $json;</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td>}</td></tr>
  <tr><td>21</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveNoContent.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> devuelveNoContent()</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> http_response_code(204);</td></tr>
  <tr><td>6</td><td>}</td></tr>
  <tr><td>7</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / fetch.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetch(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">if</span> ($opcional === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>20</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch($mode);</td></tr>
  <tr><td>21</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>22</td><td>   $statement-&gt;setFetchMode($mode, $opcional);</td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch();</td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >9. lib / php / fetchAll.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetchAll(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>): array {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  $resultado = $opcional === <span class="codeReserved">null</span></td></tr>
  <tr><td>20</td><td>   ? $statement-&gt;fetchAll($mode)</td></tr>
  <tr><td>21</td><td>   : $statement-&gt;fetchAll($mode, $opcional);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">if</span> ($resultado === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>25</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">return</span> $resultado;</td></tr>
  <tr><td>27</td><td>  }</td></tr>
  <tr><td>28</td><td> }</td></tr>
  <tr><td>29</td><td>}</td></tr>
  <tr><td>30</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >10. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >11. lib / php / NOT_FOUND.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> NOT_FOUND = 404;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >12. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >13. lib / php / recuperaArray.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera los valores asociados a un</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * parÃ¡metro multivaluado; por ejemplo, un</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * grupo de checkbox, recibido en el servidor</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * Si no se recibe el parÃ¡metro, devuelve [].</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> * Si el valor recibido no es un arreglo, lo</span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> * coloca dentro de uno.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>14</td><td><span class="codeReserved">function</span> recuperaArray(string $parametro)</td></tr>
  <tr><td>15</td><td>{</td></tr>
  <tr><td>16</td><td> <span class="codeReserved">if</span> (isset($_REQUEST[$parametro])) {</td></tr>
  <tr><td>17</td><td>  $valor = $_REQUEST[$parametro];</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">return</span> is_array($valor)</td></tr>
  <tr><td>19</td><td>   ? $valor</td></tr>
  <tr><td>20</td><td>   : [$valor];</td></tr>
  <tr><td>21</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td>}</td></tr>
  <tr><td>25</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >14. lib / php / recuperaEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * Devuelve el valor entero de un parÃ¡metro recibido en el</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuekve <span class="codeReserved">false</span></span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> * Si se recibe una cadena vacÃ­a, se devuelve <span class="codeReserved">null</span>.</span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> * Si parÃ¡metro no se puede convertir a entero, se genera</span></td></tr>
  <tr><td>14</td><td><span class="codeComment"> * un error.</span></td></tr>
  <tr><td>15</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>16</td><td><span class="codeReserved">function</span> recuperaEntero(string $parametro): <span class="codeReserved">false</span>|<span class="codeReserved">null</span>|<span class="codeReserved">int</span></td></tr>
  <tr><td>17</td><td>{</td></tr>
  <tr><td>18</td><td> $valor = recuperaTexto($parametro);</td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($valor === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>21</td><td> } <span class="codeReserved">elseif</span> ($valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span>;</td></tr>
  <tr><td>23</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">return</span> (<span class="codeReserved">int</span>) trim($valor);</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >15. lib / php / recuperaIdEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> recuperaIdEntero(string $parametro): <span class="codeReserved">int</span></td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> $id = recuperaEntero($parametro);</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>14</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>15</td><td>   title: <span class="codeString">"Falta el id."</span>,</td></tr>
  <tr><td>16</td><td>   type: <span class="codeString">"/error/faltaid.html"</span>,</td></tr>
  <tr><td>17</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de id."</span>,</td></tr>
  <tr><td>18</td><td>  );</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">null</span>)</td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>22</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>23</td><td>   title: <span class="codeString">"Id en blanco."</span>,</td></tr>
  <tr><td>24</td><td>   type: <span class="codeString">"/error/idenblanco.html"</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $id;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >16. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >17. lib / php / usuRolAgrega.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> usuRolAgrega(PDO $conexion, <span class="codeReserved">int</span> $usuId, array $rolIds)</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">if</span> (sizeof($rolIds) &gt; 0) {</td></tr>
  <tr><td>6</td><td>  $insert = $conexion-&gt;prepare(</td></tr>
  <tr><td>7</td><td>   <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> USU_ROL</span></td></tr>
  <tr><td>8</td><td><span class="codeString">     (USU_ID, ROL_ID)</span></td></tr>
  <tr><td>9</td><td><span class="codeString">    <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>10</td><td><span class="codeString">     (:usuId, :rolId)"</span></td></tr>
  <tr><td>11</td><td>  );</td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">foreach</span> ($rolIds <span class="codeReserved">as</span> $rolId) {</td></tr>
  <tr><td>13</td><td>   $insert-&gt;execute(</td></tr>
  <tr><td>14</td><td>    [</td></tr>
  <tr><td>15</td><td>     <span class="codeString">":usuId"</span> =&gt; $usuId,</td></tr>
  <tr><td>16</td><td>     <span class="codeString">":rolId"</span> =&gt; $rolId</td></tr>
  <tr><td>17</td><td>    ]</td></tr>
  <tr><td>18</td><td>   );</td></tr>
  <tr><td>19</td><td>  }</td></tr>
  <tr><td>20</td><td> }</td></tr>
  <tr><td>21</td><td>}</td></tr>
  <tr><td>22</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >18. lib / php / usuRolIds.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> usuRolIds(PDO $conexion, <span class="codeReserved">int</span> $usuId)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td> <span class="codeReserved">return</span> fetchAll(</td></tr>
  <tr><td>8</td><td>  $conexion-&gt;query(</td></tr>
  <tr><td>9</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>10</td><td><span class="codeString">    ROL_ID</span></td></tr>
  <tr><td>11</td><td><span class="codeString">   <span class="codeReserved">FROM</span> USU_ROL</span></td></tr>
  <tr><td>12</td><td><span class="codeString">   <span class="codeReserved">WHERE</span></span></td></tr>
  <tr><td>13</td><td><span class="codeString">    USU_ID = :usuId</span></td></tr>
  <tr><td>14</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> ROL_ID"</span></td></tr>
  <tr><td>15</td><td>  ),</td></tr>
  <tr><td>16</td><td>  [<span class="codeString">":usuId"</span> =&gt; $usuId],</td></tr>
  <tr><td>17</td><td>  PDO::FETCH_COLUMN</td></tr>
  <tr><td>18</td><td> );</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >19. lib / php / validaCue.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaCue(<span class="codeReserved">false</span>|string $cue)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($cue === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>11</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>12</td><td>   title: <span class="codeString">"Falta el cue."</span>,</td></tr>
  <tr><td>13</td><td>   type: <span class="codeString">"/error/faltacue.html"</span>,</td></tr>
  <tr><td>14</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de cue."</span>,</td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $trimCue = trim($cue);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($trimCue === <span class="codeString">""</span>)</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>21</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>22</td><td>   title: <span class="codeString">"Cue en blanco."</span>,</td></tr>
  <tr><td>23</td><td>   type: <span class="codeString">"/error/cuenblanco.html"</span>,</td></tr>
  <tr><td>24</td><td>   detail: <span class="codeString">"Pon texto en el campo cue."</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $trimCue;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >L. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-cuenblanco-html.html">error / cuenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-faltacue-html.html">error / faltacue.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-faltadescripcion-html.html">error / faltadescripcion.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-faltaid-html.html">error / faltaid.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-idenblanco-html.html">error / idenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m18amuchos/m-error/m-usuarionoencontrado-html.html">error / usuarionoencontrado.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / cuenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Cue en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Cue en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">h1</span>&gt;Pon texto en el campo cue.&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / faltacue.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el cue&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el cue&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de cue.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / faltadescripcion.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta la descripciÃ³n&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta la descripciÃ³n&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de descripcion.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. error / faltaid.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el id&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el id&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de id.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. error / idenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Id en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Id en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. error / usuarionoencontrado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Usuario no encontrado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Usuario no encontrado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ningÃºn usuario con el id solicitado.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >M. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ el acceso a bases de datos que implementan
    relaciones a muchos, usando servicios. El ejemplo tambiÃ©n implementa una
    estructura de usuarios y roles.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >22. AutenticaciÃ³n</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m19aut/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/mBder.html">Diagrama entidad relaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/mBrel.html">Diagrama relacional</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/mCdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-perfil-html.html">perfil.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-login-html.html">login.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-admin-html.html">admin.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-cliente-html.html">cliente.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-js/">Carpeta Â« js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se amplÃ­a el ejemplo de la lecciÃ³n anterior para controlar
    el acceso a una app.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="https://srvaut.rf.gd/" rel="noreferrer"
      target="_blank">https://srvaut.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>Prueba con los siguientes usarios y contraseÃ±as:</p>
   <dl>
    <dt>pepito</dt>
    <dd>cuentos</dd>
    <dt>susana</dt>
    <dd>alegria</dd>
    <dt>bebe</dt>
    <dd>saurio</dd>
   </dl>
  </li>
  <li>
   <p>
    Este ejmplo se puede complementar usando reCaptcha..
   </p>
  </li>
  <li>
   <p>
    Este ejemplo usa <dfn>sesiÃ³n en el navegador</dfn>, que es un archivo en el
    servidor que permite guardar la informaciÃ³n del usuario. Este mecanismo estÃ¡
    cayendo en desuso, porque limita la veocidad del servidor y lo expone a
    fallas de seguridad.
   </p>
  </li>
  <li>
   <p>
    Hoy en dÃ­a se prefiere usar servidores de <dfn>OAuth 2</dfn> para autenticar
    usuarios. Los principales servidores para este tipo de autenticaciÃ³n son
    Google, Facebook y Microsoft.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama entidad relaciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Algunos navegadores web bloquean las interfaces que muestran etiquetas como
    <q>contraseÃ±a</q>, <q>usuario</q>, <q>id</q>, <q>email</q>, etcÃ©tera,
    suponiendo que es un
    intento de engaÃ±ar al usuario; para evitar este problema, al campo con el
    nombre de usuario se le llama <q>cue</q> y a la conreaseÃ±a <q>match</q>.
   </p>
  </li>
 </ul>
</div>
<figure>
 <img style="max-height: none;"
   src="/img/m19aut/autder.drawio.svg"
   alt="Diagrama entidad relaciÃ³n">
</figure>
      </section>
     <section >
         <h1 >C. Diagrama relacional</h1><figure>
 <img style="max-height: none;"
   src="/img/m19aut/autrel.drawio.svg"
   alt="Diagrama relacional">
</figure>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m19aut/autdeploy.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >E. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="https://srvaut.rf.gd/" rel="noreferrer"
      target="_blank">https://srvaut.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvaut.zip" download>/src/srvaut.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>En algunos host tienes que configurar el certificado SSL.</p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >F. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-admin-html.html">admin.html</a></p>
  </li>
  <li>
   <p><a href="m-cliente-html.html">cliente.html</a></p>
  </li>
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <p><a href="m-login-html.html">login.html</a></p>
  </li>
  <li>
   <p><a href="m-perfil-html.html">perfil.html</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-cuenblanco-html.html">cuenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-datosincorrectos-html.html">datosincorrectos.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltacue-html.html">faltacue.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltadescripcion-html.html">faltadescripcion.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltaid-html.html">faltaid.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltamatch-html.html">faltamatch.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltanombre-html.html">faltanombre.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-idenblanco-html.html">idenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-matchenblanco-html.html">matchenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-noautorizado-html.html">noautorizado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-nojson-html.html">nojson.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-nombreenblanco-html.html">nombreenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-pasatiemponoencontrado-html.html">pasatiemponoencontrado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-rolincorrecto-html.html">rolincorrecto.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-sesioniniciada-html.html">sesioniniciada.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-js/m-CUE-js.html">CUE.js</a></p>
  </li>
  <li>
   <p><a href="m-js/m-protege-js.html">protege.js</a></p>
  </li>
  <li>
   <p><a href="m-js/m-ROL_IDS-js.html">ROL_IDS.js</a></p>
  </li>
  <li>
   <p><a href="m-js/m-ROL_ID_ADMINISTRADOR-js.html">ROL_ID_ADMINISTRADOR.js</a></p>
  </li>
  <li>
   <p><a href="m-js/m-ROL_ID_CLIENTE-js.html">ROL_ID_CLIENTE.js</a></p>
  </li>
  <li>
   <p><a href="m-js/m-Sesion-js.html">Sesion.js</a></p>
  </li>
    <li>
     <details>
      <summary>custom</summary>
      <ul>
  <li>
   <p><a href="m-js/m-custom/m-mi-nav-js.html">mi-nav.js</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-htmlentities-js.html">htmlentities.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetch-php.html">fetch.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetchAll-php.html">fetchAll.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-usuRolAgrega-php.html">usuRolAgrega.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-usuRolIds-php.html">usuRolIds.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-validaCue-php.html">validaCue.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-Bd-php.html">Bd.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-CUE-php.html">CUE.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-login-php.html">login.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-logout-php.html">logout.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-protege-php.html">protege.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-ROL_IDS-php.html">ROL_IDS.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-ROL_ID_ADMINISTRADOR-php.html">ROL_ID_ADMINISTRADOR.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-ROL_ID_CLIENTE-php.html">ROL_ID_CLIENTE.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-saludo-cliente-php.html">saludo-cliente.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-sesion-actual-php.html">sesion-actual.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-Sesion-php.html">Sesion.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >G. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;AutenticaciÃ³n&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/protege.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/custom/mi-nav.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"protege(&#039;srv/sesion-actual.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">  .then(sesion =&gt; nav.sesion = sesion)</span></td></tr>
  <tr><td>19</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">mi-nav</span> id=<span class="codeString">"nav"</span>&gt;&lt;/<span class="codeReserved">mi-nav</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">h1</span>&gt;AutenticaciÃ³n&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> &lt;<span class="codeReserved">p</span>&gt;Bienvenid@.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. perfil.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Perfil&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/protege.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/custom/mi-nav.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"protege(&#039;srv/sesion-actual.php&#039;)</span></td></tr>
  <tr><td>19</td><td><span class="codeString">  .then(sesion =&gt; {</span></td></tr>
  <tr><td>20</td><td><span class="codeString">   nav.sesion = sesion</span></td></tr>
  <tr><td>21</td><td><span class="codeString">   <span class="codeReserved">const</span> cue = sesion.cue</span></td></tr>
  <tr><td>22</td><td><span class="codeString">   <span class="codeReserved">if</span> (cue === &#039;&#039;) {</span></td></tr>
  <tr><td>23</td><td><span class="codeString">    login.hidden = <span class="codeReserved">false</span></span></td></tr>
  <tr><td>24</td><td><span class="codeString">    outputCue.value = &#039;No ha iniciado sesiÃ³n.&#039;</span></td></tr>
  <tr><td>25</td><td><span class="codeString">    outputRoles.value = &#039;&#039;</span></td></tr>
  <tr><td>26</td><td><span class="codeString">   } <span class="codeReserved">else</span> {</span></td></tr>
  <tr><td>27</td><td><span class="codeString">    logout.hidden = <span class="codeReserved">false</span></span></td></tr>
  <tr><td>28</td><td><span class="codeString">    outputCue.value = cue</span></td></tr>
  <tr><td>29</td><td><span class="codeString">    <span class="codeReserved">const</span> rolIds = sesion.rolIds</span></td></tr>
  <tr><td>30</td><td><span class="codeString">    outputRoles.value = rolIds.size === 0</span></td></tr>
  <tr><td>31</td><td><span class="codeString">     ? &#039;Sin roles&#039;</span></td></tr>
  <tr><td>32</td><td><span class="codeString">     : Array.<span class="codeReserved">from</span>(rolIds).join(&#039;, &#039;)</span></td></tr>
  <tr><td>33</td><td><span class="codeString">   }</span></td></tr>
  <tr><td>34</td><td><span class="codeString">  })</span></td></tr>
  <tr><td>35</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> &lt;<span class="codeReserved">mi-nav</span> id=<span class="codeString">"nav"</span>&gt;&lt;/<span class="codeReserved">mi-nav</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td> &lt;<span class="codeReserved">h1</span>&gt;Perfil&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>42</td><td>  &lt;<span class="codeReserved">output</span> id=<span class="codeString">"outputCue"</span>&gt;</td></tr>
  <tr><td>43</td><td>   &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>44</td><td>  &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>45</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>48</td><td>  &lt;<span class="codeReserved">output</span> id=<span class="codeString">"outputRoles"</span>&gt;</td></tr>
  <tr><td>49</td><td>   &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>50</td><td>  &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>51</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>  &lt;<span class="codeReserved">a</span> id=<span class="codeString">"login"</span> hidden href=<span class="codeString">"login.html"</span>&gt;Iniciar sesiÃ³n&lt;/<span class="codeReserved">a</span>&gt;</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>  &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> id=<span class="codeString">"logout"</span> hidden</td></tr>
  <tr><td>58</td><td>    onclick=<span class="codeString">"consumeJson(&#039;srv/logout.php&#039;)</span></td></tr>
  <tr><td>59</td><td><span class="codeString">     .then(json =&gt; location.reload())</span></td></tr>
  <tr><td>60</td><td><span class="codeString">     .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>61</td><td>   Terminar sesiÃ³n</td></tr>
  <tr><td>62</td><td>  &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. login.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Iniciar sesiÃ³n&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/protege.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"protege(&#039;srv/sesion-actual.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">  .then(sesion =&gt; {</span></td></tr>
  <tr><td>19</td><td><span class="codeString">   <span class="codeReserved">if</span> (sesion.cue !== &#039;&#039;) {</span></td></tr>
  <tr><td>20</td><td><span class="codeString">    location.href = &#039;perfil.html&#039;</span></td></tr>
  <tr><td>21</td><td><span class="codeString">   }</span></td></tr>
  <tr><td>22</td><td><span class="codeString">  })</span></td></tr>
  <tr><td>23</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> &lt;<span class="codeReserved">form</span> id=<span class="codeString">"login"</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/login.php&#039;, event)</span></td></tr>
  <tr><td>26</td><td><span class="codeString">   .then(sesion =&gt; location.href = &#039;perfil.html&#039;)</span></td></tr>
  <tr><td>27</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Iniciar SesiÃ³n&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"perfil.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>34</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>35</td><td>    Cue</td></tr>
  <tr><td>36</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"cue"</span>&gt;</td></tr>
  <tr><td>37</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>38</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>41</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>42</td><td>    Match</td></tr>
  <tr><td>43</td><td>    &lt;<span class="codeReserved">input</span> type=<span class="codeString">"password"</span> name=<span class="codeString">"match"</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>45</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Iniciar sesiÃ³n&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. admin.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Solo Administradores&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/ROL_ID_ADMINISTRADOR.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/protege.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/custom/mi-nav.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;<span class="codeReserved">body</span></td></tr>
  <tr><td>20</td><td>  onload=<span class="codeString">"protege(&#039;srv/sesion-actual.php&#039;, [ROL_ID_ADMINISTRADOR], &#039;index.html&#039;)</span></td></tr>
  <tr><td>21</td><td><span class="codeString">   .then(sesion =&gt; {</span></td></tr>
  <tr><td>22</td><td><span class="codeString">     nav.sesion = sesion</span></td></tr>
  <tr><td>23</td><td><span class="codeString">     main.hidden = <span class="codeReserved">false</span></span></td></tr>
  <tr><td>24</td><td><span class="codeString">    })</span></td></tr>
  <tr><td>25</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> &lt;<span class="codeReserved">mi-nav</span> id=<span class="codeString">"nav"</span>&gt;&lt;/<span class="codeReserved">mi-nav</span>&gt;</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> &lt;<span class="codeReserved">main</span> id=<span class="codeString">"main"</span> hidden&gt;</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Solo Administradores&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  &lt;<span class="codeReserved">p</span>&gt;Hola.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> onclick=<span class="codeString">"consumeJson(&#039;srv/saludo-cliente.php&#039;)</span></td></tr>
  <tr><td>37</td><td><span class="codeString">      .then(saludo =&gt; alert(saludo.body))</span></td></tr>
  <tr><td>38</td><td><span class="codeString">      .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>39</td><td>    Ejecuta servicio</td></tr>
  <tr><td>40</td><td>   &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>41</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> &lt;/<span class="codeReserved">main</span>&gt;</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >K. cliente.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Solo Clientes&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/ROL_ID_CLIENTE.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/protege.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"./js/custom/mi-nav.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"protege(&#039;srv/sesion-actual.php&#039;, [ROL_ID_CLIENTE], &#039;index.html&#039;)</span></td></tr>
  <tr><td>20</td><td><span class="codeString">   .then(sesion =&gt; {</span></td></tr>
  <tr><td>21</td><td><span class="codeString">     nav.sesion = sesion</span></td></tr>
  <tr><td>22</td><td><span class="codeString">     main.hidden = <span class="codeReserved">false</span></span></td></tr>
  <tr><td>23</td><td><span class="codeString">    })</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> &lt;<span class="codeReserved">mi-nav</span> id=<span class="codeString">"nav"</span>&gt;&lt;/<span class="codeReserved">mi-nav</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td> &lt;<span class="codeReserved">main</span> id=<span class="codeString">"main"</span> hidden&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Solo Clientes&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>  &lt;<span class="codeReserved">p</span>&gt;Hola.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>35</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> onclick=<span class="codeString">"consumeJson(&#039;srv/saludo-cliente.php&#039;)</span></td></tr>
  <tr><td>36</td><td><span class="codeString">     .then(saludo =&gt; alert(saludo.body))</span></td></tr>
  <tr><td>37</td><td><span class="codeString">     .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>38</td><td>    Ejecuta servicio</td></tr>
  <tr><td>39</td><td>   &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>40</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td> &lt;/<span class="codeReserved">main</span>&gt;</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >L. Carpeta Â« js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m19aut/m-js/m-CUE-js.html">js / CUE.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-js/m-protege-js.html">js / protege.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-js/m-ROL_IDS-js.html">js / ROL_IDS.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-js/m-ROL_ID_ADMINISTRADOR-js.html">js / ROL_ID_ADMINISTRADOR.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-js/m-ROL_ID_CLIENTE-js.html">js / ROL_ID_CLIENTE.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-js/m-Sesion-js.html">js / Sesion.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-js/m-custom/">Carpeta Â« js / custom Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. js / CUE.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">export</span> <span class="codeReserved">const</span> CUE = <span class="codeString">"cue"</span></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. js / protege.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"../lib/js/consumeJson.js"</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">import</span> { Sesion } <span class="codeReserved">from</span> <span class="codeString">"./Sesion.js"</span></td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} servicio</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string[]} [rolIdsPermitidos]</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} [urlDeProtecciÃ³n]</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> protege(servicio, rolIdsPermitidos, urlDeProtecciÃ³n) {</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> consumeJson(servicio)</td></tr>
  <tr><td>11</td><td> <span class="codeReserved">const</span> sesion = <span class="codeReserved">new</span> Sesion(respuesta.body)</td></tr>
  <tr><td>12</td><td> <span class="codeReserved">if</span> (rolIdsPermitidos === undefined) {</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">return</span> sesion</td></tr>
  <tr><td>14</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">const</span> rolIds = sesion.rolIds</td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">for</span> (<span class="codeReserved">const</span> rolId of rolIdsPermitidos) {</td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (rolIds.has(rolId)) {</td></tr>
  <tr><td>18</td><td>    <span class="codeReserved">return</span> sesion</td></tr>
  <tr><td>19</td><td>   }</td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">if</span> (urlDeProtecciÃ³n !== undefined) {</td></tr>
  <tr><td>22</td><td>   location.href = urlDeProtecciÃ³n</td></tr>
  <tr><td>23</td><td>  }</td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"No autorizado."</span>)</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"protege"</span>] = protege</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. js / ROL_IDS.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">export</span> <span class="codeReserved">const</span> ROL_IDS = <span class="codeString">"rolIds"</span></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. js / ROL_ID_ADMINISTRADOR.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">export</span> <span class="codeReserved">const</span> ROL_ID_ADMINISTRADOR = <span class="codeString">"Administrador"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">// Permite que los eventos de html usen la constante.</span></td></tr>
  <tr><td>4</td><td>window[<span class="codeString">"ROL_ID_ADMINISTRADOR"</span>] = ROL_ID_ADMINISTRADOR</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. js / ROL_ID_CLIENTE.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">export</span> <span class="codeReserved">const</span> ROL_ID_CLIENTE = <span class="codeString">"Cliente"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">// Permite que los eventos de html usen la constante.</span></td></tr>
  <tr><td>4</td><td>window[<span class="codeString">"ROL_ID_CLIENTE"</span>] = ROL_ID_CLIENTE</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. js / Sesion.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { CUE } <span class="codeReserved">from</span> <span class="codeString">"./CUE.js"</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">import</span> { ROL_IDS } <span class="codeReserved">from</span> <span class="codeString">"./ROL_IDS.js"</span></td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> Sesion {</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">constructor</span>(objeto) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">this</span>.cue = objeto[CUE]</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> <span class="codeReserved">this</span>.cue !== <span class="codeString">"string"</span>)</td></tr>
  <tr><td>14</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"cue debe ser string."</span>)</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">const</span> rolIds = objeto[ROL_IDS]</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (!Array.isArray(rolIds))</td></tr>
  <tr><td>19</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"rolIds debe ser arreglo."</span>)</td></tr>
  <tr><td>20</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">this</span>.rolIds = <span class="codeReserved">new</span> Set(rolIds)</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td><span class="codeComment">// Permite que los eventos de html usen la clase.</span></td></tr>
  <tr><td>28</td><td>window[<span class="codeString">"Sesion"</span>] = Sesion</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >G. Carpeta Â« js / custom Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m19aut/m-js/m-custom/m-mi-nav-js.html">js / custom / mi-nav.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. js / custom / mi-nav.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { htmlentities } <span class="codeReserved">from</span> <span class="codeString">"../../lib/js/htmlentities.js"</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">import</span> { Sesion } <span class="codeReserved">from</span> <span class="codeString">"../Sesion.js"</span></td></tr>
  <tr><td>3</td><td><span class="codeReserved">import</span> { ROL_ID_ADMINISTRADOR } <span class="codeReserved">from</span> <span class="codeString">"../ROL_ID_ADMINISTRADOR.js"</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">import</span> { ROL_ID_CLIENTE } <span class="codeReserved">from</span> <span class="codeString">"../ROL_ID_CLIENTE.js"</span></td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> MiNav <span class="codeReserved">extends</span> HTMLElement {</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> connectedCallback() {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">this</span>.style.<span class="codeReserved">display</span> = <span class="codeString">"block"</span></td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">this</span>.innerHTML = <span class="codeComment">/* html */</span></td></tr>
  <tr><td>13</td><td>   <span class="codeString">`&lt;<span class="codeReserved">nav</span>&gt;</span></td></tr>
  <tr><td>14</td><td><span class="codeString">     &lt;<span class="codeReserved">ul</span> style=&quot;<span class="codeReserved">display</span>: <span class="codeReserved">flex</span>;</span></td></tr>
  <tr><td>15</td><td><span class="codeString">            flex-wrap: wrap;</span></td></tr>
  <tr><td>16</td><td><span class="codeString">            <span class="codeReserved">padding</span>:0;</span></td></tr>
  <tr><td>17</td><td><span class="codeString">            <span class="codeReserved">gap</span>: 0.5em;</span></td></tr>
  <tr><td>18</td><td><span class="codeString">            <span class="codeReserved">list-style-type</span>: none&quot;&gt;</span></td></tr>
  <tr><td>19</td><td><span class="codeString">      &lt;<span class="codeReserved">li</span>&gt;&lt;<span class="codeReserved">progress</span> max=&quot;100&quot;&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">li</span>&gt;</span></td></tr>
  <tr><td>20</td><td><span class="codeString">     &lt;/<span class="codeReserved">ul</span>&gt;</span></td></tr>
  <tr><td>21</td><td><span class="codeString">    &lt;/<span class="codeReserved">nav</span>&gt;`</span></td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>26</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Sesion} sesion</span></td></tr>
  <tr><td>27</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>28</td><td> set sesion(sesion) {</td></tr>
  <tr><td>29</td><td>  <span class="codeReserved">const</span> cue = sesion.cue</td></tr>
  <tr><td>30</td><td>  <span class="codeReserved">const</span> rolIds = sesion.rolIds</td></tr>
  <tr><td>31</td><td>  <span class="codeReserved">let</span> innerHTML = <span class="codeComment">/* html */</span> <span class="codeString">`&lt;<span class="codeReserved">li</span>&gt;&lt;<span class="codeReserved">a</span> href=&quot;index.html&quot;&gt;Inicio&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">li</span>&gt;`</span></td></tr>
  <tr><td>32</td><td>  innerHTML += <span class="codeReserved">this</span>.hipervinculosAdmin(rolIds)</td></tr>
  <tr><td>33</td><td>  innerHTML += <span class="codeReserved">this</span>.hipervinculosCliente(rolIds)</td></tr>
  <tr><td>34</td><td>  <span class="codeReserved">const</span> cueHtml = htmlentities(cue)</td></tr>
  <tr><td>35</td><td>  <span class="codeReserved">if</span> (cue !== <span class="codeString">""</span>) {</td></tr>
  <tr><td>36</td><td>   innerHTML +=  <span class="codeComment">/* html */</span> <span class="codeString">`&lt;<span class="codeReserved">li</span>&gt;${cueHtml}&lt;/<span class="codeReserved">li</span>&gt;`</span></td></tr>
  <tr><td>37</td><td>  }</td></tr>
  <tr><td>38</td><td>  innerHTML += <span class="codeComment">/* html */</span> <span class="codeString">`&lt;<span class="codeReserved">li</span>&gt;&lt;<span class="codeReserved">a</span> href=&quot;perfil.html&quot;&gt;Perfil&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">li</span>&gt;`</span></td></tr>
  <tr><td>39</td><td>  <span class="codeReserved">const</span> ul = <span class="codeReserved">this</span>.querySelector(<span class="codeString">"ul"</span>)</td></tr>
  <tr><td>40</td><td>  <span class="codeReserved">if</span> (ul !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>41</td><td>   ul.innerHTML = innerHTML</td></tr>
  <tr><td>42</td><td>  }</td></tr>
  <tr><td>43</td><td> }</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>46</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Set&lt;string&gt;} rolIds</span></td></tr>
  <tr><td>47</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>48</td><td> hipervinculosAdmin(rolIds) {</td></tr>
  <tr><td>49</td><td>  <span class="codeReserved">return</span> rolIds.has(ROL_ID_ADMINISTRADOR) ?</td></tr>
  <tr><td>50</td><td>   <span class="codeComment">/* html */</span> <span class="codeString">`&lt;<span class="codeReserved">li</span>&gt;&lt;<span class="codeReserved">a</span> href=&quot;admin.html&quot;&gt;Para administradores&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">li</span>&gt;`</span></td></tr>
  <tr><td>51</td><td>   : <span class="codeString">""</span></td></tr>
  <tr><td>52</td><td> }</td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>55</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Set&lt;string&gt;} rolIds</span></td></tr>
  <tr><td>56</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>57</td><td> hipervinculosCliente(rolIds) {</td></tr>
  <tr><td>58</td><td>  <span class="codeReserved">return</span> rolIds.has(ROL_ID_CLIENTE) ?</td></tr>
  <tr><td>59</td><td>   <span class="codeComment">/* html */</span> <span class="codeString">`&lt;<span class="codeReserved">li</span>&gt;&lt;<span class="codeReserved">a</span> href=&quot;cliente.html&quot;&gt;Para clientes&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">li</span>&gt;`</span></td></tr>
  <tr><td>60</td><td>   : <span class="codeString">""</span></td></tr>
  <tr><td>61</td><td> }</td></tr>
  <tr><td>62</td><td>}</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>customElements.define(<span class="codeString">"mi-nav"</span>, MiNav)</td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >M. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m19aut/m-srv/m-Bd-php.html">srv / Bd.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-CUE-php.html">srv / CUE.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-login-php.html">srv / login.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-logout-php.html">srv / logout.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-protege-php.html">srv / protege.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-ROL_IDS-php.html">srv / ROL_IDS.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-ROL_ID_ADMINISTRADOR-php.html">srv / ROL_ID_ADMINISTRADOR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-ROL_ID_CLIENTE-php.html">srv / ROL_ID_CLIENTE.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-saludo-cliente-php.html">srv / saludo-cliente.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-sesion-actual-php.html">srv / sesion-actual.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-srv/m-Sesion-php.html">srv / Sesion.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / Bd.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ROL_ID_CLIENTE.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ROL_ID_ADMINISTRADOR.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/usuRolAgrega.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">class</span> Bd</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">private</span> <span class="codeReserved">static</span> ?PDO $conexion = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">static</span> <span class="codeReserved">function</span> getConexion(): PDO</td></tr>
  <tr><td>13</td><td> {</td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">if</span> (<span class="codeReserved">self</span>::$conexion === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td>   <span class="codeReserved">self</span>::$conexion = <span class="codeReserved">new</span> PDO(</td></tr>
  <tr><td>17</td><td>    <span class="codeComment">// cadena de conexiÃ³n</span></td></tr>
  <tr><td>18</td><td>    <span class="codeString">"sqlite:srvaut.db"</span>,</td></tr>
  <tr><td>19</td><td>    <span class="codeComment">// usuario</span></td></tr>
  <tr><td>20</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>21</td><td>    <span class="codeComment">// contraseÃ±a</span></td></tr>
  <tr><td>22</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>23</td><td>    <span class="codeComment">// Opciones: conexiones persistentes y lanza excepciones.</span></td></tr>
  <tr><td>24</td><td>    [PDO::ATTR_PERSISTENT =&gt; <span class="codeReserved">true</span>, PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION]</td></tr>
  <tr><td>25</td><td>   );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>28</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> USUARIO (</span></td></tr>
  <tr><td>29</td><td><span class="codeString">      USU_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>30</td><td><span class="codeString">      USU_CUE <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>31</td><td><span class="codeString">      USU_MATCH <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>32</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_PK</span></td></tr>
  <tr><td>33</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(USU_ID),</span></td></tr>
  <tr><td>34</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_CUE_UNQ</span></td></tr>
  <tr><td>35</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(USU_CUE),</span></td></tr>
  <tr><td>36</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> USU_CUE_NV</span></td></tr>
  <tr><td>37</td><td><span class="codeString">       CHECK(LENGTH(USU_CUE) &gt; 0)</span></td></tr>
  <tr><td>38</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>39</td><td>   );</td></tr>
  <tr><td>40</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>41</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> ROL (</span></td></tr>
  <tr><td>42</td><td><span class="codeString">      ROL_ID <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>43</td><td><span class="codeString">      ROL_DESCRIPCION <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>44</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_PK</span></td></tr>
  <tr><td>45</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(ROL_ID),</span></td></tr>
  <tr><td>46</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_ID_NV</span></td></tr>
  <tr><td>47</td><td><span class="codeString">       CHECK(LENGTH(ROL_ID) &gt; 0),</span></td></tr>
  <tr><td>48</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_DESCR_UNQ</span></td></tr>
  <tr><td>49</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(ROL_DESCRIPCION),</span></td></tr>
  <tr><td>50</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ROL_DESCR_NV</span></td></tr>
  <tr><td>51</td><td><span class="codeString">       CHECK(LENGTH(ROL_DESCRIPCION) &gt; 0)</span></td></tr>
  <tr><td>52</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>53</td><td>   );</td></tr>
  <tr><td>54</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>55</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> USU_ROL (</span></td></tr>
  <tr><td>56</td><td><span class="codeString">       USU_ID <span class="codeReserved">INTEGER</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>57</td><td><span class="codeString">       ROL_ID <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>58</td><td><span class="codeString">       <span class="codeReserved">CONSTRAINT</span> USU_ROL_PK</span></td></tr>
  <tr><td>59</td><td><span class="codeString">        <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(USU_ID, ROL_ID),</span></td></tr>
  <tr><td>60</td><td><span class="codeString">       <span class="codeReserved">CONSTRAINT</span> USU_ROL_USU_FK</span></td></tr>
  <tr><td>61</td><td><span class="codeString">        <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (USU_ID) <span class="codeReserved">REFERENCES</span> USUARIO(USU_ID),</span></td></tr>
  <tr><td>62</td><td><span class="codeString">       <span class="codeReserved">CONSTRAINT</span> USU_ROL_ROL_FK</span></td></tr>
  <tr><td>63</td><td><span class="codeString">        <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (ROL_ID) <span class="codeReserved">REFERENCES</span> ROL(ROL_ID)</span></td></tr>
  <tr><td>64</td><td><span class="codeString">      )'</span></td></tr>
  <tr><td>65</td><td>   );</td></tr>
  <tr><td>66</td><td></td></tr>
  <tr><td>67</td><td>   $insertRol = <span class="codeReserved">self</span>::$conexion-&gt;prepare(</td></tr>
  <tr><td>68</td><td>    <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> ROL</span></td></tr>
  <tr><td>69</td><td><span class="codeString">      (ROL_ID, ROL_DESCRIPCION)</span></td></tr>
  <tr><td>70</td><td><span class="codeString">     <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>71</td><td><span class="codeString">      (:id, :descripcion)"</span></td></tr>
  <tr><td>72</td><td>   );</td></tr>
  <tr><td>73</td><td></td></tr>
  <tr><td>74</td><td>   $selectRol =</td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;prepare(<span class="codeString">"<span class="codeReserved">SELECT</span> ROL_ID <span class="codeReserved">FROM</span> ROL <span class="codeReserved">WHERE</span> ROL_ID = :id"</span>);</td></tr>
  <tr><td>76</td><td></td></tr>
  <tr><td>77</td><td>   $selectRol-&gt;execute([<span class="codeString">":id"</span> =&gt; ROL_ID_ADMINISTRADOR]);</td></tr>
  <tr><td>78</td><td>   <span class="codeReserved">if</span> ($selectRol-&gt;fetchColumn() === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>79</td><td>    $insertRol-&gt;execute([</td></tr>
  <tr><td>80</td><td>     <span class="codeString">":id"</span> =&gt; ROL_ID_ADMINISTRADOR,</td></tr>
  <tr><td>81</td><td>     <span class="codeString">":descripcion"</span> =&gt; <span class="codeString">"Administra el sistema."</span></td></tr>
  <tr><td>82</td><td>    ]);</td></tr>
  <tr><td>83</td><td>   }</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>   $selectRol-&gt;execute([<span class="codeString">":id"</span> =&gt; ROL_ID_CLIENTE]);</td></tr>
  <tr><td>86</td><td>   <span class="codeReserved">if</span> ($selectRol-&gt;fetchColumn() === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>87</td><td>    $insertRol-&gt;execute([</td></tr>
  <tr><td>88</td><td>     <span class="codeString">":id"</span> =&gt; ROL_ID_CLIENTE,</td></tr>
  <tr><td>89</td><td>     <span class="codeString">":descripcion"</span> =&gt; <span class="codeString">"Realiza compras."</span></td></tr>
  <tr><td>90</td><td>    ]);</td></tr>
  <tr><td>91</td><td>   }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   $insertUsuario = <span class="codeReserved">self</span>::$conexion-&gt;prepare(</td></tr>
  <tr><td>94</td><td>    <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> USUARIO</span></td></tr>
  <tr><td>95</td><td><span class="codeString">      (USU_CUE, USU_MATCH)</span></td></tr>
  <tr><td>96</td><td><span class="codeString">     <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>97</td><td><span class="codeString">      (:cue, :match)"</span></td></tr>
  <tr><td>98</td><td>   );</td></tr>
  <tr><td>99</td><td></td></tr>
  <tr><td>100</td><td>   $selectUsuario = <span class="codeReserved">self</span>::$conexion-&gt;prepare(</td></tr>
  <tr><td>101</td><td>    <span class="codeString">"<span class="codeReserved">SELECT</span> USU_CUE <span class="codeReserved">FROM</span> USUARIO <span class="codeReserved">WHERE</span> USU_CUE = :cue"</span></td></tr>
  <tr><td>102</td><td>   );</td></tr>
  <tr><td>103</td><td></td></tr>
  <tr><td>104</td><td>   $selectUsuario-&gt;execute([<span class="codeString">":cue"</span> =&gt; <span class="codeString">"pepito"</span>]);</td></tr>
  <tr><td>105</td><td>   <span class="codeReserved">if</span> ($selectUsuario-&gt;fetchColumn() === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>106</td><td>    $insertUsuario-&gt;execute([</td></tr>
  <tr><td>107</td><td>     <span class="codeString">":cue"</span> =&gt; <span class="codeString">"pepito"</span>,</td></tr>
  <tr><td>108</td><td>     <span class="codeString">":match"</span> =&gt; password_hash(<span class="codeString">"cuentos"</span>, PASSWORD_DEFAULT)</td></tr>
  <tr><td>109</td><td>    ]);</td></tr>
  <tr><td>110</td><td>    <span class="codeComment">/* Recupera el id generado. Si usas una secuencia, pasa como</span></td></tr>
  <tr><td>111</td><td><span class="codeComment">     * parÃ¡metro de lastInsertId el nombre de dicha secuencia y</span></td></tr>
  <tr><td>112</td><td><span class="codeComment">     * poner esta instrucciÃ³n antes del <span class="codeReserved">INSERT</span>, al cual se le</span></td></tr>
  <tr><td>113</td><td><span class="codeComment">     * pasarle el id generado. */</span></td></tr>
  <tr><td>114</td><td>    $usuId = <span class="codeReserved">self</span>::$conexion-&gt;lastInsertId();</td></tr>
  <tr><td>115</td><td>    usuRolAgrega(<span class="codeReserved">self</span>::$conexion, $usuId, [ROL_ID_CLIENTE]);</td></tr>
  <tr><td>116</td><td>   }</td></tr>
  <tr><td>117</td><td></td></tr>
  <tr><td>118</td><td>   $selectUsuario-&gt;execute([<span class="codeString">":cue"</span> =&gt; <span class="codeString">"susana"</span>]);</td></tr>
  <tr><td>119</td><td>   <span class="codeReserved">if</span> ($selectUsuario-&gt;fetchColumn() === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>120</td><td>    $insertUsuario-&gt;execute([</td></tr>
  <tr><td>121</td><td>     <span class="codeString">":cue"</span> =&gt; <span class="codeString">"susana"</span>,</td></tr>
  <tr><td>122</td><td>     <span class="codeString">":match"</span> =&gt; password_hash(<span class="codeString">"alegria"</span>, PASSWORD_DEFAULT)</td></tr>
  <tr><td>123</td><td>    ]);</td></tr>
  <tr><td>124</td><td>    $usuId = <span class="codeReserved">self</span>::$conexion-&gt;lastInsertId();</td></tr>
  <tr><td>125</td><td>    usuRolAgrega(<span class="codeReserved">self</span>::$conexion, $usuId, [ROL_ID_ADMINISTRADOR]);</td></tr>
  <tr><td>126</td><td>   }</td></tr>
  <tr><td>127</td><td></td></tr>
  <tr><td>128</td><td>   $selectUsuario-&gt;execute([<span class="codeString">":cue"</span> =&gt; <span class="codeString">"bebe"</span>]);</td></tr>
  <tr><td>129</td><td>   <span class="codeReserved">if</span> ($selectUsuario-&gt;fetchColumn() === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>130</td><td>    $insertUsuario-&gt;execute([</td></tr>
  <tr><td>131</td><td>     <span class="codeString">":cue"</span> =&gt; <span class="codeString">"bebe"</span>,</td></tr>
  <tr><td>132</td><td>     <span class="codeString">":match"</span> =&gt; password_hash(<span class="codeString">"saurio"</span>, PASSWORD_DEFAULT)</td></tr>
  <tr><td>133</td><td>    ]);</td></tr>
  <tr><td>134</td><td>    $usuId = <span class="codeReserved">self</span>::$conexion-&gt;lastInsertId();</td></tr>
  <tr><td>135</td><td>    usuRolAgrega(</td></tr>
  <tr><td>136</td><td>     <span class="codeReserved">self</span>::$conexion,</td></tr>
  <tr><td>137</td><td>     $usuId,</td></tr>
  <tr><td>138</td><td>     [ROL_ID_ADMINISTRADOR, ROL_ID_CLIENTE]</td></tr>
  <tr><td>139</td><td>    );</td></tr>
  <tr><td>140</td><td>   }</td></tr>
  <tr><td>141</td><td>  }</td></tr>
  <tr><td>142</td><td></td></tr>
  <tr><td>143</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">self</span>::$conexion;</td></tr>
  <tr><td>144</td><td> }</td></tr>
  <tr><td>145</td><td>}</td></tr>
  <tr><td>146</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. srv / CUE.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> CUE = <span class="codeString">"cue"</span>;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. srv / login.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaCue.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/usuRolIds.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/CUE.php"</span>;</td></tr>
  <tr><td>13</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ROL_IDS.php"</span>;</td></tr>
  <tr><td>14</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>15</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/protege.php"</span>;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> $sesion = protege();</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">if</span> ($sesion-&gt;cue !== <span class="codeString">""</span>)</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>23</td><td>   status: NO_AUTORIZADO,</td></tr>
  <tr><td>24</td><td>   type: <span class="codeString">"/error/sesioniniciada.html"</span>,</td></tr>
  <tr><td>25</td><td>   title: <span class="codeString">"SesiÃ³n iniciada."</span>,</td></tr>
  <tr><td>26</td><td>   detail: <span class="codeString">"La sesiÃ³n ya estÃ¡ iniciada."</span>,</td></tr>
  <tr><td>27</td><td>  );</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> $cue = recuperaTexto(<span class="codeString">"cue"</span>);</td></tr>
  <tr><td>30</td><td> $match = recuperaTexto(<span class="codeString">"match"</span>);</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> $cue = validaCue($cue);</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td> <span class="codeReserved">if</span> ($match === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>35</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>36</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>37</td><td>   title: <span class="codeString">"Falta el match."</span>,</td></tr>
  <tr><td>38</td><td>   type: <span class="codeString">"/error/faltamatch.html"</span>,</td></tr>
  <tr><td>39</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de match."</span>,</td></tr>
  <tr><td>40</td><td>  );</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td> <span class="codeReserved">if</span> ($match === <span class="codeString">""</span>)</td></tr>
  <tr><td>43</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>44</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>45</td><td>   title: <span class="codeString">"Match en blanco."</span>,</td></tr>
  <tr><td>46</td><td>   type: <span class="codeString">"/error/matchenblanco.html"</span>,</td></tr>
  <tr><td>47</td><td>   detail: <span class="codeString">"Pon texto en el campo match."</span>,</td></tr>
  <tr><td>48</td><td>  );</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td> $usuario = fetch(</td></tr>
  <tr><td>53</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>54</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>55</td><td><span class="codeString">     USU_ID <span class="codeReserved">as</span> id,</span></td></tr>
  <tr><td>56</td><td><span class="codeString">     USU_CUE <span class="codeReserved">as</span> cue,</span></td></tr>
  <tr><td>57</td><td><span class="codeString">     USU_MATCH <span class="codeReserved">as</span> match</span></td></tr>
  <tr><td>58</td><td><span class="codeString">    <span class="codeReserved">FROM</span> USUARIO</span></td></tr>
  <tr><td>59</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> USU_CUE = :cue"</span></td></tr>
  <tr><td>60</td><td>  ),</td></tr>
  <tr><td>61</td><td>  [<span class="codeString">":cue"</span> =&gt; $cue]</td></tr>
  <tr><td>62</td><td> );</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td> <span class="codeReserved">if</span> ($usuario === <span class="codeReserved">false</span> || !password_verify($match, $usuario-&gt;match))</td></tr>
  <tr><td>65</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>66</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>67</td><td>   type: <span class="codeString">"/error/datosincorrectos.html"</span>,</td></tr>
  <tr><td>68</td><td>   title: <span class="codeString">"Datos incorrectos."</span>,</td></tr>
  <tr><td>69</td><td>   detail: <span class="codeString">"El cue y/o el match proporcionados son incorrectos."</span>,</td></tr>
  <tr><td>70</td><td>  );</td></tr>
  <tr><td>71</td><td></td></tr>
  <tr><td>72</td><td> $rolIds = usuRolIds($conexion, $usuario-&gt;id);</td></tr>
  <tr><td>73</td><td></td></tr>
  <tr><td>74</td><td> $_SESSION[CUE] = $cue;</td></tr>
  <tr><td>75</td><td> $_SESSION[ROL_IDS] = $rolIds;</td></tr>
  <tr><td>76</td><td> devuelveJson([</td></tr>
  <tr><td>77</td><td>  CUE =&gt; $cue,</td></tr>
  <tr><td>78</td><td>  ROL_IDS =&gt; $rolIds</td></tr>
  <tr><td>79</td><td> ]);</td></tr>
  <tr><td>80</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>83</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>86</td><td>}</td></tr>
  <tr><td>87</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. srv / logout.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/CUE.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ROL_IDS.php"</span>;</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> session_start();</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">if</span> (isset($_SESSION[CUE])) {</td></tr>
  <tr><td>13</td><td>  unset($_SESSION[CUE]);</td></tr>
  <tr><td>14</td><td> }</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> <span class="codeReserved">if</span> (isset($_SESSION[ROL_IDS])) {</td></tr>
  <tr><td>17</td><td>  unset($_SESSION[ROL_IDS]);</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> session_destroy();</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> devuelveJson([]);</td></tr>
  <tr><td>23</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. srv / protege.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/CUE.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ROL_IDS.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ROL_ID_CLIENTE.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Sesion.php"</span>;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td><span class="codeReserved">const</span> NO_AUTORIZADO = 401;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td><span class="codeReserved">function</span> protege(?array $rolIdsPermitidos = <span class="codeReserved">null</span>)</td></tr>
  <tr><td>12</td><td>{</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> session_start();</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> $cue = isset($_SESSION[CUE]) ? $_SESSION[CUE] : <span class="codeString">""</span>;</td></tr>
  <tr><td>17</td><td> $rolIds = isset($_SESSION[ROL_IDS]) ? $_SESSION[ROL_IDS] : [];</td></tr>
  <tr><td>18</td><td> $sesion = <span class="codeReserved">new</span> Sesion($cue, $rolIds);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">if</span> ($rolIdsPermitidos === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">return</span> $sesion;</td></tr>
  <tr><td>23</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>  <span class="codeReserved">foreach</span> ($rolIdsPermitidos <span class="codeReserved">as</span> $rolId) {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">if</span> (array_search($rolId, $rolIds, <span class="codeReserved">true</span>) !== <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>27</td><td>    <span class="codeReserved">return</span> $sesion;</td></tr>
  <tr><td>28</td><td>   }</td></tr>
  <tr><td>29</td><td>  }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>32</td><td>   status: NO_AUTORIZADO,</td></tr>
  <tr><td>33</td><td>   type: <span class="codeString">"/error/noautorizado.html"</span>,</td></tr>
  <tr><td>34</td><td>   title: <span class="codeString">"No autorizado."</span>,</td></tr>
  <tr><td>35</td><td>   detail: <span class="codeString">"No estÃ¡ autorizado para usar este recurso."</span>,</td></tr>
  <tr><td>36</td><td>  );</td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td>}</td></tr>
  <tr><td>39</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. srv / ROL_IDS.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> ROL_IDS = <span class="codeString">"rolIds"</span>;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. srv / ROL_ID_ADMINISTRADOR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> ROL_ID_ADMINISTRADOR = <span class="codeString">"Administrador"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. srv / ROL_ID_CLIENTE.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> ROL_ID_CLIENTE = <span class="codeString">"Cliente"</span>;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. srv / saludo-cliente.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ROL_ID_CLIENTE.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/protege.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $sesion = protege([ROL_ID_CLIENTE]);</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> devuelveJson(<span class="codeString">"Hola "</span> . $sesion-&gt;cue);</td></tr>
  <tr><td>15</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>18</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>21</td><td>}</td></tr>
  <tr><td>22</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. srv / sesion-actual.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/protege.php"</span>;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> devuelveJson(protege());</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>16</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >K. srv / Sesion.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">class</span> Sesion</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeReserved">public</span> string $cue;</td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> array $rolIds;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(string $cue, array $rolIds)</td></tr>
  <tr><td>10</td><td> {</td></tr>
  <tr><td>11</td><td>  $this-&gt;cue = $cue;</td></tr>
  <tr><td>12</td><td>  $this-&gt;rolIds = $rolIds;</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >N. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m19aut/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m19aut/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-js/m-htmlentities-js.html">lib / js / htmlentities.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / htmlentities.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * Codifica un texto para que cambie los caracteres</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * especiales y no se pueda interpretar como</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * etiiqueta HTML. Esta tÃ©cnica evita la inyecciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * de cÃ³digo.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } texto</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">*/</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> htmlentities(texto) {</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">return</span> texto.replace(<span class="codeString">/[&lt;&gt;&quot;&#039;]/</span>g, textoDetectado =&gt; {</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">switch</span> (textoDetectado) {</td></tr>
  <tr><td>11</td><td>   <span class="codeReserved">case</span> <span class="codeString">"<"</span>: <span class="codeReserved">return</span> <span class="codeString">"&lt;"</span></td></tr>
  <tr><td>12</td><td>   <span class="codeReserved">case</span> <span class="codeString">"&gt;"</span>: <span class="codeReserved">return</span> <span class="codeString">"&gt;"</span></td></tr>
  <tr><td>13</td><td>   <span class="codeReserved">case</span> <span class="codeString">'&quot;'</span>: <span class="codeReserved">return</span> <span class="codeString">"&quot;"</span></td></tr>
  <tr><td>14</td><td>   <span class="codeReserved">case</span> <span class="codeString">"&#039;"</span>: <span class="codeReserved">return</span> <span class="codeString">"&#039;"</span></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">default</span>: <span class="codeReserved">return</span> textoDetectado</td></tr>
  <tr><td>16</td><td>  }</td></tr>
  <tr><td>17</td><td> })</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-fetch-php.html">lib / php / fetch.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-fetchAll-php.html">lib / php / fetchAll.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-usuRolAgrega-php.html">lib / php / usuRolAgrega.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-usuRolIds-php.html">lib / php / usuRolIds.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-lib/m-php/m-validaCue-php.html">lib / php / validaCue.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / fetch.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetch(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">if</span> ($opcional === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>20</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch($mode);</td></tr>
  <tr><td>21</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>22</td><td>   $statement-&gt;setFetchMode($mode, $opcional);</td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch();</td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / fetchAll.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetchAll(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>): array {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  $resultado = $opcional === <span class="codeReserved">null</span></td></tr>
  <tr><td>20</td><td>   ? $statement-&gt;fetchAll($mode)</td></tr>
  <tr><td>21</td><td>   : $statement-&gt;fetchAll($mode, $opcional);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">if</span> ($resultado === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>25</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">return</span> $resultado;</td></tr>
  <tr><td>27</td><td>  }</td></tr>
  <tr><td>28</td><td> }</td></tr>
  <tr><td>29</td><td>}</td></tr>
  <tr><td>30</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >9. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >10. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >11. lib / php / usuRolAgrega.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> usuRolAgrega(PDO $conexion, <span class="codeReserved">int</span> $usuId, array $rolIds)</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">if</span> (sizeof($rolIds) &gt; 0) {</td></tr>
  <tr><td>6</td><td>  $insert = $conexion-&gt;prepare(</td></tr>
  <tr><td>7</td><td>   <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> USU_ROL</span></td></tr>
  <tr><td>8</td><td><span class="codeString">     (USU_ID, ROL_ID)</span></td></tr>
  <tr><td>9</td><td><span class="codeString">    <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>10</td><td><span class="codeString">     (:usuId, :rolId)"</span></td></tr>
  <tr><td>11</td><td>  );</td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">foreach</span> ($rolIds <span class="codeReserved">as</span> $rolId) {</td></tr>
  <tr><td>13</td><td>   $insert-&gt;execute(</td></tr>
  <tr><td>14</td><td>    [</td></tr>
  <tr><td>15</td><td>     <span class="codeString">":usuId"</span> =&gt; $usuId,</td></tr>
  <tr><td>16</td><td>     <span class="codeString">":rolId"</span> =&gt; $rolId</td></tr>
  <tr><td>17</td><td>    ]</td></tr>
  <tr><td>18</td><td>   );</td></tr>
  <tr><td>19</td><td>  }</td></tr>
  <tr><td>20</td><td> }</td></tr>
  <tr><td>21</td><td>}</td></tr>
  <tr><td>22</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >12. lib / php / usuRolIds.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> usuRolIds(PDO $conexion, <span class="codeReserved">int</span> $usuId)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td> <span class="codeReserved">return</span> fetchAll(</td></tr>
  <tr><td>8</td><td>  $conexion-&gt;query(</td></tr>
  <tr><td>9</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>10</td><td><span class="codeString">    ROL_ID</span></td></tr>
  <tr><td>11</td><td><span class="codeString">   <span class="codeReserved">FROM</span> USU_ROL</span></td></tr>
  <tr><td>12</td><td><span class="codeString">   <span class="codeReserved">WHERE</span></span></td></tr>
  <tr><td>13</td><td><span class="codeString">    USU_ID = :usuId</span></td></tr>
  <tr><td>14</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> ROL_ID"</span></td></tr>
  <tr><td>15</td><td>  ),</td></tr>
  <tr><td>16</td><td>  [<span class="codeString">":usuId"</span> =&gt; $usuId],</td></tr>
  <tr><td>17</td><td>  PDO::FETCH_COLUMN</td></tr>
  <tr><td>18</td><td> );</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >13. lib / php / validaCue.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaCue($cue)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($cue === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>11</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>12</td><td>   title: <span class="codeString">"Falta el cue."</span>,</td></tr>
  <tr><td>13</td><td>   type: <span class="codeString">"/error/faltacue.html"</span>,</td></tr>
  <tr><td>14</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de cue."</span>,</td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $trimCue = trim($cue);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($trimCue === <span class="codeString">""</span>)</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>21</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>22</td><td>   title: <span class="codeString">"Cue en blanco."</span>,</td></tr>
  <tr><td>23</td><td>   type: <span class="codeString">"/error/cuenblanco.html"</span>,</td></tr>
  <tr><td>24</td><td>   detail: <span class="codeString">"Pon texto en el campo cue."</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $trimCue;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >O. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m19aut/m-error/m-cuenblanco-html.html">error / cuenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-datosincorrectos-html.html">error / datosincorrectos.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-faltacue-html.html">error / faltacue.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-faltadescripcion-html.html">error / faltadescripcion.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-faltaid-html.html">error / faltaid.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-faltamatch-html.html">error / faltamatch.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-faltanombre-html.html">error / faltanombre.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-idenblanco-html.html">error / idenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-matchenblanco-html.html">error / matchenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-noautorizado-html.html">error / noautorizado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-nojson-html.html">error / nojson.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-nombreenblanco-html.html">error / nombreenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-pasatiemponoencontrado-html.html">error / pasatiemponoencontrado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-rolincorrecto-html.html">error / rolincorrecto.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m19aut/m-error/m-sesioniniciada-html.html">error / sesioniniciada.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / cuenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Cue en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Cue en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">h1</span>&gt;Pon texto en el campo cue.&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / datosincorrectos.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Datos incorrectos&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Datos incorrectos&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;El cue y/o el match proporcionados son incorrectos.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / faltacue.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el cue&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el cue&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de cue.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. error / faltadescripcion.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta la descripciÃ³n&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta la descripciÃ³n&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. error / faltaid.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el id&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el id&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de id.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. error / faltamatch.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el match&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el match&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de match.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. error / faltanombre.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el nombre&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el nombre&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. error / idenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Id en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Id en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. error / matchenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Match en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Match en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">h1</span>&gt;Pon texto en el campo match.&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >K. error / noautorizado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;No autorizado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;No autorizado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No estÃ¡ autorizado para usar este recurso.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >L. error / nojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El valor devuelto no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El valor devuelto no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, la respuesta generada, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >M. error / nombreenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon texto en el campo nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. error / pasatiemponoencontrado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Pasatiempo no encontrado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Pasatiempo no encontrado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ningÃºn pasatiempo con el id solicitado.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >O. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >P. error / rolincorrecto.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Tipo incorrecto para un rol&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Tipo incorrecto para un rol&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >Q. error / sesioniniciada.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;SesiÃ³n iniciada&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;SesiÃ³n iniciada&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La sesiÃ³n ya estÃ¡ iniciada.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >P. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >Q. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se ampliÃ³ el ejemplo de la lecciÃ³n anterior para controlar
    el acceso a una app.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >23. Archivos en la base de datos</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m20archivos/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/mBder.html">Diagrama entidad relaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/mBrel.html">Diagrama relacional</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/mCdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-agrega-html.html">agrega.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-modifica-html.html">modifica.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se muestra el almacenamiento de un archivo por registro de
    la base de datos, usando servicios.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvarchivos.rf.gd/" rel="noreferrer"
      target="_blank">http://srvarchivos.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Este ejemplo toma como base la lecciÃ³n de asociaciones a uno, pero en caso
    de necesitar varios archivos por producto, puedes tomar como base la
    lecciÃ³n de asociaciones a muchos.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama entidad relaciÃ³n</h1><figure>
 <img style="max-height: none;"
   src="/img/m20archivos/archivosder.drawio.svg"
   alt="Diagrama entidad relaciÃ³n">
</figure>
      </section>
     <section >
         <h1 >C. Diagrama relacional</h1><figure>
 <img style="max-height: none;"
   src="/img/m20archivos/archivosrel.drawio.svg"
   alt="Diagrama relacional">
</figure>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m20archivos/archivosdeploy.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >E. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvarchivos.rf.gd/" rel="noreferrer"
      target="_blank">http://srvarchivos.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvarchivos.zip" download>/src/srvarchivos.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >F. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-agrega-html.html">agrega.html</a></p>
  </li>
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <p><a href="m-modifica-html.html">modifica.html</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-archivocargaincompleta-html.html">archivocargaincompleta.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-archivodemasiadolargo-html.html">archivodemasiadolargo.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-archivonoenviado-html.html">archivonoenviado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-archivonoguardado-html.html">archivonoguardado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-extensionprohibida-html.html">extensionprohibida.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltacarpetatemporal-html.html">faltacarpetatemporal.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltaid-html.html">faltaid.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltaimagen-html.html">faltaimagen.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltanombre-html.html">faltanombre.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-idenblanco-html.html">idenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-imagenvacia-html.html">imagenvacia.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-nombreenblanco-html.html">nombreenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-productonoencontrado-html.html">productonoencontrado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraImagenSeleccionada-js.html">muestraImagenSeleccionada.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraObjeto-js.html">muestraObjeto.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveCreated-php.html">devuelveCreated.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveNoContent-php.html">devuelveNoContent.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetch-php.html">fetch.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetchAll-php.html">fetchAll.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-NOT_FOUND-php.html">NOT_FOUND.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaBytes-php.html">recuperaBytes.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaEntero-php.html">recuperaEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaIdEntero-php.html">recuperaIdEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-validaNombre-php.html">validaNombre.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-archivo-php.html">archivo.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-Bd-php.html">Bd.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-producto-agrega-php.html">producto-agrega.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-producto-elimina-php.html">producto-elimina.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-producto-modifica-php.html">producto-modifica.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-producto-php.html">producto.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-productos-php.html">productos.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-validaImagen-php.html">validaImagen.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >G. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Archivos&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/productos.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">  .then(render =&gt; muestraObjeto(document, render.body))</span></td></tr>
  <tr><td>19</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">h1</span>&gt;Archivos&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"agrega.html"</span>&gt;Agregar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> &lt;<span class="codeReserved">dl</span> id=<span class="codeString">"lista"</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">dt</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">dt</span>&gt;</td></tr>
  <tr><td>27</td><td>  &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;</td></tr>
  <tr><td>28</td><td> &lt;/<span class="codeReserved">dl</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. agrega.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Agregar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraImagenSeleccionada.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"muestraImagenSeleccionada(forma, forma.imagen)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> &lt;<span class="codeReserved">form</span> id=<span class="codeString">"forma"</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/producto-agrega.php&#039;, event)</span></td></tr>
  <tr><td>21</td><td><span class="codeString">   .then(respuesta =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>22</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Agregar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>29</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>30</td><td>    Nombre *</td></tr>
  <tr><td>31</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span>&gt;</td></tr>
  <tr><td>32</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>33</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>37</td><td>    Imagen *</td></tr>
  <tr><td>38</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"imagen"</span> type=<span class="codeString">"file"</span> accept=<span class="codeString">"image/*"</span> data-img=<span class="codeString">"preview"</span></td></tr>
  <tr><td>39</td><td>      oninput=<span class="codeString">"muestraImagenSeleccionada(forma, <span class="codeReserved">this</span>).<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>40</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>41</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Agregar&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>  &lt;<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>48</td><td>   &lt;<span class="codeReserved">img</span> id=<span class="codeString">"preview"</span> hidden alt=<span class="codeString">"Imagen del producto"</span> style=<span class="codeString">"<span class="codeReserved">max-width</span>: 100%;"</span>&gt;</td></tr>
  <tr><td>49</td><td>  &lt;/<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. modifica.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Modificar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraImagenSeleccionada.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>18</td><td>  <span class="codeComment">// Obtiene los parÃ¡metros de la pÃ¡gina.</span></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">const</span> params = <span class="codeReserved">new</span> URL(location.href).searchParams</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"<span class="codeReserved">if</span> (params.size &gt; 0) {</span></td></tr>
  <tr><td>25</td><td><span class="codeString">   consumeJson(&#039;srv/producto.php?&#039; + params)</span></td></tr>
  <tr><td>26</td><td><span class="codeString">    .then(modelo =&gt; muestraObjeto(document, modelo.body))</span></td></tr>
  <tr><td>27</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>28</td><td><span class="codeString">  }"</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/producto-modifica.php&#039;, event)</span></td></tr>
  <tr><td>31</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>32</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Modificar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td>  &lt;<span class="codeReserved">input</span> type=<span class="codeString">"hidden"</span> name=<span class="codeString">"id"</span>&gt;</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>41</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>42</td><td>    Nombre *</td></tr>
  <tr><td>43</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span> value=<span class="codeString">"Cargando&hellip;"</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>45</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>48</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>49</td><td>    Imagen</td></tr>
  <tr><td>50</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"imagen"</span> type=<span class="codeString">"file"</span> accept=<span class="codeString">"image/*"</span> data-img=<span class="codeString">"preview"</span></td></tr>
  <tr><td>51</td><td>      oninput=<span class="codeString">"muestraImagenSeleccionada(document, <span class="codeReserved">this</span>).<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>52</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>53</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Guardar&lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> onclick=<span class="codeString">"</span></td></tr>
  <tr><td>62</td><td><span class="codeString">     <span class="codeReserved">if</span> (params.size &gt; 0 && confirm(&#039;Confirma la eliminaciÃ³n&#039;)) {</span></td></tr>
  <tr><td>63</td><td><span class="codeString">      consumeJson(&#039;srv/producto-elimina.php?&#039; + params)</span></td></tr>
  <tr><td>64</td><td><span class="codeString">       .then(() =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>65</td><td><span class="codeString">       .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>66</td><td><span class="codeString">     }"</span>&gt;</td></tr>
  <tr><td>67</td><td>    Eliminar</td></tr>
  <tr><td>68</td><td>   &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>69</td><td></td></tr>
  <tr><td>70</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>71</td><td></td></tr>
  <tr><td>72</td><td>  &lt;<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>73</td><td>   &lt;<span class="codeReserved">img</span> id=<span class="codeString">"preview"</span> hidden alt=<span class="codeString">"Imagen del producto"</span> style=<span class="codeString">"<span class="codeReserved">max-width</span>: 100%;"</span>&gt;</td></tr>
  <tr><td>74</td><td>  &lt;/<span class="codeReserved">figure</span>&gt;</td></tr>
  <tr><td>75</td><td></td></tr>
  <tr><td>76</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >J. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-archivo-php.html">srv / archivo.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-Bd-php.html">srv / Bd.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-producto-agrega-php.html">srv / producto-agrega.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-producto-elimina-php.html">srv / producto-elimina.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-producto-modifica-php.html">srv / producto-modifica.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-producto-php.html">srv / producto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-productos-php.html">srv / productos.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-srv/m-validaImagen-php.html">srv / validaImagen.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / archivo.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeComment">// Evita que la imagen se cargue en el cachÃ© de la computadora.</span></td></tr>
  <tr><td>14</td><td> header(<span class="codeString">"Cache-Control: no-store, no-cache, must-revalidate, max-age=0"</span>);</td></tr>
  <tr><td>15</td><td> header(<span class="codeString">"Cache-Control: post-check=0, pre-check=0"</span>, <span class="codeReserved">false</span>);</td></tr>
  <tr><td>16</td><td> header(<span class="codeString">"Pragma: no-cache"</span>);</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $amiId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> $bytes = fetch(</td></tr>
  <tr><td>23</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>24</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>25</td><td><span class="codeString">     ARCH_BYTES</span></td></tr>
  <tr><td>26</td><td><span class="codeString">    <span class="codeReserved">FROM</span> ARCHIVO</span></td></tr>
  <tr><td>27</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> ARCH_ID = :id"</span></td></tr>
  <tr><td>28</td><td>  ),</td></tr>
  <tr><td>29</td><td>  [<span class="codeString">":id"</span> =&gt; $amiId],</td></tr>
  <tr><td>30</td><td>  PDO::FETCH_COLUMN</td></tr>
  <tr><td>31</td><td> );</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> <span class="codeReserved">if</span> ($bytes === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  $idHtml = htmlentities($amiId);</td></tr>
  <tr><td>36</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>37</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>38</td><td>   title: <span class="codeString">"Archivo no encontrado."</span>,</td></tr>
  <tr><td>39</td><td>   type: <span class="codeString">"/error/archivonoencontrado.html"</span>,</td></tr>
  <tr><td>40</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn archivo con el id $idHtml."</span>,</td></tr>
  <tr><td>41</td><td>  );</td></tr>
  <tr><td>42</td><td> }</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td> $contentType = (<span class="codeReserved">new</span> finfo(FILEINFO_MIME_TYPE))-&gt;buffer($bytes);</td></tr>
  <tr><td>45</td><td> header(<span class="codeString">"Content-Type: $contentType"</span>);</td></tr>
  <tr><td>46</td><td> echo $bytes;</td></tr>
  <tr><td>47</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>50</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>53</td><td>}</td></tr>
  <tr><td>54</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. srv / Bd.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">class</span> Bd</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeReserved">private</span> <span class="codeReserved">static</span> ?PDO $conexion = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> <span class="codeReserved">static</span> <span class="codeReserved">function</span> getConexion(): PDO</td></tr>
  <tr><td>9</td><td> {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>  <span class="codeReserved">if</span> (<span class="codeReserved">self</span>::$conexion === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>   <span class="codeReserved">self</span>::$conexion = <span class="codeReserved">new</span> PDO(</td></tr>
  <tr><td>14</td><td>    <span class="codeComment">// cadena de conexiÃ³n</span></td></tr>
  <tr><td>15</td><td>    <span class="codeString">"sqlite:srvarchivos.db"</span>,</td></tr>
  <tr><td>16</td><td>    <span class="codeComment">// usuario</span></td></tr>
  <tr><td>17</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>18</td><td>    <span class="codeComment">// contraseÃ±a</span></td></tr>
  <tr><td>19</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>20</td><td>    <span class="codeComment">// Opciones: conexiones persistentes y lanza excepciones.</span></td></tr>
  <tr><td>21</td><td>    [PDO::ATTR_PERSISTENT =&gt; <span class="codeReserved">true</span>, PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION]</td></tr>
  <tr><td>22</td><td>   );</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>25</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> ARCHIVO (</span></td></tr>
  <tr><td>26</td><td><span class="codeString">      ARCH_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>27</td><td><span class="codeString">      ARCH_BYTES <span class="codeReserved">BLOB</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>28</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> ARCH_PK</span></td></tr>
  <tr><td>29</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(ARCH_ID)</span></td></tr>
  <tr><td>30</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>31</td><td>   );</td></tr>
  <tr><td>32</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>33</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> PRODUCTO (</span></td></tr>
  <tr><td>34</td><td><span class="codeString">      PROD_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>35</td><td><span class="codeString">      PROD_NOMBRE <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>36</td><td><span class="codeString">      ARCH_ID <span class="codeReserved">INTEGER</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>37</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PROD_PK</span></td></tr>
  <tr><td>38</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(PROD_ID),</span></td></tr>
  <tr><td>39</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PROD_NOM_UNQ</span></td></tr>
  <tr><td>40</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(PROD_NOMBRE),</span></td></tr>
  <tr><td>41</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PROD_NOM_NV</span></td></tr>
  <tr><td>42</td><td><span class="codeString">       CHECK(LENGTH(PROD_NOMBRE) &gt; 0),</span></td></tr>
  <tr><td>43</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PROD_ARCH_FK</span></td></tr>
  <tr><td>44</td><td><span class="codeString">       <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (ARCH_ID) <span class="codeReserved">REFERENCES</span> ARCHIVO(ARCH_ID)</span></td></tr>
  <tr><td>45</td><td><span class="codeString">      )'</span></td></tr>
  <tr><td>46</td><td>   );</td></tr>
  <tr><td>47</td><td>  }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">self</span>::$conexion;</td></tr>
  <tr><td>50</td><td> }</td></tr>
  <tr><td>51</td><td>}</td></tr>
  <tr><td>52</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. srv / producto-agrega.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaBytes.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaNombre.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveCreated.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaImagen.php"</span>;</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>17</td><td> $bytes = recuperaBytes(<span class="codeString">"imagen"</span>);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> $nombre = validaNombre($nombre);</td></tr>
  <tr><td>20</td><td> $bytes = validaImagen($bytes);</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> <span class="codeReserved">if</span> ($bytes === <span class="codeString">""</span>) {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>25</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>26</td><td>   title: <span class="codeString">"Imagen vacÃ­a."</span>,</td></tr>
  <tr><td>27</td><td>   type: <span class="codeString">"/error/imagenvacia.html"</span>,</td></tr>
  <tr><td>28</td><td>   detail: <span class="codeString">"Selecciona un archivo que no estÃ© vacÃ­o."</span></td></tr>
  <tr><td>29</td><td>  );</td></tr>
  <tr><td>30</td><td> }</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>33</td><td> $conexion-&gt;beginTransaction();</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>36</td><td>  <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> ARCHIVO</span></td></tr>
  <tr><td>37</td><td><span class="codeString">     (ARCH_BYTES)</span></td></tr>
  <tr><td>38</td><td><span class="codeString">    <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>39</td><td><span class="codeString">     (:bytes)"</span></td></tr>
  <tr><td>40</td><td> )</td></tr>
  <tr><td>41</td><td>  -&gt;execute([<span class="codeString">":bytes"</span> =&gt; $bytes]);</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td> <span class="codeComment">/* Recupera el id generado. Si usas una secuencia, pasa como</span></td></tr>
  <tr><td>44</td><td><span class="codeComment">  * parÃ¡metro de lastInsertId el nombre de dicha secuencia y</span></td></tr>
  <tr><td>45</td><td><span class="codeComment">  * poner esta instrucciÃ³n antes del <span class="codeReserved">INSERT</span>, al cual se le</span></td></tr>
  <tr><td>46</td><td><span class="codeComment">  * pasarle el id generado. */</span></td></tr>
  <tr><td>47</td><td> $archId = $conexion-&gt;lastInsertId();</td></tr>
  <tr><td>48</td><td> $encodeArchId = urlencode($archId);</td></tr>
  <tr><td>49</td><td> $htmlEncodeArchId = htmlentities($encodeArchId);</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>52</td><td>  <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> PRODUCTO</span></td></tr>
  <tr><td>53</td><td><span class="codeString">    (PROD_NOMBRE, ARCH_ID)</span></td></tr>
  <tr><td>54</td><td><span class="codeString">   <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>55</td><td><span class="codeString">    (:nombre, :archId)"</span></td></tr>
  <tr><td>56</td><td> )</td></tr>
  <tr><td>57</td><td>  -&gt;execute([</td></tr>
  <tr><td>58</td><td>   <span class="codeString">":nombre"</span> =&gt; $nombre,</td></tr>
  <tr><td>59</td><td>   <span class="codeString">":archId"</span> =&gt; $archId</td></tr>
  <tr><td>60</td><td>  ]);</td></tr>
  <tr><td>61</td><td> $id = $conexion-&gt;lastInsertId();</td></tr>
  <tr><td>62</td><td> $encodeId = urlencode($id);</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td> $conexion-&gt;commit();</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td> <span class="codeComment">// Los bytes se descargan con &quot;archivo.php&quot;; no desde aquÃ­.</span></td></tr>
  <tr><td>67</td><td> devuelveCreated(<span class="codeString">"/srv/producto.php?id=$encodeId"</span>, [</td></tr>
  <tr><td>68</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $id],</td></tr>
  <tr><td>69</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $nombre],</td></tr>
  <tr><td>70</td><td>  <span class="codeString">"imagen"</span> =&gt; [<span class="codeString">"data-file"</span> =&gt; <span class="codeString">"srv/archivo.php?id=$htmlEncodeArchId"</span>]</td></tr>
  <tr><td>71</td><td> ]);</td></tr>
  <tr><td>72</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>73</td><td></td></tr>
  <tr><td>74</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>75</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>76</td><td></td></tr>
  <tr><td>77</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>78</td><td>}</td></tr>
  <tr><td>79</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. srv / producto-elimina.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveNoContent.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> $prodId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>16</td><td> $conexion-&gt;beginTransaction();</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $archId = fetch(</td></tr>
  <tr><td>19</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>20</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>21</td><td><span class="codeString">     A.ARCH_ID</span></td></tr>
  <tr><td>22</td><td><span class="codeString">    <span class="codeReserved">FROM</span> PRODUCTO P</span></td></tr>
  <tr><td>23</td><td><span class="codeString">     <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> ARCHIVO A</span></td></tr>
  <tr><td>24</td><td><span class="codeString">     <span class="codeReserved">ON</span> P.ARCH_ID = A.ARCH_ID</span></td></tr>
  <tr><td>25</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> P.PROD_ID = :prodId"</span></td></tr>
  <tr><td>26</td><td>  ),</td></tr>
  <tr><td>27</td><td>  [<span class="codeString">":prodId"</span> =&gt; $prodId],</td></tr>
  <tr><td>28</td><td>  PDO::FETCH_COLUMN</td></tr>
  <tr><td>29</td><td> );</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td> <span class="codeReserved">if</span> ($archId === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  <span class="codeComment">// No encontrÃ³ un producto con ese $prodId. Ya estÃ¡ borrado. </span></td></tr>
  <tr><td>34</td><td>  $conexioncon-&gt;rollBack();</td></tr>
  <tr><td>35</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  <span class="codeReserved">if</span> ($archId !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>38</td><td>   $conexion-&gt;prepare(</td></tr>
  <tr><td>39</td><td>    <span class="codeString">"<span class="codeReserved">DELETE</span> <span class="codeReserved">FROM</span> ARCHIVO</span></td></tr>
  <tr><td>40</td><td><span class="codeString">      <span class="codeReserved">WHERE</span> ARCH_ID = :archId"</span></td></tr>
  <tr><td>41</td><td>   )-&gt;execute([<span class="codeString">":archId"</span> =&gt; $archId]);</td></tr>
  <tr><td>42</td><td>  }</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>45</td><td>   <span class="codeString">"<span class="codeReserved">DELETE</span> <span class="codeReserved">FROM</span> PRODUCTO</span></td></tr>
  <tr><td>46</td><td><span class="codeString">     <span class="codeReserved">WHERE</span> PROD_ID = :prodId"</span></td></tr>
  <tr><td>47</td><td>  )</td></tr>
  <tr><td>48</td><td>   -&gt;execute([<span class="codeString">":prodId"</span> =&gt; $prodId]);</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>  $conexion-&gt;commit();</td></tr>
  <tr><td>51</td><td> }</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td> devuelveNoContent();</td></tr>
  <tr><td>54</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>57</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>60</td><td>}</td></tr>
  <tr><td>61</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. srv / producto-modifica.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaBytes.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaNombre.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>13</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>14</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaImagen.php"</span>;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $prodId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>19</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>20</td><td> $bytes = recuperaBytes(<span class="codeString">"imagen"</span>);</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> $nombre = validaNombre($nombre);</td></tr>
  <tr><td>23</td><td> $bytes = validaImagen($bytes);</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>26</td><td> $conexion-&gt;beginTransaction();</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td> $archId = fetch(</td></tr>
  <tr><td>29</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>30</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>31</td><td><span class="codeString">     A.ARCH_ID <span class="codeReserved">AS</span> archId</span></td></tr>
  <tr><td>32</td><td><span class="codeString">    <span class="codeReserved">FROM</span> PRODUCTO P</span></td></tr>
  <tr><td>33</td><td><span class="codeString">     <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> ARCHIVO A</span></td></tr>
  <tr><td>34</td><td><span class="codeString">     <span class="codeReserved">ON</span> P.ARCH_ID = A.ARCH_ID</span></td></tr>
  <tr><td>35</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> P.PROD_ID = :prodId"</span></td></tr>
  <tr><td>36</td><td>  ),</td></tr>
  <tr><td>37</td><td>  [<span class="codeString">":prodId"</span> =&gt; $prodId],</td></tr>
  <tr><td>38</td><td>  PDO::FETCH_COLUMN</td></tr>
  <tr><td>39</td><td> );</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td> <span class="codeReserved">if</span> ($archId === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  $prodIdHtml = htmlentities($prodId);</td></tr>
  <tr><td>44</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>45</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>46</td><td>   title: <span class="codeString">"Producto no encontrado."</span>,</td></tr>
  <tr><td>47</td><td>   type: <span class="codeString">"/error/productonoencontrado.html"</span>,</td></tr>
  <tr><td>48</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn producto con el id $prodIdHtml."</span>,</td></tr>
  <tr><td>49</td><td>  );</td></tr>
  <tr><td>50</td><td> }</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td> <span class="codeReserved">if</span> ($bytes !== <span class="codeString">""</span>) {</td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">if</span> ($archId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>   $conexion-&gt;prepare(</td></tr>
  <tr><td>57</td><td>    <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> ARCHIVO</span></td></tr>
  <tr><td>58</td><td><span class="codeString">       (ARCH_BYTES)</span></td></tr>
  <tr><td>59</td><td><span class="codeString">      <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>60</td><td><span class="codeString">       (:bytes)"</span></td></tr>
  <tr><td>61</td><td>   )</td></tr>
  <tr><td>62</td><td>    -&gt;execute([<span class="codeString">":bytes"</span> =&gt; $bytes]);</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeComment">/* Recupera el id generado. Si usas una secuencia, pasa como</span></td></tr>
  <tr><td>65</td><td><span class="codeComment">    * parÃ¡metro de lastInsertId el nombre de dicha secuencia y</span></td></tr>
  <tr><td>66</td><td><span class="codeComment">    * poner esta instrucciÃ³n antes del <span class="codeReserved">INSERT</span>, al cual se le</span></td></tr>
  <tr><td>67</td><td><span class="codeComment">    * pasarle el id generado. */</span></td></tr>
  <tr><td>68</td><td>   $archId = $conexion-&gt;lastInsertId();</td></tr>
  <tr><td>69</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td>   $conexion-&gt;prepare(</td></tr>
  <tr><td>72</td><td>    <span class="codeString">"<span class="codeReserved">UPDATE</span> ARCHIVO</span></td></tr>
  <tr><td>73</td><td><span class="codeString">     <span class="codeReserved">SET</span> ARCH_BYTES = :bytes</span></td></tr>
  <tr><td>74</td><td><span class="codeString">     <span class="codeReserved">WHERE</span> ARCH_ID = :archId"</span></td></tr>
  <tr><td>75</td><td>   )</td></tr>
  <tr><td>76</td><td>    -&gt;execute([</td></tr>
  <tr><td>77</td><td>     <span class="codeString">":bytes"</span> =&gt; $bytes,</td></tr>
  <tr><td>78</td><td>     <span class="codeString">":archId"</span> =&gt; $archId</td></tr>
  <tr><td>79</td><td>    ]);</td></tr>
  <tr><td>80</td><td>  }</td></tr>
  <tr><td>81</td><td> }</td></tr>
  <tr><td>82</td><td></td></tr>
  <tr><td>83</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>84</td><td>  <span class="codeString">"<span class="codeReserved">UPDATE</span> PRODUCTO</span></td></tr>
  <tr><td>85</td><td><span class="codeString">   <span class="codeReserved">SET</span></span></td></tr>
  <tr><td>86</td><td><span class="codeString">    PROD_NOMBRE = :nombre,</span></td></tr>
  <tr><td>87</td><td><span class="codeString">    ARCH_ID = :archId</span></td></tr>
  <tr><td>88</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> PROD_ID = :prodId"</span></td></tr>
  <tr><td>89</td><td> )</td></tr>
  <tr><td>90</td><td>  -&gt;execute([</td></tr>
  <tr><td>91</td><td>   <span class="codeString">":prodId"</span> =&gt; $prodId,</td></tr>
  <tr><td>92</td><td>   <span class="codeString">":nombre"</span> =&gt; $nombre,</td></tr>
  <tr><td>93</td><td>   <span class="codeString">":archId"</span> =&gt; $archId</td></tr>
  <tr><td>94</td><td>  ]);</td></tr>
  <tr><td>95</td><td></td></tr>
  <tr><td>96</td><td> $conexion-&gt;commit();</td></tr>
  <tr><td>97</td><td></td></tr>
  <tr><td>98</td><td> $encodeArchId = $archId === <span class="codeReserved">null</span> ? <span class="codeString">""</span> : urlencode($archId);</td></tr>
  <tr><td>99</td><td> $htmlEncodeArchId = htmlentities($encodeArchId);</td></tr>
  <tr><td>100</td><td></td></tr>
  <tr><td>101</td><td> <span class="codeComment">// Los bytes se descargan con &quot;archivo.php&quot;; no desde aquÃ­.</span></td></tr>
  <tr><td>102</td><td> devuelveJson([</td></tr>
  <tr><td>103</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $prodId],</td></tr>
  <tr><td>104</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $nombre],</td></tr>
  <tr><td>105</td><td>  <span class="codeString">"imagen"</span> =&gt; [</td></tr>
  <tr><td>106</td><td>   <span class="codeString">"data-file"</span> =&gt; $htmlEncodeArchId === <span class="codeString">""</span></td></tr>
  <tr><td>107</td><td>    ? <span class="codeString">""</span></td></tr>
  <tr><td>108</td><td>    : <span class="codeString">"srv/archivo.php?id=$htmlEncodeArchId"</span></td></tr>
  <tr><td>109</td><td>  ]</td></tr>
  <tr><td>110</td><td> ]);</td></tr>
  <tr><td>111</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>114</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>115</td><td></td></tr>
  <tr><td>116</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>117</td><td>}</td></tr>
  <tr><td>118</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. srv / producto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> $prodId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $modelo = fetch(</td></tr>
  <tr><td>19</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>20</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>21</td><td><span class="codeString">     P.PROD_NOMBRE <span class="codeReserved">AS</span> prodNombre,</span></td></tr>
  <tr><td>22</td><td><span class="codeString">     A.ARCH_ID <span class="codeReserved">AS</span> archId</span></td></tr>
  <tr><td>23</td><td><span class="codeString">    <span class="codeReserved">FROM</span> PRODUCTO P</span></td></tr>
  <tr><td>24</td><td><span class="codeString">     <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> ARCHIVO A</span></td></tr>
  <tr><td>25</td><td><span class="codeString">     <span class="codeReserved">ON</span> P.ARCH_ID = A.ARCH_ID</span></td></tr>
  <tr><td>26</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> P.PROD_ID = :prodId"</span></td></tr>
  <tr><td>27</td><td>  ),</td></tr>
  <tr><td>28</td><td>  [<span class="codeString">":prodId"</span> =&gt; $prodId]</td></tr>
  <tr><td>29</td><td> );</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td> <span class="codeReserved">if</span> ($modelo === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  $prodIdHtml = htmlentities($prodId);</td></tr>
  <tr><td>34</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>35</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>36</td><td>   title: <span class="codeString">"Producto no encontrado."</span>,</td></tr>
  <tr><td>37</td><td>   type: <span class="codeString">"/error/productonoencontrado.html"</span>,</td></tr>
  <tr><td>38</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn producto con el id $prodIdHtml."</span>,</td></tr>
  <tr><td>39</td><td>  );</td></tr>
  <tr><td>40</td><td> }</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td> $encodeArchId = $modelo-&gt;archId === <span class="codeReserved">null</span> ? <span class="codeString">""</span> : urlencode($modelo-&gt;archId);</td></tr>
  <tr><td>43</td><td> $htmlEncodeArchId = htmlentities($encodeArchId);</td></tr>
  <tr><td>44</td><td> devuelveJson([</td></tr>
  <tr><td>45</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $prodId],</td></tr>
  <tr><td>46</td><td>  <span class="codeString">"nombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $modelo-&gt;prodNombre],</td></tr>
  <tr><td>47</td><td>  <span class="codeString">"imagen"</span> =&gt; [</td></tr>
  <tr><td>48</td><td>   <span class="codeString">"data-file"</span> =&gt; $htmlEncodeArchId === <span class="codeString">""</span></td></tr>
  <tr><td>49</td><td>    ? <span class="codeString">""</span></td></tr>
  <tr><td>50</td><td>    : <span class="codeString">"srv/archivo.php?id=$htmlEncodeArchId"</span></td></tr>
  <tr><td>51</td><td>  ]</td></tr>
  <tr><td>52</td><td> ]);</td></tr>
  <tr><td>53</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>56</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>59</td><td>}</td></tr>
  <tr><td>60</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. srv / productos.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>13</td><td> $lista = fetchAll($conexion-&gt;query(</td></tr>
  <tr><td>14</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>15</td><td><span class="codeString">    P.PROD_ID <span class="codeReserved">AS</span> prodId,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    P.PROD_NOMBRE <span class="codeReserved">AS</span> prodNombre,</span></td></tr>
  <tr><td>17</td><td><span class="codeString">    A.ARCH_ID <span class="codeReserved">AS</span> archId</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   <span class="codeReserved">FROM</span> PRODUCTO P</span></td></tr>
  <tr><td>19</td><td><span class="codeString">    <span class="codeReserved">LEFT</span> <span class="codeReserved">JOIN</span> ARCHIVO A</span></td></tr>
  <tr><td>20</td><td><span class="codeString">    <span class="codeReserved">ON</span> P.ARCH_ID = A.ARCH_ID</span></td></tr>
  <tr><td>21</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> P.PROD_NOMBRE"</span></td></tr>
  <tr><td>22</td><td> ));</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td> $render = <span class="codeString">""</span>;</td></tr>
  <tr><td>25</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>26</td><td>  $prodId = htmlentities($modelo-&gt;prodId);</td></tr>
  <tr><td>27</td><td>  $prodNombre = htmlentities($modelo-&gt;prodNombre);</td></tr>
  <tr><td>28</td><td>  $encodeArchId = $modelo-&gt;archId === <span class="codeReserved">null</span> ? <span class="codeString">""</span> : urlencode($modelo-&gt;archId);</td></tr>
  <tr><td>29</td><td>  $archId = $encodeArchId === <span class="codeString">""</span> ? <span class="codeString">""</span> : htmlentities($encodeArchId);</td></tr>
  <tr><td>30</td><td>  $src = $archId === <span class="codeString">""</span> ? <span class="codeString">""</span> : <span class="codeString">"srv/archivo.php?id=$archId"</span>;</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>  $render .=</td></tr>
  <tr><td>33</td><td>   <span class="codeString">"&lt;<span class="codeReserved">div</span> style=&#039;<span class="codeReserved">display</span>: <span class="codeReserved">flex</span>; <span class="codeReserved">flex-direction</span>: row-reverse;</span></td></tr>
  <tr><td>34</td><td><span class="codeString">      <span class="codeReserved">align-items</span>: center; <span class="codeReserved">gap</span>: 0.5rem&#039;&gt;</span></td></tr>
  <tr><td>35</td><td><span class="codeString">     &lt;<span class="codeReserved">dt</span> style=&#039;<span class="codeReserved">flex</span>: 1 1 0&#039;&gt;</span></td></tr>
  <tr><td>36</td><td><span class="codeString">      &lt;<span class="codeReserved">a</span> href=&#039;modifica.html?id=$prodId&#039;&gt;$prodNombre&lt;/<span class="codeReserved">a</span>&gt;</span></td></tr>
  <tr><td>37</td><td><span class="codeString">     &lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>38</td><td><span class="codeString">     &lt;<span class="codeReserved">dd</span> style=&#039;<span class="codeReserved">flex</span>: 1 1 0; <span class="codeReserved">margin</span>: 0&#039;&gt;</span></td></tr>
  <tr><td>39</td><td><span class="codeString">      &lt;<span class="codeReserved">a</span> href=&#039;modifica.html?id=$prodId&#039;&gt;&lt;<span class="codeReserved">img</span> style=&#039;<span class="codeReserved">width</span>: 100%&#039;</span></td></tr>
  <tr><td>40</td><td><span class="codeString">        alt=&#039;Imagen del producto&#039; <span class="codeReserved">src</span>=&#039;$src&#039;&gt;&lt;/<span class="codeReserved">a</span>&gt;</span></td></tr>
  <tr><td>41</td><td><span class="codeString">     &lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>42</td><td><span class="codeString">    &lt;/<span class="codeReserved">div</span>&gt;"</span>;</td></tr>
  <tr><td>43</td><td> }</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td> devuelveJson([<span class="codeString">"lista"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>46</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>49</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>52</td><td>}</td></tr>
  <tr><td>53</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. srv / validaImagen.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaImagen(<span class="codeReserved">false</span>|string $bytes)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($bytes === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>12</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>13</td><td>   title: <span class="codeString">"Falta la imagen."</span>,</td></tr>
  <tr><td>14</td><td>   type: <span class="codeString">"/error/faltaimagen.html"</span>,</td></tr>
  <tr><td>15</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de imagen."</span></td></tr>
  <tr><td>16</td><td>  );</td></tr>
  <tr><td>17</td><td> }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">return</span> $bytes;</td></tr>
  <tr><td>20</td><td>}</td></tr>
  <tr><td>21</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >K. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-js/m-muestraImagenSeleccionada-js.html">lib / js / muestraImagenSeleccionada.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-js/m-muestraObjeto-js.html">lib / js / muestraObjeto.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraImagenSeleccionada.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { getImgParaElementoHtml } <span class="codeReserved">from</span> <span class="codeString">"./muestraObjeto.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {HTMLInputElement} input</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>7</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraImagenSeleccionada(raizHtml, input) {</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">return</span> <span class="codeReserved">new</span> Promise((resolve, reject) =&gt; {</td></tr>
  <tr><td>9</td><td>  setTimeout(() =&gt; {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>12</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>13</td><td>    <span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>     <span class="codeReserved">const</span> dataUrl = getDataUrlDeSeleccion(input)</td></tr>
  <tr><td>16</td><td>     <span class="codeReserved">if</span> (dataUrl === <span class="codeString">""</span>) {</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>      <span class="codeReserved">const</span> file = input.dataset.file</td></tr>
  <tr><td>19</td><td>      <span class="codeReserved">if</span> (file === undefined || file === <span class="codeString">""</span>) {</td></tr>
  <tr><td>20</td><td>       img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>21</td><td>       img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>22</td><td>      } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td>       img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>24</td><td>       img.<span class="codeReserved">src</span> = file</td></tr>
  <tr><td>25</td><td>      }</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td>     } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>      img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>30</td><td>      img.<span class="codeReserved">src</span> = dataUrl</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>     }</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>     resolve(<span class="codeReserved">true</span>)</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td>    } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>     reject(error)</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td>    }</td></tr>
  <tr><td>43</td><td>   }</td></tr>
  <tr><td>44</td><td></td></tr>
  <tr><td>45</td><td>  },</td></tr>
  <tr><td>46</td><td>   500)</td></tr>
  <tr><td>47</td><td> })</td></tr>
  <tr><td>48</td><td>}</td></tr>
  <tr><td>49</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>50</td><td>window[<span class="codeString">"muestraImagenSeleccionada"</span>] = muestraImagenSeleccionada</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>53</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {HTMLInputElement} input</span></td></tr>
  <tr><td>54</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>55</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getDataUrlDeSeleccion(input) {</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> seleccion = getArchivoSeleccionado(input)</td></tr>
  <tr><td>57</td><td> <span class="codeReserved">if</span> (seleccion === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>58</td><td>  <span class="codeReserved">return</span> <span class="codeString">""</span></td></tr>
  <tr><td>59</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">return</span> URL.createObjectURL(seleccion)</td></tr>
  <tr><td>61</td><td> }</td></tr>
  <tr><td>62</td><td>}</td></tr>
  <tr><td>63</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>64</td><td>window[<span class="codeString">"getDataUrlDeSeleccion"</span>] = getDataUrlDeSeleccion</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td></td></tr>
  <tr><td>67</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>68</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>69</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>70</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getArchivoSeleccionado(input) {</td></tr>
  <tr><td>71</td><td> <span class="codeReserved">const</span> seleccion = input.files</td></tr>
  <tr><td>72</td><td> <span class="codeReserved">if</span> (seleccion === <span class="codeReserved">null</span> || seleccion.length === 0) {</td></tr>
  <tr><td>73</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>74</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">return</span> seleccion.item(0)</td></tr>
  <tr><td>76</td><td> }</td></tr>
  <tr><td>77</td><td>}</td></tr>
  <tr><td>78</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>79</td><td>window[<span class="codeString">"getArchivoSeleccionado"</span>] = getArchivoSeleccionado</td></tr>
  <tr><td>80</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / muestraObjeto.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraObjeto(raizHtml, objeto) {</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [nombre, definiciones] of Object.entries(objeto)) {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">if</span> (Array.isArray(definiciones)) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   muestraArray(raizHtml, nombre, definiciones)</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (definiciones !== undefined && definiciones !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">const</span> elementoHtml = buscaElementoHtml(raizHtml, nombre)</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (elementoHtml <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>    muestraInput(raizHtml, elementoHtml, definiciones)</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>   } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (elementoHtml !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> elementoHtml) {</td></tr>
  <tr><td>25</td><td>      elementoHtml[atributo] = valor</td></tr>
  <tr><td>26</td><td>     }</td></tr>
  <tr><td>27</td><td>    }</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>   }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>window[<span class="codeString">"muestraObjeto"</span>] = muestraObjeto</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } nombre</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>43</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> buscaElementoHtml(raizHtml, nombre) {</td></tr>
  <tr><td>44</td><td> <span class="codeReserved">return</span> raizHtml.querySelector(</td></tr>
  <tr><td>45</td><td>  <span class="codeString">`#${nombre},[name=&quot;${nombre}&quot;],[data-name=&quot;${nombre}&quot;]`</span>)</td></tr>
  <tr><td>46</td><td>}</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } propiedad</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {any[]} valores</span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>53</td><td><span class="codeReserved">function</span> muestraArray(raizHtml, propiedad, valores) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> <span class="codeReserved">const</span> conjunto = <span class="codeReserved">new</span> Set(valores)</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> elementos =</td></tr>
  <tr><td>57</td><td>  raizHtml.querySelectorAll(<span class="codeString">`[name=&quot;${propiedad}&quot;],[data-name=&quot;${propiedad}&quot;]`</span>)</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> <span class="codeReserved">if</span> (elementos.length === 1) {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">const</span> elemento = elementos[0]</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLSelectElement) {</td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">const</span> options = elemento.options</td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = options.length; i &lt; len; i++) {</td></tr>
  <tr><td>65</td><td>    <span class="codeReserved">const</span> option = options[i]</td></tr>
  <tr><td>66</td><td>    option.selected = conjunto.has(option.value)</td></tr>
  <tr><td>67</td><td>   }</td></tr>
  <tr><td>68</td><td>   <span class="codeReserved">return</span></td></tr>
  <tr><td>69</td><td>  }</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td> }</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = elementos.length; i &lt; len; i++) {</td></tr>
  <tr><td>74</td><td>  <span class="codeReserved">const</span> elemento = elementos[i]</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>76</td><td>   elemento.checked = conjunto.has(elemento.value)</td></tr>
  <tr><td>77</td><td>  }</td></tr>
  <tr><td>78</td><td> }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>}</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>83</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>84</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>85</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } definiciones</span></td></tr>
  <tr><td>86</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>87</td><td><span class="codeReserved">function</span> muestraInput(raizHtml, input, definiciones) {</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>  <span class="codeReserved">if</span> (atributo == <span class="codeString">"data-file"</span>) {</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>95</td><td>    input.dataset.file = valor</td></tr>
  <tr><td>96</td><td>    input.value = <span class="codeString">""</span></td></tr>
  <tr><td>97</td><td>    <span class="codeReserved">if</span> (valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>98</td><td>     img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>99</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>100</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>101</td><td>     img.<span class="codeReserved">src</span> = valor</td></tr>
  <tr><td>102</td><td>     img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>103</td><td>    }</td></tr>
  <tr><td>104</td><td>   }</td></tr>
  <tr><td>105</td><td></td></tr>
  <tr><td>106</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> input) {</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>   input[atributo] = valor</td></tr>
  <tr><td>109</td><td></td></tr>
  <tr><td>110</td><td>  }</td></tr>
  <tr><td>111</td><td> }</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td>}</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>116</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>117</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLElement } elementoHtml</span></td></tr>
  <tr><td>118</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>119</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getImgParaElementoHtml(raizHtml, elementoHtml) {</td></tr>
  <tr><td>120</td><td> <span class="codeReserved">const</span> imgId = elementoHtml.getAttribute(<span class="codeString">"data-img"</span>)</td></tr>
  <tr><td>121</td><td> <span class="codeReserved">if</span> (imgId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>122</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>123</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>124</td><td>  <span class="codeReserved">const</span> input = buscaElementoHtml(raizHtml, imgId)</td></tr>
  <tr><td>125</td><td>  <span class="codeReserved">if</span> (input <span class="codeReserved">instanceof</span> HTMLImageElement) {</td></tr>
  <tr><td>126</td><td>   <span class="codeReserved">return</span> input</td></tr>
  <tr><td>127</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>128</td><td>   <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>129</td><td>  }</td></tr>
  <tr><td>130</td><td> }</td></tr>
  <tr><td>131</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-devuelveCreated-php.html">lib / php / devuelveCreated.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-devuelveNoContent-php.html">lib / php / devuelveNoContent.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-fetch-php.html">lib / php / fetch.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-fetchAll-php.html">lib / php / fetchAll.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-NOT_FOUND-php.html">lib / php / NOT_FOUND.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-recuperaBytes-php.html">lib / php / recuperaBytes.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-recuperaEntero-php.html">lib / php / recuperaEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-recuperaIdEntero-php.html">lib / php / recuperaIdEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-lib/m-php/m-validaNombre-php.html">lib / php / validaNombre.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveCreated.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveCreated($urlDelNuevo, $resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(201);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Location: {$urlDelNuevo}"</span>);</td></tr>
  <tr><td>17</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>18</td><td>  echo $json;</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td>}</td></tr>
  <tr><td>21</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveNoContent.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> devuelveNoContent()</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> http_response_code(204);</td></tr>
  <tr><td>6</td><td>}</td></tr>
  <tr><td>7</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / fetch.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetch(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">if</span> ($opcional === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>20</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch($mode);</td></tr>
  <tr><td>21</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>22</td><td>   $statement-&gt;setFetchMode($mode, $opcional);</td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch();</td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >9. lib / php / fetchAll.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetchAll(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>): array {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  $resultado = $opcional === <span class="codeReserved">null</span></td></tr>
  <tr><td>20</td><td>   ? $statement-&gt;fetchAll($mode)</td></tr>
  <tr><td>21</td><td>   : $statement-&gt;fetchAll($mode, $opcional);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">if</span> ($resultado === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>25</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">return</span> $resultado;</td></tr>
  <tr><td>27</td><td>  }</td></tr>
  <tr><td>28</td><td> }</td></tr>
  <tr><td>29</td><td>}</td></tr>
  <tr><td>30</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >10. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >11. lib / php / NOT_FOUND.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> NOT_FOUND = 404;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >12. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >13. lib / php / recuperaBytes.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td>use <span class="codeReserved">function</span> PHPSTORM_META\type;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaBytes(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeReserved">if</span> (isset($_FILES[$parametro])) {</td></tr>
  <tr><td>12</td><td>  $path = $_FILES[$parametro][<span class="codeString">"tmp_name"</span>];</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">if</span> ($path === <span class="codeString">""</span>) {</td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">return</span> <span class="codeString">""</span>;</td></tr>
  <tr><td>16</td><td>  } <span class="codeReserved">elseif</span> (is_uploaded_file($path)) {</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>   $contents = file_get_contents($path);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td>   <span class="codeReserved">if</span> ($contents === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>    <span class="codeReserved">switch</span> ($_FILES[$parametro][<span class="codeString">'error'</span>]) {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_OK:</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>      <span class="codeReserved">return</span> $contents;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_INI_SIZE:</td></tr>
  <tr><td>29</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_FORM_SIZE:</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>      <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>32</td><td>       status: BAD_REQUEST,</td></tr>
  <tr><td>33</td><td>       title: <span class="codeString">"Archivo demasiado largo."</span>,</td></tr>
  <tr><td>34</td><td>       type: <span class="codeString">"/error/archivodemasiadolargo.html"</span>,</td></tr>
  <tr><td>35</td><td>       detail: <span class="codeString">"El archivo "</span> - $parametro .</td></tr>
  <tr><td>36</td><td>        <span class="codeString">" excede el tamaÃ±o mÃ¡ximo que el servidor puede recibir."</span></td></tr>
  <tr><td>37</td><td>      );</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_PARTIAL:</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>      <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>42</td><td>       status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>43</td><td>       title: <span class="codeString">"Carga incompleta de archivo."</span>,</td></tr>
  <tr><td>44</td><td>       type: <span class="codeString">"/error/archivocargaincompleta.html"</span>,</td></tr>
  <tr><td>45</td><td>       detail: <span class="codeString">"Por una razÃ³n desconocida, el archivo "</span> - $parametro .</td></tr>
  <tr><td>46</td><td>        <span class="codeString">" no se cargÃ³ completamente."</span></td></tr>
  <tr><td>47</td><td>      );</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_NO_FILE:</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td>      <span class="codeReserved">throw</span> creaArchivoNoEnviado($parametro);</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_NO_TMP_DIR:</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>      <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>56</td><td>       status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>57</td><td>       title: <span class="codeString">"Falta la carpeta temporal."</span>,</td></tr>
  <tr><td>58</td><td>       type: <span class="codeString">"/error/faltacarpetatemporal.html"</span>,</td></tr>
  <tr><td>59</td><td>       detail: <span class="codeString">"Por una razÃ³n desconocida, falta la carpeta temporal "</span> .</td></tr>
  <tr><td>60</td><td>        <span class="codeString">"para cargar el archivo $parametro."</span>,</td></tr>
  <tr><td>61</td><td>      );</td></tr>
  <tr><td>62</td><td></td></tr>
  <tr><td>63</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_CANT_WRITE:</td></tr>
  <tr><td>64</td><td></td></tr>
  <tr><td>65</td><td>      <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>66</td><td>       status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>67</td><td>       title: <span class="codeString">"El archivo no se guardÃ³."</span>,</td></tr>
  <tr><td>68</td><td>       type: <span class="codeString">"/error/archivonoguardado.html"</span>,</td></tr>
  <tr><td>69</td><td>       detail: <span class="codeString">"Por una razÃ³n desconocida, el archivo "</span> - $parametro .</td></tr>
  <tr><td>70</td><td>        <span class="codeString">" no se pudo guardar en disco."</span>,</td></tr>
  <tr><td>71</td><td>      );</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>     <span class="codeReserved">case</span> UPLOAD_ERR_EXTENSION:</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>      <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>76</td><td>       status: BAD_REQUEST,</td></tr>
  <tr><td>77</td><td>       title: <span class="codeString">"ExtensiÃ³n no permitida."</span>,</td></tr>
  <tr><td>78</td><td>       type: <span class="codeString">"/error/extensionprohibida.html"</span>,</td></tr>
  <tr><td>79</td><td>       detail: <span class="codeString">"La extensiÃ³n del archivo "</span> - $parametro .</td></tr>
  <tr><td>80</td><td>        <span class="codeString">" no estÃ¡ permitida en el servidor."</span></td></tr>
  <tr><td>81</td><td>      );</td></tr>
  <tr><td>82</td><td></td></tr>
  <tr><td>83</td><td>     <span class="codeReserved">default</span>:</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>      <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Exception(<span class="codeString">"Error no identificado recuperando el archivo "</span> .</td></tr>
  <tr><td>86</td><td>       $parametro . <span class="codeString">"."</span>);</td></tr>
  <tr><td>87</td><td>    }</td></tr>
  <tr><td>88</td><td>   } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>89</td><td></td></tr>
  <tr><td>90</td><td>    <span class="codeReserved">return</span> $contents;</td></tr>
  <tr><td>91</td><td>   }</td></tr>
  <tr><td>92</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>93</td><td></td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">throw</span> creaArchivoNoEnviado($parametro);</td></tr>
  <tr><td>95</td><td>  }</td></tr>
  <tr><td>96</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>97</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>98</td><td> }</td></tr>
  <tr><td>99</td><td>}</td></tr>
  <tr><td>100</td><td></td></tr>
  <tr><td>101</td><td><span class="codeReserved">function</span> creaArchivoNoEnviado(string $parametro)</td></tr>
  <tr><td>102</td><td>{</td></tr>
  <tr><td>103</td><td> <span class="codeReserved">return</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>104</td><td>  status: BAD_REQUEST,</td></tr>
  <tr><td>105</td><td>  title: <span class="codeString">"Archivo no enviado."</span>,</td></tr>
  <tr><td>106</td><td>  type: <span class="codeString">"/error/archivonoenviado.html"</span>,</td></tr>
  <tr><td>107</td><td>  detail: <span class="codeString">"El archivo $parametro no fuÃ© recibido por el servidor."</span></td></tr>
  <tr><td>108</td><td> );</td></tr>
  <tr><td>109</td><td>}</td></tr>
  <tr><td>110</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >14. lib / php / recuperaEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * Devuelve el valor entero de un parÃ¡metro recibido en el</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuekve <span class="codeReserved">false</span></span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> * Si se recibe una cadena vacÃ­a, se devuelve <span class="codeReserved">null</span>.</span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> * Si parÃ¡metro no se puede convertir a entero, se genera</span></td></tr>
  <tr><td>14</td><td><span class="codeComment"> * un error.</span></td></tr>
  <tr><td>15</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>16</td><td><span class="codeReserved">function</span> recuperaEntero(string $parametro): <span class="codeReserved">false</span>|<span class="codeReserved">null</span>|<span class="codeReserved">int</span></td></tr>
  <tr><td>17</td><td>{</td></tr>
  <tr><td>18</td><td> $valor = recuperaTexto($parametro);</td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($valor === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>21</td><td> } <span class="codeReserved">elseif</span> ($valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span>;</td></tr>
  <tr><td>23</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">return</span> (<span class="codeReserved">int</span>) trim($valor);</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >15. lib / php / recuperaIdEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> recuperaIdEntero(string $parametro): <span class="codeReserved">int</span></td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> $id = recuperaEntero($parametro);</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>14</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>15</td><td>   title: <span class="codeString">"Falta el id."</span>,</td></tr>
  <tr><td>16</td><td>   type: <span class="codeString">"/error/faltaid.html"</span>,</td></tr>
  <tr><td>17</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de id."</span>,</td></tr>
  <tr><td>18</td><td>  );</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">null</span>)</td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>22</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>23</td><td>   title: <span class="codeString">"Id en blanco."</span>,</td></tr>
  <tr><td>24</td><td>   type: <span class="codeString">"/error/idenblanco.html"</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $id;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >16. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >17. lib / php / validaNombre.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaNombre(<span class="codeReserved">false</span>|string $nombre)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($nombre === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>11</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>12</td><td>   title: <span class="codeString">"Falta el nombre."</span>,</td></tr>
  <tr><td>13</td><td>   type: <span class="codeString">"/error/faltanombre.html"</span>,</td></tr>
  <tr><td>14</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de nombre."</span></td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $trimNombre = trim($nombre);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($trimNombre === <span class="codeString">""</span>)</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>21</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>22</td><td>   title: <span class="codeString">"Nombre en blanco."</span>,</td></tr>
  <tr><td>23</td><td>   type: <span class="codeString">"/error/nombreenblanco.html"</span>,</td></tr>
  <tr><td>24</td><td>   detail: <span class="codeString">"Pon texto en el campo nombre."</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $trimNombre;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >L. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m20archivos/m-error/m-archivocargaincompleta-html.html">error / archivocargaincompleta.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-archivodemasiadolargo-html.html">error / archivodemasiadolargo.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-archivonoenviado-html.html">error / archivonoenviado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-archivonoguardado-html.html">error / archivonoguardado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-extensionprohibida-html.html">error / extensionprohibida.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-faltacarpetatemporal-html.html">error / faltacarpetatemporal.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-faltaid-html.html">error / faltaid.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-faltaimagen-html.html">error / faltaimagen.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-faltanombre-html.html">error / faltanombre.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-idenblanco-html.html">error / idenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-imagenvacia-html.html">error / imagenvacia.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-nombreenblanco-html.html">error / nombreenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-productonoencontrado-html.html">error / productonoencontrado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m20archivos/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / archivocargaincompleta.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Carga incompleta de archivo&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Carga incompleta de archivo&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Por una razÃ³n desconocida, un archivo no se cargÃ³ completamente.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / archivodemasiadolargo.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Archivo demasiado largo&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Archivo demasiado largo&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Un archivo excede el tamaÃ±o mÃ¡ximo que el servidor puede recibir.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / archivonoenviado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Archivo no enviado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Archivo no enviado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Un archivo no fuÃ© recibido por el servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / archivonoguardado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El archivo no se guardÃ³&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El archivo no se guardÃ³&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Por una razÃ³n desconocida, un archivo no se pudo guardar en disco.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. error / extensionprohibida.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;ExtensiÃ³n no permitida&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;ExtensiÃ³n no permitida&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La extensiÃ³n de un archivo no estÃ¡ permitida en el servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. error / faltacarpetatemporal.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta la carpeta temporal&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta la carpeta temporal&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Por una razÃ³n desconocida, falta la carpeta temporal para cargar archivos.</td></tr>
  <tr><td>19</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. error / faltaid.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el id&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el id&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de id.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. error / faltaimagen.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta la imagen&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta la imagen&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de imagen.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. error / faltanombre.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el nombre&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el nombre&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >K. error / idenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Id en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Id en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >L. error / imagenvacia.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Imagen vacÃ­a&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Imagen vacÃ­a&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Selecciona un archivo que no estÃ© vacÃ­o.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >M. error / nombreenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon texto en el campo nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. error / productonoencontrado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Producto no encontrado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Producto no encontrado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ningÃºn producto con el id solicitado.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >O. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >M. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ el almacenamiento de un archivo por registro de
    la base de datos, usando servicios.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >24. Compras sencillas</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m21compras/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/mBder.html">Diagrama entidad relaciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/mBrel.html">Diagrama relacional</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/mCdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-agrega-html.html">agrega.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-carrito-html.html">carrito.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-modifica-html.html">modifica.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se muestra la base de una aplicaciÃ³n que vende o compra.
   </p>
  </li>
  <li>
   <p>
    Para poder manejar compras en lÃ­nea, es necesario que la venta incluya la
    referencia al cliente.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvcompras.rf.gd/" rel="noreferrer"
      target="_blank">http://srvcompras.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama entidad relaciÃ³n</h1><figure>
 <img style="max-height: none;"
   src="/img/m21compras/comprasder.drawio.svg"
   alt="Diagrama entidad relaciÃ³n">
</figure>
      </section>
     <section >
         <h1 >C. Diagrama relacional</h1><figure>
 <img style="max-height: none;"
   src="/img/m21compras/comprasrel.drawio.svg"
   alt="Diagrama relacional">
</figure>
      </section>
     <section >
         <h1 >D. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m21compras/comprasdeploy.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >E. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvcompras.rf.gd/" rel="noreferrer"
      target="_blank">http://srvcompras.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvcompras.zip" download>/src/srvcompras.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >F. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-agrega-html.html">agrega.html</a></p>
  </li>
  <li>
   <p><a href="m-carrito-html.html">carrito.html</a></p>
  </li>
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <p><a href="m-modifica-html.html">modifica.html</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-cantidadenblanco-html.html">cantidadenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-cantidadincorrecta-html.html">cantidadincorrecta.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-detalledeventaincorrecto-html.html">detalledeventaincorrecto.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-detalledeventanoencontrado-html.html">detalledeventanoencontrado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-existenciasincorrectas-html.html">existenciasincorrectas.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltacantidad-html.html">faltacantidad.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltaid-html.html">faltaid.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltanombre-html.html">faltanombre.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-idenblanco-html.html">idenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-nombreenblanco-html.html">nombreenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-precioincorrecto-html.html">precioincorrecto.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-productonoencontrado-html.html">productonoencontrado.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-ventaencapturanoencontrada-html.html">ventaencapturanoencontrada.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraObjeto-js.html">muestraObjeto.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveCreated-php.html">devuelveCreated.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveNoContent-php.html">devuelveNoContent.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetch-php.html">fetch.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-fetchAll-php.html">fetchAll.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-NOT_FOUND-php.html">NOT_FOUND.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaArray-php.html">recuperaArray.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaDecimal-php.html">recuperaDecimal.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaEntero-php.html">recuperaEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaIdEntero-php.html">recuperaIdEntero.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-Bd-php.html">Bd.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-det-venta-agrega-php.html">det-venta-agrega.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-det-venta-elimina-php.html">det-venta-elimina.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-det-venta-modifica-php.html">det-venta-modifica.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-det-venta-php.html">det-venta.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-detVentaConsulta-php.html">detVentaConsulta.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-producto-php.html">producto.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-productoBusca-php.html">productoBusca.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-productos-php.html">productos.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-validaCantidad-php.html">validaCantidad.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-validaProducto-php.html">validaProducto.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-validaVenta-php.html">validaVenta.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-venta-en-captura-procesa-php.html">venta-en-captura-procesa.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-venta-en-captura-php.html">venta-en-captura.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-ventaEnCapturaBusca-php.html">ventaEnCapturaBusca.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >G. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Productos&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/productos.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   .then(render =&gt; muestraObjeto(document, render.body))</span></td></tr>
  <tr><td>19</td><td><span class="codeString">   .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">h1</span>&gt;Productos&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"carrito.html"</span>&gt;Ver carrito&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> &lt;<span class="codeReserved">dl</span> id=<span class="codeString">"lista"</span>&gt;</td></tr>
  <tr><td>26</td><td>  &lt;<span class="codeReserved">dt</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">dt</span>&gt;</td></tr>
  <tr><td>27</td><td>  &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;</td></tr>
  <tr><td>28</td><td> &lt;/<span class="codeReserved">dl</span>&gt;</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. agrega.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Agregar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">// Obtiene los parÃ¡metros de la pÃ¡gina.</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">const</span> params = <span class="codeReserved">new</span> URL(location.href).searchParams</td></tr>
  <tr><td>19</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"<span class="codeReserved">if</span> (params.size &gt; 0) {</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   consumeJson(&#039;srv/producto.php?&#039; + params)</span></td></tr>
  <tr><td>25</td><td><span class="codeString">    .then(producto =&gt; muestraObjeto(document, producto.body))</span></td></tr>
  <tr><td>26</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>27</td><td><span class="codeString">  }"</span>&gt;</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/det-venta-agrega.php&#039;, event)</span></td></tr>
  <tr><td>30</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>31</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Agregar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">input</span> type=<span class="codeString">"hidden"</span> name=<span class="codeString">"id"</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>40</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>41</td><td>    Producto</td></tr>
  <tr><td>42</td><td>    &lt;<span class="codeReserved">output</span> name=<span class="codeString">"producto"</span>&gt;</td></tr>
  <tr><td>43</td><td>     &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>44</td><td>    &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>45</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>46</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>49</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>50</td><td>    Precio</td></tr>
  <tr><td>51</td><td>    &lt;<span class="codeReserved">output</span> name=<span class="codeString">"precio"</span>&gt;</td></tr>
  <tr><td>52</td><td>     &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>53</td><td>    &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>54</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>55</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>58</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>59</td><td>    Cantidad *</td></tr>
  <tr><td>60</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"cantidad"</span> type=<span class="codeString">"number"</span> min=<span class="codeString">"0"</span> step=<span class="codeString">"0.01"</span>&gt;</td></tr>
  <tr><td>61</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>62</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Agregar&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>69</td><td></td></tr>
  <tr><td>70</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>71</td><td></td></tr>
  <tr><td>72</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. carrito.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Carrito&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/venta-en-captura.php&#039;)</span></td></tr>
  <tr><td>18</td><td><span class="codeString">  .then(venta =&gt; muestraObjeto(document, venta.body))</span></td></tr>
  <tr><td>19</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;<span class="codeReserved">h1</span>&gt;Carrito&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>  &lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Productos&lt;/<span class="codeReserved">a</span>&gt;</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td>  &lt;<span class="codeReserved">button</span> type=<span class="codeString">'button'</span> onclick=<span class="codeString">"<span class="codeReserved">if</span> (confirm(&#039;Confirma procesar&#039;)) {</span></td></tr>
  <tr><td>28</td><td><span class="codeString">     consumeJson(&#039;srv/venta-en-captura-procesa.php&#039;)</span></td></tr>
  <tr><td>29</td><td><span class="codeString">      .then(() =&gt; location.href = &#039;index.html&#039;)</span></td></tr>
  <tr><td>30</td><td><span class="codeString">      .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>31</td><td><span class="codeString">    }"</span>&gt;</td></tr>
  <tr><td>32</td><td>   Procesar compra</td></tr>
  <tr><td>33</td><td>  &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>38</td><td>  &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>39</td><td>   Folio</td></tr>
  <tr><td>40</td><td>   &lt;<span class="codeReserved">output</span> id=<span class="codeString">"folio"</span>&gt;</td></tr>
  <tr><td>41</td><td>    &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>42</td><td>   &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>43</td><td>  &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>44</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td> &lt;<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>  &lt;<span class="codeReserved">legend</span>&gt;Detalle&lt;/<span class="codeReserved">legend</span>&gt;</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>  &lt;<span class="codeReserved">dl</span> id=<span class="codeString">"detalles"</span>&gt;</td></tr>
  <tr><td>51</td><td>   &lt;<span class="codeReserved">dt</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">dt</span>&gt;</td></tr>
  <tr><td>52</td><td>   &lt;<span class="codeReserved">dd</span>&gt;&lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;&lt;/<span class="codeReserved">dd</span>&gt;</td></tr>
  <tr><td>53</td><td>  &lt;/<span class="codeReserved">dl</span>&gt;</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> &lt;/<span class="codeReserved">fieldset</span>&gt;</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. modifica.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Modificar&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraObjeto.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">// Obtiene los parÃ¡metros de la pÃ¡gina.</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">const</span> params = <span class="codeReserved">new</span> URL(location.href).searchParams</td></tr>
  <tr><td>19</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"<span class="codeReserved">if</span> (params.size &gt; 0) {</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   consumeJson(&#039;srv/det-venta.php?&#039; + params)</span></td></tr>
  <tr><td>25</td><td><span class="codeString">    .then(modelo =&gt; muestraObjeto(document, modelo.body))</span></td></tr>
  <tr><td>26</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>27</td><td><span class="codeString">  }"</span>&gt;</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> &lt;<span class="codeReserved">form</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/det-venta-modifica.php&#039;, event)</span></td></tr>
  <tr><td>30</td><td><span class="codeString">    .then(modelo =&gt; location.href = &#039;carrito.html&#039;)</span></td></tr>
  <tr><td>31</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Modificar&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"carrito.html"</span>&gt;Cancelar&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>  &lt;<span class="codeReserved">input</span> type=<span class="codeString">"hidden"</span> name=<span class="codeString">"prodId"</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>40</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>41</td><td>    Producto</td></tr>
  <tr><td>42</td><td>    &lt;<span class="codeReserved">output</span> name=<span class="codeString">"prodNombre"</span>&gt;</td></tr>
  <tr><td>43</td><td>     &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>44</td><td>    &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>45</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>46</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>49</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>50</td><td>    Precio</td></tr>
  <tr><td>51</td><td>    &lt;<span class="codeReserved">output</span> name=<span class="codeString">"precio"</span>&gt;</td></tr>
  <tr><td>52</td><td>     &lt;<span class="codeReserved">progress</span> max=<span class="codeString">"100"</span>&gt;Cargando&hellip;&lt;/<span class="codeReserved">progress</span>&gt;</td></tr>
  <tr><td>53</td><td>    &lt;/<span class="codeReserved">output</span>&gt;</td></tr>
  <tr><td>54</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>55</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>58</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>59</td><td>    Cantidad *</td></tr>
  <tr><td>60</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"cantidad"</span> type=<span class="codeString">"number"</span> min=<span class="codeString">"0"</span> step=<span class="codeString">"0.01"</span>&gt;</td></tr>
  <tr><td>61</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>62</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>  &lt;<span class="codeReserved">p</span>&gt;* Obligatorio&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Guardar&lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>69</td><td></td></tr>
  <tr><td>70</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"button"</span> onclick=<span class="codeString">"</span></td></tr>
  <tr><td>71</td><td><span class="codeString">     <span class="codeReserved">if</span> (params.size &gt; 0 && confirm(&#039;Confirma la eliminaciÃ³n&#039;)) {</span></td></tr>
  <tr><td>72</td><td><span class="codeString">      consumeJson(&#039;srv/det-venta-elimina.php?&#039; + params)</span></td></tr>
  <tr><td>73</td><td><span class="codeString">       .then(() =&gt; location.href = &#039;carrito.html&#039;)</span></td></tr>
  <tr><td>74</td><td><span class="codeString">       .<span class="codeReserved">catch</span>(muestraError)</span></td></tr>
  <tr><td>75</td><td><span class="codeString">     }"</span>&gt;</td></tr>
  <tr><td>76</td><td>    Eliminar</td></tr>
  <tr><td>77</td><td>   &lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>78</td><td></td></tr>
  <tr><td>79</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>80</td><td></td></tr>
  <tr><td>81</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>82</td><td></td></tr>
  <tr><td>83</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >K. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m21compras/m-srv/m-Bd-php.html">srv / Bd.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-det-venta-agrega-php.html">srv / det-venta-agrega.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-det-venta-elimina-php.html">srv / det-venta-elimina.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-det-venta-modifica-php.html">srv / det-venta-modifica.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-det-venta-php.html">srv / det-venta.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-detVentaConsulta-php.html">srv / detVentaConsulta.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-producto-php.html">srv / producto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-productoBusca-php.html">srv / productoBusca.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-productos-php.html">srv / productos.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-validaCantidad-php.html">srv / validaCantidad.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-validaProducto-php.html">srv / validaProducto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-validaVenta-php.html">srv / validaVenta.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-venta-en-captura-procesa-php.html">srv / venta-en-captura-procesa.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-venta-en-captura-php.html">srv / venta-en-captura.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-srv/m-ventaEnCapturaBusca-php.html">srv / ventaEnCapturaBusca.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / Bd.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">class</span> Bd</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeReserved">private</span> <span class="codeReserved">static</span> ?PDO $conexion = <span class="codeReserved">null</span>;</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> <span class="codeReserved">static</span> <span class="codeReserved">function</span> getConexion(): PDO</td></tr>
  <tr><td>9</td><td> {</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">if</span> (<span class="codeReserved">self</span>::$conexion === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>   <span class="codeReserved">self</span>::$conexion = <span class="codeReserved">new</span> PDO(</td></tr>
  <tr><td>12</td><td>    <span class="codeComment">// cadena de conexiÃ³n</span></td></tr>
  <tr><td>13</td><td>    <span class="codeString">"sqlite:srvcompras.db"</span>,</td></tr>
  <tr><td>14</td><td>    <span class="codeComment">// usuario</span></td></tr>
  <tr><td>15</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>    <span class="codeComment">// contraseÃ±a</span></td></tr>
  <tr><td>17</td><td>    <span class="codeReserved">null</span>,</td></tr>
  <tr><td>18</td><td>    <span class="codeComment">// Opciones: conexiones persistentes y lanza excepciones.</span></td></tr>
  <tr><td>19</td><td>    [PDO::ATTR_PERSISTENT =&gt; <span class="codeReserved">true</span>, PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION]</td></tr>
  <tr><td>20</td><td>   );</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>23</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> VENTA (</span></td></tr>
  <tr><td>24</td><td><span class="codeString">      VENT_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>25</td><td><span class="codeString">      VENT_EN_CAPTURA <span class="codeReserved">INTEGER</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>26</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> VENT_PK</span></td></tr>
  <tr><td>27</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(VENT_ID)</span></td></tr>
  <tr><td>28</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>29</td><td>   );</td></tr>
  <tr><td>30</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>31</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> PRODUCTO (</span></td></tr>
  <tr><td>32</td><td><span class="codeString">      PROD_ID <span class="codeReserved">INTEGER</span>,</span></td></tr>
  <tr><td>33</td><td><span class="codeString">      PROD_NOMBRE <span class="codeReserved">TEXT</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>34</td><td><span class="codeString">      PROD_EXISTENCIAS <span class="codeReserved">REAL</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>35</td><td><span class="codeString">      PROD_PRECIO <span class="codeReserved">REAL</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>36</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PROD_PK</span></td></tr>
  <tr><td>37</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span>(PROD_ID),</span></td></tr>
  <tr><td>38</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PROD_NOM_UNQ</span></td></tr>
  <tr><td>39</td><td><span class="codeString">       <span class="codeReserved">UNIQUE</span>(PROD_NOMBRE),</span></td></tr>
  <tr><td>40</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> PROD_NOM_NV</span></td></tr>
  <tr><td>41</td><td><span class="codeString">       CHECK(LENGTH(PROD_NOMBRE) &gt; 0)</span></td></tr>
  <tr><td>42</td><td><span class="codeString">     )'</span></td></tr>
  <tr><td>43</td><td>   );</td></tr>
  <tr><td>44</td><td>   <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>45</td><td>    <span class="codeString">'<span class="codeReserved">CREATE</span> <span class="codeReserved">TABLE</span> <span class="codeReserved">IF</span> <span class="codeReserved">NOT</span> <span class="codeReserved">EXISTS</span> DET_VENTA (</span></td></tr>
  <tr><td>46</td><td><span class="codeString">      VENT_ID <span class="codeReserved">INTEGER</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>47</td><td><span class="codeString">      PROD_ID <span class="codeReserved">INTEGER</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>48</td><td><span class="codeString">      DTV_CANTIDAD <span class="codeReserved">REAL</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>49</td><td><span class="codeString">      DTV_PRECIO <span class="codeReserved">REAL</span> <span class="codeReserved">NOT</span> <span class="codeReserved">NULL</span>,</span></td></tr>
  <tr><td>50</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> DTV_PK</span></td></tr>
  <tr><td>51</td><td><span class="codeString">       <span class="codeReserved">PRIMARY</span> <span class="codeReserved">KEY</span> (VENT_ID, PROD_ID),</span></td></tr>
  <tr><td>52</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> DTV_VENT_FK</span></td></tr>
  <tr><td>53</td><td><span class="codeString">       <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (VENT_ID) <span class="codeReserved">REFERENCES</span> VENTA(VENT_ID),</span></td></tr>
  <tr><td>54</td><td><span class="codeString">      <span class="codeReserved">CONSTRAINT</span> DTV_PROD_FK</span></td></tr>
  <tr><td>55</td><td><span class="codeString">       <span class="codeReserved">FOREIGN</span> <span class="codeReserved">KEY</span> (PROD_ID) <span class="codeReserved">REFERENCES</span> PRODUCTO(PROD_ID)</span></td></tr>
  <tr><td>56</td><td><span class="codeString">      )'</span></td></tr>
  <tr><td>57</td><td>   );</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td>   $cantidadDeProductos =</td></tr>
  <tr><td>60</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;query(<span class="codeString">"<span class="codeReserved">SELECT</span> COUNT(PROD_ID) <span class="codeReserved">FROM</span> PRODUCTO"</span>)</td></tr>
  <tr><td>61</td><td>    -&gt;fetchColumn();</td></tr>
  <tr><td>62</td><td></td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">if</span> ($cantidadDeProductos === 0) {</td></tr>
  <tr><td>64</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>65</td><td>     <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> PRODUCTO</span></td></tr>
  <tr><td>66</td><td><span class="codeString">       (PROD_NOMBRE, PROD_EXISTENCIAS, PROD_PRECIO)</span></td></tr>
  <tr><td>67</td><td><span class="codeString">      <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>68</td><td><span class="codeString">       (&#039;Sandwich&#039;, 50, 15),</span></td></tr>
  <tr><td>69</td><td><span class="codeString">       (&#039;Hot dog&#039;, 40, 30),</span></td></tr>
  <tr><td>70</td><td><span class="codeString">       (&#039;Hamburguesa&#039;, 30, 40)"</span></td></tr>
  <tr><td>71</td><td>    );</td></tr>
  <tr><td>72</td><td>   }</td></tr>
  <tr><td>73</td><td></td></tr>
  <tr><td>74</td><td>   $cantidadDeVentas =</td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;query(<span class="codeString">"<span class="codeReserved">SELECT</span> COUNT(VENT_ID) <span class="codeReserved">FROM</span> VENTA"</span>)</td></tr>
  <tr><td>76</td><td>    -&gt;fetchColumn();</td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>   <span class="codeReserved">if</span> ($cantidadDeVentas === 0) {</td></tr>
  <tr><td>79</td><td>    <span class="codeReserved">self</span>::$conexion-&gt;exec(</td></tr>
  <tr><td>80</td><td>     <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> VENTA</span></td></tr>
  <tr><td>81</td><td><span class="codeString">       (VENT_EN_CAPTURA)</span></td></tr>
  <tr><td>82</td><td><span class="codeString">      <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>83</td><td><span class="codeString">       (1)"</span></td></tr>
  <tr><td>84</td><td>    );</td></tr>
  <tr><td>85</td><td>   }</td></tr>
  <tr><td>86</td><td>  }</td></tr>
  <tr><td>87</td><td></td></tr>
  <tr><td>88</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">self</span>::$conexion;</td></tr>
  <tr><td>89</td><td> }</td></tr>
  <tr><td>90</td><td>}</td></tr>
  <tr><td>91</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. srv / det-venta-agrega.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaDecimal.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveCreated.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaCantidad.php"</span>;</td></tr>
  <tr><td>13</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/productoBusca.php"</span>;</td></tr>
  <tr><td>14</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaProducto.php"</span>;</td></tr>
  <tr><td>15</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ventaEnCapturaBusca.php"</span>;</td></tr>
  <tr><td>16</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaVenta.php"</span>;</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $prodId = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> $cantidad = recuperaDecimal(<span class="codeString">"cantidad"</span>);</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td> $cantidad = validaCantidad($cantidad);</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> $producto = productoBusca($prodId);</td></tr>
  <tr><td>27</td><td> validaProducto($producto, $prodId);</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> $venta = ventaEnCapturaBusca();</td></tr>
  <tr><td>30</td><td> validaVenta($venta);</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>33</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>34</td><td>  <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> DET_VENTA</span></td></tr>
  <tr><td>35</td><td><span class="codeString">     (VENT_ID, PROD_ID, DTV_CANTIDAD, DTV_PRECIO)</span></td></tr>
  <tr><td>36</td><td><span class="codeString">    <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>37</td><td><span class="codeString">     (:ventId, :prodId, :cantidad, :precio)"</span></td></tr>
  <tr><td>38</td><td> )</td></tr>
  <tr><td>39</td><td>  -&gt;execute(</td></tr>
  <tr><td>40</td><td>   [</td></tr>
  <tr><td>41</td><td>    <span class="codeString">":ventId"</span> =&gt; $venta-&gt;id,</td></tr>
  <tr><td>42</td><td>    <span class="codeString">":prodId"</span> =&gt; $prodId,</td></tr>
  <tr><td>43</td><td>    <span class="codeString">":cantidad"</span> =&gt; $cantidad,</td></tr>
  <tr><td>44</td><td>    <span class="codeString">":precio"</span> =&gt; $producto-&gt;precio,</td></tr>
  <tr><td>45</td><td>   ]</td></tr>
  <tr><td>46</td><td>  );</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td> $encodeProdId = urlencode($prodId);</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td> devuelveCreated(<span class="codeString">"/srv/det-venta.php?id=$encodeProdId"</span>, [</td></tr>
  <tr><td>51</td><td>  <span class="codeString">"prodId"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $prodId],</td></tr>
  <tr><td>52</td><td>  <span class="codeString">"prodNombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $producto-&gt;nombre],</td></tr>
  <tr><td>53</td><td>  <span class="codeString">"precio"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"$"</span> . number_format($producto-&gt;precio, 2)],</td></tr>
  <tr><td>54</td><td>  <span class="codeString">"cantidad"</span> =&gt; [<span class="codeString">"valueAsNumber"</span> =&gt; $cantidad],</td></tr>
  <tr><td>55</td><td> ]);</td></tr>
  <tr><td>56</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>59</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>62</td><td>}</td></tr>
  <tr><td>63</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. srv / det-venta-elimina.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveNoContent.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ventaEnCapturaBusca.php"</span>;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> $prodId = recuperaIdEntero(<span class="codeString">"prodId"</span>);</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $venta = ventaEnCapturaBusca();</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> ($venta !== <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  $conexion = Bd::getConexion();</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>22</td><td>   <span class="codeString">"<span class="codeReserved">DELETE</span> <span class="codeReserved">FROM</span> DET_VENTA</span></td></tr>
  <tr><td>23</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> VENT_ID = :ventId</span></td></tr>
  <tr><td>24</td><td><span class="codeString">     AND PROD_ID = :prodId"</span></td></tr>
  <tr><td>25</td><td>  )</td></tr>
  <tr><td>26</td><td>   -&gt;execute([</td></tr>
  <tr><td>27</td><td>    <span class="codeString">":ventId"</span> =&gt; $venta-&gt;id,</td></tr>
  <tr><td>28</td><td>    <span class="codeString">":prodId"</span> =&gt; $prodId,</td></tr>
  <tr><td>29</td><td>   ]);</td></tr>
  <tr><td>30</td><td> }</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> devuelveNoContent();</td></tr>
  <tr><td>33</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>36</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. srv / det-venta-modifica.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaDecimal.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaCantidad.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/productoBusca.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaProducto.php"</span>;</td></tr>
  <tr><td>13</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ventaEnCapturaBusca.php"</span>;</td></tr>
  <tr><td>14</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaVenta.php"</span>;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $prodId = recuperaIdEntero(<span class="codeString">"prodId"</span>);</td></tr>
  <tr><td>19</td><td> $cantidad = recuperaDecimal(<span class="codeString">"cantidad"</span>);</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> $cantidad = validaCantidad($cantidad);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> $producto = productoBusca($prodId);</td></tr>
  <tr><td>24</td><td> validaProducto($producto, $prodId);</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> $venta = ventaEnCapturaBusca();</td></tr>
  <tr><td>27</td><td> validaVenta($venta);</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>30</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>31</td><td>  <span class="codeString">"<span class="codeReserved">UPDATE</span> DET_VENTA</span></td></tr>
  <tr><td>32</td><td><span class="codeString">    <span class="codeReserved">SET</span></span></td></tr>
  <tr><td>33</td><td><span class="codeString">     DTV_CANTIDAD = :cantidad,</span></td></tr>
  <tr><td>34</td><td><span class="codeString">     DTV_PRECIO = :precio</span></td></tr>
  <tr><td>35</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> </span></td></tr>
  <tr><td>36</td><td><span class="codeString">     VENT_ID = :ventId</span></td></tr>
  <tr><td>37</td><td><span class="codeString">     AND PROD_ID = :prodId"</span></td></tr>
  <tr><td>38</td><td> )</td></tr>
  <tr><td>39</td><td>  -&gt;execute(</td></tr>
  <tr><td>40</td><td>   [</td></tr>
  <tr><td>41</td><td>    <span class="codeString">":ventId"</span> =&gt; $venta-&gt;id,</td></tr>
  <tr><td>42</td><td>    <span class="codeString">":prodId"</span> =&gt; $prodId,</td></tr>
  <tr><td>43</td><td>    <span class="codeString">":cantidad"</span> =&gt; $cantidad,</td></tr>
  <tr><td>44</td><td>    <span class="codeString">":precio"</span> =&gt; $producto-&gt;precio</td></tr>
  <tr><td>45</td><td>   ]</td></tr>
  <tr><td>46</td><td>  );</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td> devuelveJson([</td></tr>
  <tr><td>49</td><td>  <span class="codeString">"prodId"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $prodId],</td></tr>
  <tr><td>50</td><td>  <span class="codeString">"prodNombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $producto-&gt;nombre],</td></tr>
  <tr><td>51</td><td>  <span class="codeString">"precio"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"$"</span> . number_format($producto-&gt;precio, 2)],</td></tr>
  <tr><td>52</td><td>  <span class="codeString">"cantidad"</span> =&gt; [<span class="codeString">"valueAsNumber"</span> =&gt; $cantidad],</td></tr>
  <tr><td>53</td><td> ]);</td></tr>
  <tr><td>54</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>57</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>60</td><td>}</td></tr>
  <tr><td>61</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. srv / det-venta.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/productoBusca.php"</span>;</td></tr>
  <tr><td>12</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaProducto.php"</span>;</td></tr>
  <tr><td>13</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ventaEnCapturaBusca.php"</span>;</td></tr>
  <tr><td>14</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaVenta.php"</span>;</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $prodId = recuperaIdEntero(<span class="codeString">"prodId"</span>);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $venta = ventaEnCapturaBusca();</td></tr>
  <tr><td>21</td><td> validaVenta($venta);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> $producto = productoBusca($prodId);</td></tr>
  <tr><td>24</td><td> validaProducto($producto, $prodId);</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td> $detVenta = fetch(</td></tr>
  <tr><td>29</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>30</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>31</td><td><span class="codeString">    DTV_CANTIDAD <span class="codeReserved">AS</span> cantidad,</span></td></tr>
  <tr><td>32</td><td><span class="codeString">    DTV_PRECIO <span class="codeReserved">AS</span> precio</span></td></tr>
  <tr><td>33</td><td><span class="codeString">   <span class="codeReserved">FROM</span> DET_VENTA</span></td></tr>
  <tr><td>34</td><td><span class="codeString">   <span class="codeReserved">WHERE</span></span></td></tr>
  <tr><td>35</td><td><span class="codeString">    VENT_ID = :ventId</span></td></tr>
  <tr><td>36</td><td><span class="codeString">    AND PROD_ID = :prodId"</span></td></tr>
  <tr><td>37</td><td>  ),</td></tr>
  <tr><td>38</td><td>  [</td></tr>
  <tr><td>39</td><td>   <span class="codeString">":ventId"</span> =&gt; $venta-&gt;id,</td></tr>
  <tr><td>40</td><td>   <span class="codeString">":prodId"</span> =&gt; $prodId</td></tr>
  <tr><td>41</td><td>  ]</td></tr>
  <tr><td>42</td><td> );</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td> <span class="codeReserved">if</span> ($detVenta === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>45</td><td>  $htmlId = htmlentities($prodId);</td></tr>
  <tr><td>46</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>47</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>48</td><td>   type: <span class="codeString">"/error/detalledeventanoencontrado.html"</span>,</td></tr>
  <tr><td>49</td><td>   title: <span class="codeString">"Detalle de venta no encontrado."</span>,</td></tr>
  <tr><td>50</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn detalle de venta con el id de producto "</span></td></tr>
  <tr><td>51</td><td>    . $htmlId . <span class="codeString">"."</span>,</td></tr>
  <tr><td>52</td><td>  );</td></tr>
  <tr><td>53</td><td> }</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> devuelveJson([</td></tr>
  <tr><td>56</td><td>  <span class="codeString">"prodId"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $prodId],</td></tr>
  <tr><td>57</td><td>  <span class="codeString">"prodNombre"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $producto-&gt;nombre],</td></tr>
  <tr><td>58</td><td>  <span class="codeString">"precio"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"$"</span> . number_format($detVenta-&gt;precio, 2)],</td></tr>
  <tr><td>59</td><td>  <span class="codeString">"cantidad"</span> =&gt; [<span class="codeString">"valueAsNumber"</span> =&gt; $detVenta-&gt;cantidad],</td></tr>
  <tr><td>60</td><td> ]);</td></tr>
  <tr><td>61</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>62</td><td></td></tr>
  <tr><td>63</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>64</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>67</td><td>}</td></tr>
  <tr><td>68</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. srv / detVentaConsulta.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> detVentaConsulta(<span class="codeReserved">int</span> $ventaId)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">return</span> fetchAll(</td></tr>
  <tr><td>12</td><td>  $conexion-&gt;query(</td></tr>
  <tr><td>13</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>14</td><td><span class="codeString">    DV.PROD_ID <span class="codeReserved">AS</span> prodId,</span></td></tr>
  <tr><td>15</td><td><span class="codeString">    P.PROD_NOMBRE <span class="codeReserved">AS</span> prodNombre,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    P.PROD_EXISTENCIAS <span class="codeReserved">AS</span> prodExistencias,</span></td></tr>
  <tr><td>17</td><td><span class="codeString">    P.PROD_PRECIO <span class="codeReserved">AS</span> prodPrecio,</span></td></tr>
  <tr><td>18</td><td><span class="codeString">    DV.DTV_CANTIDAD <span class="codeReserved">AS</span> cantidad,</span></td></tr>
  <tr><td>19</td><td><span class="codeString">    DV.DTV_PRECIO <span class="codeReserved">AS</span> precio</span></td></tr>
  <tr><td>20</td><td><span class="codeString">   <span class="codeReserved">FROM</span> DET_VENTA DV, PRODUCTO P</span></td></tr>
  <tr><td>21</td><td><span class="codeString">   <span class="codeReserved">WHERE</span></span></td></tr>
  <tr><td>22</td><td><span class="codeString">    DV.PROD_ID = P.PROD_ID</span></td></tr>
  <tr><td>23</td><td><span class="codeString">    AND DV.VENT_ID = :ventId</span></td></tr>
  <tr><td>24</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> P.PROD_NOMBRE"</span></td></tr>
  <tr><td>25</td><td>  ),</td></tr>
  <tr><td>26</td><td>  [<span class="codeString">":ventId"</span> =&gt; $ventaId]</td></tr>
  <tr><td>27</td><td> );</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. srv / producto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/NOT_FOUND.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaIdEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/productoBusca.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaProducto.php"</span>;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $id = recuperaIdEntero(<span class="codeString">"id"</span>);</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $producto = productoBusca($id);</td></tr>
  <tr><td>18</td><td> validaProducto($producto, $id);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> devuelveJson([</td></tr>
  <tr><td>21</td><td>  <span class="codeString">"id"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $id],</td></tr>
  <tr><td>22</td><td>  <span class="codeString">"producto"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $producto-&gt;nombre],</td></tr>
  <tr><td>23</td><td>  <span class="codeString">"precio"</span> =&gt; [<span class="codeString">"value"</span> =&gt; <span class="codeString">"$"</span> . number_format($producto-&gt;precio, 2)],</td></tr>
  <tr><td>24</td><td> ]);</td></tr>
  <tr><td>25</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>28</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>29</td><td></td></tr>
  <tr><td>30</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>31</td><td>}</td></tr>
  <tr><td>32</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. srv / productoBusca.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> productoBusca(<span class="codeReserved">int</span> $id)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">return</span> fetch(</td></tr>
  <tr><td>12</td><td>  $conexion-&gt;prepare(</td></tr>
  <tr><td>13</td><td>   <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>14</td><td><span class="codeString">    PROD_NOMBRE <span class="codeReserved">AS</span> nombre,</span></td></tr>
  <tr><td>15</td><td><span class="codeString">    PROD_PRECIO <span class="codeReserved">AS</span> precio,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    PROD_EXISTENCIAS <span class="codeReserved">AS</span> existencias</span></td></tr>
  <tr><td>17</td><td><span class="codeString">   <span class="codeReserved">FROM</span> PRODUCTO</span></td></tr>
  <tr><td>18</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> PROD_ID = :id"</span></td></tr>
  <tr><td>19</td><td>  ),</td></tr>
  <tr><td>20</td><td>  [<span class="codeString">":id"</span> =&gt; $id]</td></tr>
  <tr><td>21</td><td> );</td></tr>
  <tr><td>22</td><td>}</td></tr>
  <tr><td>23</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. srv / productos.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> $conexionexion = Bd::getConexion();</td></tr>
  <tr><td>13</td><td> $lista = fetchAll($conexionexion-&gt;query(</td></tr>
  <tr><td>14</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>15</td><td><span class="codeString">    PROD_ID <span class="codeReserved">as</span> id,</span></td></tr>
  <tr><td>16</td><td><span class="codeString">    PROD_NOMBRE <span class="codeReserved">as</span> nombre,</span></td></tr>
  <tr><td>17</td><td><span class="codeString">    PROD_PRECIO <span class="codeReserved">as</span> precio,</span></td></tr>
  <tr><td>18</td><td><span class="codeString">    PROD_EXISTENCIAS <span class="codeReserved">as</span> existencias</span></td></tr>
  <tr><td>19</td><td><span class="codeString">   <span class="codeReserved">FROM</span> PRODUCTO</span></td></tr>
  <tr><td>20</td><td><span class="codeString">   <span class="codeReserved">ORDER</span> <span class="codeReserved">BY</span> PROD_NOMBRE"</span></td></tr>
  <tr><td>21</td><td> ));</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> $render = <span class="codeString">""</span>;</td></tr>
  <tr><td>24</td><td> <span class="codeReserved">foreach</span> ($lista <span class="codeReserved">as</span> $modelo) {</td></tr>
  <tr><td>25</td><td>  $encodeId = urlencode($modelo-&gt;id);</td></tr>
  <tr><td>26</td><td>  $id = htmlentities($encodeId);</td></tr>
  <tr><td>27</td><td>  $nombre = htmlentities($modelo-&gt;nombre);</td></tr>
  <tr><td>28</td><td>  $precio = htmlentities(<span class="codeString">"$"</span> . number_format($modelo-&gt;precio, 2));</td></tr>
  <tr><td>29</td><td>  $existencias = htmlentities(number_format($modelo-&gt;existencias, 2));</td></tr>
  <tr><td>30</td><td>  $render .=</td></tr>
  <tr><td>31</td><td>   <span class="codeString">"&lt;<span class="codeReserved">dt</span>&gt;$nombre&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>32</td><td><span class="codeString">    &lt;<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>33</td><td><span class="codeString">     &lt;<span class="codeReserved">a</span> href=&#039;agrega.html?id=$id&#039;&gt;Agregar al carrito&lt;/<span class="codeReserved">a</span>&gt;</span></td></tr>
  <tr><td>34</td><td><span class="codeString">    &lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>35</td><td><span class="codeString">    &lt;<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>36</td><td><span class="codeString">     &lt;<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>37</td><td><span class="codeString">      &lt;<span class="codeReserved">dt</span>&gt;Precio&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>38</td><td><span class="codeString">      &lt;<span class="codeReserved">dd</span>&gt;$precio&lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>39</td><td><span class="codeString">      &lt;<span class="codeReserved">dt</span>&gt;Existencias&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>40</td><td><span class="codeString">      &lt;<span class="codeReserved">dd</span>&gt;$existencias&lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>41</td><td><span class="codeString">     &lt;/<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>42</td><td><span class="codeString">    &lt;/<span class="codeReserved">dd</span>&gt;"</span>;</td></tr>
  <tr><td>43</td><td> }</td></tr>
  <tr><td>44</td><td> devuelveJson([<span class="codeString">"lista"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $render]]);</td></tr>
  <tr><td>45</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>48</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>51</td><td>}</td></tr>
  <tr><td>52</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. srv / validaCantidad.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> validaCantidad(<span class="codeReserved">false</span>|<span class="codeReserved">null</span>|float $cantidad)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> <span class="codeReserved">if</span> ($cantidad === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>11</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>12</td><td>   title: <span class="codeString">"Falta la cantidad."</span>,</td></tr>
  <tr><td>13</td><td>   type: <span class="codeString">"/error/faltacantidad.html"</span>,</td></tr>
  <tr><td>14</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de cantidad."</span></td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> ($cantidad === <span class="codeReserved">null</span>)</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>19</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>20</td><td>   title: <span class="codeString">"Falta la cantidad."</span>,</td></tr>
  <tr><td>21</td><td>   type: <span class="codeString">"/error/cantidadenblanco.html"</span>,</td></tr>
  <tr><td>22</td><td>   detail: <span class="codeString">"Pon un nÃºmero en el campo cantidad."</span></td></tr>
  <tr><td>23</td><td>  );</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">return</span> $cantidad;</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >K. srv / validaProducto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> validaProducto($producto, $prodId)</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">if</span> ($producto === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>6</td><td>  $htmlId = htmlentities($prodId);</td></tr>
  <tr><td>7</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>8</td><td>   status: NOT_FOUND,</td></tr>
  <tr><td>9</td><td>   title: <span class="codeString">"Producto no encontrado."</span>,</td></tr>
  <tr><td>10</td><td>   type: <span class="codeString">"/error/productonoencontrado.html"</span>,</td></tr>
  <tr><td>11</td><td>   detail: <span class="codeString">"No se encontrÃ³ ningÃºn producto con el id $htmlId."</span>,</td></tr>
  <tr><td>12</td><td>  );</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >L. srv / validaVenta.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> validaVenta($venta)</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">if</span> ($venta === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>6</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>7</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>8</td><td>   title: <span class="codeString">"Venta en captura no encontrada."</span>,</td></tr>
  <tr><td>9</td><td>   type: <span class="codeString">"/error/ventaencapturanoencontrada.html"</span>,</td></tr>
  <tr><td>10</td><td>   detail: <span class="codeString">"No se encontrÃ³ ninguna venta en captura."</span>,</td></tr>
  <tr><td>11</td><td>  );</td></tr>
  <tr><td>12</td><td>}</td></tr>
  <tr><td>13</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >M. srv / venta-en-captura-procesa.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveCreated.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ventaEnCapturaBusca.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaVenta.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/detVentaConsulta.php"</span>;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>15</td><td> $conexion-&gt;beginTransaction();</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $venta = ventaEnCapturaBusca();</td></tr>
  <tr><td>18</td><td> validaVenta($venta);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $detalles = detVentaConsulta($venta-&gt;id);</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> <span class="codeComment">// Actualiza las existencias de los productos vendidos.</span></td></tr>
  <tr><td>23</td><td> $update = $conexion-&gt;prepare(</td></tr>
  <tr><td>24</td><td>  <span class="codeString">"<span class="codeReserved">UPDATE</span> PRODUCTO</span></td></tr>
  <tr><td>25</td><td><span class="codeString">   <span class="codeReserved">SET</span> PROD_EXISTENCIAS = :existencias</span></td></tr>
  <tr><td>26</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> PROD_ID = :prodId"</span></td></tr>
  <tr><td>27</td><td> );</td></tr>
  <tr><td>28</td><td> <span class="codeReserved">foreach</span> ($detalles <span class="codeReserved">as</span> $detVenta) {</td></tr>
  <tr><td>29</td><td>  $update-&gt;execute([</td></tr>
  <tr><td>30</td><td>   <span class="codeString">":prodId"</span> =&gt; $detVenta-&gt;prodId,</td></tr>
  <tr><td>31</td><td>   <span class="codeString">":existencias"</span> =&gt; $detVenta-&gt;prodExistencias - $detVenta-&gt;cantidad</td></tr>
  <tr><td>32</td><td>  ]);</td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td> $conexion-&gt;prepare(</td></tr>
  <tr><td>36</td><td>  <span class="codeString">"<span class="codeReserved">UPDATE</span> VENTA</span></td></tr>
  <tr><td>37</td><td><span class="codeString">    <span class="codeReserved">SET</span> VENT_EN_CAPTURA = 0</span></td></tr>
  <tr><td>38</td><td><span class="codeString">    <span class="codeReserved">WHERE</span> VENT_ID = :id"</span></td></tr>
  <tr><td>39</td><td> )</td></tr>
  <tr><td>40</td><td>  -&gt;execute([<span class="codeString">":id"</span> =&gt; $venta-&gt;id]);</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td> $conexion-&gt;exec(</td></tr>
  <tr><td>43</td><td>  <span class="codeString">"<span class="codeReserved">INSERT</span> <span class="codeReserved">INTO</span> VENTA</span></td></tr>
  <tr><td>44</td><td><span class="codeString">    (VENT_EN_CAPTURA)</span></td></tr>
  <tr><td>45</td><td><span class="codeString">   <span class="codeReserved">VALUES</span></span></td></tr>
  <tr><td>46</td><td><span class="codeString">    (1)"</span></td></tr>
  <tr><td>47</td><td> );</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td> <span class="codeComment">/* Recupera el id generado. Si usas una secuencia, pasa como</span></td></tr>
  <tr><td>50</td><td><span class="codeComment">  * parÃ¡metro de lastInsertId el nombre de dicha secuencia y</span></td></tr>
  <tr><td>51</td><td><span class="codeComment">  * poner esta instrucciÃ³n antes del <span class="codeReserved">INSERT</span>, al cual se le</span></td></tr>
  <tr><td>52</td><td><span class="codeComment">  * pasarle el id generado. */</span></td></tr>
  <tr><td>53</td><td> $folio = $conexion-&gt;lastInsertId();</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> $conexion-&gt;commit();</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td> devuelveCreated(<span class="codeString">"/srv/venta-en-captura.php"</span>, [</td></tr>
  <tr><td>58</td><td>  <span class="codeString">"folio"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $folio],</td></tr>
  <tr><td>59</td><td>  <span class="codeString">"detalles"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; <span class="codeString">""</span>]</td></tr>
  <tr><td>60</td><td> ]);</td></tr>
  <tr><td>61</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>62</td><td></td></tr>
  <tr><td>63</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>64</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>67</td><td>}</td></tr>
  <tr><td>68</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. srv / venta-en-captura.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetchAll.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ventaEnCapturaBusca.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/validaVenta.php"</span>;</td></tr>
  <tr><td>11</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/detVentaConsulta.php"</span>;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> $venta = ventaEnCapturaBusca();</td></tr>
  <tr><td>16</td><td> validaVenta($venta);</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td> $detalles = detVentaConsulta($venta-&gt;id);</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> $renderDetalles = <span class="codeString">""</span>;</td></tr>
  <tr><td>21</td><td> <span class="codeReserved">foreach</span> ($detalles <span class="codeReserved">as</span> $detVenta) {</td></tr>
  <tr><td>22</td><td>  $encodeProdId = urlencode($detVenta-&gt;prodId);</td></tr>
  <tr><td>23</td><td>  $prodId = htmlentities($encodeProdId);</td></tr>
  <tr><td>24</td><td>  $prodNombre = htmlentities($detVenta-&gt;prodNombre);</td></tr>
  <tr><td>25</td><td>  $precio = htmlentities(<span class="codeString">"$"</span> . number_format($detVenta-&gt;prodPrecio, 2));</td></tr>
  <tr><td>26</td><td>  $cantidad = htmlentities(number_format($detVenta-&gt;cantidad, 2));</td></tr>
  <tr><td>27</td><td>  $renderDetalles .=</td></tr>
  <tr><td>28</td><td>   <span class="codeString">"&lt;<span class="codeReserved">dt</span>&gt;$prodNombre&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>29</td><td><span class="codeString">    &lt;<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>30</td><td><span class="codeString">     &lt;<span class="codeReserved">a</span> href= &#039;modifica.html?prodId=$prodId&#039;&gt;Modificar o eliminar&lt;/<span class="codeReserved">a</span>&gt;</span></td></tr>
  <tr><td>31</td><td><span class="codeString">    &lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>32</td><td><span class="codeString">    &lt;<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>33</td><td><span class="codeString">     &lt;<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>34</td><td><span class="codeString">      &lt;<span class="codeReserved">dt</span>&gt;Cantidad&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>35</td><td><span class="codeString">      &lt;<span class="codeReserved">dd</span>&gt;$cantidad&lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>36</td><td><span class="codeString">      &lt;<span class="codeReserved">dt</span>&gt;Precio&lt;/<span class="codeReserved">dt</span>&gt;</span></td></tr>
  <tr><td>37</td><td><span class="codeString">      &lt;<span class="codeReserved">dd</span>&gt;$precio&lt;/<span class="codeReserved">dd</span>&gt;</span></td></tr>
  <tr><td>38</td><td><span class="codeString">     &lt;/<span class="codeReserved">dl</span>&gt;</span></td></tr>
  <tr><td>39</td><td><span class="codeString">    &lt;/<span class="codeReserved">dd</span>&gt;"</span>;</td></tr>
  <tr><td>40</td><td> }</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td> devuelveJson([</td></tr>
  <tr><td>43</td><td>  <span class="codeString">"folio"</span> =&gt; [<span class="codeString">"value"</span> =&gt; $venta-&gt;id],</td></tr>
  <tr><td>44</td><td>  <span class="codeString">"detalles"</span> =&gt; [<span class="codeString">"innerHTML"</span> =&gt; $renderDetalles]</td></tr>
  <tr><td>45</td><td> ]);</td></tr>
  <tr><td>46</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>49</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>52</td><td>}</td></tr>
  <tr><td>53</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >O. srv / ventaEnCapturaBusca.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/fetch.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/Bd.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> ventaEnCapturaBusca()</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $conexion = Bd::getConexion();</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">return</span> fetch($conexion-&gt;query(</td></tr>
  <tr><td>12</td><td>  <span class="codeString">"<span class="codeReserved">SELECT</span></span></td></tr>
  <tr><td>13</td><td><span class="codeString">    VENT_ID <span class="codeReserved">as</span> id,</span></td></tr>
  <tr><td>14</td><td><span class="codeString">    VENT_EN_CAPTURA <span class="codeReserved">as</span> enCaptura</span></td></tr>
  <tr><td>15</td><td><span class="codeString">   <span class="codeReserved">FROM</span> VENTA</span></td></tr>
  <tr><td>16</td><td><span class="codeString">   <span class="codeReserved">WHERE</span> VENT_EN_CAPTURA = 1"</span></td></tr>
  <tr><td>17</td><td> ));</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >L. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m21compras/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m21compras/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-js/m-muestraObjeto-js.html">lib / js / muestraObjeto.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraObjeto.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } objeto</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraObjeto(raizHtml, objeto) {</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [nombre, definiciones] of Object.entries(objeto)) {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td>  <span class="codeReserved">if</span> (Array.isArray(definiciones)) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>   muestraArray(raizHtml, nombre, definiciones)</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (definiciones !== undefined && definiciones !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>   <span class="codeReserved">const</span> elementoHtml = buscaElementoHtml(raizHtml, nombre)</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>   <span class="codeReserved">if</span> (elementoHtml <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>    muestraInput(raizHtml, elementoHtml, definiciones)</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>   } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (elementoHtml !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>    <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>24</td><td>     <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> elementoHtml) {</td></tr>
  <tr><td>25</td><td>      elementoHtml[atributo] = valor</td></tr>
  <tr><td>26</td><td>     }</td></tr>
  <tr><td>27</td><td>    }</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>   }</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>}</td></tr>
  <tr><td>36</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>37</td><td>window[<span class="codeString">"muestraObjeto"</span>] = muestraObjeto</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>40</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>41</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } nombre</span></td></tr>
  <tr><td>42</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>43</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> buscaElementoHtml(raizHtml, nombre) {</td></tr>
  <tr><td>44</td><td> <span class="codeReserved">return</span> raizHtml.querySelector(</td></tr>
  <tr><td>45</td><td>  <span class="codeString">`#${nombre},[name=&quot;${nombre}&quot;],[data-name=&quot;${nombre}&quot;]`</span>)</td></tr>
  <tr><td>46</td><td>}</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>49</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>50</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string } propiedad</span></td></tr>
  <tr><td>51</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {any[]} valores</span></td></tr>
  <tr><td>52</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>53</td><td><span class="codeReserved">function</span> muestraArray(raizHtml, propiedad, valores) {</td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td> <span class="codeReserved">const</span> conjunto = <span class="codeReserved">new</span> Set(valores)</td></tr>
  <tr><td>56</td><td> <span class="codeReserved">const</span> elementos =</td></tr>
  <tr><td>57</td><td>  raizHtml.querySelectorAll(<span class="codeString">`[name=&quot;${propiedad}&quot;],[data-name=&quot;${propiedad}&quot;]`</span>)</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td> <span class="codeReserved">if</span> (elementos.length === 1) {</td></tr>
  <tr><td>60</td><td>  <span class="codeReserved">const</span> elemento = elementos[0]</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLSelectElement) {</td></tr>
  <tr><td>63</td><td>   <span class="codeReserved">const</span> options = elemento.options</td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = options.length; i &lt; len; i++) {</td></tr>
  <tr><td>65</td><td>    <span class="codeReserved">const</span> option = options[i]</td></tr>
  <tr><td>66</td><td>    option.selected = conjunto.has(option.value)</td></tr>
  <tr><td>67</td><td>   }</td></tr>
  <tr><td>68</td><td>   <span class="codeReserved">return</span></td></tr>
  <tr><td>69</td><td>  }</td></tr>
  <tr><td>70</td><td></td></tr>
  <tr><td>71</td><td> }</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">let</span> i = 0, len = elementos.length; i &lt; len; i++) {</td></tr>
  <tr><td>74</td><td>  <span class="codeReserved">const</span> elemento = elementos[i]</td></tr>
  <tr><td>75</td><td>  <span class="codeReserved">if</span> (elemento <span class="codeReserved">instanceof</span> HTMLInputElement) {</td></tr>
  <tr><td>76</td><td>   elemento.checked = conjunto.has(elemento.value)</td></tr>
  <tr><td>77</td><td>  }</td></tr>
  <tr><td>78</td><td> }</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>}</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>83</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>84</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLInputElement } input</span></td></tr>
  <tr><td>85</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { any } definiciones</span></td></tr>
  <tr><td>86</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>87</td><td><span class="codeReserved">function</span> muestraInput(raizHtml, input, definiciones) {</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td> <span class="codeReserved">for</span> (<span class="codeReserved">const</span> [atributo, valor] of Object.entries(definiciones)) {</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td>  <span class="codeReserved">if</span> (atributo == <span class="codeString">"data-file"</span>) {</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>   <span class="codeReserved">const</span> img = getImgParaElementoHtml(raizHtml, input)</td></tr>
  <tr><td>94</td><td>   <span class="codeReserved">if</span> (img !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>95</td><td>    input.dataset.file = valor</td></tr>
  <tr><td>96</td><td>    input.value = <span class="codeString">""</span></td></tr>
  <tr><td>97</td><td>    <span class="codeReserved">if</span> (valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>98</td><td>     img.<span class="codeReserved">src</span> = <span class="codeString">""</span></td></tr>
  <tr><td>99</td><td>     img.hidden = <span class="codeReserved">true</span></td></tr>
  <tr><td>100</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>101</td><td>     img.<span class="codeReserved">src</span> = valor</td></tr>
  <tr><td>102</td><td>     img.hidden = <span class="codeReserved">false</span></td></tr>
  <tr><td>103</td><td>    }</td></tr>
  <tr><td>104</td><td>   }</td></tr>
  <tr><td>105</td><td></td></tr>
  <tr><td>106</td><td>  } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (atributo <span class="codeReserved">in</span> input) {</td></tr>
  <tr><td>107</td><td></td></tr>
  <tr><td>108</td><td>   input[atributo] = valor</td></tr>
  <tr><td>109</td><td></td></tr>
  <tr><td>110</td><td>  }</td></tr>
  <tr><td>111</td><td> }</td></tr>
  <tr><td>112</td><td></td></tr>
  <tr><td>113</td><td>}</td></tr>
  <tr><td>114</td><td></td></tr>
  <tr><td>115</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>116</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { Document | HTMLElement } raizHtml</span></td></tr>
  <tr><td>117</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { HTMLElement } elementoHtml</span></td></tr>
  <tr><td>118</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>119</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> getImgParaElementoHtml(raizHtml, elementoHtml) {</td></tr>
  <tr><td>120</td><td> <span class="codeReserved">const</span> imgId = elementoHtml.getAttribute(<span class="codeString">"data-img"</span>)</td></tr>
  <tr><td>121</td><td> <span class="codeReserved">if</span> (imgId === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>122</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>123</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>124</td><td>  <span class="codeReserved">const</span> input = buscaElementoHtml(raizHtml, imgId)</td></tr>
  <tr><td>125</td><td>  <span class="codeReserved">if</span> (input <span class="codeReserved">instanceof</span> HTMLImageElement) {</td></tr>
  <tr><td>126</td><td>   <span class="codeReserved">return</span> input</td></tr>
  <tr><td>127</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>128</td><td>   <span class="codeReserved">return</span> <span class="codeReserved">null</span></td></tr>
  <tr><td>129</td><td>  }</td></tr>
  <tr><td>130</td><td> }</td></tr>
  <tr><td>131</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-devuelveCreated-php.html">lib / php / devuelveCreated.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-devuelveNoContent-php.html">lib / php / devuelveNoContent.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-fetch-php.html">lib / php / fetch.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-fetchAll-php.html">lib / php / fetchAll.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-NOT_FOUND-php.html">lib / php / NOT_FOUND.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-recuperaArray-php.html">lib / php / recuperaArray.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-recuperaDecimal-php.html">lib / php / recuperaDecimal.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-recuperaEntero-php.html">lib / php / recuperaEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-recuperaIdEntero-php.html">lib / php / recuperaIdEntero.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveCreated.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveCreated($urlDelNuevo, $resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(201);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Location: {$urlDelNuevo}"</span>);</td></tr>
  <tr><td>17</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>18</td><td>  echo $json;</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td>}</td></tr>
  <tr><td>21</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveNoContent.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> devuelveNoContent()</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> http_response_code(204);</td></tr>
  <tr><td>6</td><td>}</td></tr>
  <tr><td>7</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / fetch.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetch(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">if</span> ($opcional === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>20</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch($mode);</td></tr>
  <tr><td>21</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>22</td><td>   $statement-&gt;setFetchMode($mode, $opcional);</td></tr>
  <tr><td>23</td><td>   <span class="codeReserved">return</span> $statement-&gt;fetch();</td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >9. lib / php / fetchAll.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> fetchAll(</td></tr>
  <tr><td>4</td><td> PDOStatement|<span class="codeReserved">false</span> $statement,</td></tr>
  <tr><td>5</td><td> $parametros = [],</td></tr>
  <tr><td>6</td><td> <span class="codeReserved">int</span> $mode = PDO::FETCH_OBJ,</td></tr>
  <tr><td>7</td><td> $opcional = <span class="codeReserved">null</span></td></tr>
  <tr><td>8</td><td>): array {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($statement === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  <span class="codeReserved">if</span> (sizeof($parametros) &gt; 0) {</td></tr>
  <tr><td>16</td><td>   $statement-&gt;execute($parametros);</td></tr>
  <tr><td>17</td><td>  }</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  $resultado = $opcional === <span class="codeReserved">null</span></td></tr>
  <tr><td>20</td><td>   ? $statement-&gt;fetchAll($mode)</td></tr>
  <tr><td>21</td><td>   : $statement-&gt;fetchAll($mode, $opcional);</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">if</span> ($resultado === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>24</td><td>   <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>25</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">return</span> $resultado;</td></tr>
  <tr><td>27</td><td>  }</td></tr>
  <tr><td>28</td><td> }</td></tr>
  <tr><td>29</td><td>}</td></tr>
  <tr><td>30</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >10. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >11. lib / php / NOT_FOUND.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> NOT_FOUND = 404;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >12. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >13. lib / php / recuperaArray.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera los valores asociados a un</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * parÃ¡metro multivaluado; por ejemplo, un</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * grupo de checkbox, recibido en el servidor</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * por medio de GET, POST o cookie. Si no se</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * recibe el parÃ¡metro, devuelve []. Si el</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * valor recibido no es un arreglo, lo coloca</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> * dentro de uno.</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>12</td><td><span class="codeReserved">function</span> recuperaArray(string $parametro)</td></tr>
  <tr><td>13</td><td>{</td></tr>
  <tr><td>14</td><td> <span class="codeReserved">if</span> (isset($_REQUEST[$parametro])) {</td></tr>
  <tr><td>15</td><td>  $valor = $_REQUEST[$parametro];</td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">return</span> is_array($valor)</td></tr>
  <tr><td>17</td><td>   ? $valor</td></tr>
  <tr><td>18</td><td>   : [$valor];</td></tr>
  <tr><td>19</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">return</span> [];</td></tr>
  <tr><td>21</td><td> }</td></tr>
  <tr><td>22</td><td>}</td></tr>
  <tr><td>23</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >14. lib / php / recuperaDecimal.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * Recupera el valor decimal de un parÃ¡metro (que</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * puede tener fracciones) enviado al servidor por</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * medio de GET, POST o cookie.</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuekve <span class="codeReserved">false</span></span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> * Si se recibe una cadena vacÃ­a, se devuelve <span class="codeReserved">null</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>14</td><td><span class="codeComment"> * Si parÃ¡metro no se puede convertir a entero,</span></td></tr>
  <tr><td>15</td><td><span class="codeComment"> * devuelve 0.</span></td></tr>
  <tr><td>16</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>17</td><td><span class="codeReserved">function</span> recuperaDecimal(string $parametro): <span class="codeReserved">false</span>|<span class="codeReserved">null</span>|float</td></tr>
  <tr><td>18</td><td>{</td></tr>
  <tr><td>19</td><td> $valor = recuperaTexto($parametro);</td></tr>
  <tr><td>20</td><td> <span class="codeReserved">if</span> ($valor === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">elseif</span> ($valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span>;</td></tr>
  <tr><td>24</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>25</td><td>  <span class="codeReserved">return</span> (float) trim($valor);</td></tr>
  <tr><td>26</td><td> }</td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $valor === <span class="codeReserved">null</span>|| $valor === <span class="codeString">""</span></td></tr>
  <tr><td>28</td><td>  ? <span class="codeReserved">null</span></td></tr>
  <tr><td>29</td><td>  : trim($valor);</td></tr>
  <tr><td>30</td><td>}</td></tr>
  <tr><td>31</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >15. lib / php / recuperaEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaTexto.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * Devuelve el valor entero de un parÃ¡metro recibido en el</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuekve <span class="codeReserved">false</span></span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> *</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> * Si se recibe una cadena vacÃ­a, se devuelve <span class="codeReserved">null</span>.</span></td></tr>
  <tr><td>12</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>13</td><td><span class="codeComment"> * Si parÃ¡metro no se puede convertir a entero, se genera</span></td></tr>
  <tr><td>14</td><td><span class="codeComment"> * un error.</span></td></tr>
  <tr><td>15</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>16</td><td><span class="codeReserved">function</span> recuperaEntero(string $parametro): <span class="codeReserved">false</span>|<span class="codeReserved">null</span>|<span class="codeReserved">int</span></td></tr>
  <tr><td>17</td><td>{</td></tr>
  <tr><td>18</td><td> $valor = recuperaTexto($parametro);</td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($valor === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">false</span>;</td></tr>
  <tr><td>21</td><td> } <span class="codeReserved">elseif</span> ($valor === <span class="codeString">""</span>) {</td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">return</span> <span class="codeReserved">null</span>;</td></tr>
  <tr><td>23</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>24</td><td>  <span class="codeReserved">return</span> (<span class="codeReserved">int</span>) trim($valor);</td></tr>
  <tr><td>25</td><td> }</td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >16. lib / php / recuperaIdEntero.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/recuperaEntero.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> recuperaIdEntero(string $parametro): <span class="codeReserved">int</span></td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> $id = recuperaEntero($parametro);</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>14</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>15</td><td>   title: <span class="codeString">"Falta el id."</span>,</td></tr>
  <tr><td>16</td><td>   type: <span class="codeString">"/error/faltaid.html"</span>,</td></tr>
  <tr><td>17</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de id."</span>,</td></tr>
  <tr><td>18</td><td>  );</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">if</span> ($id === <span class="codeReserved">null</span>)</td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>22</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>23</td><td>   title: <span class="codeString">"Id en blanco."</span>,</td></tr>
  <tr><td>24</td><td>   type: <span class="codeString">"/error/idenblanco.html"</span>,</td></tr>
  <tr><td>25</td><td>  );</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeReserved">return</span> $id;</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >17. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >M. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m21compras/m-error/m-cantidadenblanco-html.html">error / cantidadenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-cantidadincorrecta-html.html">error / cantidadincorrecta.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-detalledeventaincorrecto-html.html">error / detalledeventaincorrecto.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-detalledeventanoencontrado-html.html">error / detalledeventanoencontrado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-existenciasincorrectas-html.html">error / existenciasincorrectas.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-faltacantidad-html.html">error / faltacantidad.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-faltaid-html.html">error / faltaid.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-faltanombre-html.html">error / faltanombre.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-idenblanco-html.html">error / idenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-nombreenblanco-html.html">error / nombreenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-precioincorrecto-html.html">error / precioincorrecto.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-productonoencontrado-html.html">error / productonoencontrado.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m21compras/m-error/m-ventaencapturanoencontrada-html.html">error / ventaencapturanoencontrada.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / cantidadenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Cantidad en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon un nÃºmero en el campo cantidad.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / cantidadincorrecta.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;La cantidad no puede ser NAN&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;La cantidad no puede ser NAN&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / detalledeventaincorrecto.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Tipo incorrecto para un etalle de venta&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Tipo incorrecto para un etalle de venta&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / detalledeventanoencontrado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Detalle de venta no encontrado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Detalle de venta no encontrado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ningÃºn detalle de venta con el id de producto solicitado.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. error / existenciasincorrectas.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Las existencias no pueden ser NAN&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Las existencias no pueden ser NAN&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. error / faltacantidad.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta la cantidad&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta la cantidad&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de cantidad.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. error / faltaid.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el id&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el id&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de id.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. error / faltanombre.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el nombre&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el nombre&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. error / idenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Id en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Id en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >K. error / nombreenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Nombre en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon texto en el campo nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >L. error / precioincorrecto.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El precio no puede ser NAN&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El precio no puede ser NAN&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >M. error / productonoencontrado.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Producto no encontrado&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Producto no encontrado&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ningÃºn producto con el id solicitado.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >N. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >O. error / ventaencapturanoencontrada.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Venta en captura no encontrada&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Venta en captura no encontrada&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;No se encontrÃ³ ninguna venta en captura.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >N. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >O. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ la base de una aplicaciÃ³n que vende o compra.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >25. Pruebas</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m22pruebas/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mBlighthouse.html">Pruebas de rendimiento y soporte de estÃ¡ndares</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/">PHPUnit</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/">Jasmine</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mFcurl.html">Prueba de los servicios</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mEapp.html">Pruebas de la app</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se muestra como probar una aplicaciÃ³n web.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Pruebas de rendimiento y soporte de estÃ¡ndares</h1><div class="lectura">
 <ul>
  <li>
   <p>
    <dfn>Lighthouse</dfn>
    es una herramienta automatizada para mejorar el rendimiento, calidad y
    correcciÃ³n de aplicaciones web.
   </p>
  </li>
  <li>
   <p>
    <a href="https://drive.google.com/file/d/14ev2YZVrturnlNOn9cS4nMH0LvWTU5Ad/view?usp=sharing"
      target="_blank" rel="noreferrer">Video sobre el uso de Lighthouse.</a>
   </p>
  </li>
 </ul>
</div>
      </section>
     <section>
         <h1 >C. PHPUnit</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/mAintro.html">introducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/mBsalida.html">Salida de las pruebas realizadas</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m01instrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-src/">Carpeta Â« src Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-tests/">Carpeta Â« tests Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-composer-json.html">composer.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-composer-lock.html">composer.lock</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-vendor/">Carpeta Â« vendor Â»</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >1. introducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Las
    <dfn>pruebas de unidad</dfn>
    permiten asegurar que una parte del cÃ³digo cumple correctamente con sus
    funciones.
   </p>
  </li>
  <li>
   <p>
    A continuaciÃ³n se muestra como realizar pruebas del servidor con PHPunit.
   </p>
  </li>
  <li>
   <p>
    En la prÃ¡ctica, los sistemas deben pasar todas las pruebas. En este ejemplo
    se fallan algunas.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >2. Salida de las pruebas realizadas</h1><div class="lectura">
 <p>
  Esta salida muestra algunos fallos para que te des cuenta como se ven. En la
  prÃ¡ctica, todas la pruebas deben aprobarse.
 </p>
 <pre style="white-space: pre-wrap;overflow-wrap: anywhere"><samp>
  PHPUnit 10.5.5 by Sebastian Bergmann and contributors.

  Runtime:       PHP 8.2.7
  
  ..F                                                                 3 / 3 (100%)
  
  Time: 00:00.091, Memory: 8.00 MB
  
  There was 1 failure:
  
  1) RecomiendaTest::testReg2
  Probando reg 2
  Failed asserting that two strings are equal.
  --- Expected
  +++ Actual
  @@ @@
  -'Daddy Yankee.'
  +'Bad Bunny.'
  
  /home/runner/phpunit/tests/RecomiendaTest.php:19
</samp></pre>
</div>
      </section>
     <section >
         <h1 >3. Hazlo funcionar</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este ejercicio usa la librerÃ­a PHPUnit para PHP. Puedes profundizar en este
    tema en la URL
    <a href="https://phpunit.de/" rel="noreferrer"
      target="_blank">https://phpunit.de/</a>
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/phpunit.zip" download>/src/phpunit.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que que desees.
   </p>
  </li>
  <li>
   <p>
    El proyecto ya contiene la carpeta <q>vendor</q> y el
    archivo <q>composer.lock</q>, pero si quieres crearlos, debes seguir estos
    pasos:
   </p>
   <ol>
    <li>
     <p>
      Instalar composer. Para Windows, usa el instalador de
      <a href="https://getcomposer.org/download/" rel="noreferrer"
        target="_blank">>https://getcomposer.org/download/</a>.
     </p>
    </li>
    <li>
     <p>
      Abre una terminal y ejecuta el comando
      <br><samp>composer update</samp>
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    Abre una terminal y ejecuta el comando
    <br><samp>./vendor/bin/phpunit tests</samp>
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >4. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-composer-json.html">composer.json</a></p>
  </li>
  <li>
   <p><a href="m-composer-lock.html">composer.lock</a></p>
  </li>
    <li>
     <details>
      <summary>src</summary>
      <ul>
  <li>
   <p><a href="m-src/m-recomienda-php.html">recomienda.php</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>tests</summary>
      <ul>
  <li>
   <p><a href="m-tests/m-RecomiendaTest-php.html">RecomiendaTest.php</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>vendor</summary>
      <ul>
  <li>
   <p><a href="m-vendor/m--- No se muestra el contenido de esta carpeta --.html">-- No se muestra el contenido de esta carpeta --</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section>
         <h1 >5. Carpeta Â« src Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-src/m-recomienda-php.html">src / recomienda.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. src / recomienda.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> recomienda(string $genero): string</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">if</span> ($genero === <span class="codeString">&quot;pop&quot;</span>) {</td></tr>
  <tr><td>6</td><td>  <span class="codeReserved">return</span> <span class="codeString">&quot;Dua Lipa.&quot;</span>;</td></tr>
  <tr><td>7</td><td> } <span class="codeReserved">elseif</span> ($genero === <span class="codeString">&quot;reg&quot;</span>) {</td></tr>
  <tr><td>8</td><td>  <span class="codeReserved">return</span> <span class="codeString">&quot;Bad Bunny.&quot;</span>;</td></tr>
  <tr><td>9</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">return</span> <span class="codeString">&quot;De eso no conozco&quot;</span>;</td></tr>
  <tr><td>11</td><td> }</td></tr>
  <tr><td>12</td><td>}</td></tr>
  <tr><td>13</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >6. Carpeta Â« tests Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-tests/m-RecomiendaTest-php.html">tests / RecomiendaTest.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. tests / RecomiendaTest.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td>use PHPUnit\Framework\TestCase;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">&quot;/../src/recomienda.php&quot;</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td>final <span class="codeReserved">class</span> RecomiendaTest extends TestCase</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> testPop()</td></tr>
  <tr><td>10</td><td> {</td></tr>
  <tr><td>11</td><td>  $<span class="codeReserved">this</span>-&gt;assertEquals(<span class="codeString">&quot;Dua Lipa.&quot;</span>, recomienda(<span class="codeString">&quot;pop&quot;</span>), <span class="codeString">&quot;Probando pop&quot;</span>);</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> testReg()</td></tr>
  <tr><td>14</td><td> {</td></tr>
  <tr><td>15</td><td>  $<span class="codeReserved">this</span>-&gt;assertEquals(<span class="codeString">&quot;Bad Bunny.&quot;</span>, recomienda(<span class="codeString">&quot;reg&quot;</span>), <span class="codeString">&quot;Probando reg&quot;</span>);</td></tr>
  <tr><td>16</td><td> }</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> testReg2()</td></tr>
  <tr><td>18</td><td> {</td></tr>
  <tr><td>19</td><td>  $<span class="codeReserved">this</span>-&gt;assertEquals(<span class="codeString">&quot;Daddy Yankee.&quot;</span>, recomienda(<span class="codeString">&quot;reg&quot;</span>), <span class="codeString">&quot;Probando reg 2&quot;</span>);</td></tr>
  <tr><td>20</td><td> }</td></tr>
  <tr><td>21</td><td>}</td></tr>
  <tr><td>22</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >7. composer.json</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;require-dev&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;phpunit/phpunit&quot;</span>: <span class="codeString">&quot;^10&quot;</span></td></tr>
  <tr><td>4</td><td> }</td></tr>
  <tr><td>5</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. composer.lock</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>-- No se muestra eÃ± contenido de este archivo --</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >9. Carpeta Â« vendor Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m22pruebas/mCphpunit/m-vendor/m--- No se muestra el contenido de esta carpeta --.html">vendor / -- No se muestra el contenido de esta carpeta --</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. vendor / -- No se muestra el contenido de esta carpeta --</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >D. Jasmine</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/mAintro.html">introducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/mBsalida.html">Salida de las pruebas realizadas</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/mAinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-src/">Carpeta Â« src Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-spec/">Carpeta Â« spec Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-package-json.html">package.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-package-lock-json.html">package-lock.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-node_modules/">Carpeta Â« node_modules Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >1. introducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Las
    <dfn>pruebas de unidad</dfn>
    permiten asegurar que una parte del cÃ³digo cumple correctamente con sus
    funciones.
   </p>
  </li>
  <li>
   <p>
    A continuaciÃ³n se muestra como realizar pruebas del cliente con Jasmine.
   </p>
  </li>
  <li>
   <p>
    En la prÃ¡ctica, los sistemas deben pasar todas las pruebas. En este ejemplo
    se fallan algunas.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >2. Salida de las pruebas realizadas</h1><div class="lectura">
 <p>
  Esta salida muestra algunos fallos para que te des cuenta como se ven. En la
  prÃ¡ctica, todas la pruebas deben aprobarse.
 </p>
 <pre style="white-space: pre-wrap;overflow-wrap: anywhere"><samp>
> nodejs@1.0.0 test
> jasmine

Randomized with seed 87173
Started
.<span class="codeString">F</span>.

Failures:
1) recomienda reg2
  Message:
  <span class="codeString">Expected 'Bad Bunny.' to be 'Daddy Yankee.'.</span>
  Stack:
        at &lt;Jasmine>
        at UserContext.&lt;anonymous> (file:///D:/gilpg/Documents/Sitios/awoas/jasminewin/spec/recomiendaSpec.js:6:45)
        at &lt;Jasmine>

3 specs, 1 failure
Finished in 0.012 seconds
Randomized with seed 87173 (jasmine --random=true --seed=87173)
</samp></pre>
</div>
      </section>
     <section >
         <h1 >3. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Este ejercicio usa la librerÃ­a Jasmine para JavaScript. Puedes profundizar
    en este tema en la URL
    <a href="https://jasmine.github.io/" rel="noreferrer"
      target="_blank">https://jasmine.github.io/</a>
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/jasmine.zip" download>/src/jasmine.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees. El cÃ³digo a probar se coloca en la
    carpeta <q>src</q> y las pruebas en la carpeta <q>spec</q>.
   </p>
  </li>
  <li>
   <p>
    El proyecto ya contiene la carpeta <q>node_modules</q> y el
    archivo <q>package-lock.json</q>, pero si quieres crearlos, debes seguir
    estos pasos:
   </p>
   <ol>
    <li>
     <p>
      Instala Node.js desde
      <a href="https://nodejs.org/en" target="_blank"
        rel="noreferrer">https://nodejs.org/en</a>.
     </p>
    </li>
    <li>
     <p>
      Desde Visual Studio Code abre una terminal y usa el siguiente comando para
      inicializar el proyecto de node:
      <br><kbd>npm init -y</kbd>
     </p>
    </li>
    <li>
     <p>
      Edita el archivo <q>packege.json</q> e inserta en la linea 6, sin borrar
      ni sobreescribir nada, la siguiente lÃ­nea
      <br><code>"type": "module",</code>
     </p>
    </li>
    <li>
     <p>
      En el mismo archivo <q>packege.json</q> cambia la lÃ­nea que dice
      <code>"test"</code> a que diga:
      <br><code>"test": "jasmine"</code>
     </p>
    </li>
    <li>
     <p>Instala Jasmine en el proyecto con la orden:
      <br><kbd>npm install --save-dev jasmine</kbd>
     </p>
    </li>
    <li>
     <p>Inicializa Jasmine con la orden:
      <br><kbd>npx jasmine init</kbd>
     </p>
    </li>
   </ol>
  <li>
   <p>Ejecuta las pruebas con la orden:
    <br><kbd>npm run test</kbd>
   </p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >4. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
  <li>
   <p><a href="m-package-lock-json.html">package-lock.json</a></p>
  </li>
  <li>
   <p><a href="m-package-json.html">package.json</a></p>
  </li>
    <li>
     <details>
      <summary>node_modules</summary>
      <ul>
  <li>
   <p><a href="m-node_modules/m--- No se muestra el contenido de esta carpeta --.html">-- No se muestra el contenido de esta carpeta --</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>spec</summary>
      <ul>
  <li>
   <p><a href="m-spec/m-recomiendaSpec-js.html">recomiendaSpec.js</a></p>
  </li>
    <li>
     <details>
      <summary>support</summary>
      <ul>
  <li>
   <p><a href="m-spec/m-support/m-jasmine-json.html">jasmine.json</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>src</summary>
      <ul>
  <li>
   <p><a href="m-src/m-recomienda-js.html">recomienda.js</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section>
         <h1 >5. Carpeta Â« src Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-src/m-recomienda-js.html">src / recomienda.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. src / recomienda.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} genero</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> recomienda(genero) {</td></tr>
  <tr><td>5</td><td> <span class="codeReserved">if</span> (genero === <span class="codeString">"pop"</span>) {</td></tr>
  <tr><td>6</td><td>  <span class="codeReserved">return</span> <span class="codeString">"Dua Lipa."</span></td></tr>
  <tr><td>7</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (genero === <span class="codeString">"reg"</span>) {</td></tr>
  <tr><td>8</td><td>  <span class="codeReserved">return</span> <span class="codeString">"Bad Bunny."</span></td></tr>
  <tr><td>9</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>10</td><td>  <span class="codeReserved">return</span> <span class="codeString">"De eso no conozco."</span></td></tr>
  <tr><td>11</td><td> }</td></tr>
  <tr><td>12</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >6. Carpeta Â« spec Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-spec/m-recomiendaSpec-js.html">spec / recomiendaSpec.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-spec/m-support/">Carpeta Â« spec / support Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. spec / recomiendaSpec.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { recomienda } <span class="codeReserved">from</span> <span class="codeString">'../src/recomienda.js'</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td>describe(<span class="codeString">"recomienda"</span>, () =&gt; {</td></tr>
  <tr><td>4</td><td> it(<span class="codeString">"pop"</span>, () =&gt; expect(recomienda(<span class="codeString">"pop"</span>)).toBe(<span class="codeString">"Dua Lipa."</span>))</td></tr>
  <tr><td>5</td><td> it(<span class="codeString">"reg"</span>, () =&gt; expect(recomienda(<span class="codeString">"reg"</span>)).toBe(<span class="codeString">"Bad Bunny."</span>))</td></tr>
  <tr><td>6</td><td> it(<span class="codeString">"reg2"</span>, () =&gt; expect(recomienda(<span class="codeString">"reg"</span>)).toBe(<span class="codeString">"Daddy Yankee."</span>))</td></tr>
  <tr><td>7</td><td>})</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >B. Carpeta Â« spec / support Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-spec/m-support/m-jasmine-json.html">spec / support / jasmine.json</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. spec / support / jasmine.json</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td>  <span class="codeString">"spec_dir"</span>: <span class="codeString">"spec"</span>,</td></tr>
  <tr><td>3</td><td>  <span class="codeString">"spec_files"</span>: [</td></tr>
  <tr><td>4</td><td>    <span class="codeString">"**/*[sS]pec.?(m)js"</span></td></tr>
  <tr><td>5</td><td>  ],</td></tr>
  <tr><td>6</td><td>  <span class="codeString">"helpers"</span>: [</td></tr>
  <tr><td>7</td><td>    <span class="codeString">"helpers/**/*.?(m)js"</span></td></tr>
  <tr><td>8</td><td>  ],</td></tr>
  <tr><td>9</td><td>  <span class="codeString">"env"</span>: {</td></tr>
  <tr><td>10</td><td>    <span class="codeString">"stopSpecOnExpectationFailure"</span>: <span class="codeReserved">false</span>,</td></tr>
  <tr><td>11</td><td>    <span class="codeString">"random"</span>: <span class="codeReserved">true</span></td></tr>
  <tr><td>12</td><td>  }</td></tr>
  <tr><td>13</td><td>}</td></tr>
  <tr><td>14</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section >
         <h1 >7. package.json</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">"name"</span>: <span class="codeString">"nodejs"</span>,</td></tr>
  <tr><td>3</td><td> <span class="codeString">"version"</span>: <span class="codeString">"1.0.0"</span>,</td></tr>
  <tr><td>4</td><td> <span class="codeString">"description"</span>: ,</td></tr>
  <tr><td>5</td><td> <span class="codeString">"main"</span>: <span class="codeString">"index.js"</span>,</td></tr>
  <tr class="resaltado"><td>6</td><td> <span class="codeString">"type"</span>: <span class="codeString">"module"</span>,</td></tr>
  <tr><td>7</td><td> <span class="codeString">"scripts"</span>: {</td></tr>
  <tr class="resaltado"><td>8</td><td>   <span class="codeString">"test"</span>: <span class="codeString">"jasmine"</span></td></tr>
  <tr><td>9</td><td> },</td></tr>
  <tr><td>10</td><td> <span class="codeString">"keywords"</span>: [],</td></tr>
  <tr><td>11</td><td> <span class="codeString">"author"</span>: ,</td></tr>
  <tr><td>12</td><td> <span class="codeString">"license"</span>: <span class="codeString">"ISC"</span>,</td></tr>
  <tr><td>13</td><td> <span class="codeString">"dependencies"</span>: {</td></tr>
  <tr><td>14</td><td>   <span class="codeString">"@types/node"</span>: <span class="codeString">"^18.0.6"</span>,</td></tr>
  <tr><td>15</td><td>   <span class="codeString">"node-fetch"</span>: <span class="codeString">"^3.2.6"</span></td></tr>
  <tr><td>16</td><td> },</td></tr>
  <tr><td>17</td><td> <span class="codeString">"devDependencies"</span>: {</td></tr>
  <tr><td>18</td><td>   <span class="codeString">"jasmine"</span>: <span class="codeString">"^5.1.0"</span></td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td>}</td></tr>
  <tr><td>21</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. package-lock.json</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>-- No se muestra el contenido de este archivo. --</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >9. Carpeta Â« node_modules Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m22pruebas/mDjasmine/m-node_modules/m--- No se muestra el contenido de esta carpeta --.html">node_modules / -- No se muestra el contenido de esta carpeta --</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. node_modules / -- No se muestra el contenido de esta carpeta --</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >10. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >E. Prueba de los servicios</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este ejercicio usa el comando curl, que nos permite realizar una
    conexiÃ³n a un sitio. Puedes profundizar en este tema en la URL
    <a href="https://curl.se/" rel="noreferrer"
      target="_blank">https://curl.se/</a>
   </p>
  </li>
  <li>
   <p>
    Si usas un sistema similar a Unix, como Linux o macOS, curl ya estÃ¡
    instalado. Si usas Windows, descarga curl desde
    <a href="https://curl.se/windows/" rel="noreferrer"
      target="_blank">https://curl.se/windows/</a>.
    DescompÃ¡ctalo y copia la carpeta a C:, AÃ±Ã¡de la ruta hasta la subcarpeta
    <em>bin</em> a la variable de ambiente <em>Path</em>.
   </p>
  </li>
  <li>
   <p>Corre localmente el proyecto srvdevuelve.</p>
  </li>
  <li>
   <p>Crea una carpeta para el proyecto y Ã¡brela con Visual Studio Code.</p>
  </li>
  <li>
   <p>Crea el archivo <q>curl.bat</q> y ponle el siguiente contenido.</p>
   <muestra-codigo>
    <div>
     <div>curl http://localhost/srv/devuelve.php
     </div>
     <div></div>
    </div>
   </muestra-codigo>
  </li>
  <p>Ejecuta el proyecto con la orden:
   <br><kbd>curl.bat</kbd>
 </ul>
</div>
      </section>
     <section >
         <h1 >F. Pruebas de la app</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Hay herramientas que permiten probar toda la aplicaciÃ³n.
   </p>
  </li>
  <li>
   <p>Cypress:
    <a href="https://www.cypress.io/"
      target="_blank" rel="noreferrer">https://www.cypress.io/</a>.
   </p>
  </li>
  <li>
   <p>Selenium:
    <a href="https://www.selenium.dev/"
      target="_blank" rel="noreferrer">https://www.selenium.dev/</a>.
   </p>
  </li>
  <li>
   <p>Puppeteer:
    <a href="https://github.com/puppeteer/puppeteer"
      target="_blank" rel="noreferrer">https://github.com/puppeteer/puppeteer</a>.
   </p>
  </li>
  <li>
   <p>
    <a href="https://drive.google.com/file/d/1TlTaJZa7iLUhN3nM9EmDap8jZfotFFOh/view?usp=sharing"
      target="_blank" rel="noreferrer">Video sobre la instalaciÃ³n de Selenium.</a>
   </p>
  </li>
  <li>
   <p>
    <a href="https://drive.google.com/file/d/1XwKZekALsv2GOGqlS4EhiI29UpBgKGV9/view?usp=sharing"
      target="_blank" rel="noreferrer">Video sobre el uso de Selenium.</a>
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >G. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ como probar una aplicaciÃ³n web.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
     <section>
         <h1 >26. Servicio con token</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m23token/mAintro.html">IntroducciÃ³n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/mDdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/mGinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-formulario-html.html">formulario.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-srv/">Carpeta Â« srv Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/">Carpeta Â« lib Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/">Carpeta Â« error Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/mTresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. IntroducciÃ³n</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este ejemplo muestra como proteger servicios y formas con el uso de tokens.
   </p>
  </li>
  <li>
   <p>
    Puedes probar el ejemplo en
    <a href="http://srvtoken.rf.gd/" rel="noreferrer"
      target="_blank">http://srvtoken.rf.gd/</a>.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >B. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m23token/srvtokendistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section >
         <h1 >C. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvtoken.rf.gd/" rel="noreferrer"
      target="_blank">http://srvtoken.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p>
    Descarga el archivo
    <a href="/src/srvtoken.zip" download>/src/srvtoken.zip</a> y
    descompÃ¡ctalo.
   </p>
  </li>
  <li>
   <p>
    Abre la carpeta descompactada con Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    Edita los archivos que desees.
   </p>
  </li>
  <li>
   <p>
    Haz clic derecho en <em>index.html</em>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p>Para depurar paso a paso haz lo siguiente:</p>
   <ol>
    <li>
     <p>
      En el navegador, haz clic derecho en la pÃ¡gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pestaÃ±a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      estÃ¡ en InglÃ©s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el nÃºmero de la lÃ­nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no estÃ¡ configurada la depuraciÃ³n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em> <img alt=""
        src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraciÃ³n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el nÃºmero de la lÃ­nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la pÃ¡gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las lÃ­neas de cÃ³digo seleccionadas, aparece
      resaltada en la pestaÃ±a de fuentes. Usa los controles de depuraciÃ³n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    SÃºbelo al hosting que elijas. En algunos casos puedes usar filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >D. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los triÃ¡ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-formulario-html.html">formulario.html</a></p>
  </li>
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltanombre-html.html">faltanombre.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltasaludo-html.html">faltasaludo.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-faltatoken-html.html">faltatoken.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-nombreenblanco-html.html">nombreenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-paginaexpirada-html.html">paginaexpirada.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-paginanoregistrada-html.html">paginanoregistrada.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-saludoenblanco-html.html">saludoenblanco.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-sintokens-html.html">sintokens.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-submitForm-js.html">submitForm.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-BAD_REQUEST-php.html">BAD_REQUEST.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-creaToken-php.html">creaToken.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveErrorInterno-php.html">devuelveErrorInterno.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveProblemDetails-php.html">devuelveProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-ProblemDetails-php.html">ProblemDetails.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-recuperaTexto-php.html">recuperaTexto.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-validaToken-php.html">validaToken.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-procesa-php.html">procesa.php</a></p>
  </li>
  <li>
   <p><a href="m-srv/m-registra-php.html">registra.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >E. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Uso de tokens&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Uso de tokens&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  &lt;<span class="codeReserved">a</span> href=<span class="codeString">"formulario.html"</span>&gt;Servicio que procesa un formulario con token.&lt;/<span class="codeReserved">a</span>&gt;</td></tr>
  <tr><td>19</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. formulario.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Servicio que procesa un formulario con token&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/consumeJson.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>12</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/submitForm.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>13</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span> <span class="codeReserved">src</span>=<span class="codeString">"lib/js/muestraError.js"</span>&gt;&lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> token = <span class="codeString">""</span></td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td><span class="codeComment">&lt;!-- Al cargar, registra este formulario en la sesiÃ³n y recibe un token. --&gt;</span></td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>&lt;<span class="codeReserved">body</span> onload=<span class="codeString">"consumeJson(&#039;srv/registra.php&#039;)</span></td></tr>
  <tr><td>26</td><td><span class="codeString">  .then(token =&gt; forma.token.value = token.body)</span></td></tr>
  <tr><td>27</td><td><span class="codeString">  .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> &lt;<span class="codeReserved">form</span> id=<span class="codeString">"forma"</span> onsubmit=<span class="codeString">"submitForm(&#039;srv/procesa.php&#039;, event)</span></td></tr>
  <tr><td>30</td><td><span class="codeString">    .then(resultado =&gt; {</span></td></tr>
  <tr><td>31</td><td><span class="codeString">     alert(resultado.body)</span></td></tr>
  <tr><td>32</td><td><span class="codeString">     location.href = &#039;index.html&#039;</span></td></tr>
  <tr><td>33</td><td><span class="codeString">    })</span></td></tr>
  <tr><td>34</td><td><span class="codeString">    .<span class="codeReserved">catch</span>(muestraError)"</span>&gt;</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td>  &lt;<span class="codeReserved">h1</span>&gt;Servicio que procesa un formulario con token&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td>  &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">a</span> href=<span class="codeString">"index.html"</span>&gt;Cancela&lt;/<span class="codeReserved">a</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>  <span class="codeComment">&lt;!-- Al enviar la forma, se envÃ­a el token recibido. --&gt;</span></td></tr>
  <tr><td>41</td><td>  &lt;<span class="codeReserved">input</span> type=<span class="codeString">"hidden"</span> name=<span class="codeString">"token"</span>&gt;</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>44</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>45</td><td>    Saludo:</td></tr>
  <tr><td>46</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"saludo"</span>&gt;</td></tr>
  <tr><td>47</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>48</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>51</td><td>   &lt;<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>52</td><td>    Nombre:</td></tr>
  <tr><td>53</td><td>    &lt;<span class="codeReserved">input</span> name=<span class="codeString">"nombre"</span>&gt;</td></tr>
  <tr><td>54</td><td>   &lt;/<span class="codeReserved">label</span>&gt;</td></tr>
  <tr><td>55</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>  &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>58</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"reset"</span>&gt;Restaurar&lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>59</td><td>   &lt;<span class="codeReserved">button</span> type=<span class="codeString">"submit"</span>&gt;Procesa&lt;/<span class="codeReserved">button</span>&gt;</td></tr>
  <tr><td>60</td><td>  &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td> &lt;/<span class="codeReserved">form</span>&gt;</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >G. Carpeta Â« srv Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m23token/m-srv/m-procesa-php.html">srv / procesa.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-srv/m-registra-php.html">srv / registra.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / procesa.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/BAD_REQUEST.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/validaToken.php"</span>;</td></tr>
  <tr><td>6</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/recuperaTexto.php"</span>;</td></tr>
  <tr><td>7</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/ProblemDetails.php"</span>;</td></tr>
  <tr><td>8</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>9</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>10</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> session_start();</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> $token = recuperaTexto(<span class="codeString">"token"</span>);</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> ($token === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>19</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>20</td><td>   title: <span class="codeString">"Falta el token."</span>,</td></tr>
  <tr><td>21</td><td>   type: <span class="codeString">"/error/faltatoken.html"</span>,</td></tr>
  <tr><td>22</td><td>  );</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> validaToken(<span class="codeString">"formulario"</span>, $token);</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td> <span class="codeComment">// Si el token se hallÃ³, precesa normalmente la forma.</span></td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td> $saludo = recuperaTexto(<span class="codeString">"saludo"</span>);</td></tr>
  <tr><td>30</td><td> $nombre = recuperaTexto(<span class="codeString">"nombre"</span>);</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> <span class="codeReserved">if</span> ($saludo === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>33</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>34</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>35</td><td>   title: <span class="codeString">"Falta el saludo."</span>,</td></tr>
  <tr><td>36</td><td>   type: <span class="codeString">"/error/faltasaludo.html"</span>,</td></tr>
  <tr><td>37</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de saludo."</span>,</td></tr>
  <tr><td>38</td><td>  );</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td> <span class="codeReserved">if</span> ($saludo === <span class="codeString">""</span>)</td></tr>
  <tr><td>41</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>42</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>43</td><td>   title: <span class="codeString">"El saludo estÃ¡ en blanco."</span>,</td></tr>
  <tr><td>44</td><td>   type: <span class="codeString">"/error/saludoenblanco.html"</span>,</td></tr>
  <tr><td>45</td><td>   detail: <span class="codeString">"Pon texto en el campo saludo."</span>,</td></tr>
  <tr><td>46</td><td>  );</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td> <span class="codeReserved">if</span> ($nombre === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>49</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>50</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>51</td><td>   title: <span class="codeString">"Falta el nombre."</span>,</td></tr>
  <tr><td>52</td><td>   type: <span class="codeString">"/error/faltanombre.html"</span>,</td></tr>
  <tr><td>53</td><td>   detail: <span class="codeString">"La solicitud no tiene el valor de nombre."</span>,</td></tr>
  <tr><td>54</td><td>  );</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td> <span class="codeReserved">if</span> ($nombre === <span class="codeString">""</span>)</td></tr>
  <tr><td>57</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>58</td><td>   status: BAD_REQUEST,</td></tr>
  <tr><td>59</td><td>   title: <span class="codeString">"El nombre estÃ¡ en blanco."</span>,</td></tr>
  <tr><td>60</td><td>   type: <span class="codeString">"/error/nombreenblanco.html"</span>,</td></tr>
  <tr><td>61</td><td>   detail: <span class="codeString">"Pon texto en el campo nombre."</span>,</td></tr>
  <tr><td>62</td><td>  );</td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td> $resultado = <span class="codeString">"{$saludo} {$nombre}."</span>;</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td> devuelveJson($resultado);</td></tr>
  <tr><td>67</td><td>} <span class="codeReserved">catch</span> (ProblemDetails $details) {</td></tr>
  <tr><td>68</td><td></td></tr>
  <tr><td>69</td><td> devuelveProblemDetails($details);</td></tr>
  <tr><td>70</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>71</td><td></td></tr>
  <tr><td>72</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>73</td><td>}</td></tr>
  <tr><td>74</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. srv / registra.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/creaToken.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveErrorInterno.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">try</span> {</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> session_start();</td></tr>
  <tr><td>10</td><td> <span class="codeComment">// Crea un token para la pÃ¡gina &quot;formulario&quot; que expira en 5 minutos.</span></td></tr>
  <tr><td>11</td><td> devuelveJson(creaToken(<span class="codeString">"formulario"</span>, 5));</td></tr>
  <tr><td>12</td><td>} <span class="codeReserved">catch</span> (Throwable $error) {</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> devuelveErrorInterno($error);</td></tr>
  <tr><td>15</td><td>}</td></tr>
  <tr><td>16</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >H. Carpeta Â« lib Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m23token/m-lib/m-js/">Carpeta Â« lib / js Â»</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/">Carpeta Â« lib / php Â»</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta Â« lib / js Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m23token/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-js/m-submitForm-js.html">lib / js / submitForm.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * hay error, lanza una excepciÃ³n. Si no hay error,</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>14</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>15</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>16</td><td>  })</td></tr>
  <tr><td>17</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>19</td><td> }</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>22</td><td></td></tr>
  <tr><td>23</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo Ã©xito.</span></td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>29</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>44</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>45</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>46</td><td></td></tr>
  <tr><td>47</td><td>   }</td></tr>
  <tr><td>48</td><td></td></tr>
  <tr><td>49</td><td>  }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>52</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>53</td><td></td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>55</td><td></td></tr>
  <tr><td>56</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>57</td><td></td></tr>
  <tr><td>58</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>59</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>60</td><td></td></tr>
  <tr><td>61</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>62</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>63</td><td></td></tr>
  <tr><td>64</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>65</td><td></td></tr>
  <tr><td>66</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>67</td><td></td></tr>
  <tr><td>68</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>69</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>72</td><td></td></tr>
  <tr><td>73</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>74</td><td></td></tr>
  <tr><td>75</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>76</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>77</td><td></td></tr>
  <tr><td>78</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>79</td><td></td></tr>
  <tr><td>80</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>81</td><td></td></tr>
  <tr><td>82</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>83</td><td>      undefined, texto)</td></tr>
  <tr><td>84</td><td></td></tr>
  <tr><td>85</td><td>    }</td></tr>
  <tr><td>86</td><td></td></tr>
  <tr><td>87</td><td>   }</td></tr>
  <tr><td>88</td><td></td></tr>
  <tr><td>89</td><td>  }</td></tr>
  <tr><td>90</td><td></td></tr>
  <tr><td>91</td><td> }</td></tr>
  <tr><td>92</td><td></td></tr>
  <tr><td>93</td><td>}</td></tr>
  <tr><td>94</td><td></td></tr>
  <tr><td>95</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>96</td><td>window[<span class="codeString">"consumeJson"</span>] = consumeJson</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * alerta el mensaje de una excepciÃ³n.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripciÃ³n del error.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>8</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  console.log(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>13</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>19</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>20</td><td>  }</td></tr>
  <tr><td>21</td><td>  mensaje += <span class="codeString">`\n\nCÃ³digo: ${error.status}`</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>23</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  console.error(mensaje)</td></tr>
  <tr><td>27</td><td>  console.error(error)</td></tr>
  <tr><td>28</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>29</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>30</td><td>  alert(mensaje)</td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  console.error(error)</td></tr>
  <tr><td>35</td><td>  alert(error.message)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> }</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>}</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>42</td><td>window[<span class="codeString">"muestraError"</span>] = muestraError</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>6</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>12</td><td>  super(title)</td></tr>
  <tr><td>13</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>14</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>16</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>17</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>21</td><td>  <span class="codeComment">/** <span class="codeReserved">@readonly</span> */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>23</td><td> }</td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / submitForm.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./consumeJson.js"</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * EnvÃ­a los datos de la forma a la url usando la codificaciÃ³n</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * multipart/form-data.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {string} url</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {Event} event</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { &quot;GET&quot; | &quot;POST&quot;| &quot;PUT&quot; | &quot;PATCH&quot; | &quot;<span class="codeReserved">DELETE</span>&quot; | &quot;TRACE&quot; | &quot;OPTIONS&quot;</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> *  | &quot;CONNECT&quot; | &quot;HEAD&quot; } metodoHttp</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>11</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> submitForm(url, event, metodoHttp = <span class="codeString">"POST"</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td> event.preventDefault()</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">const</span> form = event.target</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> <span class="codeReserved">if</span> (!(form <span class="codeReserved">instanceof</span> HTMLFormElement))</td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"event.target no es un elemento de tipo form."</span>)</td></tr>
  <tr><td>19</td><td></td></tr>
  <tr><td>20</td><td> <span class="codeReserved">return</span> consumeJson(fetch(url, {</td></tr>
  <tr><td>21</td><td>  method: metodoHttp,</td></tr>
  <tr><td>22</td><td>  headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> },</td></tr>
  <tr><td>23</td><td>  body: <span class="codeReserved">new</span> FormData(form)</td></tr>
  <tr><td>24</td><td> }))</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>}</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td><span class="codeComment">// Permite que los eventos de html usen la funciÃ³n.</span></td></tr>
  <tr><td>29</td><td>window[<span class="codeString">"submitForm"</span>] = submitForm</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta Â« lib / php Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-BAD_REQUEST-php.html">lib / php / BAD_REQUEST.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-creaToken-php.html">lib / php / creaToken.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-devuelveErrorInterno-php.html">lib / php / devuelveErrorInterno.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-devuelveProblemDetails-php.html">lib / php / devuelveProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-ProblemDetails-php.html">lib / php / ProblemDetails.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-recuperaTexto-php.html">lib / php / recuperaTexto.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-lib/m-php/m-validaToken-php.html">lib / php / validaToken.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / BAD_REQUEST.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> BAD_REQUEST = 400;</td></tr>
  <tr><td>4</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / creaToken.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">function</span> creaToken(string $pagina, <span class="codeReserved">int</span> $duracionEnMinutos)</td></tr>
  <tr><td>4</td><td>{</td></tr>
  <tr><td>5</td><td> $criptografiaFuerte = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeComment">// Crea el token</span></td></tr>
  <tr><td>8</td><td> $token = [</td></tr>
  <tr><td>9</td><td>  <span class="codeString">"expiracion"</span> =&gt; time() + 60 * $duracionEnMinutos,</td></tr>
  <tr><td>10</td><td>  <span class="codeComment">// El token es de 80 caracteres, criptogrÃ¡ficamente fuerte.</span></td></tr>
  <tr><td>11</td><td>  <span class="codeString">"texto"</span> =&gt; bin2hex(openssl_random_pseudo_bytes(80, $criptografiaFuerte))</td></tr>
  <tr><td>12</td><td> ];</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> <span class="codeComment">// Verifica que ya haya tokens $pagina.</span></td></tr>
  <tr><td>15</td><td> <span class="codeReserved">if</span> (isset($_SESSION[$pagina])) {</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>  $tokensParaPagina = $_SESSION[$pagina];</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>  <span class="codeComment">// Como ya existe el arreglo, elimina los tokens expirados para esta pagina.</span></td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">foreach</span> ($tokensParaPagina <span class="codeReserved">as</span> $llave =&gt; $tokenParaPagina) {</td></tr>
  <tr><td>21</td><td>   <span class="codeReserved">if</span> ($tokenParaPagina[<span class="codeString">"expiracion"</span>] &gt; time()) {</td></tr>
  <tr><td>22</td><td>    unset($tokensParaPagina[$llave]);</td></tr>
  <tr><td>23</td><td>   }</td></tr>
  <tr><td>24</td><td>  }</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td>  <span class="codeComment">// Se puede usar uno o varios tokens por pagina.</span></td></tr>
  <tr><td>27</td><td>  $tokensParaPagina[] = $token;</td></tr>
  <tr><td>28</td><td>  $_SESSION[$pagina] = $tokensParaPagina;</td></tr>
  <tr><td>29</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  <span class="codeComment">// Se puede usar uno o varios tokens por pagina </span></td></tr>
  <tr><td>32</td><td>  $_SESSION[$pagina] = [$token];</td></tr>
  <tr><td>33</td><td> }</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td> <span class="codeReserved">return</span> $token[<span class="codeString">"texto"</span>];</td></tr>
  <tr><td>36</td><td>}</td></tr>
  <tr><td>37</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / devuelveErrorInterno.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveProblemDetails.php"</span>;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> devuelveErrorInterno(Throwable $error)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td> devuelveProblemDetails(<span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>10</td><td>  status: INTERNAL_SERVER_ERROR,</td></tr>
  <tr><td>11</td><td>  title: $error-&gt;getMessage(),</td></tr>
  <tr><td>12</td><td>  type: <span class="codeString">"/error/errorinterno.html"</span></td></tr>
  <tr><td>13</td><td> ));</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >5. lib / php / devuelveProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td><span class="codeReserved">function</span> devuelveProblemDetails(ProblemDetails $details)</td></tr>
  <tr><td>7</td><td>{</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> $body = [<span class="codeString">"title"</span> =&gt; $details-&gt;title];</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($details-&gt;type !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>11</td><td>  $body[<span class="codeString">"type"</span>] = $details-&gt;type;</td></tr>
  <tr><td>12</td><td> }</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">if</span> ($details-&gt;detail !== <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>14</td><td>  $body[<span class="codeString">"detail"</span>] = $details-&gt;detail;</td></tr>
  <tr><td>15</td><td> }</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $json = json_encode($body);</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>22</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>  http_response_code($details-&gt;status);</td></tr>
  <tr><td>25</td><td>  header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>26</td><td>  echo $json;</td></tr>
  <tr><td>27</td><td> }</td></tr>
  <tr><td>28</td><td>}</td></tr>
  <tr><td>29</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >6. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >7. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >8. lib / php / ProblemDetails.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/** Detalle de los errores devueltos por un servicio. */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Exception</td></tr>
  <tr><td>5</td><td>{</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td> <span class="codeReserved">public</span> <span class="codeReserved">int</span> $status;</td></tr>
  <tr><td>8</td><td> <span class="codeReserved">public</span> string $title;</td></tr>
  <tr><td>9</td><td> <span class="codeReserved">public</span> ?string $type;</td></tr>
  <tr><td>10</td><td> <span class="codeReserved">public</span> ?string $detail;</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td> <span class="codeReserved">public</span> <span class="codeReserved">function</span> <span class="codeReserved">__construct</span>(</td></tr>
  <tr><td>13</td><td>  <span class="codeReserved">int</span> $status,</td></tr>
  <tr><td>14</td><td>  string $title,</td></tr>
  <tr><td>15</td><td>  ?string $type = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>16</td><td>  ?string $detail = <span class="codeReserved">null</span>,</td></tr>
  <tr><td>17</td><td>  Throwable $previous = <span class="codeReserved">null</span></td></tr>
  <tr><td>18</td><td> ) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">parent</span>::<span class="codeReserved">__construct</span>($title, $status, $previous);</td></tr>
  <tr><td>20</td><td>  $this-&gt;status = $status;</td></tr>
  <tr><td>21</td><td>  $this-&gt;type = $type;</td></tr>
  <tr><td>22</td><td>  $this-&gt;title = $title;</td></tr>
  <tr><td>23</td><td>  $this-&gt;detail = $detail;</td></tr>
  <tr><td>24</td><td> }</td></tr>
  <tr><td>25</td><td>}</td></tr>
  <tr><td>26</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >9. lib / php / recuperaTexto.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> * Recupera el texto de un parÃ¡metro enviado al</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * servidor por medio de GET, POST o cookie.</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * Si el parÃ¡metro no se recibe, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">function</span> recuperaTexto(string $parametro): <span class="codeReserved">false</span>|string</td></tr>
  <tr><td>10</td><td>{</td></tr>
  <tr><td>11</td><td> <span class="codeComment">/* Si el parÃ¡metro estÃ¡ asignado en $_REQUEST,</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  * devuelve su valor; de lo contrario, devuelve <span class="codeReserved">false</span>.</span></td></tr>
  <tr><td>13</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>14</td><td> $valor = isset($_REQUEST[$parametro])</td></tr>
  <tr><td>15</td><td>  ? $_REQUEST[$parametro]</td></tr>
  <tr><td>16</td><td>  : <span class="codeReserved">false</span>;</td></tr>
  <tr><td>17</td><td> <span class="codeReserved">return</span> $valor;</td></tr>
  <tr><td>18</td><td>}</td></tr>
  <tr><td>19</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >10. lib / php / validaToken.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/ProblemDetails.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">const</span> FORBIDDEN = 403;</td></tr>
  <tr><td>6</td><td></td></tr>
  <tr><td>7</td><td><span class="codeReserved">function</span> validaToken(string $pagina, string $token)</td></tr>
  <tr><td>8</td><td>{</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> (!isset($_SESSION[$pagina]))</td></tr>
  <tr><td>11</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>12</td><td>   status: FORBIDDEN,</td></tr>
  <tr><td>13</td><td>   title: <span class="codeString">"PÃ¡gina no registrada."</span>,</td></tr>
  <tr><td>14</td><td>   type: <span class="codeString">"/error/paginanoregistrada.html"</span>,</td></tr>
  <tr><td>15</td><td>  );</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> $tokensParaPagina = $_SESSION[$pagina];</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> <span class="codeReserved">if</span> (!is_array($tokensParaPagina))</td></tr>
  <tr><td>20</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>21</td><td>   status: FORBIDDEN,</td></tr>
  <tr><td>22</td><td>   title: <span class="codeString">"No hay arereglo de tokens."</span>,</td></tr>
  <tr><td>23</td><td>   type: <span class="codeString">"/error/sintokens.html"</span>,</td></tr>
  <tr><td>24</td><td>  );</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> $hallado = <span class="codeReserved">false</span>;</td></tr>
  <tr><td>27</td><td></td></tr>
  <tr><td>28</td><td> <span class="codeComment">// Valida que el token se haya registrado.</span></td></tr>
  <tr><td>29</td><td> <span class="codeReserved">foreach</span> ($tokensParaPagina <span class="codeReserved">as</span> $llave =&gt; $tokenParaPagina) {</td></tr>
  <tr><td>30</td><td></td></tr>
  <tr><td>31</td><td>  <span class="codeReserved">if</span> (strcmp($token, $tokenParaPagina[<span class="codeString">"texto"</span>]) === 0) {</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td>   <span class="codeReserved">if</span> ($tokenParaPagina[<span class="codeString">"expiracion"</span>] &lt; time()) {</td></tr>
  <tr><td>34</td><td>    unset($tokensParaPagina[$llave]);</td></tr>
  <tr><td>35</td><td>    $_SESSION[$pagina] = $tokensParaPagina;</td></tr>
  <tr><td>36</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>37</td><td>     status: FORBIDDEN,</td></tr>
  <tr><td>38</td><td>     title: <span class="codeString">"Tiempo de expiraciÃ³n excedido."</span>,</td></tr>
  <tr><td>39</td><td>     type: <span class="codeString">"/error/paginaexpirada.html"</span>,</td></tr>
  <tr><td>40</td><td>    );</td></tr>
  <tr><td>41</td><td>   }</td></tr>
  <tr><td>42</td><td></td></tr>
  <tr><td>43</td><td>   $hallado = <span class="codeReserved">true</span>;</td></tr>
  <tr><td>44</td><td>  } <span class="codeReserved">elseif</span> ($tokenParaPagina[<span class="codeString">"expiracion"</span>] &gt; time()) {</td></tr>
  <tr><td>45</td><td></td></tr>
  <tr><td>46</td><td>   <span class="codeComment">// Elimina tokens expirados</span></td></tr>
  <tr><td>47</td><td>   unset($tokensParaPagina[$llave]);</td></tr>
  <tr><td>48</td><td>  }</td></tr>
  <tr><td>49</td><td> }</td></tr>
  <tr><td>50</td><td></td></tr>
  <tr><td>51</td><td> $_SESSION[$pagina] = $tokensParaPagina;</td></tr>
  <tr><td>52</td><td></td></tr>
  <tr><td>53</td><td> <span class="codeReserved">if</span> ($hallado === <span class="codeReserved">false</span>)</td></tr>
  <tr><td>54</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(</td></tr>
  <tr><td>55</td><td>   status: FORBIDDEN,</td></tr>
  <tr><td>56</td><td>   title: <span class="codeString">"PÃ¡gina no registrada."</span>,</td></tr>
  <tr><td>57</td><td>   type: <span class="codeString">"/error/paginanoregistrada.html"</span>,</td></tr>
  <tr><td>58</td><td>  );</td></tr>
  <tr><td>59</td><td>}</td></tr>
  <tr><td>60</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section>
         <h1 >I. Carpeta Â« error Â»</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a href="print.html" target="_blank" rel="noopener">VersiÃ³n para
      imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m23token/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-faltanombre-html.html">error / faltanombre.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-faltasaludo-html.html">error / faltasaludo.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-faltatoken-html.html">error / faltatoken.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-nombreenblanco-html.html">error / nombreenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-paginaexpirada-html.html">error / paginaexpirada.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-paginanoregistrada-html.html">error / paginanoregistrada.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-saludoenblanco-html.html">error / saludoenblanco.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m23token/m-error/m-sintokens-html.html">error / sintokens.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se presentÃ³ de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / faltanombre.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el nombre&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el nombre&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >C. error / faltasaludo.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el saludo&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el saludo&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;La solicitud no tiene el valor de saludo.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >D. error / faltatoken.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Falta el token&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Falta el token&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >E. error / nombreenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El nombre estÃ¡ en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El nombre estÃ¡ en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon texto en el campo nombre.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >F. error / paginaexpirada.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Tiempo de expiraciÃ³n excedido&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Tiempo de expiraciÃ³n excedido&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >G. error / paginanoregistrada.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;PÃ¡gina no registrada&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;PÃ¡gina no registrada&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >H. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >I. error / saludoenblanco.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El saludo estÃ¡ en blanco&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El saludo estÃ¡ en blanco&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Pon texto en el campo saludo.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >J. error / sintokens.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;No hay arereglo de tokens&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;No hay arereglo de tokens&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section >
         <h1 >J. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aquÃ­ su estructura, pero puede encontrarse la explicaciÃ³n de
    todo en la documentaciÃ³n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >K. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecciÃ³n se mostrÃ³ como proteger servicios y formas con el uso de
    tokens.
   </p>
  </li>
 </ul>
</div>
      </section>
      </section>
</body>

</html>