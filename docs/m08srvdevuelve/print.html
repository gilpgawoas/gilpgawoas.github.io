<!DOCTYPE html>
<html lang="es">

<head>
 <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" sizes="32x32" href="/favicon.ico">
<meta name="theme-color" content="#039623">
<link rel="manifest" href="/site.webmanifest">
<script src="/lib/js/muestra-codigo.js"></script>
 <title>Servicio que devuelve JSON - GilPG AWOAS</title>
 <meta name="description" content="P谩gina para imprimir de la lecci贸n 芦Servicio que devuelve un resultado JSON禄.">
 <style>
 /* https://paletton.com/#uid=74W0u0kllllaFw0g0qFqFg0w0aF */
 :root {
  --marginTop: 0.25rem;
  --padTop: 0;
  --h1PadTop: 2.5rem;
  --introDuracion: 2s;
  --introFuncion: ease-out;
  --padCont: 0.5rem;
  --padNav: 0.75rem 0.5rem;
  --anchoNav: 300px;
  --anchoLectura: 900px;
  --colLetra: black;
  --colFondo: white;
  --colPush: var(--colFondo);
  --colPushHover: var(--colFondo);
  --colPushFocus: var(--colFondo);
  --colPushActive: #bae397;
  --colFondoPush: #609732;
  --colFondoPushHover: #8abd5f;
  --colFondoPushFocus: #3e7213;
  --colFondoPushActive: #224c00;
  --paddingPush: 0.2rem 0.3rem;
  --borderPush: none;
  --borderRadiusPush: 0.6em;
  --colA: #6a7b15;
  --colAVisited: #6f256f;
  --colAActive: #e498af;
  --colAPush: var(--colFondo);
  --colAVisitedPush: var(--colFondo);
  --colAPushHover: var(--colFondo);
  --colAVisitedPushHover: var(--colFondo);
  --colAPushFocus: var(--colFondo);
  --colAVisitedPushFocus: var(--colFondo);
  --colAPushActive: var(--colFondo);
  --colAVisitedPushActive: var(--colFondo);
  --colFondoAPush: #6a7b15;
  --colFondoAVisitedPush: #6f256f;
  --colFondoAPushHover: #91a437;
  --colFondoAVisitedPushHover: #a66fa6;
  --colFondoAPushFocus: #445200;
  --colFondoAVisitedPushFocus: #530e53;
  --colFondoAPushActive: #e498af;
  --colFondoAVisitedPushActive: #e498af;
  --colSombra: #49494980;
  --navSombra: 0.5rem 0 0.5rem var(--colSombra);
  --shadowTitulo: 3px 1px 2px black;
  /* --colTitulo: #bae397; */
  --colTitulo: #609732;
  /* --colTituloFondo: #609732; */
  --colPrincipalTituloStrong: #6E256E;
  --colAStrong: var(--colLetra);
  /* --colNavH1Sel: #b35f7c; */
  --colFondoNav: var(--colFondo);
  --colFondoNavSel: #e498af;
  --colScrollbar: #CFD8DC;
  --colThumb: #90a4ae;
  --colThumbActivo: #3f3f3f;
  --colResaltado: #e9c8d2;
  --colResaltado2: #bae397;
  --colResaltado3: #cfcfcf;
  --colLetraResaltado: black;
  --colLetraCodeComment: #224c00;
  --colLetraCodeString: #903357;
  --colLetraCodeReserved: #445200;
  --colSecundario: #e498af;
  --colTarget: #cef4ff;
  --colStack1: black;
  --colStack2: #224ba5;
  --colStack3: #92731f;
  --anchoThumb: 7px;
  --borderRadiusThumb: 3.5px;
  --gap: 0.5rem;
  --fontMono: 'Xanh Mono', monospace;
  --fontSans: 'Patrick Hand', sans-serif;
  /* --fontSerif: 'Purple Purse', serif; */
  --fontSerif: Georgia, 'Times New Roman', Times, serif;
  font-family: var(--fontSerif);
  color: var(--colLetra);
  background-color: var(--colFondo);
  scrollbar-width: thin;
  scrollbar-color: var(--colThumb) var(--colScrollbar);
 }

 @media (prefers-color-scheme: light) {
  :root {
   --colLetra: black;
   --colFondo: white;
  }
 }

 /* https://paletton.com/#uid=74W0u0kaVz84jP27qHbeJtFiHpX */
 @media (prefers-color-scheme: dark) {

  :root {
   --colLetra: white;
   /* --colFondo: #272727; */
   --colFondo: black;
   --colPushActive: #e3f5d4;
   --colFondoPush: #bbe697;
   --colFondoPushHover: #d0eeb7;
   --colFondoPushFocus: #9ed372;
   --colFondoPushActive: #7db84d;
   --colA: #e9f7a3;
   --colAVisited: #c89ac8;
   --colAActive: #983351;
   --colFondoAPush: #e9f7a3;
   --colFondoAVisitedPush: #c89ac8;
   --colFondoAPushHover: #f6fcda;
   --colFondoAVisitedPushHover: #dec0de;
   --colFondoAPushFocus: #b4c853;
   --colFondoAVisitedPushFocus: #9a539a;
   --colFondoAPushActive: #983351;
   --colFondoAVisitedPushActive: #983351;
   --colSombra: #00000080;
   --colTitulo: #e3f5d4;
   --colPrincipalTituloStrong: #C899C8;
   /* --colTituloFondo: #7db84d; */
   /* --colNavH1Sel: #d37290; */
   --colFondoNavSel: #7a3059;
   --colScrollbar: #616161;
   --colThumb: #ffffff;
   --colResaltado: #7a3059;
   --colResaltado2: #5c922f;
   --colResaltado3: #4e4e4e;
   --colLetraResaltado: white;
   --colLetraCodeComment: #d0eeb7;
   --colLetraCodeString: #eeb7c8;
   --colLetraCodeReserved: #f0fac0;
  }
 }

 /* xanh-mono-regular - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Xanh Mono';
  font-style: normal;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/xanh-mono-v18-latin_latin-ext-regular.woff2') format('woff2');
 }

 /* xanh-mono-italic - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Xanh Mono';
  font-style: italic;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/xanh-mono-v18-latin_latin-ext-italic.woff2') format('woff2');
 }

 /* patrick-hand-regular - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Patrick Hand';
  font-style: normal;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/patrick-hand-v23-latin_latin-ext-regular.woff2') format('woff2');
 }

 /* purple-purse-regular - latin_latin-ext */
 @font-face {
  /* Check https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/font-display for other options. */
  font-display: swap;
  font-family: 'Purple Purse';
  font-style: normal;
  font-weight: 400;
  /* Chrome 36+, Opera 23+, Firefox 39+, Safari 12+, iOS 10+ */
  src: url('/fonts/purple-purse-v23-latin_latin-ext-regular.woff2') format('woff2');
 }

 @font-face {
  font-family: 'Material Symbols Outlined';
  font-style: normal;
  src:
   url(/fonts/MaterialSymbolsOutlined[FILL\,GRAD\,opsz\,wght].woff2) format('woff2'),
   url(/fonts/MaterialSymbolsOutlined[FILL\,GRAD\,opsz\,wght].ttf) format('truetype');
 }

 .material-symbols-outlined {
  font-family: 'Material Symbols Outlined';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  width: 24px;
  height: 24px;
  /* Preferred icon size */
  display: inline-block;
  line-height: 1;
  text-transform: none;
  letter-spacing: normal;
  word-wrap: normal;
  white-space: nowrap;
  direction: ltr;
 }

 body::-webkit-scrollbar {
  width: var(--anchoThumb);
  height: var(--anchoThumb);
 }

 body::-webkit-scrollbar-track {
  background: var(--colScrollbar);
 }

 body::-webkit-scrollbar-thumb {
  background-color: var(--colThumb);
  border-radius: var(--borderRadiusThumb);
 }

 body::-webkit-scrollbar-thumb:active {
  background-color: var(--colThumbActivo);
 }

 body {
  margin-top: 0;
 }

 h1 {
  font-size: 3rem;
 }

 section h1,
 nav h1 {
  font-size: 2.5rem;
  font-style: oblique;
 }

 section section h1 {
  font-size: 2rem;
  font-style: normal;
 }

 section section section h1 {
  font-size: 2rem;
  font-style: normal;
 }

 section section section section h1 {
  font-size: 1.5rem;
  font-style: oblique;
 }

 section section section section section h1 {
  font-size: 1.5rem;
  font-style: normal;
 }

 a {
  color: var(--colA);
 }

 a:visited {
  color: var(--colAVisited);
 }

 a:active {
  color: var(--colAActive);
 }

 .anterior,
 .siguiente,
 .paginaAnterior,
 .paginaSiguiente,
 button {
  display: inline-block;
  padding: var(--paddingPush);
  border: var(--borderPush);
  border-radius: var(--borderRadiusPush);
  text-align: center;
  text-decoration: none;
 }

 .anterior,
 .siguiente,
 .paginaAnterior,
 .paginaSiguiente {
  color: var(--colAPush);
  background-color: var(--colFondoAPush);
 }

 .anterior:visited,
 .siguiente:visited,
 .paginaAnterior:visited,
 .paginaSiguiente:visited {
  color: var(--colAVisitedPush);
  background-color: var(--colFondoAVisitedPush);
 }

 .anterior.bye,
 .siguiente.bye,
 .paginaAnterior.bye,
 .paginaSiguiente.bye {
  display: none;
 }

 .anterior:hover,
 .siguiente:hover,
 .paginaAnterior:hover,
 .paginaSiguiente:hover {
  color: var(--colAPushHover);
  background-color: var(--colFondoAPushHover);
 }

 .anterior:visited:hover,
 .siguiente:visited:hover,
 .paginaAnterior:visited:hover,
 .paginaSiguiente:visited:hover {
  color: var(--colAVisitedPushHover);
  background-color: var(--colFondoAVisitedPushHover);
 }

 .anterior:focus,
 .siguiente:focus,
 .paginaAnterior:focus,
 .paginaSiguiente:focus {
  color: var(--colAPushFocus);
  background-color: var(--colFondoAPushFocus);
 }

 .anterior:visited:focus,
 .siguiente:visited:focus,
 .paginaAnterior:visited:focus,
 .paginaSiguiente:visited:focus {
  color: var(--colAVisitedPushFocus);
  background-color: var(--colFondoAVisitedPushFocus);
 }

 .anterior:active,
 .siguiente:active,
 .paginaAnterior:active,
 .paginaSiguiente:active {
  color: var(--colAPushActive);
  background-color: var(--colFondoAPushActive);
 }

 .anterior:visited:active,
 .siguiente:visited:active,
 .paginaAnterior:visited:active,
 .paginaSiguiente:visited:active {
  color: var(--colAVisitedPushActive);
  background-color: var(--colFondoAVisitedPushActive);
 }

 button {
  color: var(--colPush);
  background-color: var(--colFondoPush);
 }

 button:hover {
  color: var(--colPushHover);
  background-color: var(--colFondoPushHover);
 }

 button:focus {
  color: var(--colPushFocus);
  background-color: var(--colFondoPushFocus);
 }

 button:active {
  color: var(--colPushActive);
  background-color: var(--colFondoPushActive);
 }

 .anterior span,
 .siguiente span,
 .paginaAnterior span,
 .paginaSiguiente span,
 button span {
  vertical-align: middle;
 }

 a[data-logo] {
  display: block;
  height: 54px;
  line-height: 54px;
  padding-left: 54px;
  margin-top: 1rem;
  background-image: url("/img/icono/maskable_icon_x48.png");
  background-position: 3px center;
  background-repeat: no-repeat;
 }

 a strong,
 a code,
 h1 strong,
 h1 code {
  font-size: 1em;
 }

 a strong,
 a code {
  color: var(--colAStrong);
 }

 nav a {
  font-family: var(--fontSans);
 }

 pre {
  font-family: var(--fontMono);
 }

 code {
  font-family: var(--fontMono);
  font-size: 1rem;
 }

 .tree {
  font-family: var(--fontSans);
 }

 .tree summary {
  text-decoration: underline;
  cursor: pointer;
 }

 .tree li {
  margin-top: 1em;
  margin-bottom: 1em;
 }

 h1:not(.default) {
  font-family: var(--fontSans);
  color: var(--colTituloFondo);
 }

 h1,
 .lectura a,
 .lectura p,
 .lectura blockquote {
  overflow-wrap: anywhere;
 }

 .autor {
  font-family: var(--fontSans);
  font-size: 1.5rem;
  color: var(--colTituloFondo);
 }

 figure {
  text-align: center;
 }

 figure img {
  width: 100%;
 }

 figcaption {
  font-family: var(--fontMono);
 }

 .print .noPrint {
  display: none;
 }

 @media print {
  .noPrint {
   display: none;
  }

  .pruebaDeEscritorio {
   page-break-before: always;
  }
 }

 iframe {
  /* background-color: white; */
  box-sizing: border-box;
  resize: both;
 }

 .lectura {
  max-width: var(--anchoLectura);
  margin: 1rem auto;
 }

 .lectura p,
 .lectura blockquote {
  text-align: justify;
 }

 .horizontal {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  align-items: start;
  justify-content: center;
 }

 .horizontal>*:first-child {
  flex: 1 1 auto;
 }

 .horizontal>*:nth-child(2) {
  flex: 1 1 40ch;
 }

 .horizontal iframe {
  width: 300px;
 }

 .columnas4 {
  columns: 4 180px;
  column-gap: 1rem;
 }

 .columnas2 {
  columns: 2 360px;
  column-gap: 1rem;
 }

 .resaltado {
  background-color: var(--colResaltado);
  color: var(--colLetraResaltado);
 }

 .resaltado2 {
  background-color: var(--colResaltado2);
  color: var(--colLetraResaltado);
 }

 .resaltado3 {
  background-color: var(--colResaltado3);
  color: var(--colLetraResaltado);
 }

 table.borde {
  margin-left: auto;
  margin-right: auto;
 }

 table.borde,
 table.borde td {
  border: thin solid;
  border-collapse: collapse;
 }

 table.borde th,
 table.borde td {
  padding: 0.4rem;
 }

 table.codeShow {
  margin-left: auto;
  margin-right: auto;
  text-align: left;
 }

 .codeShow td.codeShow_order {
  text-align: right;
  padding: 0 0 0 0;
  vertical-align: top;
  font-family: var(--fontMono);
  white-space: pre;
  font-size: 1rem;
  line-height: 1.2rem;
  /* Avoid selection */
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
 }

 .codeShow td:has(pre) {
  padding: 0 0 0 0.25rem;
  vertical-align: top;
 }

 .codeShow td pre {
  font-family: var(--fontMono);
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  font-size: 1rem;
  line-height: 1.2rem;
  margin: 0;
 }

 .codeReserved {
  color: var(--colLetraCodeReserved);
  font-weight: bolder;
 }

 .codeString {
  color: var(--colLetraCodeString);
  font-weight: 600;
 }

 .codeComment {
  color: var(--colLetraCodeComment);
  font-style: italic;
 }

 @media print {

  .codeShow button {
   display: none;
  }
 }


 footer {
  margin-top: 1rem;
  display: block;
  text-align: center;
  font-family: var(--fontSans);
  font-size: small;
 }
</style>
 <style>
 .pruebaDeEscritorio {
  font-family: var(--fontSans);
 }

 .pruebaDeEscritorio .section,
 .pruebaDeEscritorio section {
  display: inline-block;
  vertical-align: top;
 }

 .pruebaDeEscritorio section {
  margin: 1em;
 }

 .section section {
  display: block;
 }

 .pruebaDeEscritorio section pre {
  margin: 0;
 }

 .pruebaDeEscritorio samp {
  font-weight: bold;
 }

 .pruebaDeEscritorio .activo {
  display: inline-block;
  margin: 0 0.2rem 0 0;
  vertical-align: top;
  background-color: var(--colSecundario);
  border: 1px solid var(--colSecundario);
 }

 .pruebaDeEscritorio :target,
 .pruebaDeEscritorio :target caption {
  background-color: var(--colTarget);
 }

 .pruebaDeEscritorio .numero1 {
  display: inline-block;
  margin: 0 0.2rem 0 0;
  color: var(--colStack1);
  border: 1px solid var(--colStack1);
 }

 .pruebaDeEscritorio .numero2 {
  display: inline-block;
  color: var(--colStack2);
  border: 1px solid var(--colStack2);
 }

 .pruebaDeEscritorio .numero3 {
  display: inline-block;
  color: var(--colStack3);
  border: 1px solid var(--colStack3);
 }

 .pruebaDeEscritorio a.parametro1,
 .pruebaDeEscritorio .parametro1 {
  color: var(--colPar1);
 }

 .pruebaDeEscritorio a.parametro2,
 .pruebaDeEscritorio .parametro2 {
  color: var(--colPar2);
 }

 .pruebaDeEscritorio .descongela {
  color: var(--colDescongela);
 }

 .pruebaDeEscritorio table.tabla1,
 .pruebaDeEscritorio table.tabla1 th,
 .pruebaDeEscritorio table.tabla1 td {
  border: 1px solid var(--colStack1);
 }

 .pruebaDeEscritorio table.tabla2,
 .pruebaDeEscritorio table.tabla2 th,
 .pruebaDeEscritorio table.tabla2 td {
  border: 1px solid var(--colStack2);
 }

 .pruebaDeEscritorio table.tabla3,
 .pruebaDeEscritorio table.tabla3 th,
 .pruebaDeEscritorio table.tabla3 td {
  border: 1px solid var(--colStack3);
 }

 .pruebaDeEscritorio .frame {
  font-family: var(--fontMono);
  border-collapse: collapse;
 }

 .pruebaDeEscritorio .frame,
 .pruebaDeEscritorio .frame th,
 .pruebaDeEscritorio .frame td {
  border: thin solid;
 }

 .pruebaDeEscritorio .frame caption {
  font-style: italic;
 }

 .pruebaDeEscritorio .objeto caption {
  text-decoration: underline;
  font-style: italic;
 }

 .pruebaDeEscritorio .creaci贸n {
  display: flex;
 }
</style>
</head>

<body class="print">
   <h1 >10. Servicio que devuelve JSON</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a target="_blank" rel="noreferrer"
      href="print.html">Versi贸n para imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/mAintro.html">Introducci贸n</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mBexportaAHtml.html">La funci贸n <dfn><code>exportaAHtml</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mBconsumeJson.html">La funci贸n <dfn><code>consumeJson</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCdevuelveJson.html">La funci贸n <dfn><code>devuelveJson</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mDProblemDetails.html">La clase <dfn><code>ProblemDetails</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mD3muestraerror.html">La funci贸n <dfn><code>muestraError</code></dfn></a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mBdeploy.html">Diagrama de despliegue</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/">Funcionamiento</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mDinstrucciones.html">Hazlo funcionar</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mArchivos.html">Archivos</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-index-html.html">index.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-srv/">Carpeta 芦 srv 禄</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-error/">Carpeta 芦 error 禄</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/">Carpeta 芦 lib 禄</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-jsconfig-json.html">jsconfig.json</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mHresumen.html">Resumen</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section >
         <h1 >A. Introducci贸n</h1><div class="lectura">
 <p>
  A partir de esta lecci贸n se introducen elementos de software que facilitan el
  desarrollo de aplicaciones orientadas a servicios.
 </p>
 <p>
  Este ejemplo recibe los datos JSON generados por un servicio.
 </p>
 <p>
  Puedes probar el ejemplo en
  <a href="http://srvdevuelve.rf.gd/" rel="noreferrer"
    target="_blank">http://srvdevuelve.rf.gd/</a>.
 </p>
</div>
      </section>
     <section >
         <h1 >B. La funci贸n <dfn><code>exportaAHtml</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    El c贸digo m谩s moderno de JavaScript se distribuye en m贸dulos.
   </p>
  </li>
  <li>
   <p>
    El c贸digo de eventos de las etiquetas de HTML no tienen acceso directo al
    contenido de m贸dulos, pero al asignar un elemento del m贸dulo como una
    propiedad del objeto window, el elemento de software se vuelve visible
    dentro de los eventos. Se puede hacer con una instrucci贸n de la forma<br>
    <code>window["propiedad"] = elementoDeSoftware</code><br>
    o de la forma<br>
    <code>window.propiedad = elementoDeSoftware</code><br>
   </p>
  </li>
  <li>
   <p>
    La funci贸n <code>exportaAHtml</code> hace visible una funci贸n a los eventos
    del c贸digo HTML.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde est谩 definida esta funci贸n y
    luego invocarla pas谩ndole la funci贸n que se exporta..
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecci贸n y las siguientes, se profundiza en el uso y
    estructura de esta funci贸n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >C. La funci贸n <dfn><code>consumeJson</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    El c贸digo que se muestra en el ejemplo de servicio se repite en muchos
    ejemplos posteriores, pero adem谩s debe realizar algunas cuastiones
    adicionales. Para simplificar el trabajo, se introduce la funci贸n
    <code>consumeJson</code>, que realiza todo lo necesario para controlar la
    conxi贸n desde el navegador web hacia el servidor.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde est谩 definida esta funci贸n y
    luego invocarla pas谩ndole la url del servicio, o alternativamente, pas谩ndole
    el resultado de invocar la funci贸n fetch que comunica al servicio.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecci贸n y las siguientes, se profundiza en el uso y
    estructura de esta funci贸n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >D. La funci贸n <dfn><code>devuelveJson</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Para devolver al cliente los resultados de la ejecuci贸n de un servicio, se
    usa la funci贸n <code>devuelveJson</code>, escrita en PHP.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde est谩 definida esta funci贸n
    usando <code>require</code> o <code>require_once</code> y luego invocarla
    pas谩ndole el resultado generado por el servicio.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecci贸n y las siguientes, se profundiza en el uso y
    estructura de esta clase.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >E. La clase <dfn><code>ProblemDetails</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Se acuerdo con el RFC 9457 en
    <a rel="noo"
      href="https://www.rfc-editor.org/info/rfc9457" rel="noreferrer"
      target="_blank">https://www.rfc-editor.org/info/rfc9457</a>,
    cuando un servicio falla, debe devolver una
    estructura JSON conocida como <dfn>Problem Details</dfn> que informa los
    detalles del fallo.
   </p>
  </li>
  <li>
   <p>
    El tipo de fallo se describe en el campo <var>type</var>, del problem
    details y, adicionalmente, todo tipo de fallo debe tener una peque帽a p谩gina
    donde se describe el problema. En estos ejemplos, se usa la carpeta
    <dfn>error</dfn> para almacenar las p谩ginas que decriben los errores.
   </p>
  </li>
  <li>
   <p>
    Para usarla en JavaScript, debes importar el archivo donde est谩 definida
    esta clase.
   </p>
  </li>
  <li>
   <p>
    Para usarla en PHP, debes importar el archivo donde est谩 definida esta
    clase usando <code>require</code> o <code>require_once</code>. En este
    ejemplo no se usa la versi贸n en PHP; se empezar谩 a usar a partir de la
    lecci贸n sobre validaciones.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecci贸n y las siguientes, se profundiza en el uso y
    estructura de estas clases.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >F. La funci贸n <dfn><code>muestraError</code></dfn></h1><div class="lectura">
 <ul>
  <li>
   <p>
    Manejamos los errores en el navegador web y de una manera uniforme con la
    funci贸n <code>muestraError</code>.
   </p>
  </li>
  <li>
   <p>
    Cuando se tiene un error normal de JavaScript, se muestra la excepci贸n
    correspondiente en la consola del navegador y el mensaje de la excepci贸n en
    un cuadro de alert.
   </p>
  </li>
  <li>
   <p>
    Cuando es un ProblemDetails, cuya estructure se revisa en la lecci贸n sobre
    validaciones, sus propiedades se muestran en la consola del navegador y en
    un cuadro de alert.
   </p>
  </li>
  <li>
   <p>
    Para usarla, debes importar el archivo donde est谩 definida esta funci贸n y
    colocarla dentro de un catch. Se le pasa como par谩metro la excepci贸n
    atrapada por el catch.
   </p>
  </li>
  <li>
   <p>
    A lo largo de esta lecci贸n y las siguientes, se profundiza en el uso y
    estructura de esta funci贸n.
   </p>
  </li>
 </ul>
</div>
      </section>
     <section >
         <h1 >G. Diagrama de despliegue</h1><figure>
 <img style="max-height: none;"
   src="/img/m08srvdevuelve/srvdevuelvedistribucion.drawio.svg"
   alt="Diagrama de despliegue">
</figure>
      </section>
     <section>
         <h1 >H. Funcionamiento</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a target="_blank" rel="noreferrer"
      href="print.html">Versi贸n para imprimir.</a>
    </p>
   </div>
<div class="lectura">
 <nav>
  <h1>Contenido</h1>
  
   <ol type="1">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m1cliente.html">Iniciamos al ejecutar c贸digo en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m2servidor.html">Se invoca el servicio en el servidor</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m3procesa.html">El servicio procesa la request y genera la response</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m4devuelve.html">El servicio devuelve la response, que es recibida en el cliente</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m5muestra.html">Muestra el objeto recibido en un alert</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/mCfunRecibe/m6termina.html">Al cerrar el alert, termina el evento</a>
    </p>
   </li>
   </ol>
 </nav>
</div>
     <section class="pruebaDeEscritorio">
         <h1 >1. Iniciamos al ejecutar c贸digo en el cliente</h1><section>
 <h1>index.html</h1>
 <pre class="resaltado"><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> consumeJson(<span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span>alert(<span class="codeString">`Nombre: ${respuesta.body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${respuesta.body.mensaje}`</span>)</span></code></pre>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >2. Se invoca el servicio en el servidor</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> consumeJson(<span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span>alert(<span class="codeString">`Nombre: ${respuesta.body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${respuesta.body.mensaje}`</span>)</span></code></pre>
 <p class="resaltado2">Ejecuta invocaServicio y env铆a request (solicitud).
 </p>
</section>
<section>
 <h1>Request</h1>
 <details class="resaltado">
  <summary>
   GET /srv/devuelve.php HTTP/1.1
  </summary>
  Accept: application/json, application/problem+json<br>
  Accept-Encoding: gzip, deflate<br>
  Accept-Language: es-ES,es;q=0.9,en;q=0.8<br>
  Connection: keep-alive<br>
  Cookie:
  __gsas=ID=329641bd2728ff51:T=1743534294:RT=1743534294:S=ALNI_MavjA3FPY-hDE5wNZO5LxFSOVeIIQ;
  __test=fe8a33dadb44b3adb2a0bc1ff8c44c98<br>
  Host: srvdevuelve.rf.gd<br>
  Referer: http://srvdevuelve.rf.gd/?i=1<br>
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
  (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
 </details>
</section>
<section>
 <h1>srv&#47;devuelve.php</h1>
 <pre class="resaltado"><code class="language-php"><span>devuelveJson([</span>
<span> <span class="codeString">&quot;nombre&quot;</span> =&gt; <span class="codeString">&quot;pp&quot;</span>,</span>
<span> <span class="codeString">&quot;mensaje&quot;</span> =&gt; <span class="codeString">&quot;Hola.&quot;</span></span>
<span>]);</span></code></pre>
 <p class="resaltado2">Despierta y recibe request.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >3. El servicio procesa la request y genera la response</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado3"> <span class="codeReserved">await</span> consumeJson(<span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span>alert(<span class="codeString">`Nombre: ${respuesta.body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${respuesta.body.mensaje}`</span>)</span></code></pre>
 <p class="resaltado3">Hace wait esperando response.</p>
</section>
<section>
 <h1>srv&#47;devuelve.php</h1>
 <pre><code class="language-php"><span class="resaltado">devuelveJson([</span>
<span class="resaltado"> <span class="codeString">&quot;nombre&quot;</span> =&gt; <span class="codeString">&quot;pp&quot;</span>,</span>
<span class="resaltado"> <span class="codeString">&quot;mensaje&quot;</span> =&gt; <span class="codeString">&quot;Hola.&quot;</span></span>
<span class="resaltado">]);</span></code></pre>
 <p class="resaltado2">Procesa la request y<br>genera response<br>(respuesta).
 </p>
</section>
<section style="vertical-align: top; overflow-wrap: anywhere;">
 <h1>Response</h1>
 <div class="resaltado">
  <details>
   <summary>
    HTTP/1.1 200 OK
   </summary>
   Server: openresty<br>
   Date: Fri, 02 May 2025 03:41:22 GMT<br>
   Content-Type: application/json<br>
   Transfer-Encoding: chunked<br>
   Connection: keep-alive<br>
   Cache-Control: max-age=0<br>
   Expires: Fri, 02 May 2025 03:41:22 GMT<br>
  </details>
  {"nombre":"pp","mensaje":"Hola."}
 </div>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >4. El servicio devuelve la response, que es recibida en el cliente</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span class="resaltado"><span class="codeReserved">const</span> respuesta =</span>
<span class="resaltado"> <span class="codeReserved">await</span> consumeJson(<span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span>alert(<span class="codeString">`Nombre: ${respuesta.body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${respuesta.body.mensaje}`</span>)</span></code></pre>
 <p class="resaltado2">Despierta y recibe response.</p>
</section>
<div class="section">
 <section>
  <h1>Response</h1>
  <div class="resaltado">
   <details>
    <summary>
     HTTP/1.1 200 OK
    </summary>
    Server: openresty<br>
    Date: Fri, 02 May 2025 03:41:22 GMT<br>
    Content-Type: application/json<br>
    Transfer-Encoding: chunked<br>
    Connection: keep-alive<br>
    Cache-Control: max-age=0<br>
    Expires: Fri, 02 May 2025 03:41:22 GMT
   </details>
   {"nombre":"pp","mensaje":"Hola."}
  </div>
 </section>
 <section>
  <h1>Memoria</h1>
  <dl class="resaltado">
   <dt>respuesta</dt>
   <dd>
    <dl>
     <dt>status</dt>
     <dd>200</dd>
     <dt>body</dt>
     <dd>
      <dl>
       <dt>nombre</dt>
       <dd>"pp"</dd>
       <dt>mensaje</dt>
       <dd>"Hola."</dd>
      </dl>
     </dd>
    </dl>
   </dd>
  </dl>
 </section>
</div>
<section>
 <h1>srv&#47;devuelve.php</h1>
 <pre class="resaltado3"><code class="language-php"><span>devuelveJson([</span>
<span> <span class="codeString">&quot;nombre&quot;</span> =&gt; <span class="codeString">&quot;pp&quot;</span>,</span>
<span> <span class="codeString">&quot;mensaje&quot;</span> =&gt; <span class="codeString">&quot;Hola.&quot;</span></span>
<span>]);</span></code></pre>
 <p class="resaltado3">Devuelve response y se duerme.</p>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >5. Muestra el objeto recibido en un alert</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span class="resaltado"><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> consumeJson(<span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span class="resaltado">alert(<span class="codeString">`Nombre: ${respuesta.body.nombre}</span></span>
<span class="resaltado"><span class="codeString">Mensaje: ${respuesta.body.mensaje}`</span>)</span></code></pre>
</section>
<section>
 <h1>Memoria</h1>
 <dl>
  <dt class="resaltado2">respuesta</dt>
  <dd>
   <dl>
    <dt>status</dt>
    <dd>200</dd>
    <dt class="resaltado2">body</dt>
    <dd>
     <dl>
      <dt class="resaltado2">nombre</dt>
      <dd class="resaltado2">"pp"</dd>
      <dt class="resaltado2">mensaje</dt>
      <dd class="resaltado2">"Hola."</dd>
     </dl>
    </dd>
   </dl>
  </dd>
 </dl>
</section>
<section>
 <h1>Alert</h1>
 <div class="resaltado" style="border: thin solid; padding: 0 0.5rem;">
  <p>Nombre: pp<br>Mensaje: Hola.</p>
  <p style="text-align: end;">
   <button type="button">Aceptar</button>
  </p>
 </div>
</section>
      </section>
     <section class="pruebaDeEscritorio">
         <h1 >6. Al cerrar el alert, termina el evento</h1><section>
 <h1>index.html</h1>
 <pre><code class="language-javascript"><span><span class="codeReserved">const</span> respuesta =</span>
<span> <span class="codeReserved">await</span> consumeJson(<span class="codeString">&quot;srv&#47;devuelve.php&quot;</span>)</span>
<span>alert(<span class="codeString">`Nombre: ${respuesta.body.nombre}</span></span>
<span><span class="codeString">Mensaje: ${respuesta.body.mensaje}`</span>)</span></code></pre>
</section>
      </section>
      </section>
     <section >
         <h1 >I. Hazlo funcionar</h1><div class="lectura">
 <ol>
  <li>
   <p>
    Prueba el ejemplo en
    <a href="http://srvdevuelve.rf.gd/" rel="noreferrer"
      target="_blank">http://srvdevuelve.rf.gd/</a>.
   </p>
  </li>
  <li>
   <p><strong>Crea tu proyecto en GitHub:</strong></p>
   <ol type="A">
    <li>
     <p>
      <em>Crea una cuenta de email</em>, por ejemplo,
      <samp>pepito@google.com</samp>
     </p>
    </li>
    <li>
     <p>
      <em>Crea una cuenta de GitHub</em> usando el email anterior y selecciona
      el nombre de usuario unsando la parte inicial del correo electr贸nico, por
      ejemplo <samp>pepito</samp>.
     </p>
    </li>
    <li>
     <p>
      <em>Crea un repositorio nuevo.</em>
      En la p谩gina principal de GitHub cliquea <em> New</em>.
     </p>
    </li>
    <li>
     <p>
      En la p谩gina <em>Create a new repository</em> introduce los siguientes
      datos:
     </p>
     <ul>
      <li>
       <p>
        Proporciona el nombre de tu repositorio debajo de donde dice
        <b>Repository name *</b>.
       </p>
      </li>
      <li>
       <p>
        Mant茅n la selecci贸n <b>Public</b> para que otros usuarios puedan ver tu
        proyecto.
       </p>
      </li>
      <li>
       <p>
        Verifica la casilla <b>Add a README file</b>. En este archivo se muestra
        informaci贸n sobre tu proyecto.
       </p>
      </li>
      <li>
       <p>
        Cliquea <em>License: <b>None</b></em>. y selecciona la licencia que
        consideres m谩s adecuada para tu proyecto.
       </p>
      </li>
      <li>
       <p>Cliquea <em>Create repository</em>.</p>
      </li>
     </ul>
    </li>
   </ol>
  </li>
  <li>
   <p><strong>Importa el proyecto en GitHub:</strong></p>
   <ol type="A">
    <li>
     <p>
      En la p谩gina principal de tu proyecto en GitHub, en la pesta帽a
      <em>&lt; &gt; Code</em>, cliquea <em>&lt; &gt; Code</em> y
      en la secci贸n <strong>Branches</strong> y copia la direcci贸n que est谩 en
      <strong>HTTPS</strong>, debajo de <strong>Clone</strong>.
     </p>
    </li>
    <li>
     <p>
      <strong>En Visual Studio Code,</strong> usa el bot贸n de la izquierda para
      <em>Source Control</em>.
     </p>
     <figure>
      <img alt="Imagen de Source Control" src="/img/source_control.png">
     </figure>
    </li>
    <li>
     <p>Cliquea el bot贸n <em>Clone Repository</em>.</p>
    </li>
    <li>
     <p>
      Pega la url que copiaste anteriormente hasta arriba, donde dice algo como
      <em>Provide repository URL</em> y presiona la teclea <kbd>Intro</kbd>.
     </p>
    </li>
    <li>
     <p>Selecciona la carpeta donde se guardar谩 la carpeta del proyecto.</p>
    </li>
    <li>
     <p>Abre la carpeta del proyecto importado.</p>
    </li>
    <li>
     <p>
      A帽ade el contenido de la carpeta descompactada que contiene el c贸digo del
      ejemplo.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>Edita los archivos que desees.</p>
  </li>
  <li>
   <p>
    Haz clic derecho en <q>index.html</q>, selecciona
    <em>PHP Server: serve project</em> y se abre el navegador para que puedas
    probar localmente el ejemplo.
   </p>
  </li>
  <li>
   <p><strong>Para depurar paso a paso</strong> haz lo siguiente:</p>
   <ol type="A">
    <li>
     <p>
      En el navegador, haz clic derecho en la p谩gina que deseas depurar y
      selecciona <em>inspeccionar</em>.
     </p>
    </li>
    <li>
     <p>
      Recarga la p谩gina, de preferencia haciendo clic derecho en el 铆cono de
      <em>volver a cargar la p谩gina</em>
      <img alt="magen del 铆cono de recarga" src="/img/reload.png"> y
      seleccionando <em>vaciar cach茅 y volver a cargar de manera forzada</em> (o
      algo parecido). Si no aparece un men煤 emergente, simplemente cliquea
      <em>volver a cargar la p谩gina</em>
      <img alt="magen del 铆cono de recarga" src="/img/reload.png">.
      Revisa que no aparezca ning煤n error ni en la pesta帽as <em>Consola</em>, ni
      en <em>Red</em>.
     </p>
    </li>
    <li>
     <p>
      Selecciona la pesta帽a <em>Fuentes</em> (o <em>Sources</em> si tu navegador
      est谩 en Ingl茅s).
     </p>
    </li>
    <li>
     <p>
      Selecciona el archivo donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Haz clic en el n煤mero de la l铆nea donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      En Visual Studio Code, abre el archivo de PHP donde vas a empezar a
      depurar.
    </li>
    <li>
     <p>
      Haz clic en <em>Run and Debug</em> <img alt=""
        src="/img/runanddebug.png">.
     </p>
    </li>
    <li>
     <p>
      Si no est谩 configurada la depuraci贸n, haz clic en <em>create a launch json
       file</em>.
     </p>
    </li>
    <li>
     <p>
      Haz clic en la flechita <em>RUN AND DEBUG</em>, al lado de la cual debe
      decir <em>Listen for Xdebug</em>
      <img alt="" src="/img/controleslanzadebug.png">.
     </p>
    </li>
    <li>
     <p>
      Aparece un cuadro con los controles de depuraci贸n
     </p>
    </li>
    <li>
     <p>
      Selecciona otra vez el archivo de PHP y haz clic en el n煤mero de la l铆nea
      donde vas a empezar a depurar.
     </p>
    </li>
    <li>
     <p>
      Regresa al navegador, recarga la p谩gina y empieza a usarla.
     </p>
    </li>
    <li>
     <p>
      Si se ejecuta alguna de las l铆neas de c贸digo seleccionadas, aparece
      resaltada en la pesta帽a de fuentes. Usa los controles de depuraci贸n para
      avanzar, como se muestra en
      <a href="https://drive.google.com/file/d/1wdg7LKHR8L21FQGsRr2bXpXqAcaEGxCx/view?usp=sharing"
        target="_blank" rel="noreferrer">este video</a>.
     </p>
    </li>
   </ol>
  </li>
  <li>
   <p>
    Sube el proyecto al hosting que elijas. En algunos casos puedes usar
    filezilla
    (<a href="https://filezilla-project.org/" target="_blank"
      rel="noreferrer">https://filezilla-project.org/</a>)
   </p>
  </li>
  <li>
   <p>Abre un navegador y prueba el proyecto en tu hosting.</p>
  </li>
  <li>
   <p>
    <strong>En el hosting InfinityFree,</strong> la primera ves que corres la
    p谩gina, puede marcar un mensaje de error, pero al recargar funciona
    correctamente. Puedes evitar este problema usando un dominio propio.
   </p>
  </li>
  <li>
   <p>
    <strong>Para subir el c贸digo a GitHub,</strong> en la secci贸n de
    <em>SOURCE CONTROL</em>, en <em>Message</em>
    introduce un mensaje sobre los cambios que hiciste, por ejemplo
    <kbd>index.html corregido</kbd>, selecciona <em>v</em> y luego
    <em>Commit & Push</em>.
   </p>
   <figure>
    <img alt="Imagen de Commit & Push" src="/img/github_commit.png">
   </figure>
  </li>
 </ol>
</div>
      </section>
     <section >
         <h1 >J. Archivos</h1>
  <div class="lectura">
   <p>Haz clic en los tri谩ngulos para expandir las carpetas</p>
   <ul class="tree">
  <li>
   <p><a href="m-index-html.html">index.html</a></p>
  </li>
  <li>
   <p><a href="m-jsconfig-json.html">jsconfig.json</a></p>
  </li>
    <li>
     <details>
      <summary>error</summary>
      <ul>
  <li>
   <p><a href="m-error/m-errorinterno-html.html">errorinterno.html</a></p>
  </li>
  <li>
   <p><a href="m-error/m-resultadonojson-html.html">resultadonojson.html</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>lib</summary>
      <ul>
    <li>
     <details>
      <summary>js</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-js/m-consumeJson-js.html">consumeJson.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-exportaAHtml-js.html">exportaAHtml.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-muestraError-js.html">muestraError.js</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-js/m-ProblemDetails-js.html">ProblemDetails.js</a></p>
  </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>php</summary>
      <ul>
  <li>
   <p><a href="m-lib/m-php/m-devuelveJson-php.html">devuelveJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-devuelveResultadoNoJson-php.html">devuelveResultadoNoJson.php</a></p>
  </li>
  <li>
   <p><a href="m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">INTERNAL_SERVER_ERROR.php</a></p>
  </li>
      </ul>
     </details>
    </li>
      </ul>
     </details>
    </li>
    <li>
     <details>
      <summary>srv</summary>
      <ul>
  <li>
   <p><a href="m-srv/m-devuelve-php.html">devuelve.php</a></p>
  </li>
      </ul>
     </details>
    </li>
   </ul>
  </div>
      </section>
     <section >
         <h1 >K. index.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Servicio que devuelve JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Servicio que devuelve JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;&lt;<span class="codeReserved">button</span> onclick=<span class="codeString">"resultado()"</span>&gt;Resultado&lt;/<span class="codeReserved">button</span>&gt;&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td> &lt;<span class="codeReserved">script</span> type=<span class="codeString">"module"</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>  <span class="codeReserved">import</span> { exportaAHtml } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/exportaAHtml.js"</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">import</span> { consumeJson } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/consumeJson.js"</span></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">import</span> { muestraError } <span class="codeReserved">from</span> <span class="codeString">"./lib/js/muestraError.js"</span></td></tr>
  <tr><td>24</td><td></td></tr>
  <tr><td>25</td><td>  <span class="codeReserved">async</span> <span class="codeReserved">function</span> resultado() {</td></tr>
  <tr><td>26</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>27</td><td>    <span class="codeReserved">const</span> respuesta =</td></tr>
  <tr><td>28</td><td>     <span class="codeReserved">await</span> consumeJson(<span class="codeString">"srv/devuelve.php"</span>)</td></tr>
  <tr><td>29</td><td>    alert(<span class="codeString">`Nombre: ${respuesta.body.nombre}</span></td></tr>
  <tr><td>30</td><td><span class="codeString">Mensaje: ${respuesta.body.mensaje}`</span>)</td></tr>
  <tr><td>31</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>32</td><td>    muestraError(error)</td></tr>
  <tr><td>33</td><td>   }</td></tr>
  <tr><td>34</td><td>  }</td></tr>
  <tr><td>35</td><td>  exportaAHtml(resultado)</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td> &lt;/<span class="codeReserved">script</span>&gt;</td></tr>
  <tr><td>38</td><td></td></tr>
  <tr><td>39</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>40</td><td></td></tr>
  <tr><td>41</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section>
         <h1 >L. Carpeta 芦 srv 禄</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a target="_blank" rel="noreferrer"
      href="print.html">Versi贸n para imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-srv/m-devuelve-php.html">srv / devuelve.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. srv / devuelve.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/../lib/php/devuelveJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td>devuelveJson([</td></tr>
  <tr><td>6</td><td> <span class="codeString">"nombre"</span> =&gt; <span class="codeString">"pp"</span>,</td></tr>
  <tr><td>7</td><td> <span class="codeString">"mensaje"</span> =&gt; <span class="codeString">"Hola."</span></td></tr>
  <tr><td>8</td><td>]);</td></tr>
  <tr><td>9</td><td></td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >M. Carpeta 芦 error 禄</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a target="_blank" rel="noreferrer"
      href="print.html">Versi贸n para imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-error/m-errorinterno-html.html">error / errorinterno.html</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-error/m-resultadonojson-html.html">error / resultadonojson.html</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >A. error / errorinterno.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;Error interno del servidor&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;Se present贸 de forma inesperada un error interno del servidor.&lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td></td></tr>
  <tr><td>19</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>20</td><td></td></tr>
  <tr><td>21</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >B. error / resultadonojson.html</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;!<span class="codeReserved">DOCTYPE</span> html&gt;</td></tr>
  <tr><td>2</td><td>&lt;<span class="codeReserved">html</span> lang=<span class="codeString">"es"</span>&gt;</td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td>&lt;<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> &lt;<span class="codeReserved">meta</span> charset=<span class="codeString">"UTF-8"</span>&gt;</td></tr>
  <tr><td>7</td><td> &lt;<span class="codeReserved">meta</span> name=<span class="codeString">"viewport"</span> <span class="codeReserved">content</span>=<span class="codeString">"<span class="codeReserved">width</span>=device-width"</span>&gt;</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td> &lt;<span class="codeReserved">title</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">title</span>&gt;</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td>&lt;/<span class="codeReserved">head</span>&gt;</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>&lt;<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td> &lt;<span class="codeReserved">h1</span>&gt;El resultado no puede representarse como JSON&lt;/<span class="codeReserved">h1</span>&gt;</td></tr>
  <tr><td>16</td><td></td></tr>
  <tr><td>17</td><td> &lt;<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>18</td><td>  Debido a un error interno del servidor, el resultado generado, no se puede</td></tr>
  <tr><td>19</td><td>  recuperar.</td></tr>
  <tr><td>20</td><td> &lt;/<span class="codeReserved">p</span>&gt;</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td>&lt;/<span class="codeReserved">body</span>&gt;</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td>&lt;/<span class="codeReserved">html</span>&gt;</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >N. Carpeta 芦 lib 禄</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a target="_blank" rel="noreferrer"
      href="print.html">Versi贸n para imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="A">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/">Carpeta 芦 lib / js 禄</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/">Carpeta 芦 lib / php 禄</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section>
         <h1 >A. Carpeta 芦 lib / js 禄</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a target="_blank" rel="noreferrer"
      href="print.html">Versi贸n para imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/m-consumeJson-js.html">lib / js / consumeJson.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/m-exportaAHtml-js.html">lib / js / exportaAHtml.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/m-muestraError-js.html">lib / js / muestraError.js</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-js/m-ProblemDetails-js.html">lib / js / ProblemDetails.js</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / js / consumeJson.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { exportaAHtml } <span class="codeReserved">from</span> <span class="codeString">"./exportaAHtml.js"</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * Espera a que la promesa de un fetch termine. Si</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * hay error, lanza una excepci贸n. Si no hay error,</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * interpreta la respuesta del servidor como JSON y</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> * la convierte en una literal de objeto.</span></td></tr>
  <tr><td>9</td><td><span class="codeComment"> * </span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { string | Promise&lt;Response&gt; } servicio</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>12</td><td><span class="codeReserved">export</span> <span class="codeReserved">async</span> <span class="codeReserved">function</span> consumeJson(servicio) {</td></tr>
  <tr><td>13</td><td></td></tr>
  <tr><td>14</td><td> <span class="codeReserved">if</span> (<span class="codeReserved">typeof</span> servicio === <span class="codeString">"string"</span>) {</td></tr>
  <tr><td>15</td><td>  servicio = fetch(servicio, {</td></tr>
  <tr><td>16</td><td>   headers: { <span class="codeString">"Accept"</span>: <span class="codeString">"application/json, application/problem+json"</span> }</td></tr>
  <tr><td>17</td><td>  })</td></tr>
  <tr><td>18</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (!(servicio <span class="codeReserved">instanceof</span> Promise)) {</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">throw</span> <span class="codeReserved">new</span> Error(<span class="codeString">"Servicio de tipo incorrecto."</span>)</td></tr>
  <tr><td>20</td><td> }</td></tr>
  <tr><td>21</td><td></td></tr>
  <tr><td>22</td><td> <span class="codeReserved">const</span> respuesta = <span class="codeReserved">await</span> servicio</td></tr>
  <tr><td>23</td><td></td></tr>
  <tr><td>24</td><td> <span class="codeReserved">const</span> headers = respuesta.headers</td></tr>
  <tr><td>25</td><td></td></tr>
  <tr><td>26</td><td> <span class="codeReserved">if</span> (respuesta.ok) {</td></tr>
  <tr><td>27</td><td>  <span class="codeComment">// Aparentemente el servidor tuvo 茅xito.</span></td></tr>
  <tr><td>28</td><td></td></tr>
  <tr><td>29</td><td>  <span class="codeReserved">if</span> (respuesta.status === 204) {</td></tr>
  <tr><td>30</td><td>   <span class="codeComment">// No contiene texto de respuesta.</span></td></tr>
  <tr><td>31</td><td></td></tr>
  <tr><td>32</td><td>   <span class="codeReserved">return</span> { headers, body: {} }</td></tr>
  <tr><td>33</td><td></td></tr>
  <tr><td>34</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>35</td><td></td></tr>
  <tr><td>36</td><td>   <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>    <span class="codeReserved">return</span> { headers, body: JSON.parse(texto) }</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>43</td><td></td></tr>
  <tr><td>44</td><td>    <span class="codeComment">// El contenido no es JSON. Probablemente sea texto de un error.</span></td></tr>
  <tr><td>45</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, texto,</td></tr>
  <tr><td>46</td><td>     <span class="codeString">"/error/errorinterno.html"</span>)</td></tr>
  <tr><td>47</td><td></td></tr>
  <tr><td>48</td><td>   }</td></tr>
  <tr><td>49</td><td></td></tr>
  <tr><td>50</td><td>  }</td></tr>
  <tr><td>51</td><td></td></tr>
  <tr><td>52</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>53</td><td>  <span class="codeComment">// Hay un error.</span></td></tr>
  <tr><td>54</td><td></td></tr>
  <tr><td>55</td><td>  <span class="codeReserved">const</span> texto = <span class="codeReserved">await</span> respuesta.text()</td></tr>
  <tr><td>56</td><td></td></tr>
  <tr><td>57</td><td>  <span class="codeReserved">if</span> (texto === <span class="codeString">""</span>) {</td></tr>
  <tr><td>58</td><td></td></tr>
  <tr><td>59</td><td>   <span class="codeComment">// No hay texto. Se usa el texto predeterminado.</span></td></tr>
  <tr><td>60</td><td>   <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText)</td></tr>
  <tr><td>61</td><td></td></tr>
  <tr><td>62</td><td>  } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>63</td><td>   <span class="codeComment">// Debiera se un ProblemDetails en JSON.</span></td></tr>
  <tr><td>64</td><td></td></tr>
  <tr><td>65</td><td>   <span class="codeReserved">try</span> {</td></tr>
  <tr><td>66</td><td></td></tr>
  <tr><td>67</td><td>    <span class="codeReserved">const</span> { title, type, detail } = JSON.parse(texto)</td></tr>
  <tr><td>68</td><td></td></tr>
  <tr><td>69</td><td>    <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers,</td></tr>
  <tr><td>70</td><td>     <span class="codeReserved">typeof</span> title === <span class="codeString">"string"</span> ? title : respuesta.statusText,</td></tr>
  <tr><td>71</td><td>     <span class="codeReserved">typeof</span> type === <span class="codeString">"string"</span> ? type : undefined,</td></tr>
  <tr><td>72</td><td>     <span class="codeReserved">typeof</span> detail === <span class="codeString">"string"</span> ? detail : undefined)</td></tr>
  <tr><td>73</td><td></td></tr>
  <tr><td>74</td><td>   } <span class="codeReserved">catch</span> (error) {</td></tr>
  <tr><td>75</td><td></td></tr>
  <tr><td>76</td><td>    <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>77</td><td>     <span class="codeComment">// El error si era un ProblemDetails</span></td></tr>
  <tr><td>78</td><td></td></tr>
  <tr><td>79</td><td>     <span class="codeReserved">throw</span> error</td></tr>
  <tr><td>80</td><td></td></tr>
  <tr><td>81</td><td>    } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>82</td><td></td></tr>
  <tr><td>83</td><td>     <span class="codeReserved">throw</span> <span class="codeReserved">new</span> ProblemDetails(respuesta.status, headers, respuesta.statusText,</td></tr>
  <tr><td>84</td><td>      undefined, texto)</td></tr>
  <tr><td>85</td><td></td></tr>
  <tr><td>86</td><td>    }</td></tr>
  <tr><td>87</td><td></td></tr>
  <tr><td>88</td><td>   }</td></tr>
  <tr><td>89</td><td></td></tr>
  <tr><td>90</td><td>  }</td></tr>
  <tr><td>91</td><td></td></tr>
  <tr><td>92</td><td> }</td></tr>
  <tr><td>93</td><td></td></tr>
  <tr><td>94</td><td>}</td></tr>
  <tr><td>95</td><td></td></tr>
  <tr><td>96</td><td>exportaAHtml(consumeJson)</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / js / exportaAHtml.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * Permite que los eventos de html usen la funci贸n.</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {<span class="codeReserved">function</span>} functionInstance</span></td></tr>
  <tr><td>4</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>5</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> exportaAHtml(functionInstance) {</td></tr>
  <tr><td>6</td><td> window[nombreDeFuncionParaHtml(functionInstance)] = functionInstance</td></tr>
  <tr><td>7</td><td>}</td></tr>
  <tr><td>8</td><td></td></tr>
  <tr><td>9</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>10</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> {<span class="codeReserved">function</span>} valor</span></td></tr>
  <tr><td>11</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>12</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> nombreDeFuncionParaHtml(valor) {</td></tr>
  <tr><td>13</td><td> <span class="codeReserved">const</span> names = valor.name.split(<span class="codeString">/\s+/</span>g)</td></tr>
  <tr><td>14</td><td> <span class="codeReserved">return</span> names[names.length - 1]</td></tr>
  <tr><td>15</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / js / muestraError.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeReserved">import</span> { exportaAHtml } <span class="codeReserved">from</span> <span class="codeString">"./exportaAHtml.js"</span></td></tr>
  <tr><td>2</td><td><span class="codeReserved">import</span> { ProblemDetails } <span class="codeReserved">from</span> <span class="codeString">"./ProblemDetails.js"</span></td></tr>
  <tr><td>3</td><td></td></tr>
  <tr><td>4</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>5</td><td><span class="codeComment"> * Muestra un error en la consola y en un cuadro de</span></td></tr>
  <tr><td>6</td><td><span class="codeComment"> * alerta el mensaje de una excepci贸n.</span></td></tr>
  <tr><td>7</td><td><span class="codeComment"> * <span class="codeReserved">@param</span> { ProblemDetails | Error | <span class="codeReserved">null</span> } error descripci贸n del error.</span></td></tr>
  <tr><td>8</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>9</td><td><span class="codeReserved">export</span> <span class="codeReserved">function</span> muestraError(error) {</td></tr>
  <tr><td>10</td><td></td></tr>
  <tr><td>11</td><td> <span class="codeReserved">if</span> (error === <span class="codeReserved">null</span>) {</td></tr>
  <tr><td>12</td><td></td></tr>
  <tr><td>13</td><td>  console.error(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>14</td><td>  alert(<span class="codeString">"Error"</span>)</td></tr>
  <tr><td>15</td><td></td></tr>
  <tr><td>16</td><td> } <span class="codeReserved">else</span> <span class="codeReserved">if</span> (error <span class="codeReserved">instanceof</span> ProblemDetails) {</td></tr>
  <tr><td>17</td><td></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">let</span> mensaje = error.title</td></tr>
  <tr><td>19</td><td>  <span class="codeReserved">if</span> (error.detail) {</td></tr>
  <tr><td>20</td><td>   mensaje += <span class="codeString">`\n\n${error.detail}`</span></td></tr>
  <tr><td>21</td><td>  }</td></tr>
  <tr><td>22</td><td>  mensaje += <span class="codeString">`\n\nC贸digo: ${error.status}`</span></td></tr>
  <tr><td>23</td><td>  <span class="codeReserved">if</span> (error.type) {</td></tr>
  <tr><td>24</td><td>   mensaje += <span class="codeString">` ${error.type}`</span></td></tr>
  <tr><td>25</td><td>  }</td></tr>
  <tr><td>26</td><td></td></tr>
  <tr><td>27</td><td>  console.error(mensaje)</td></tr>
  <tr><td>28</td><td>  console.error(error)</td></tr>
  <tr><td>29</td><td>  console.error(<span class="codeString">"Headers:"</span>)</td></tr>
  <tr><td>30</td><td>  error.headers.forEach((valor, llave) =&gt; console.error(llave, <span class="codeString">"="</span>, valor))</td></tr>
  <tr><td>31</td><td>  alert(mensaje)</td></tr>
  <tr><td>32</td><td></td></tr>
  <tr><td>33</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>34</td><td></td></tr>
  <tr><td>35</td><td>  console.error(error)</td></tr>
  <tr><td>36</td><td>  alert(error.message)</td></tr>
  <tr><td>37</td><td></td></tr>
  <tr><td>38</td><td> }</td></tr>
  <tr><td>39</td><td></td></tr>
  <tr><td>40</td><td>}</td></tr>
  <tr><td>41</td><td></td></tr>
  <tr><td>42</td><td>exportaAHtml(muestraError)</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >4. lib / js / ProblemDetails.js</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td><span class="codeComment">/**</span></td></tr>
  <tr><td>2</td><td><span class="codeComment"> * Detalle de los errores devueltos por un servicio.</span></td></tr>
  <tr><td>3</td><td><span class="codeComment"> */</span></td></tr>
  <tr><td>4</td><td><span class="codeReserved">export</span> <span class="codeReserved">class</span> ProblemDetails <span class="codeReserved">extends</span> Error {</td></tr>
  <tr><td>5</td><td></td></tr>
  <tr><td>6</td><td> <span class="codeComment">/**</span></td></tr>
  <tr><td>7</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {number} status</span></td></tr>
  <tr><td>8</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {Headers} headers</span></td></tr>
  <tr><td>9</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} title</span></td></tr>
  <tr><td>10</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [type]</span></td></tr>
  <tr><td>11</td><td><span class="codeComment">  * <span class="codeReserved">@param</span> {string} [detail]</span></td></tr>
  <tr><td>12</td><td><span class="codeComment">  */</span></td></tr>
  <tr><td>13</td><td> <span class="codeReserved">constructor</span>(status, headers, title, type, detail) {</td></tr>
  <tr><td>14</td><td>  super(title)</td></tr>
  <tr><td>15</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>16</td><td><span class="codeComment">   * <span class="codeReserved">@readonly</span></span></td></tr>
  <tr><td>17</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>18</td><td>  <span class="codeReserved">this</span>.status = status</td></tr>
  <tr><td>19</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>20</td><td><span class="codeComment">   * <span class="codeReserved">@readonly</span></span></td></tr>
  <tr><td>21</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>22</td><td>  <span class="codeReserved">this</span>.headers = headers</td></tr>
  <tr><td>23</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>24</td><td><span class="codeComment">   * <span class="codeReserved">@readonly</span></span></td></tr>
  <tr><td>25</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>26</td><td>  <span class="codeReserved">this</span>.type = type</td></tr>
  <tr><td>27</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>28</td><td><span class="codeComment">   * <span class="codeReserved">@readonly</span></span></td></tr>
  <tr><td>29</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>30</td><td>  <span class="codeReserved">this</span>.detail = detail</td></tr>
  <tr><td>31</td><td>  <span class="codeComment">/**</span></td></tr>
  <tr><td>32</td><td><span class="codeComment">   * <span class="codeReserved">@readonly</span></span></td></tr>
  <tr><td>33</td><td><span class="codeComment">   */</span></td></tr>
  <tr><td>34</td><td>  <span class="codeReserved">this</span>.title = title</td></tr>
  <tr><td>35</td><td> }</td></tr>
  <tr><td>36</td><td></td></tr>
  <tr><td>37</td><td>}</td></tr>
 </tbody>
</table>
      </section>
      </section>
     <section>
         <h1 >B. Carpeta 芦 lib / php 禄</h1>
   <div class="lectura"> 
    <p class="noPrint">
     <a target="_blank" rel="noreferrer"
      href="print.html">Versi贸n para imprimir.</a>
    </p>
   </div>

  <div class="lectura">
   <nav>
    <h1>Contenido</h1>
    
   <ol type="1">
    
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/m-devuelveJson-php.html">lib / php / devuelveJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/m-devuelveResultadoNoJson-php.html">lib / php / devuelveResultadoNoJson.php</a>
    </p>
   </li>
   <li>
    <p>
     <a href="/m08srvdevuelve/m-lib/m-php/m-INTERNAL_SERVER_ERROR-php.html">lib / php / INTERNAL_SERVER_ERROR.php</a>
    </p>
   </li>
   </ol>
   </nav>
  </div>
     <section >
         <h1 >1. lib / php / devuelveJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/devuelveResultadoNoJson.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveJson($resultado)</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> $json = json_encode($resultado);</td></tr>
  <tr><td>9</td><td></td></tr>
  <tr><td>10</td><td> <span class="codeReserved">if</span> ($json === <span class="codeReserved">false</span>) {</td></tr>
  <tr><td>11</td><td></td></tr>
  <tr><td>12</td><td>  devuelveResultadoNoJson();</td></tr>
  <tr><td>13</td><td> } <span class="codeReserved">else</span> {</td></tr>
  <tr><td>14</td><td></td></tr>
  <tr><td>15</td><td>  http_response_code(200);</td></tr>
  <tr><td>16</td><td>  header(<span class="codeString">"Content-Type: application/json"</span>);</td></tr>
  <tr><td>17</td><td>  echo $json;</td></tr>
  <tr><td>18</td><td> }</td></tr>
  <tr><td>19</td><td>}</td></tr>
  <tr><td>20</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >2. lib / php / devuelveResultadoNoJson.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">require_once</span> <span class="codeReserved">__DIR__</span> . <span class="codeString">"/INTERNAL_SERVER_ERROR.php"</span>;</td></tr>
  <tr><td>4</td><td></td></tr>
  <tr><td>5</td><td><span class="codeReserved">function</span> devuelveResultadoNoJson()</td></tr>
  <tr><td>6</td><td>{</td></tr>
  <tr><td>7</td><td></td></tr>
  <tr><td>8</td><td> http_response_code(INTERNAL_SERVER_ERROR);</td></tr>
  <tr><td>9</td><td> header(<span class="codeString">"Content-Type: application/problem+json"</span>);</td></tr>
  <tr><td>10</td><td> echo <span class="codeString">'{'</span> .</td></tr>
  <tr><td>11</td><td>  <span class="codeString">'&quot;title&quot;: &quot;El resultado no puede representarse como JSON.&quot;'</span> .</td></tr>
  <tr><td>12</td><td>  <span class="codeString">'&quot;type&quot;: &quot;/error/resultadonojson.html&quot;'</span> .</td></tr>
  <tr><td>13</td><td>  <span class="codeString">'}'</span>;</td></tr>
  <tr><td>14</td><td>}</td></tr>
  <tr><td>15</td><td></td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >3. lib / php / INTERNAL_SERVER_ERROR.php</h1><table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>&lt;?<span class="codeReserved">php</span></td></tr>
  <tr><td>2</td><td></td></tr>
  <tr><td>3</td><td><span class="codeReserved">const</span> INTERNAL_SERVER_ERROR = 500;</td></tr>
 </tbody>
</table>
      </section>
      </section>
      </section>
     <section >
         <h1 >O. jsconfig.json</h1><div class="lectura">
 <ul>
  <li>
   <p>
    Este archivo ayuda a detectar errores en los archivos del proyecto.
   </p>
  </li>
  <li>
   <p>
    Lo utiliza principalmente Visual Studio Code.
   </p>
  </li>
  <li>
   <p>
    No se explica aqu铆 su estructura, pero puede encontrarse la explicaci贸n de
    todo en la documentaci贸n del sitio de Visual Studio Code.
   </p>
  </li>
 </ul>
</div>
<table class="codeShow">
 <caption style="text-align: left">
  <button type=button title="Copiar al portapapeles"
    onclick="copyToClipboard(this)">
   <span class="material-symbols-outlined">
    content_copy
   </span>
  </button>
 </caption>
 <tbody>
  <tr><td>1</td><td>{</td></tr>
  <tr><td>2</td><td> <span class="codeString">&quot;compilerOptions&quot;</span>: {</td></tr>
  <tr><td>3</td><td>  <span class="codeString">&quot;checkJs&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>4</td><td>  <span class="codeString">&quot;strictNullChecks&quot;</span>: <span class="codeReserved">true</span>,</td></tr>
  <tr><td>5</td><td>  <span class="codeString">&quot;target&quot;</span>: <span class="codeString">&quot;ES6&quot;</span>,</td></tr>
  <tr><td>6</td><td>  <span class="codeString">&quot;module&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>7</td><td>  <span class="codeString">&quot;moduleResolution&quot;</span>: <span class="codeString">&quot;Node16&quot;</span>,</td></tr>
  <tr><td>8</td><td>  <span class="codeString">&quot;lib&quot;</span>: [</td></tr>
  <tr><td>9</td><td>   <span class="codeString">&quot;ES2017&quot;</span>,</td></tr>
  <tr><td>10</td><td>   <span class="codeString">&quot;WebWorker&quot;</span>,</td></tr>
  <tr><td>11</td><td>   <span class="codeString">&quot;DOM&quot;</span></td></tr>
  <tr><td>12</td><td>  ]</td></tr>
  <tr><td>13</td><td> }</td></tr>
  <tr><td>14</td><td>}</td></tr>
 </tbody>
</table>
      </section>
     <section >
         <h1 >P. Resumen</h1><div class="lectura">
 <ul>
  <li>
   <p>
    En esta lecci贸n se mostr贸 el funcionamiento de un ejemplo recibe los datos
    JSON generados por un servicio.
   </p>
  </li>
 </ul>
</div>
      </section>
</body>

</html>